!function(){function g(a){var b=this;if(!a)throw new Error("invalid params, notfound editor");b.editor=a,f[a.uid]=this,a.addListener("destroy",function(){delete f[a.uid],b.editor=null})}var a={},b=["width","height","position","top","left","margin","padding","overflowX","overflowY"],c={},d={},e={},f={};UM.registerUI("fullscreen",function(a){var b=this,c=$.eduibutton({icon:"fullscreen",title:b.options.labelMap&&b.options.labelMap[a]||b.getLang("labelMap."+a),click:function(){b.execCommand(a),UM.setTopEditor(b)}});return b.addListener("selectionchange",function(){var b=this.queryCommandState(a);c.edui().disabled(-1==b).active(1==b)}),b.addListener("ready",function(){b.options.fullscreen&&g.getInstance(b).toggle()}),c}),UM.commands["fullscreen"]={execCommand:function(){g.getInstance(this).toggle()},queryCommandState:function(){return this._edui_fullscreen_status},notNeedUndo:1},g.prototype={toggle:function(){var a=this.editor,b=this.isFullState();a.fireEvent("beforefullscreenchange",!b),this.update(!b),b?this.revert():this.enlarge(),a.fireEvent("afterfullscreenchange",!b),"true"===a.body.contentEditable&&a.fireEvent("fullscreenchanged",!b),a.fireEvent("selectionchange")},enlarge:function(){this.saveSataus(),this.setDocumentStatus(),this.resize()},revert:function(){var a=this.editor.options,b=/%$/.test(a.initialFrameHeight)?"100%":a.initialFrameHeight-this.getStyleValue("padding-top")-this.getStyleValue("padding-bottom")-this.getStyleValue("border-width");$.IE6&&this.getEditorHolder().style.setExpression("height","this.scrollHeight <= "+b+' ? "'+b+'px" : "auto"'),this.revertContainerStatus(),this.revertContentAreaStatus(),this.revertDocumentStatus()},update:function(a){this.editor._edui_fullscreen_status=a},resize:function(){var a=null,b=0,c=0,d=0,e=0,f=this.editor,h=null,i=null;this.isFullState()&&(a=$(window),c=a.width(),b=a.height(),i=this.getEditorHolder(),d=parseInt(domUtils.getComputedStyle(i,"border-width"),10)||0,d+=parseInt(domUtils.getComputedStyle(f.container,"border-width"),10)||0,e+=parseInt(domUtils.getComputedStyle(i,"padding-left"),10)+parseInt(domUtils.getComputedStyle(i,"padding-right"),10)||0,$.IE6&&i.style.setExpression("height",null),h=this.getBound(),$(f.container).css({width:c+"px",height:b+"px",position:$.IE6?"absolute":"fixed",top:h.top,left:h.left,margin:0,padding:0,overflowX:"hidden",overflowY:"hidden"}),$(i).css({width:c-2*d-e+"px",height:b-2*d-(f.options.withoutToolbar?0:$(".edui-toolbar",f.container).outerHeight())-$(".edui-bottombar",f.container).outerHeight()+"px",overflowX:"hidden",overflowY:"auto"}))},saveSataus:function(){var f,g,c=this.editor.container.style,d=null,e={};for(f=0,g=b.length;g>f;f++)d=b[f],e[d]=c[d];a[this.editor.uid]=e,this.saveContentAreaStatus(),this.saveDocumentStatus()},saveContentAreaStatus:function(){var a=$(this.getEditorHolder());c[this.editor.uid]={width:a.css("width"),overflowX:a.css("overflowX"),overflowY:a.css("overflowY"),height:a.css("height")}},saveDocumentStatus:function(){var a=$(this.getEditorDocumentBody());d[this.editor.uid]={overflowX:a.css("overflowX"),overflowY:a.css("overflowY")},e[this.editor.uid]={overflowX:$(this.getEditorDocumentElement()).css("overflowX"),overflowY:$(this.getEditorDocumentElement()).css("overflowY")}},revertContainerStatus:function(){$(this.editor.container).css(this.getEditorStatus())},revertContentAreaStatus:function(){var a=this.getEditorHolder(),b=this.getContentAreaStatus();this.supportMin()&&(delete b.height,a.style.height=null),$(a).css(b)},revertDocumentStatus:function(){var a=this.getDocumentStatus();$(this.getEditorDocumentBody()).css("overflowX",a.body.overflowX),$(this.getEditorDocumentElement()).css("overflowY",a.html.overflowY)},setDocumentStatus:function(){$(this.getEditorDocumentBody()).css({overflowX:"hidden",overflowY:"hidden"}),$(this.getEditorDocumentElement()).css({overflowX:"hidden",overflowY:"hidden"})},isFullState:function(){return!!this.editor._edui_fullscreen_status},getEditorStatus:function(){return a[this.editor.uid]},getContentAreaStatus:function(){return c[this.editor.uid]},getEditorDocumentElement:function(){return this.editor.container.ownerDocument.documentElement},getEditorDocumentBody:function(){return this.editor.container.ownerDocument.body},getEditorHolder:function(){return this.editor.body},getDocumentStatus:function(){return{body:d[this.editor.uid],html:e[this.editor.uid]}},supportMin:function(){var a=null;return this._support||(a=document.createElement("div"),this._support="minWidth"in a.style,a=null),this._support},getBound:function(){var a={html:!0,body:!0},b={top:0,left:0},c=null;return $.IE6?(c=this.editor.container.offsetParent,c&&!a[c.nodeName.toLowerCase()]&&(a=c.getBoundingClientRect(),b.top=-a.top,b.left=-a.left),b):b},getStyleValue:function(a){return parseInt(domUtils.getComputedStyle(this.getEditorHolder(),a))}},$.extend(g,{listen:function(){var a=null;g._hasFullscreenListener||(g._hasFullscreenListener=!0,$(window).on("resize",function(){null!==a&&(window.clearTimeout(a),a=null),a=window.setTimeout(function(){for(var b in f)f[b].resize();a=null},50)}))},getInstance:function(a){return f[a.uid]||new g(a),f[a.uid]}}),g.listen()}();