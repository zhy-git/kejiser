UM.registerUI("paragraph fontfamily fontsize",function(a){function g(a,b){var c=$("<span>").html(a).css({display:"inline",position:"absolute",top:-1e7,left:-1e5}).appendTo(document.body),d=c.width();return c.remove(),c=null,50>d?a:(a=a.slice(0,b?-4:-1),a.length?g(a+"...",!0):"...")}function h(a){var c,b=[];for(c in a.items)a.value.push(c),b.push(c),a.autowidthitem.push(g(c));return a.items=b,a.autoRecord=!1,a}function i(a){var d,e,b=null,c=[];for(d=0,e=a.items.length;e>d;d++)b=a.items[d].val,c.push(b.split(/\s*,\s*/)[0]),a.itemStyles.push("font-family: "+b),a.value.push(b),a.autowidthitem.push(g(c[d]));return a.items=c,a}function j(a){var d,e,b=null,c=[];for(a.itemStyles=[],a.value=[],d=0,e=a.items.length;e>d;d++)b=a.items[d],c.push(b),a.itemStyles.push("font-size: "+b+"px");return a.value=a.items,a.items=c,a.autoRecord=!1,a}var b=this,c=b.options.labelMap&&b.options.labelMap[a]||b.getLang("labelMap."+a),d={label:c,title:c,comboboxName:a,items:b.options[a]||[],itemStyles:[],value:[],autowidthitem:[]},e=null,f=null;if(0==d.items.length)return null;switch(a){case"paragraph":d=h(d);break;case"fontfamily":d=i(d);break;case"fontsize":d=j(d)}return e=$.eduibuttoncombobox(d).css("zIndex",b.getOpt("zIndex")+1),f=e.edui(),f.on("comboboxselect",function(c,d){b.execCommand(a,d.value)}).on("beforeshow",function(){0===e.parent().length&&e.appendTo(b.$container.find(".edui-dialog-container")),UM.setTopEditor(b)}),this.addListener("selectionchange",function(){var c=this.queryCommandState(a),d=this.queryCommandValue(a);f.button().edui().disabled(-1==c).active(1==c),d&&(d=d.replace(/['"]/g,"").toLowerCase().split(/['|"]?\s*,\s*[\1]?/),f.selectItemByLabel(d))}),f.button().addClass("edui-combobox")}),UM.registerUI("forecolor backcolor",function(a){function b(){return domUtils.getComputedStyle(e[0],"background-color")}var c=this,d=null,e=null,f=null;return this.addListener("selectionchange",function(){var b=this.queryCommandState(a);f.edui().disabled(-1==b).active(1==b)}),f=$.eduicolorsplitbutton({icon:a,caret:!0,name:a,title:c.getLang("labelMap")[a],click:function(){c.execCommand(a,b())}}),e=f.edui().colorLabel(),d=$.eduicolorpicker({name:a,lang_clearColor:c.getLang("clearColor")||"",lang_themeColor:c.getLang("themeColor")||"",lang_standardColor:c.getLang("standardColor")||""}).on("pickcolor",function(b,d){window.setTimeout(function(){e.css("backgroundColor",d),c.execCommand(a,d)},0)}).on("show",function(){UM.setActiveWidget(colorPickerWidget.root())}).css("zIndex",c.getOpt("zIndex")+1),f.edui().on("arrowclick",function(){d.parent().length||c.$container.find(".edui-dialog-container").append(d),d.edui().show(f,{caretDir:"down",offsetTop:-5,offsetLeft:8,caretLeft:11,caretTop:-8}),UM.setTopEditor(c)}).register("click",f,function(){d.edui().hide()}),f});