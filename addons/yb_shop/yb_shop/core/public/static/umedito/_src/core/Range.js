!function(){function d(a){a.collapsed=a.startContainer&&a.endContainer&&a.startContainer===a.endContainer&&a.startOffset==a.endOffset}function e(a){return!a.collapsed&&1==a.startContainer.nodeType&&a.startContainer===a.endContainer&&1==a.endOffset-a.startOffset}function f(a,b,c,e){return 1==b.nodeType&&(dtd.$empty[b.tagName]||dtd.$nonChild[b.tagName])&&(c=domUtils.getNodeIndex(b)+(a?0:1),b=b.parentNode),a?(e.startContainer=b,e.startOffset=c,e.endContainer||e.collapse(!0)):(e.endContainer=b,e.endOffset=c,e.startContainer||e.collapse(!1)),d(e),e}function h(a,b){try{if(c&&domUtils.inDoc(c,a))if(c.nodeValue.replace(fillCharReg,"").length)c.nodeValue=c.nodeValue.replace(fillCharReg,"");else{var d=c.parentNode;for(domUtils.remove(c);d&&domUtils.isEmptyInlineElement(d)&&(browser.safari?!(domUtils.getPosition(d,b)&domUtils.POSITION_CONTAINS):!d.contains(b));)c=d.parentNode,domUtils.remove(d),d=c}}catch(e){}}function i(a,b){var c;for(a=a[b];a&&domUtils.isFillChar(a);)c=a[b],domUtils.remove(a),a=c}function j(a,b){var i,j,k,l,m,n,o,p,r,q,s,c=a.startContainer,d=a.endContainer,e=a.startOffset,f=a.endOffset,g=a.document,h=g.createDocumentFragment();if(1==c.nodeType&&(c=c.childNodes[e]||(i=c.appendChild(g.createTextNode("")))),1==d.nodeType&&(d=d.childNodes[f]||(j=d.appendChild(g.createTextNode("")))),c===d&&3==c.nodeType)return h.appendChild(g.createTextNode(c.substringData(e,f-e))),b&&(c.deleteData(e,f-e),a.collapse(!0)),h;for(m=h,n=domUtils.findParents(c,!0),o=domUtils.findParents(d,!0),p=0;n[p]==o[p];)p++;for(q=p;r=n[q];q++){for(k=r.nextSibling,r==c?i||(3==a.startContainer.nodeType?(m.appendChild(g.createTextNode(c.nodeValue.slice(e))),b&&c.deleteData(e,c.nodeValue.length-e)):m.appendChild(b?c:c.cloneNode(!0))):(l=r.cloneNode(!1),m.appendChild(l));k&&k!==d&&k!==o[q];)r=k.nextSibling,m.appendChild(b?k:k.cloneNode(!0)),k=r;m=l}for(m=h,n[p]||(m.appendChild(n[p-1].cloneNode(!1)),m=m.firstChild),q=p;s=o[q];q++){if(k=s.previousSibling,s==d?j||3!=a.endContainer.nodeType||(m.appendChild(g.createTextNode(d.substringData(0,f))),b&&d.deleteData(0,f)):(l=s.cloneNode(!1),m.appendChild(l)),q!=p||!n[p])for(;k&&k!==c;)s=k.previousSibling,m.insertBefore(b?k:k.cloneNode(!0),m.firstChild),k=s;m=l}return b&&a.setStartBefore(o[p]?n[p]?o[p]:n[p-1]:o[p-1]).collapse(!0),i&&domUtils.remove(i),j&&domUtils.remove(j),h}var c,a=0,b=domUtils.fillChar,g=dom.Range=function(a,b){var c=this;c.startContainer=c.startOffset=c.endContainer=c.endOffset=null,c.document=a,c.collapsed=!0,c.body=b};g.prototype={deleteContents:function(){var a;return this.collapsed||j(this,1),browser.webkit&&(a=this.startContainer,3!=a.nodeType||a.nodeValue.length||(this.setStartBefore(a).collapse(!0),domUtils.remove(a))),this},inFillChar:function(){var a=this.startContainer;return this.collapsed&&3==a.nodeType&&a.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==a.nodeValue.length?!0:!1},setStart:function(a,b){return f(!0,a,b,this)},setEnd:function(a,b){return f(!1,a,b,this)},setStartAfter:function(a){return this.setStart(a.parentNode,domUtils.getNodeIndex(a)+1)},setStartBefore:function(a){return this.setStart(a.parentNode,domUtils.getNodeIndex(a))},setEndAfter:function(a){return this.setEnd(a.parentNode,domUtils.getNodeIndex(a)+1)},setEndBefore:function(a){return this.setEnd(a.parentNode,domUtils.getNodeIndex(a))},setStartAtFirst:function(a){return this.setStart(a,0)},setStartAtLast:function(a){return this.setStart(a,3==a.nodeType?a.nodeValue.length:a.childNodes.length)},setEndAtFirst:function(a){return this.setEnd(a,0)},setEndAtLast:function(a){return this.setEnd(a,3==a.nodeType?a.nodeValue.length:a.childNodes.length)},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},selectNodeContents:function(a){return this.setStart(a,0).setEndAtLast(a)},cloneRange:function(){var a=this;return new g(a.document).setStart(a.startContainer,a.startOffset).setEnd(a.endContainer,a.endOffset)},collapse:function(a){var b=this;return a?(b.endContainer=b.startContainer,b.endOffset=b.startOffset):(b.startContainer=b.endContainer,b.startOffset=b.endOffset),b.collapsed=!0,b},shrinkBoundary:function(a){function e(a){return 1==a.nodeType&&!domUtils.isBookmarkNode(a)&&!dtd.$empty[a.tagName]&&!dtd.$nonChild[a.tagName]}for(var c,b=this,d=b.collapsed;1==b.startContainer.nodeType&&(c=b.startContainer.childNodes[b.startOffset])&&e(c);)b.setStart(c,0);if(d)return b.collapse(!0);if(!a)for(;1==b.endContainer.nodeType&&b.endOffset>0&&(c=b.endContainer.childNodes[b.endOffset-1])&&e(c);)b.setEnd(c,c.childNodes.length);return b},trimBoundary:function(a){var b,c,d,e,f;return this.txtToElmBoundary(),b=this.startContainer,c=this.startOffset,d=this.collapsed,e=this.endContainer,3==b.nodeType&&(0==c?this.setStartBefore(b):c>=b.nodeValue.length?this.setStartAfter(b):(f=domUtils.split(b,c),b===e?this.setEnd(f,this.endOffset-c):b.parentNode===e&&(this.endOffset+=1),this.setStartBefore(f)),d)?this.collapse(!0):(a||(c=this.endOffset,e=this.endContainer,3==e.nodeType&&(0==c?this.setEndBefore(e):(c<e.nodeValue.length&&domUtils.split(e,c),this.setEndAfter(e)))),this)},txtToElmBoundary:function(a){function b(a,b){var c=a[b+"Container"],d=a[b+"Offset"];3==c.nodeType&&(d?d>=c.nodeValue.length&&a["set"+b.replace(/(\w)/,function(a){return a.toUpperCase()})+"After"](c):a["set"+b.replace(/(\w)/,function(a){return a.toUpperCase()})+"Before"](c))}return(a||!this.collapsed)&&(b(this,"start"),b(this,"end")),this},insertNode:function(a){var d,e,f,b=a,c=1;return 11==a.nodeType&&(b=a.firstChild,c=a.childNodes.length),this.trimBoundary(!0),d=this.startContainer,e=this.startOffset,f=d.childNodes[e],f?d.insertBefore(a,f):d.appendChild(a),b.parentNode===this.endContainer&&(this.endOffset=this.endOffset+c),this.setStartBefore(b)},setCursor:function(a,b){return this.collapse(!a).select(b)},createBookmark:function(b,c){var d,e=this.document.createElement("span");return e.style.cssText="display:none;line-height:0px;",e.appendChild(this.document.createTextNode("‚Äç")),e.id="_baidu_bookmark_start_"+(c?"":a++),this.collapsed||(d=e.cloneNode(!0),d.id="_baidu_bookmark_end_"+(c?"":a++)),this.insertNode(e),d&&this.collapse().insertNode(d).setEndBefore(d),this.setStartAfter(e),{start:b?e.id:e,end:d?b?d.id:d:null,id:b}},moveToBookmark:function(a){var b=a.id?this.document.getElementById(a.start):a.start,c=a.end&&a.id?this.document.getElementById(a.end):a.end;return this.setStartBefore(b),domUtils.remove(b),c?(this.setEndBefore(c),domUtils.remove(c)):this.collapse(!0),this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},getClosedNode:function(){var a,b,c;return this.collapsed||(b=this.cloneRange().adjustmentBoundary().shrinkBoundary(),e(b)&&(c=b.startContainer.childNodes[b.startOffset],c&&1==c.nodeType&&(dtd.$empty[c.tagName]||dtd.$nonChild[c.tagName])&&(a=c))),a},select:browser.ie?function(a,d){var e,f,l,j,k,m,n,o;if(this.collapsed||this.shrinkBoundary(),f=this.getClosedNode(),f&&!d){try{e=this.document.body.createControlRange(),e.addElement(f),e.select()}catch(g){}return this}j=this.createBookmark(),k=j.start,e=this.document.body.createTextRange(),e.moveToElementText(k),e.moveStart("character",1),this.collapsed?a||3==this.startContainer.nodeType||(n=this.document.createTextNode(b),o=this.document.createElement("span"),o.appendChild(this.document.createTextNode(b)),k.parentNode.insertBefore(o,k),k.parentNode.insertBefore(n,k),h(this.document,n),c=n,i(o,"previousSibling"),i(k,"nextSibling"),e.moveStart("character",-1),e.collapse(!0)):(m=this.document.body.createTextRange(),l=j.end,m.moveToElementText(l),e.setEndPoint("EndToEnd",m)),this.moveToBookmark(j),o&&domUtils.remove(o);try{e.select()}catch(g){}return this}:function(a){function d(a){function b(b,c,d){3==b.nodeType&&b.nodeValue.length<c&&(a[d+"Offset"]=b.nodeValue.length)}b(a.startContainer,a.startOffset,"start"),b(a.endContainer,a.endOffset,"end")}var g,j,k,l,e=domUtils.getWindow(this.document),f=e.getSelection();if(browser.gecko?this.body.focus():e.focus(),f){if(f.removeAllRanges(),this.collapsed&&!a&&(j=this.startContainer,k=j,1==j.nodeType&&(k=j.childNodes[this.startOffset]),3==j.nodeType&&this.startOffset||(k?k.previousSibling&&3==k.previousSibling.nodeType:j.lastChild&&3==j.lastChild.nodeType)||(g=this.document.createTextNode(b),this.insertNode(g),h(this.document,g),i(g,"previousSibling"),i(g,"nextSibling"),c=g,this.setStart(g,browser.webkit?1:0).collapse(!0))),l=this.document.createRange(),this.collapsed&&browser.opera&&1==this.startContainer.nodeType)if(k=this.startContainer.childNodes[this.startOffset]){for(;k&&domUtils.isBlockElm(k)&&1==k.nodeType&&k.childNodes[0];)k=k.childNodes[0];k&&this.setStartBefore(k).collapse(!0)}else k=this.startContainer.lastChild,k&&domUtils.isBr(k)&&this.setStartBefore(k).collapse(!0);d(this),l.setStart(this.startContainer,this.startOffset),l.setEnd(this.endContainer,this.endOffset),f.addRange(l)}return this},createAddress:function(a,b){function e(a){var h,g,i,j,k,c=a?d.startContainer:d.endContainer,e=domUtils.findParents(c,!0,function(a){return!domUtils.isBody(a)}),f=[];for(g=0;h=e[g++];)f.push(domUtils.getNodeIndex(h,b));if(i=0,b)if(3==c.nodeType){for(j=c.previousSibling;j&&3==j.nodeType;)i+=j.nodeValue.replace(fillCharReg,"").length,j=j.previousSibling;i+=a?d.startOffset:d.endOffset}else if(c=c.childNodes[a?d.startOffset:d.endOffset])i=domUtils.getNodeIndex(c,b);else for(c=a?d.startContainer:d.endContainer,k=c.firstChild;k;)if(domUtils.isFillChar(k))k=k.nextSibling;else if(i++,3==k.nodeType)for(;k&&3==k.nodeType;)k=k.nextSibling;else k=k.nextSibling;else i=a?domUtils.isFillChar(c)?0:d.startOffset:d.endOffset;return 0>i&&(i=0),f.push(i),f}var c={},d=this;return c.startAddress=e(!0),a||(c.endAddress=d.collapsed?[].concat(c.startAddress):e()),c},moveToAddress:function(a,b){function d(a,b){var e,f,h,g,i,d=c.body;for(g=0,i=a.length;i>g;g++)if(h=a[g],e=d,d=d.childNodes[h],!d){f=h;break}b?d?c.setStartBefore(d):c.setStart(e,f):d?c.setEndBefore(d):c.setEnd(e,f)}var c=this;return d(a.startAddress,!0),!b&&a.endAddress&&d(a.endAddress),c},equals:function(a){for(var b in this)if(this.hasOwnProperty(b)&&this[b]!==a[b])return!1;return!0},scrollIntoView:function(){var b,c,d,a=$('<span style="padding:0;margin:0;display:block;border:0">&nbsp;</span>');this.cloneRange().insertNode(a.get(0)),b=$(window).scrollTop(),c=$(window).height(),d=a.offset().top,(b-c>d||d>b+c)&&(d>b+c?window.scrollTo(0,d-c+a.height()):window.scrollTo(0,b-d)),a.remove()},getOffset:function(){var a=this.createBookmark(),b=$(a.start).css("display","inline-block").offset();return this.moveToBookmark(a),b}}}();