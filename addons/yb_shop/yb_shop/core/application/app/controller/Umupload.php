<?php
 namespace app\app\controller; use app\admin\service\Images; use app\common\model\ImagesGroup; session_start(); define("\x49\101\x5f\122\117\117\x54", ''); load()->func("\x66\x69\x6c\145"); use think\Controller; use think\config; use think\Db; use think\Log; use think\Image; use think\Session; define("\125\120\x4c\x4f\101\104\x5f\126\111\104\105\117", Config::get("\x76\151\145\x77\137\x72\145\160\x6c\141\x63\x65\137\163\164\x72\56\x55\x50\114\x4f\101\104\x5f\x56\111\104\x45\x4f")); class Umupload extends Controller { private $return = array(); private $file_path = ''; private $file_name = ''; private $file_size = 0; private $file_type = ''; private $upload_type = 2; public function uploadFile() { goto FlGBm; CGc_c: return $this->ajaxFileReturn(); goto OAn1H; y2LqE: if ($this->validationFile()) { goto IJLZS; } goto CGc_c; yvDnM: $ext = "\x2e" . $file_name_explode[$suffix]; goto C6HFa; IO0An: if (!strstr(UPLOAD_VIDEO, $this->file_path)) { goto aO0Ux; } goto BgKeV; E2kKG: if (!($this->file_path == '')) { goto ZciLa; } goto o6uOX; C6HFa: $newfile = $guid . $ext; goto QNsgK; gPi4l: @unlink($_FILES["\x66\151\x6c\145\137\x75\x70\x6c\157\x61\144"]); goto ZDAGq; Ota13: $this->file_path = "\160\165\142\x6c\151\x63\57\165\x70\x6c\x6f\x61\x64\x2f" . $mch_id . "\x2f" . $old_path; goto E2kKG; dK0WD: if (is_error($remotestatus)) { goto Rxk5A; } goto hB8S0; fA9fx: $this->return["\164\x69\164\x6c\145"] = $newfile; goto uSQJR; D7k_3: return $this->ajaxFileReturn(); goto gfGZy; vP0Mb: $this->return["\x75\162\x6c"] = $remoteurl; goto JWgwi; gHkH9: $this->return["\x6d\x65\x73\x73\x61\x67\145"] = "\346\x96\x87\344\273\xb6\346\xa0\274\xe5\274\x8f\351\224\x99\350\xaf\xaf"; goto D7k_3; cl5WO: $mimetype = exif_imagetype($ok["\x70\141\164\x68"]); goto LP8FI; o6uOX: $this->return["\x6d\145\x73\163\x61\147\145"] = "\xe6\x96\207\344\273\266\xe8\xb7\xaf\345\276\x84\344\270\215\350\x83\275\xe4\xb8\xba\347\xa9\xba"; goto vkn4Z; TWEnh: mkdir($this->file_path, $mode, true); goto yAFUT; Nzyrt: Rxk5A: goto KZCR0; TjZML: $file_name_explode = explode("\56", $this->file_name); goto Gofnz; ZDAGq: $this->return["\x73\164\x61\x74\x65"] = "\123\125\103\103\105\x53\x53"; goto FZpkm; BgKeV: $this->return["\155\145\x73\163\x61\147\145"] = "\xe8\257\267\346\243\x80\346\237\xa5\346\202\250\xe7\x9a\204\344\xb8\x8a\344\274\xa0\345\217\202\346\x95\xb0\xe9\x85\x8d\347\xbd\256\xe6\x88\226\xe4\270\x8a\344\274\xa0\xe7\x9a\x84\346\x96\x87\xe4\xbb\xb6\346\x98\257\345\220\xa6\346\x9c\x89\xe8\257\257"; goto te9zw; Vzx6G: if (file_exists($this->file_path)) { goto SJ7cP; } goto E7D2z; gBCYz: if (empty($_W["\163\x65\x74\x74\x69\156\147"]["\162\x65\155\157\164\x65"]["\164\x79\x70\x65"])) { goto ksyeV; } goto wm6nn; vkn4Z: return $this->ajaxFileReturn(); goto NwHE4; gvKey: return $this->ajaxFileReturn(); goto grRPl; aTed_: $remotestatus = file_remote_upload($pathname); goto dK0WD; GVm3z: aO0Ux: goto gPi4l; hCrrA: $this->file_name = $_FILES["\165\160\146\151\154\x65"]["\x6e\x61\x6d\145"]; goto N2qNL; LP8FI: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto zdmDQ; } goto gHkH9; QNsgK: $ok = $this->moveUploadFile($_FILES["\165\x70\146\151\x6c\145"]["\164\x6d\160\137\x6e\x61\155\x65"], $this->file_path . $newfile); goto cl5WO; N2qNL: $this->file_size = $_FILES["\165\160\146\151\x6c\145"]["\163\x69\x7a\145"]; goto kX8GN; te9zw: goto dSzBu; goto GVm3z; ICg6v: return $this->ajaxFileReturn(); goto LpKyL; TF_RK: goto bpx6Y; goto Nzyrt; hB8S0: $remoteurl = tomedia($ok["\160\141\x74\150"]); goto AUrlz; FZpkm: $this->return["\165\162\x6c"] = $_W["\x73\151\x74\145\x72\x6f\x6f\164"] . "\141\x64\x64\x6f\156\163\57\x79\x62\x5f\x73\150\x6f\x70\57\x63\157\162\145\57" . $ok["\160\141\x74\150"]; goto fA9fx; xFFky: ksyeV: goto R7YGz; Qf5SS: $this->return["\155\145\x73\x73\x61\147\x65"] = "\xe6\x96\207\xe4\273\xb6\xe5\244\247\xe5\xb0\x8f\344\xb8\xba\60\115\x42"; goto gvKey; FlGBm: global $_W; goto sjP5E; E7D2z: $mode = intval("\60\x37\67\x37", 8); goto TWEnh; gfGZy: zdmDQ: goto gBCYz; IoVqA: return json_encode($this->return); goto TF_RK; hSk87: bpx6Y: goto xFFky; kX8GN: $this->file_type = $_FILES["\x75\x70\146\151\154\x65"]["\164\x79\160\145"]; goto LBAyo; grRPl: uBcc8: goto y2LqE; OAn1H: IJLZS: goto lGSLZ; KZCR0: return "\xe8\xbf\x9c\xe7\xa8\213\xe9\231\x84\344\273\266\344\xb8\x8a\xe4\274\xa0\345\244\xb1\350\264\245\357\xbc\214\350\257\xb7\xe6\xa3\200\346\237\xa5\351\x85\x8d\xe7\275\256\xe5\271\xb6\351\x87\x8d\346\x96\260\xe4\270\x8a\xe4\274\240"; goto hSk87; UAZSw: goto NXOqH; goto gx8QB; rP7Hf: NXOqH: goto ICg6v; yAFUT: SJ7cP: goto hCrrA; lGSLZ: $guid = app_random(32); goto TjZML; z8AXL: $this->return["\x6d\x65\163\163\141\x67\x65"] = "\xe8\257\xb7\xe6\xa3\x80\xe6\x9f\xa5\346\202\xa8\347\232\x84\344\270\x8a\344\xbc\xa0\xe5\x8f\202\xe6\225\260\xe9\x85\215\xe7\xbd\256\xe6\210\x96\344\xb8\x8a\xe4\xbc\xa0\347\x9a\204\346\x96\207\xe4\xbb\266\xe6\x98\xaf\345\x90\246\346\x9c\211\xe8\257\xaf"; goto UAZSw; R7YGz: if ($ok["\143\157\144\x65"]) { goto ZEk7P; } goto z8AXL; gx8QB: ZEk7P: goto IO0An; Gofnz: $suffix = count($file_name_explode) - 1; goto yvDnM; wm6nn: $pathname = $ok["\160\141\x74\150"]; goto aTed_; HFgCO: $old_path = request()->post("\x66\151\154\145\137\160\141\164\150", ''); goto Ota13; JWgwi: $this->return["\x74\151\164\154\145"] = $newfile; goto IoVqA; sjP5E: $mch_id = $_W["\x61\143\151\x64"]; goto HFgCO; AUrlz: $this->return["\163\x74\x61\x74\x65"] = "\123\x55\x43\x43\x45\123\123"; goto vP0Mb; uSQJR: dSzBu: goto rP7Hf; NwHE4: ZciLa: goto Vzx6G; LBAyo: if (!($this->file_size == 0)) { goto uBcc8; } goto Qf5SS; LpKyL: } private function ajaxFileReturn() { goto aIhRS; v6TYP: if (!(empty($this->return["\x6d\x65\163\163\x61\147\145"]) || null == $this->return["\155\145\163\163\x61\x67\145"] || '' == $this->return["\x6d\x65\163\163\x61\x67\x65"])) { goto zwu3M; } goto s1Mwl; sNEde: $this->return["\x64\x61\x74\141"] = ''; goto eUza3; iQ00l: KtL3F: goto v6TYP; oAE0K: if (!(empty($this->return["\144\x61\x74\141"]) || null == $this->return["\144\141\164\141"] || '' == $this->return["\x64\x61\x74\x61"])) { goto UEw_3; } goto sNEde; ux2Th: zwu3M: goto oAE0K; bcube: return json_encode($this->return); goto sLcWG; eUza3: UEw_3: goto bcube; aIhRS: if (!(empty($this->return["\x63\x6f\x64\145"]) || null == $this->return["\143\x6f\x64\x65"] || '' == $this->return["\x63\157\144\x65"])) { goto KtL3F; } goto INkKu; INkKu: $this->return["\143\x6f\x64\x65"] = 0; goto iQ00l; s1Mwl: $this->return["\x6d\x65\x73\163\141\x67\x65"] = ''; goto ux2Th; sLcWG: } private function validationFile() { goto SK2zy; u1gGh: $alltype = ["\151\x6d\x61\147\x65\x2f\152\160\147", "\151\155\141\x67\x65\57\152\160\145\x67", "\x69\155\141\147\x65\57\160\156\x67", "\x69\155\x61\x67\x65\57\x67\x69\146"]; goto j2c5Z; BP2TN: KDTIk: goto u1gGh; qI5xR: return $flag; goto ohWqg; Em5ZF: $flag = false; goto BP2TN; S9EPJ: if (!($this->file_size > 10000000)) { goto KDTIk; } goto sgYhq; SK2zy: $flag = true; goto S9EPJ; sgYhq: $this->return["\155\x65\163\163\x61\147\145"] = "\346\226\x87\344\273\266\xe4\270\x8a\344\xbc\240\xe5\xa4\xb1\350\xb4\xa5\54\350\xaf\267\xe6\243\x80\xe6\x9f\xa5\346\202\250\xe4\270\212\xe4\274\240\347\232\204\xe6\x96\x87\xe4\273\xb6\347\261\273\345\x9e\x8b\x2c\xe6\x96\207\xe4\273\266\xe5\244\247\xe5\260\x8f\xe4\xb8\x8d\xe8\x83\275\xe8\266\x85\xe8\277\x87\61\60\x4d\102"; goto Em5ZF; Z1QYj: $this->return["\155\145\x73\x73\141\x67\x65"] = "\xe6\x96\x87\344\xbb\266\347\xb1\xbb\xe5\236\x8b\351\224\231\xe8\xaf\257"; goto AHEqV; OBqR7: JhteO: goto qI5xR; j2c5Z: if (in_array($this->file_type, $alltype)) { goto JhteO; } goto Z1QYj; AHEqV: $flag = false; goto OBqR7; ohWqg: } public function photoCreate($upFilePath, $photoPath, $ext, $type = 0, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $domain, $bucket) { goto nboy7; gvKeG: if ($pic_id == '') { goto E2LVc; } goto nkjP8; ZIY_s: $photoArray["\163\x6d\141\x6c\x6c\120\x61\164\x68"]["\160\141\164\x68"] = $upFilePath . md5(time() . $pic_tag) . "\x33" . $ext; goto iDzuR; k_hfH: xQ3Q5: goto Nn7q_; dcbJo: return $retval; goto FeQI6; lR9fq: LF1_V: goto k_hfH; Ahfxk: $photoArray["\x62\151\x67\x50\x61\164\150"]["\x70\141\164\x68"] = $upFilePath . md5(time() . $pic_tag) . "\61" . $ext; goto RYKYc; iDzuR: $photoArray["\154\x69\x74\x74\154\145\x50\141\164\150"]["\x70\x61\x74\x68"] = $upFilePath . md5(time() . $pic_tag) . "\64" . $ext; goto V2K1j; Nn7q_: $album = new Images(); goto gvKeG; koHa3: $_W = $_SESSION["\167\x65\67\x5f\167"]; goto Ox17H; bM4sB: otd6H: goto dcbJo; Z8_G0: $image = \think\Image::open($photoPath); goto Ahfxk; t3B_s: goto otd6H; goto CAJ2I; nkjP8: $retval = $album->ModifyAlbumPicture($pic_id, $_W["\x73\x69\x74\x65\162\157\157\x74"] . "\141\144\144\157\156\x73\57\171\142\x5f\163\150\x6f\160\x2f\143\157\162\145\57" . $photoPath, $width . "\54" . $height, $width . "\54" . $height, $photoArray["\142\151\147\120\x61\164\150"]["\160\141\x74\x68"], $photoArray["\x62\151\147\x50\x61\164\x68"]["\167\x69\x64\164\150"] . "\x2c" . $photoArray["\142\151\x67\120\x61\x74\x68"]["\150\145\x69\x67\x68\164"], $photoArray["\x62\151\147\x50\x61\164\x68"]["\167\x69\x64\164\150"] . "\54" . $photoArray["\x62\151\x67\120\141\x74\150"]["\x68\145\151\147\150\164"], $photoArray["\155\x69\144\x64\154\145\x50\141\164\x68"]["\160\141\x74\150"], $photoArray["\155\x69\x64\x64\x6c\145\120\x61\164\150"]["\167\x69\x64\164\150"] . "\54" . $photoArray["\155\x69\144\x64\x6c\145\120\141\164\150"]["\150\x65\151\x67\x68\x74"], $photoArray["\x6d\151\x64\144\x6c\145\120\x61\164\150"]["\x77\151\144\x74\150"] . "\54" . $photoArray["\x6d\x69\x64\144\154\145\120\141\164\150"]["\150\x65\x69\x67\x68\x74"], $photoArray["\x73\155\141\x6c\x6c\120\141\x74\150"]["\x70\141\164\150"], $photoArray["\x73\155\141\154\154\120\x61\x74\150"]["\x77\151\x64\164\x68"] . "\54" . $photoArray["\163\155\141\x6c\x6c\120\141\x74\150"]["\150\x65\151\147\x68\x74"], $photoArray["\163\155\x61\x6c\154\x50\x61\x74\150"]["\x77\x69\x64\x74\150"] . "\x2c" . $photoArray["\163\155\141\x6c\x6c\120\141\x74\x68"]["\x68\x65\x69\147\150\x74"], $photoArray["\x6c\151\x74\x74\154\x65\x50\141\164\x68"]["\x70\141\x74\150"], $photoArray["\x6c\151\164\164\154\x65\120\141\164\x68"]["\x77\151\144\164\x68"] . "\x2c" . $photoArray["\154\x69\164\164\154\145\x50\x61\x74\x68"]["\x68\x65\x69\x67\150\x74"], $photoArray["\x6c\151\164\x74\x6c\145\120\x61\164\x68"]["\167\x69\144\x74\150"] . "\54" . $photoArray["\x6c\151\x74\x74\154\145\x50\141\x74\x68"]["\x68\x65\x69\147\150\164"], $this->instance_id, $this->upload_type, $domain, $bucket); goto fykKN; fykKN: $retval = $pic_id; goto t3B_s; kzAhB: if (!($this->upload_type == 1)) { goto xQ3Q5; } goto Z8_G0; Ox17H: $photoArray = array("\x62\x69\147\x50\x61\164\150" => array("\x70\141\x74\150" => '', "\x77\x69\x64\164\150" => 700, "\150\x65\151\x67\150\164" => 700, "\164\171\x70\x65" => "\x31"), "\155\151\144\x64\154\x65\x50\141\164\150" => array("\160\x61\164\150" => '', "\x77\151\144\164\x68" => 360, "\150\145\151\x67\x68\x74" => 360, "\x74\171\160\145" => "\62"), "\x73\155\x61\x6c\x6c\x50\141\x74\x68" => array("\x70\x61\164\x68" => '', "\x77\x69\x64\164\x68" => 240, "\150\x65\x69\x67\x68\164" => 240, "\164\171\160\x65" => "\x33"), "\154\x69\164\x74\x6c\x65\120\x61\164\x68" => array("\160\141\x74\x68" => '', "\x77\x69\144\164\x68" => 60, "\150\145\x69\147\150\164" => 60, "\x74\171\x70\145" => "\x34")); goto kzAhB; Z3L0E: $retval = $album->addPicture($album_id, $pic_name, $pic_tag, $_W["\163\x69\x74\145\162\x6f\x6f\164"] . "\141\x64\x64\157\x6e\163\x2f\171\142\137\163\150\x6f\160\x2f\x63\157\x72\x65\x2f" . $photoPath, $width . "\x2c" . $height, $width . "\x2c" . $height, $photoArray["\142\151\x67\120\x61\x74\150"]["\x70\x61\x74\x68"], $photoArray["\x62\x69\x67\x50\x61\164\x68"]["\x77\x69\144\164\x68"] . "\54" . $photoArray["\142\151\147\x50\x61\x74\x68"]["\x68\145\151\147\x68\x74"], $photoArray["\142\x69\147\x50\141\x74\150"]["\x77\151\144\x74\x68"] . "\54" . $photoArray["\142\x69\147\120\141\x74\x68"]["\150\145\151\147\150\x74"], $photoArray["\x6d\x69\144\x64\x6c\145\120\141\x74\150"]["\160\141\x74\x68"], $photoArray["\155\x69\x64\x64\x6c\x65\120\x61\164\x68"]["\x77\x69\x64\x74\x68"] . "\x2c" . $photoArray["\155\x69\144\x64\154\x65\x50\x61\164\150"]["\x68\145\x69\147\150\x74"], $photoArray["\x6d\x69\x64\x64\154\x65\x50\141\164\x68"]["\x77\x69\144\x74\150"] . "\x2c" . $photoArray["\155\x69\144\144\154\145\120\141\x74\x68"]["\150\x65\151\x67\x68\x74"], $photoArray["\x73\x6d\x61\x6c\x6c\x50\141\x74\x68"]["\160\141\x74\150"], $photoArray["\163\x6d\141\154\154\x50\141\164\x68"]["\167\x69\144\x74\150"] . "\x2c" . $photoArray["\163\155\x61\x6c\154\120\141\x74\x68"]["\x68\x65\x69\147\150\x74"], $photoArray["\x73\x6d\141\154\x6c\120\x61\164\x68"]["\167\151\144\x74\x68"] . "\54" . $photoArray["\163\155\x61\x6c\154\x50\x61\x74\150"]["\x68\x65\151\147\150\x74"], $photoArray["\x6c\x69\164\x74\154\145\120\141\x74\x68"]["\160\141\x74\x68"], $photoArray["\x6c\151\164\164\x6c\x65\120\141\164\x68"]["\167\x69\x64\164\150"] . "\54" . $photoArray["\x6c\x69\164\x74\154\x65\x50\x61\164\150"]["\150\145\x69\x67\150\164"], $photoArray["\154\151\x74\164\154\x65\120\x61\x74\150"]["\167\x69\144\164\x68"] . "\54" . $photoArray["\154\151\164\164\x6c\x65\120\141\164\150"]["\150\145\151\147\150\x74"], $this->upload_type, $domain, $bucket); goto bM4sB; CAJ2I: E2LVc: goto Z3L0E; RYKYc: $photoArray["\x6d\x69\144\x64\x6c\145\120\x61\x74\x68"]["\160\141\x74\150"] = $upFilePath . md5(time() . $pic_tag) . "\x32" . $ext; goto ZIY_s; nboy7: global $_W; goto koHa3; V2K1j: foreach ($photoArray as $v) { goto G5ngm; sNHLw: $image->thumb($v["\x77\x69\144\164\x68"], $v["\x68\x65\151\147\x68\x74"], \think\Image::m4sSY)->save($v["\x70\x61\164\x68"]); goto O3riQ; O3riQ: PdBlv: goto QEAv3; QEAv3: ct39H: goto YDNqN; G5ngm: if (!stristr($type, $v["\164\x79\160\x65"])) { goto PdBlv; } goto sNHLw; YDNqN: } goto lR9fq; FeQI6: } public function moveUploadFile($file_path, $key) { goto ikHQT; ikHQT: if (!($this->upload_type == 2)) { goto d9095; } goto Ae5ry; OA2Yo: return $result; goto u7QRX; wM6xX: $result = ["\143\x6f\144\145" => $ok, "\x70\141\164\150" => $key, "\x64\157\x6d\141\x69\x6e" => '', "\142\165\143\x6b\145\x74" => '']; goto JRUPt; Ae5ry: $ok = @move_uploaded_file($file_path, $key); goto wM6xX; JRUPt: d9095: goto OA2Yo; u7QRX: } public function photoAlbumUpload() { goto myjk2; x04oL: goto kX1Xt; goto Gz2lt; YCaTd: $album_id = request()->post("\147\162\157\x75\x70\x5f\x69\144", ''); goto ybZGJ; sGLjw: $data["\146\x69\x6c\x65\x5f\151\144"] = $retval; goto aYl3u; lqjD6: $_W = $_SESSION["\x77\145\67\137\167"]; goto y2tLf; X2fVR: if (!($this->file_path == '')) { goto tgTKP; } goto tKgo8; E_dK0: $type = request()->post("\164\x79\160\x65", ''); goto jOtKL; vuuIg: $remotestatus = file_remote_upload($pathname); goto YOmSP; sYYeD: return $data; goto x04oL; wYcmb: $image_size = @getimagesize($ok["\160\x61\164\x68"]); goto vEBYI; mVeCD: TS4js: goto CGzEQ; XSKXU: $width = $image_size[0]; goto w410V; gMDOz: Z3IpQ: goto AK_Er; nPCAR: $data["\x66\x69\x6c\x65\137\x70\141\x74\x68"] = $remoteurl; goto ryz4t; Sx53Z: fSQFw: goto lZWdC; X8rRP: tq_Oo: goto iBaZU; YGp1m: return $data; goto t6Cs4; ryz4t: $res = Db::name("\171\x62\x73\x63\137\x69\x6d\x61\147\145\x73")->insertGetId(["\x67\x72\157\x75\x70\137\x69\144" => $album_id, "\151\x6d\147\137\156\141\x6d\x65" => $newfile, "\x69\155\147\137\164\x61\147" => '', "\x69\x6d\x67\137\x63\157\x76\145\x72" => $remoteurl]); goto JFqyp; qI2VB: if (!($this->file_size > 5000000)) { goto Rd2aX; } goto HiJJ4; NhCh8: $this->file_type = $_FILES["\x75\160\146\151\x6c\145"]["\164\x79\x70\145"]; goto iPBU7; DoNvR: $mode = intval("\x30\67\67\67", 8); goto IAsi0; EOJE4: $old_path = $this->file_path = request()->post("\146\151\x6c\145\137\x70\x61\x74\150", ''); goto Dix0S; TV5Bt: $pic_id = request()->post("\x69\155\147\x5f\151\x64", ''); goto z4dbs; O9qcr: $suffix = count($file_name_explode) - 1; goto IVnCA; R2vRH: Dn4eh: goto lubPY; icxUM: $data["\155\145\163\x73\x61\x67\145"] = "\xe5\x9b\276\xe7\x89\207\344\xb8\x8a\344\xbc\240\xe5\xa4\261\350\xb4\xa5"; goto MmD4B; Xb2LN: $data["\x6d\x65\163\x73\141\x67\145"] = "\xe5\x9b\xbe\347\x89\207\xe4\270\212\xe4\274\240\345\244\261\xe8\xb4\xa5"; goto rMgTH; qBzWa: $mimetype = exif_imagetype($ok["\x70\x61\x74\x68"]); goto Im4bd; y2tLf: if (empty($_W["\163\145\x74\164\x69\x6e\147"]["\162\x65\x6d\x6f\164\145"]["\164\171\x70\x65"])) { goto fSQFw; } goto EhL01; jlc98: return $data; goto P9OTp; npF2_: $data["\x73\x74\141\164\145"] = "\x30"; goto Xb2LN; vEBYI: if ($image_size) { goto X8875; } goto Otwvt; Dix0S: $this->file_path = "\160\165\x62\x6c\151\x63\x2f\165\x70\154\x6f\x61\x64\x2f" . $mch_id . "\x2f" . $old_path; goto X2fVR; te8KV: $data["\x73\164\141\164\145"] = "\x30"; goto OFod7; j9Lb7: $data["\x73\x74\x61\164\145"] = "\x30"; goto SM30G; dnbWt: kX1Xt: goto gMDOz; jOtKL: $pic_name = request()->post("\x69\155\x67\x5f\156\x61\x6d\x65", $file_new_name . $guid); goto YCaTd; kLk3a: goto ZmXeC; goto mVeCD; xkl98: $data["\x6f\162\151\147\151\x6e\137\146\x69\x6c\145\137\x6e\x61\155\145"] = $this->file_name; goto SKuUC; Zwk7g: $retval = $this->photoCreate($this->file_path, $ok["\x70\141\x74\x68"], "\x2e" . $file_name_explode[$suffix], $type, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $ok["\x64\x6f\155\x61\151\156"], $ok["\x62\x75\143\153\145\164"]); goto SSYzj; WEjLD: return $data; goto Z1zBJ; ItHyU: $tmp_array = $file_name_explode; goto zYTIw; Im4bd: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto elMFO; } goto j9Lb7; zYTIw: unset($tmp_array[$suffix]); goto wXZ5f; Uuhuw: @unlink($_FILES["\146\x69\x6c\x65\137\165\x70\154\x6f\x61\x64"]); goto wYcmb; MmD4B: $data["\x6f\162\151\147\151\156\x5f\x66\x69\x6c\145\x5f\156\x61\155\x65"] = $this->file_name; goto jlc98; SSYzj: if ($retval > 0) { goto TS4js; } goto npF2_; IgtEW: return $data; goto QT8nn; Otwvt: $data["\163\x74\x61\164\145"] = "\x30"; goto te87s; QFV2P: $picture_info = $album->getAlubmPictureDetail(["\x69\x6d\147\x5f\151\x64" => $retval]); goto sGLjw; K02gP: $name = $file_name_explode[0]; goto E_dK0; iBaZU: $guid = time(); goto q_wHb; StuOp: aZXti: goto kKXws; x_6Zi: $data["\x6f\x72\x69\147\151\x6e\137\x66\x69\x6c\145\x5f\156\141\155\145"] = $this->file_name; goto YGp1m; EhL01: $pathname = $ok["\160\141\164\150"]; goto vuuIg; vCD6t: return "\xe8\xbf\234\xe7\xa8\213\351\231\x84\xe4\273\xb6\344\xb8\212\344\xbc\xa0\xe5\244\261\350\264\245\xef\xbc\x8c\xe8\257\267\346\xa3\200\xe6\x9f\245\xe9\205\215\xe7\xbd\256\xe5\xb9\xb6\xe9\207\x8d\xe6\x96\xb0\344\270\212\344\274\xa0"; goto yQxLr; wkibj: return $this->ajaxFileReturn(); goto X8rRP; esmqG: global $_W; goto lqjD6; P9OTp: goto Z3IpQ; goto DKD7d; IVnCA: $ext = "\x2e" . $file_name_explode[$suffix]; goto ItHyU; IAsi0: mkdir($this->file_path, $mode, true); goto StuOp; QT8nn: goto b99Bt; goto MKPu2; MKPu2: woYUY: goto vCD6t; JFqyp: $data["\x73\x74\141\164\145"] = 1; goto aRze3; l5ZvF: $album_id = request()->post("\x67\x72\157\165\x70\137\x69\x64", ''); goto EOJE4; DgFwh: $data["\146\x69\x6c\x65\137\160\x61\164\150"] = $_W["\163\151\x74\x65\162\x6f\157\164"] . "\141\x64\x64\157\156\163\57\171\142\137\x73\150\x6f\x70\x2f\143\157\162\x65\57" . $this->file_path . $newfile; goto Qf8pZ; CGzEQ: $album = new Images(); goto QFV2P; YOmSP: if (is_error($remotestatus)) { goto woYUY; } goto fNzu5; kKXws: $this->file_name = $_FILES["\165\160\146\x69\154\x65"]["\x6e\x61\x6d\x65"]; goto MPjbn; FCP2A: $data["\146\151\154\x65\137\x6e\141\x6d\x65"] = ''; goto IgtEW; MPjbn: $this->file_size = $_FILES["\165\x70\146\x69\154\x65"]["\x73\x69\172\x65"]; goto NhCh8; aYl3u: $data["\x66\x69\154\x65\x5f\x6e\141\155\x65"] = $picture_info["\x70\x69\x63\x5f\x63\157\x76\145\x72\137\x6d\151\x64"]; goto iC0x4; tKgo8: $data["\x73\164\141\164\145"] = "\x30"; goto CpZNx; KsMj9: $data["\157\162\x69\147\x69\x6e\137\146\x69\154\145\x5f\156\x61\x6d\145"] = $this->file_name; goto sYYeD; rMgTH: $data["\157\x72\151\147\151\x6e\137\x66\x69\154\x65\x5f\x6e\141\x6d\x65"] = $this->file_name; goto MNOl3; B4bG9: if (file_exists($this->file_path)) { goto aZXti; } goto DoNvR; Qf8pZ: $data["\x73\164\141\164\145"] = "\x31"; goto sXIJK; MWtcl: $mch_id = Session::get("\x62\165\163\x5f\151\x64"); goto l5ZvF; V4014: $data["\x73\x74\x61\x74\145"] = "\x30"; goto icxUM; q_wHb: $file_name_explode = explode("\56", $this->file_name); goto O9qcr; yQxLr: b99Bt: goto Sx53Z; wXZ5f: $file_new_name = implode("\56", $tmp_array); goto TGkKA; ybZGJ: if (!empty($album_id)) { goto Dn4eh; } goto iZQNT; Z1zBJ: elMFO: goto esmqG; myjk2: $data = array(); goto MWtcl; aRze3: $data["\146\x69\154\145\137\x69\x64"] = $res; goto FCP2A; TGkKA: $newfile = md5($file_new_name . $guid) . $ext; goto ob6rI; z4dbs: $upload_flag = request()->post("\x75\160\x6c\x6f\x61\144\137\x66\x6c\x61\x67", ''); goto Zwk7g; fNzu5: $remoteurl = tomedia($ok["\160\x61\164\150"]); goto vVZNU; nAf3V: RkpjD: goto qI2VB; DKD7d: JM9HT: goto Uuhuw; lZWdC: if ($ok["\143\x6f\x64\x65"]) { goto JM9HT; } goto V4014; iZQNT: $album_id = $group_id["\x67\162\157\165\x70\137\x69\x64"]; goto R2vRH; ob6rI: $ok = $this->moveUploadFile($_FILES["\165\x70\x66\x69\x6c\145"]["\x74\x6d\x70\137\156\141\155\145"], $this->file_path . $newfile); goto qBzWa; lubPY: $pic_tag = request()->post("\151\155\147\137\164\x61\x67", $file_new_name); goto TV5Bt; te87s: $data["\155\145\x73\163\141\x67\x65"] = "\xe5\x9b\xbe\347\x89\x87\344\270\212\344\xbc\xa0\345\244\xb1\350\xb4\245"; goto KsMj9; OnEBy: if ($this->validationFile()) { goto tq_Oo; } goto wkibj; Gz2lt: X8875: goto q36av; iPBU7: if (!($this->file_size == 0)) { goto RkpjD; } goto te8KV; w0WVe: ZmXeC: goto dnbWt; ViST7: $data["\x6f\162\151\x67\x69\156\137\x66\x69\154\145\x5f\156\141\x6d\x65"] = $this->file_name; goto WEjLD; OFod7: $data["\x6d\x65\163\163\x61\x67\x65"] = "\346\226\x87\xe4\273\266\xe5\xa4\xa7\xe5\260\x8f\344\xb8\272\x30\115\x42"; goto xkl98; SKuUC: return $data; goto nAf3V; yyIQp: Rd2aX: goto OnEBy; t6Cs4: tgTKP: goto B4bG9; MNOl3: return $data; goto kLk3a; HiJJ4: $data["\163\x74\x61\164\145"] = "\x30"; goto tLEX3; tLEX3: $data["\x6d\x65\163\x73\141\147\145"] = "\xe6\x96\x87\xe4\273\266\xe5\244\247\xe5\xb0\x8f\344\270\x8d\350\x83\xbd\350\266\205\xe8\xbf\x87\x35\x4d\102"; goto iC02G; wzfYc: $group_id = $group->getInfo(["\155\143\x68\x5f\x69\144" => $mch_id, "\x69\163\137\x64\x65\146\141\x75\154\x74" => "\x31"]); goto XSKXU; QbRAw: return $data; goto yyIQp; iC02G: $data["\157\162\x69\x67\x69\156\x5f\146\x69\x6c\145\x5f\x6e\141\155\x65"] = $this->file_name; goto QbRAw; vVZNU: $data["\x6f\162\151\x67\151\156\x5f\x66\151\154\145\137\156\x61\155\145"] = $this->file_name; goto nPCAR; w410V: $height = $image_size[1]; goto K02gP; q36av: $group = new ImagesGroup(); goto wzfYc; iC0x4: $data["\x6f\162\151\147\x69\156\137\146\x69\154\x65\x5f\x6e\141\155\x65"] = $this->file_name; goto DgFwh; sXIJK: return $data; goto w0WVe; SM30G: $data["\155\145\163\163\141\x67\x65"] = "\346\x96\207\xe4\273\266\346\240\274\xe5\xbc\217\351\224\231\xe8\257\257"; goto ViST7; CpZNx: $data["\x6d\x65\163\163\x61\x67\145"] = "\346\x96\207\xe4\273\xb6\350\xb7\257\345\276\x84\xe4\xb8\215\350\203\xbd\xe4\xb8\272\347\251\xba"; goto x_6Zi; AK_Er: } public function deleteimg() { goto E6bz_; mSd4M: $error = $bucketMgr->delete($_W["\163\x65\x74\164\x69\x6e\147"]["\162\x65\155\157\x74\x65"]["\161\151\156\x69\x75"]["\x62\165\143\153\x65\x74"], $file); goto nG_F7; BC_mm: c3cBc: goto ZqbIA; dXsDI: HctY6: goto x1gl7; mzQM9: $path = "\57" . $file; goto aQQhD; lXG0L: goto vpJ3y; goto KMZF_; D8wKc: wkQQt: goto dnSHy; r58TB: goto c3cBc; goto D8wKc; x1gl7: if (!($error->code() == 612)) { goto HQo_X; } goto O54wS; Xl9FM: goto Vc5DT; goto dXsDI; v7LxA: $bucket = explode("\x40\x40", $_W["\x73\145\x74\x74\x69\156\147"]["\x72\145\x6d\x6f\x74\x65"]["\141\x6c\x69\157\163\163"]["\142\165\x63\x6b\145\x74"]); goto Oj3Zs; sviys: if (!(empty($file) || empty($type))) { goto y183Y; } goto YpIOe; GeztU: try { goto B3uPR; Q35ka: $res = $ossClient->deleteObject($_W["\x73\x65\x74\x74\151\x6e\147"]["\x72\x65\155\157\164\145"]["\x61\154\151\157\x73\x73"]["\x62\x75\143\x6b\145\x74"], $file); goto HVJUT; HVJUT: exit(json_encode($res, true)); goto ZsiGH; B3uPR: $ossClient = new \OSS\OssClient($_W["\x73\145\x74\x74\151\x6e\147"]["\x72\145\155\157\164\x65"]["\x61\154\x69\x6f\163\x73"]["\x6b\145\x79"], $_W["\x73\145\164\x74\151\156\147"]["\162\x65\155\157\x74\145"]["\141\x6c\151\157\x73\163"]["\163\145\143\162\x65\164"], $endpoint); goto Q35ka; ZsiGH: } catch (\OSS\Core\OssException $e) { goto MhLv0; Al_Rt: $res["\155\163\x67"] = $e->getMessage(); goto ba7Ra; ba7Ra: $res["\143\157\x64\x65"] = $e->getCode(); goto qKUsR; dCaIn: $res["\145\162\162\137\x6d\163\x67"] = $e->getErrorMessage(); goto Al_Rt; qKUsR: exit(json_encode($res, true)); goto YUEay; MhLv0: $res["\x65\162\162\x5f\x63\x6f\x64\x65"] = $e->getErrorCode(); goto dCaIn; YUEay: } goto zdmuq; qnzdd: foreach ($file as $item) { goto FakTF; MrTRA: goto Onp51; goto gbvj0; xWCPq: $str .= "\57\160\165\142\154\151\x63\x2f\165\x70\x6c\x6f\x61\x64\x2f" . $item; goto MrTRA; v3hNc: DJmaU: goto J1x0z; SLbgA: $str .= "\160\165\142\x6c\151\143\x2f\x75\x70\x6c\157\x61\x64\x2f" . $item; goto hagqS; Fq8RM: sEDuZ: goto b5cAC; IvM70: if ($str == '') { goto DKojw; } goto xWCPq; b5cAC: $i += 1; goto v3hNc; FakTF: if (!($i > 0)) { goto sEDuZ; } goto IvM70; hagqS: Onp51: goto Fq8RM; gbvj0: DKojw: goto SLbgA; J1x0z: } goto NADzD; HPIdd: load()->library("\143\x6f\163\166\63"); goto NpsNb; PtOkN: if ($type == 3) { goto P0zWi; } goto ausrw; NADzD: poIEb: goto COLbL; SgolJ: load()->library("\x71\x69\156\151\165"); goto y_dTK; Zwm1V: $endpoint = "\150\x74\x74\x70\x3a\57\57" . $buckets[$_W["\x73\x65\x74\x74\x69\156\147"]["\x72\145\155\x6f\164\145"]["\141\154\151\157\x73\163"]["\142\x75\143\x6b\145\164"]]["\x6c\157\x63\x61\x74\151\157\x6e"] . "\x2e\141\x6c\x69\x79\x75\x6e\x63\163\x2e\143\157\155"; goto GeztU; s95pT: $ftp_config = array("\x68\157\163\x74\156\141\x6d\x65" => $_W["\163\145\x74\x74\151\156\147"]["\162\x65\x6d\x6f\164\145"]["\x66\164\160"]["\150\x6f\163\x74"], "\165\163\145\162\156\141\x6d\x65" => $_W["\163\x65\x74\164\151\x6e\x67"]["\x72\x65\155\x6f\x74\145"]["\146\x74\x70"]["\x75\x73\x65\162\156\x61\155\145"], "\x70\x61\163\163\167\157\x72\x64" => $_W["\x73\145\164\x74\x69\156\147"]["\x72\x65\155\157\164\x65"]["\146\x74\160"]["\x70\x61\x73\x73\167\157\x72\144"], "\160\157\x72\164" => $_W["\163\x65\x74\x74\x69\156\x67"]["\x72\145\x6d\x6f\164\145"]["\x66\x74\x70"]["\x70\157\162\x74"], "\163\163\154" => $_W["\163\x65\x74\x74\x69\156\x67"]["\162\x65\x6d\157\164\x65"]["\x66\164\x70"]["\x73\163\154"], "\160\141\163\163\151\166\145" => $_W["\x73\x65\x74\164\151\x6e\147"]["\x72\x65\x6d\157\x74\x65"]["\x66\164\160"]["\160\x61\163\x76"], "\164\151\x6d\145\157\x75\x74" => empty($_W["\163\145\164\x74\x69\x6e\x67"]["\x72\145\155\157\x74\145"]["\x66\164\x70"]["\x74\151\x6d\x65\x6f\x75\164"]) ? 0 : $_W["\x73\145\x74\x74\151\x6e\x67"]["\162\x65\x6d\x6f\x74\145"]["\146\x74\x70"]["\164\x69\x6d\x65\x6f\165\164"], "\x72\x6f\157\164\144\151\162" => $_W["\x73\x65\x74\164\151\x6e\147"]["\x72\145\155\x6f\164\x65"]["\146\x74\x70"]["\144\x69\x72"]); goto qvYdg; r_9L6: phWlU: goto CzX_0; vVw3p: uD4gG: goto fswOS; NpsNb: $result = \Qcloud_cos\Cosapi::delFile($bucketName, $path); goto HsUAc; sTEdr: Dvvru: goto ImPqT; EYWJb: exit(json_encode($result, true)); goto nMK20; ZDUvi: if ($type == 1) { goto wkQQt; } goto sAk22; Oj3Zs: $_W["\x73\x65\x74\x74\x69\156\x67"]["\162\145\x6d\x6f\x74\x65"]["\141\154\x69\x6f\163\163"]["\142\x75\x63\x6b\x65\164"] = $bucket[0]; goto nTNLh; YvPPR: if (true === $ftp->connect()) { goto phWlU; } goto hfumE; E6bz_: $file = request()->param("\x66\x69\x6c\x65", ''); goto QU_KO; CzX_0: if ($ftp->delete_file($file)) { goto EuIGK; } goto plzBv; gkgua: $bucketMgr = new \Qiniu\Storage\BucketManager($auth); goto mSd4M; n1uyP: load()->model("\141\164\164\x61\x63\x68\155\145\x6e\164"); goto aOtn2; zdmuq: goto c3cBc; goto iSWmN; gf_6C: Sxgle: goto g4Fmi; nMK20: dPoVK: goto BC_mm; sVOb6: global $_W; goto sviys; ImPqT: $bucketName = $_W["\x73\145\164\x74\151\156\147"]["\162\x65\x6d\x6f\164\145"]["\x63\157\163"]["\x62\x75\143\x6b\145\164"]; goto mzQM9; g4Fmi: load()->library("\x63\x6f\x73"); goto IO1Xl; zAp85: if (count($file) == 1) { goto M22a2; } goto Z3_dQ; IdGZV: pLIPw: goto n1uyP; O54wS: exit(json_encode($error, true)); goto FTdPl; F421o: exit(json_encode($error, true)); goto Xl9FM; FTdPl: HQo_X: goto K3gZy; hfumE: exit("\146\x74\x70\xe8\xbf\236\346\216\245\345\xa4\261\350\264\xa5\357\274\x8c\xe8\257\xb7\xe6\243\200\xe6\237\245\xe9\205\215\347\xbd\xae\xe5\xb9\xb6\351\207\215\xe6\226\260\xe5\x88\240\xe9\231\244"); goto VEoq2; nTNLh: $buckets = attachment_alioss_buctkets($_W["\x73\145\164\x74\151\x6e\147"]["\162\x65\155\x6f\164\145"]["\x61\x6c\x69\x6f\x73\x73"]["\153\145\x79"], $_W["\163\145\x74\x74\151\156\x67"]["\x72\x65\155\x6f\164\x65"]["\141\x6c\151\157\x73\x73"]["\x73\x65\x63\162\145\164"]); goto Zwm1V; K3gZy: exit(json_encode($error, true)); goto fXZGJ; bvP2b: $i = 0; goto qnzdd; Gm1QH: oKNLF: goto EYWJb; jWoUV: goto c3cBc; goto IdGZV; fXZGJ: Vc5DT: goto dmB2g; VEoq2: goto sWNSi; goto r_9L6; eDVie: M22a2: goto a3JBy; COLbL: $file = $str; goto kCRFq; dnSHy: load()->library("\x66\164\x70"); goto s95pT; sAk22: if ($type == 2) { goto pLIPw; } goto PtOkN; tjPw5: vpJ3y: goto wI42l; f1HCQ: exit; goto tjPw5; wI42l: sWNSi: goto jWoUV; fswOS: if (!empty($result["\143\157\144\145"])) { goto oKNLF; } goto Cp7di; QU_KO: $type = request()->param("\x74\171\160\145", 0); goto sVOb6; qvYdg: $ftp = new \Ftp($ftp_config); goto YvPPR; ausrw: if ($type == 4) { goto Dvvru; } goto r58TB; KMZF_: EuIGK: goto f1HCQ; d2cbi: y183Y: goto yENH3; ZqbIA: return true; goto HUViR; IO1Xl: \qcloudcos\Cosapi::setRegion($_W["\x73\145\x74\164\151\156\x67"]["\162\x65\155\157\164\x65"]["\143\157\163"]["\154\157\x63\x61\154"]); goto jq7uX; vQpms: goto dPoVK; goto Gm1QH; Z3_dQ: $str = ''; goto bvP2b; y_dTK: $auth = new \Qiniu\Auth($_W["\163\145\x74\x74\x69\x6e\147"]["\x72\x65\x6d\x6f\x74\145"]["\161\151\x6e\x69\x75"]["\141\x63\x63\x65\x73\163\x6b\x65\x79"], $_W["\163\145\x74\x74\151\x6e\x67"]["\x72\x65\155\157\164\145"]["\x71\151\x6e\151\x75"]["\x73\145\143\162\145\164\x6b\x65\171"]); goto gkgua; yENH3: $file = explode("\57\x70\165\x62\x6c\151\143\x2f\165\x70\154\x6f\141\144\x2f", $file); goto zAp85; a3JBy: $file = $file[0]; goto oZgzW; Cp7di: exit(json_encode($result, true)); goto vQpms; iSWmN: P0zWi: goto SgolJ; dmB2g: goto c3cBc; goto sTEdr; oZgzW: Ya6Kn: goto ZDUvi; aQQhD: if (!empty($_W["\x73\145\x74\164\x69\156\x67"]["\x72\x65\x6d\157\x74\145"]["\143\157\x73"]["\x6c\x6f\x63\141\x6c"])) { goto Sxgle; } goto HPIdd; YpIOe: exit; goto d2cbi; kCRFq: goto Ya6Kn; goto eDVie; nG_F7: if ($error instanceof Qiniu\Http\Error) { goto HctY6; } goto F421o; aOtn2: load()->library("\157\163\163"); goto v7LxA; jq7uX: $result = \qcloudcos\Cosapi::delFile($bucketName, $path); goto vVw3p; plzBv: exit("\xe5\x88\xa0\351\x99\244\146\164\160\xe9\231\x84\344\273\xb6\xe5\244\261\350\264\245\357\274\214\350\257\xb7\xe6\xa3\200\xe6\x9f\xa5\351\x85\x8d\xe7\275\256\345\xb9\xb6\xe9\x87\x8d\346\226\260\xe5\x88\240\351\x99\244"); goto lXG0L; HsUAc: goto uD4gG; goto gf_6C; HUViR: } } function app_random($length = 16) { goto dCccS; pQWEe: $i++; goto bamnC; j_0Oi: $i = 0; goto e5dO9; FG1Bx: if (!($i < $length)) { goto zvgPD; } goto oG8Cm; v2qKN: $password = ''; goto j_0Oi; oG8Cm: $password .= $chars[mt_rand(0, strlen($chars) - 1)]; goto bQ0R2; e5dO9: t9qcq: goto FG1Bx; ftm8Q: return $password; goto xwLVD; bamnC: goto t9qcq; goto oAehi; bQ0R2: n1lNJ: goto pQWEe; dCccS: $chars = "\x61\142\x63\x64\145\x66\147\x68\x69\152\153\x6c\x6d\156\157\x70\161\x72\163\164\x75\166\x77\x78\171\x7a\x41\102\x43\x44\105\106\x47\x48\111\112\x4b\114\115\116\x4f\120\121\x52\x53\124\125\x56\127\x58\x59\132\x30\x31\x32\63\64\65\66\x37\x38\71"; goto v2qKN; oAehi: zvgPD: goto ftm8Q; xwLVD: }
