<?php
 namespace app\api\service; use think\Db; use think\Exception; use think\log; require_once BASE_ROOT . "\143\157\x72\x65\57\141\160\x70\x6c\151\x63\x61\164\x69\x6f\156\x2f\143\x6f\x6d\155\157\156\56\x70\x68\x70"; require_once BASE_ROOT . "\143\x6f\162\x65\57\141\x70\160\154\151\x63\x61\x74\151\157\x6e\57\x61\144\x6d\151\156\x2f\163\x65\x72\166\x69\143\145\x2f\120\162\151\x6e\x74\145\x72\x53\145\x72\166\x69\x63\145\x2e\160\150\x70"; use app\admin\service\PrinterService; class OrderService { private $o = "\171\142\x73\143\137\x6f\162\x64\145\162"; private $uc = "\171\142\x73\x63\x5f\x75\x73\145\162\x5f\x63\157\x75\x70\157\156"; private $s = "\171\x62\163\143\x5f\147\x6f\157\144\x73\x5f\x73\x6b\165"; private $g = "\x79\x62\163\x63\137\x67\x6f\157\x64\163"; private $op = "\171\x62\163\x63\137\x6f\x72\144\x65\x72\x5f\x70\x61\171\x6d\145\156\x74"; private $i = "\x79\142\163\143\137\x69\155\141\x67\x65\x73"; private $og = "\x79\x62\163\x63\x5f\157\x72\x64\x65\x72\137\x67\157\x6f\x64\163"; private $dq = "\x79\142\163\143\x5f\x61\162\145\x61"; private $u = "\171\142\163\143\137\x75\163\x65\x72"; private $os = "\171\142\163\143\x5f\157\162\144\145\162\x5f\x73\150\x61\162\145"; private $usm = "\171\142\x73\x63\137\x75\x73\x65\x72\x5f\x73\150\x61\162\x65\x5f\x6d\157\x6e\x65\x79"; public function createOrder($data) { goto d2I62; FrZq9: return ["\145\x72\x72\x5f\x63\x6f\x64\x65" => 0, "\x69\156\x66\x6f" => $order_id]; goto tfPBR; efmbu: try { goto J0DsJ; DJw0S: $pid_db2 = $this->is_distributor($pid2); goto o92NB; pVjuR: tgFYd: goto pjC6D; YoCw5: DvL32: goto Yeq6_; LR1e4: lQ9I0: goto g3NRk; SQIEx: Db::name($this->os)->insert($fx_data); goto ti2vp; rFmL8: unset($data_new["\163\x6b\x75\x5f\x69\x64"]); goto x8M_Z; MubGX: $pid3 = 0; goto BY3oh; enPp6: $fx_data["\x73\x65\143\x6f\156\144\x5f\160\x72\151\x63\145"] = floatval($data["\160\141\171\137\155\x6f\x6e\145\x79"]) * floatval($setting["\x73\145\143\x6f\x6e\144"]) / 100; goto x0QZm; I7486: if (!($data["\143\157\165\160\x6f\x6e\x5f\151\x64"] != 0)) { goto fTWBf; } goto OFBE1; e9MiO: Db::name($this->uc)->where("\x69\144", $data["\143\x6f\x75\160\x6f\156\x5f\x69\x64"])->update($coupon_data); goto mCS0C; a4d4s: Db::name($this->op)->insert($pay_data); goto eBy95; qLh92: $share_goods_id = 0; goto FvmPX; gBTtH: v8lBn: goto Wx8Y4; gxn_z: goto rvTET; goto TI62N; SfO7S: $setting = $this->get_shareSetting($data["\x6d\143\x68\137\151\144"], $share_goods_id); goto voGr_; Fljlz: $pid1 = 0; goto c6C26; BY3oh: pJQqb: goto Vaxx3; KL1Au: $fx_data["\160\x61\162\x65\x6e\164\137\x69\144\x5f\62"] = $pid2; goto bxc4_; S81Kl: $data_new["\x72\145\146\x75\156\x64\x5f\x74\151\x6d\145"] = 0; goto c0DCw; g3NRk: foreach ($sku as $value) { goto HMiVn; GdHjb: throw new Exception("\345\xba\x93\345\255\x98\344\xb8\x8d\350\xb6\263"); goto AeHiV; unHW9: if (!($goods_num == 1)) { goto y2vNB; } goto EsnQs; muB0D: L0j2H: goto iLBjI; EsnQs: $share_goods_id = $data_sku["\147\x6f\157\x64\x73\x5f\151\144"]; goto OH194; xsg1M: goto rXRmH; goto JY3ER; zXgly: $data_sku = Db::name($this->s)->where("\163\153\x75\137\x69\x64", $value_data[0])->find(); goto Ve7lZ; RLh_y: Db::name($this->g)->where("\x67\157\157\144\163\137\151\144", $data_sku["\x67\x6f\x6f\x64\163\137\151\144"])->setDec("\163\x74\157\143\x6b", $value_data[1]); goto hWmtM; OBJuf: $goods_data = ["\x6f\162\144\145\x72\x5f\151\x64" => $order_id, "\x73\x6b\165\x5f\151\144" => $value_data[0], "\x73\x6b\x75\x5f\x6e\x61\155\x65" => $data_sku["\163\x6b\165\x5f\x6e\x61\155\145"], "\147\x6f\x6f\x64\x73\137\151\144" => $data_sku["\x67\157\157\x64\x73\x5f\x69\x64"], "\147\157\157\144\163\x5f\156\x61\155\145" => $data_goods["\x67\x6f\x6f\x64\163\x5f\156\141\x6d\145"], "\x70\x72\x69\143\145" => $value_data[1] * $data_sku["\x70\162\x69\x63\145"], "\x6e\x75\155" => $value_data[1], "\147\x6f\x6f\144\x73\x5f\155\157\156\145\171" => $data_sku["\160\162\x69\x63\145"], "\x67\157\x6f\x64\163\x5f\x69\x6d\x61\x67\145\163" => $images, "\x62\x75\171\145\x72\137\x69\x64" => $data["\x62\165\171\x65\x72\137\x69\144"]]; goto GGyjw; Fs_Gb: $images = $data_sku["\x69\x6d\141\147\x65\163"]; goto xsg1M; HMiVn: $value_data = explode("\x3a", $value); goto zXgly; Z68kT: $data_goods = Db::name($this->g)->where("\147\157\157\x64\x73\137\x69\x64", $data_sku["\147\x6f\157\x64\x73\x5f\151\144"])->find(); goto teBDL; zfccX: rXRmH: goto OBJuf; teBDL: Db::name($this->g)->where("\x67\157\x6f\144\x73\137\151\144", $data_sku["\147\x6f\x6f\144\x73\137\151\x64"])->setInc("\x72\145\x61\154\137\x73\141\154\145\163", $value_data[1]); goto bcgUp; JY3ER: RNIcl: goto aukTx; AeHiV: f18yy: goto unHW9; y7akE: if ($data_sku->images == 0) { goto RNIcl; } goto Fs_Gb; hWmtM: Db::name($this->s)->where("\x73\x6b\165\x5f\x69\144", $value_data[0])->setDec("\163\164\157\x63\153", $value_data[1]); goto y7akE; aukTx: $images = $data_goods["\151\x6d\141\147\x65\163"]; goto zfccX; OH194: y2vNB: goto Z68kT; GGyjw: Db::name($this->og)->insert($goods_data); goto muB0D; bcgUp: Db::name($this->g)->where("\x67\x6f\157\144\x73\x5f\151\144", $data_sku["\147\x6f\x6f\x64\x73\x5f\x69\144"])->setInc("\163\x61\x6c\145\x73", $value_data[1]); goto RLh_y; Ve7lZ: if (!($data_sku["\163\164\x6f\143\153"] <= 0)) { goto f18yy; } goto GdHjb; iLBjI: } goto rhy1m; F_1As: $fx_data["\162\145\142\x61\x74\145"] = $fx_data["\x66\151\162\163\164\137\160\x72\x69\x63\x65"]; goto XCGL2; aXPW0: $pid = $u["\160\x69\x64"] ? $u["\x70\x69\x64"] : 0; goto ghSr6; lZ3UE: C6ifL: goto KL1Au; VGCrg: $pid_db3 = $this->is_distributor($pid3); goto JAJ8s; hAFUs: $fx_data["\x70\141\x72\x65\156\x74\137\151\144\137\63"] = $pid3; goto eeuaK; eBy95: $u = Db::name($this->u)->where("\x75\151\x64", $data["\142\x75\x79\145\x72\137\x69\144"])->find(); goto aXPW0; txnUi: $pid2 = $this->get_user_uid($pid); goto iCyDq; c0DCw: $data_new["\x63\x6f\x6e\x73\151\x67\156\x5f\164\151\155\145"] = 0; goto oHRW6; vQTP8: cvTWD: goto I7486; wrxBh: rvTET: goto Yyn9i; QSwWe: goto xAY9S; goto rf_KX; FQtW6: $pp->print_order(); goto vQTP8; qIi0G: $pid2 = 0; goto lZ3UE; iCyDq: $pid_db2 = $this->is_distributor($pid2); goto WmrcN; bxc4_: if (!($pid_db3 != 1)) { goto pJQqb; } goto MubGX; x8M_Z: $data_new["\x66\x69\x6e\151\x73\150\137\x74\x69\x6d\145"] = 0; goto S81Kl; LqSXk: $fx_data["\x73\145\143\x6f\x6e\x64\137\x70\x72\151\143\145"] = $setting["\163\x65\x63\157\156\144"]; goto wZUUr; J0DsJ: $data_new = $data; goto rFmL8; TSA5T: if ($setting["\x6c\x65\166\x65\154"] == 1) { goto cYAoF; } goto k5Hhv; hlHYd: $fx_data["\x66\151\162\x73\164\137\x70\x72\151\143\145"] = $setting["\x66\x69\162\163\x74"]; goto LqSXk; XCGL2: ugSs4: goto TSA5T; voGr_: $fx_data = array("\x75\x73\x65\162\137\x69\144" => $data["\142\x75\171\145\x72\x5f\x69\144"], "\x6f\162\x64\145\x72\137\x69\x64" => $order_id, "\x66\x69\x72\x73\x74\x5f\x70\162\x69\143\145" => 0, "\x73\x65\143\x6f\x6e\x64\137\x70\x72\151\x63\145" => 0, "\164\150\151\162\144\137\x70\162\151\143\145" => 0, "\160\141\x72\x65\156\164\x5f\x69\144\x5f\61" => $pid1, "\160\x61\162\145\156\x74\137\x69\x64\137\62" => 0, "\160\x61\x72\x65\x6e\x74\x5f\151\144\137\x33" => 0, "\x69\163\137\x64\x65\154" => 1, "\x72\x65\142\x61\164\x65" => 0, "\155\x63\150\x5f\151\144" => $data["\x6d\x63\150\137\151\x64"], "\143\x72\x65\x61\164\x65\x5f\x74\x69\155\x65" => time()); goto kraGU; c6C26: s100F: goto SfO7S; k5Hhv: if ($setting["\x6c\x65\x76\145\154"] == 2) { goto Q63o3; } goto p2KZt; AEFQU: $goods_num = 0; goto qLh92; wZUUr: $fx_data["\164\150\x69\162\x64\x5f\x70\x72\x69\143\x65"] = $setting["\164\x68\x69\x72\144"]; goto gxn_z; TI62N: rkhNE: goto ka4sy; FvmPX: if (!(count($sku) == 1)) { goto lQ9I0; } goto iTD7C; A43y3: $fx_data["\x70\141\x72\145\x6e\164\137\151\x64\137\x32"] = $pid2; goto SQIEx; oHRW6: $data_new["\163\145\154\154\145\162\x5f\155\145\x6d\157"] = ''; goto Fx0s2; p2KZt: if ($setting["\154\145\166\145\154"] == 3) { goto za_DV; } goto QSwWe; bUExC: Db::name($this->os)->insert($fx_data); goto YoCw5; kraGU: if (!($setting && $setting["\154\145\166\145\154"] != 0)) { goto lAaY0; } goto H3E6B; ti2vp: ehj74: goto fm3uE; PSalZ: if (!$order_id) { goto cvTWD; } goto hlH3p; Yeq6_: goto xAY9S; goto wTiVq; WzUyV: $pid2 = $this->get_user_uid($pid); goto DJw0S; wTiVq: Q63o3: goto txnUi; EX4Zs: if (!($pid1 != 0 || $fx_data["\162\x65\x62\141\164\145"] != 0)) { goto DvL32; } goto bUExC; qkDOF: $pid2 = 0; goto pVjuR; mCS0C: fTWBf: goto wmePo; eLH10: $sku = explode("\x2c", $sku_id); goto AEFQU; Fx0s2: $order_id = Db::name($this->o)->insertGetId($data_new); goto PSalZ; fm3uE: goto xAY9S; goto oRLMU; rhy1m: dwB_o: goto Oy718; oRLMU: za_DV: goto WzUyV; Vaxx3: if (!($pid1 != 0 || $pid2 != 0 || $pid3 != 0 || $fx_data["\162\x65\142\141\164\145"] != 0)) { goto v8lBn; } goto hAFUs; IhSfw: Db::commit(); goto FlQoc; Yyn9i: if (!($u["\x69\163\137\144\x69\163\164\162\151\142\x75\x74\157\x72"] && $setting["\x69\163\x5f\162\145\142\x61\x74\x65"] == 1)) { goto ugSs4; } goto F_1As; iTD7C: $goods_num = 1; goto LR1e4; OFBE1: $coupon_data = array("\x73\164\x61\164\x75\163" => 1, "\165\163\145\137\164\151\155\x65" => time()); goto e9MiO; Oy718: $pay_data = array("\x6f\165\x74\137\164\x72\x61\144\x65\137\x6e\x6f" => $data["\157\x75\x74\137\x74\x72\141\x64\x65\x5f\x6e\157"], "\160\x61\171\x5f\164\x79\x70\x65" => $data["\160\141\x79\137\164\x79\160\x65"], "\164\x79\x70\145\x5f\141\x6c\151\x73\137\151\144" => $order_id, "\x70\141\171\x5f\x62\157\144\x79" => "\xe7\x94\xa8\346\x88\xb7\xe6\224\257\xe4\273\230", "\160\x61\x79\x5f\x64\x65\164\x61\151\154" => "\xe7\x94\xa8\xe6\210\xb7\350\xb4\xad\xe4\xb9\260\345\x95\x86\345\x93\201", "\x70\x61\171\x5f\155\157\x6e\x65\171" => $data["\160\141\171\x5f\155\x6f\x6e\145\x79"], "\160\x61\x79\137\x73\164\141\164\165\x73" => 0, "\160\x61\171\137\x74\151\155\x65" => 0, "\143\x72\x65\x61\164\x65\x5f\x74\151\x6d\145" => time()); goto a4d4s; r2cTJ: $pid1 = $pid; goto EEM1Q; EEM1Q: if (!($pid_db != 1)) { goto s100F; } goto Fljlz; ka4sy: $fx_data["\x66\151\x72\163\x74\x5f\x70\x72\151\x63\145"] = floatval($data["\160\141\x79\137\155\x6f\x6e\x65\171"]) * floatval($setting["\146\151\162\163\x74"]) / 100; goto enPp6; ghSr6: $pid_db = $this->is_distributor($pid); goto r2cTJ; Wx8Y4: xAY9S: goto AABS4; rf_KX: cYAoF: goto EX4Zs; hlH3p: $pp = new PrinterService($data["\x6d\x63\150\137\x69\144"], $order_id, "\x6f\162\x64\x65\162", 0); goto FQtW6; eeuaK: Db::name($this->os)->insert($fx_data); goto gBTtH; x0QZm: $fx_data["\164\x68\151\x72\x64\137\x70\x72\x69\143\145"] = floatval($data["\160\x61\171\137\x6d\x6f\156\x65\x79"]) * floatval($setting["\x74\x68\151\162\144"]) / 100; goto wrxBh; H3E6B: if ($setting["\x70\x72\151\143\145\137\x74\x79\x70\x65"] == 0) { goto rkhNE; } goto hlHYd; wmePo: $sku_id = rtrim($data["\163\153\165\137\151\x64"], "\54"); goto eLH10; o92NB: $pid3 = $this->get_user_uid($pid2); goto VGCrg; JAJ8s: if (!($pid_db2 != 1)) { goto C6ifL; } goto qIi0G; pjC6D: if (!($pid1 != 0 || $pid2 != 0 || $fx_data["\162\x65\142\x61\164\145"] != 0)) { goto ehj74; } goto A43y3; WmrcN: if (!($pid_db2 != 1)) { goto tgFYd; } goto qkDOF; AABS4: lAaY0: goto IhSfw; FlQoc: } catch (\Exception $e) { goto Ofd3O; l74RE: Log::write("\xe7\224\x9f\xe6\x88\220\xe8\256\xa2\xe5\215\x95\xe5\xa4\xb1\350\264\245\x20\55\55\x28\347\224\xa8\xe6\210\267\x69\x64\xef\xbc\x9a" . $data["\142\165\171\145\x72\137\151\x64"] . "\51\x20\xe9\224\x99\xe8\257\257\344\xbf\241\346\x81\257\xef\274\x9a" . $e->getMessage(), "\x6f\162\x64\145\x72\137\x65\x72\x72\x6f\x72"); goto vgs39; Ofd3O: Db::rollback(); goto l74RE; vgs39: return ["\145\162\162\137\143\157\x64\x65" => 1, "\155\163\147" => $e->getMessage()]; goto mrmCP; mrmCP: } goto FrZq9; d2I62: Db::startTrans(); goto efmbu; tfPBR: } public function get_shareSetting($mch_id, $share_goods_id) { goto zcdth; ErivB: $info["\x66\151\x72\x73\x74"] = $goods_share["\x66\151\162\x73\164"]; goto epyX3; CJXUM: ry65k: goto Np8dp; QRy37: return $info; goto z1pwB; F5Lyk: $info["\160\x72\151\x63\x65\137\164\x79\x70\x65"] = $goods_share["\x70\x72\151\143\145\137\x74\x79\160\145"]; goto ErivB; sFF3a: if (!$goods_share) { goto ry65k; } goto F5Lyk; bbtVZ: $info["\x74\x68\x69\162\x64"] = $goods_share["\x74\150\151\x72\144"]; goto CJXUM; epyX3: $info["\x73\145\x63\x6f\x6e\144"] = $goods_share["\163\x65\143\157\x6e\144"]; goto bbtVZ; AEi7W: if (!($share_goods_id != 0)) { goto p7a2l; } goto EDXT9; Np8dp: p7a2l: goto QRy37; zcdth: $info = Db::name("\171\142\163\143\x5f\x75\x73\x65\x72\x5f\x73\150\141\x72\145\x5f\163\x65\x74\164\151\x6e\147")->where("\155\x63\x68\x5f\x69\x64", $mch_id)->find(); goto AEi7W; EDXT9: $goods_share = Db::name("\171\x62\x73\x63\x5f\147\157\157\144\163\137\x73\x68\x61\x72\145\137\163\x65\164\x74\x69\x6e\x67")->where(["\x6d\x63\150\137\x69\x64" => $mch_id, "\147\157\157\x64\163\x5f\151\x64" => $share_goods_id, "\x73\x74\141\164\165\x73" => 1])->find(); goto sFF3a; z1pwB: } public function is_distributor($uid) { goto xEAiM; DqAJ3: W9Ifd: goto QLbDa; gGa8I: if ($a) { goto W9Ifd; } goto f64yf; VINSh: goto eudKW; goto DqAJ3; j1O4b: return 0; goto ZfFJk; tzx8m: eudKW: goto KxXnm; ZfFJk: Xk0ON: goto a55LX; QLbDa: return $a; goto tzx8m; xEAiM: if (!($uid == 0)) { goto Xk0ON; } goto j1O4b; a55LX: $a = Db::name($this->u)->where(["\165\151\144" => $uid])->value("\151\163\137\144\151\163\164\x72\151\x62\165\x74\157\x72"); goto gGa8I; f64yf: return 0; goto VINSh; KxXnm: } public function get_user_uid($uid) { goto p9kaz; A4Bg8: eeHtq: goto N_5j3; yDZNr: goto Ou27C; goto mTiQ4; KNt9v: return 0; goto yDZNr; NMEzR: return 0; goto A4Bg8; Ac3ia: Ou27C: goto Qpshw; g9iaS: if ($pid) { goto T6dto; } goto KNt9v; mTiQ4: T6dto: goto ISWHX; N_5j3: $pid = Db::name($this->u)->where(["\x75\x69\x64" => $uid])->value("\160\151\x64"); goto g9iaS; p9kaz: if (!($uid == 0)) { goto eeHtq; } goto NMEzR; ISWHX: return $pid; goto Ac3ia; Qpshw: } public function orderList($data, $page = 1) { goto GaTn4; UGHDu: return $order_list; goto DWRWK; nUTfE: return $order_list; goto Zk7dP; GaTn4: $order_list = null; goto HoCAq; mgCak: foreach ($order_list as $key => $value) { goto BHmX1; nnM3X: F0fcI: goto R_wHO; BHmX1: $goods = Db::name($this->og)->where("\x6f\162\144\145\162\x5f\151\144", $value["\157\162\x64\x65\162\137\151\144"])->select(); goto em2Eh; eFVs0: $order_list[$key]["\x67\x6f\x6f\144\163"] = $goods; goto nnM3X; em2Eh: foreach ($goods as $k => $v) { goto D9y4h; HlsCh: if (!$pic) { goto CtFHz; } goto cjjUL; Vsuej: CtFHz: goto JaLTR; cjjUL: $goods[$k]["\x70\151\x63"] = $pic; goto Vsuej; JaLTR: gRTBf: goto kQMr8; D9y4h: $pic = Db::name($this->i)->where("\x69\155\147\137\x69\144", $v["\147\x6f\x6f\144\163\137\x69\155\141\x67\145\x73"])->field("\151\155\147\x5f\143\x6f\x76\145\x72\x2c\151\x6d\147\137\143\x6f\166\145\x72\x5f\x62\x69\147\x2c\x69\155\x67\x5f\x63\x6f\x76\145\x72\137\x6d\x69\144\x2c\x69\155\x67\x5f\x63\x6f\166\x65\x72\137\163\155\x61\x6c\x6c")->find(); goto HlsCh; kQMr8: } goto urH4j; urH4j: BuQuc: goto eFVs0; R_wHO: } goto pm2Yc; fy6Hb: if (!empty($order_list)) { goto aYpRY; } goto nUTfE; Zk7dP: aYpRY: goto mgCak; HoCAq: $order_list = Db::name($this->o)->where($data)->where("\151\x73\x5f\144\145\154\145\x74\145\x64", 0)->page($page, PAGE_NUM)->order("\x63\162\x65\x61\x74\x65\137\164\x69\155\x65", "\144\x65\163\x63")->select(); goto fy6Hb; pm2Yc: hdD6g: goto UGHDu; DWRWK: } public function getOrder($data) { goto r6yxd; r6yxd: $order_info = null; goto cnHCI; pcb96: $address["\x63\x69\164\x79"] = $city["\x6e\141\x6d\145"]; goto RBJyx; mNtnp: $order_info["\155\145\156\x74\x69\x6f\156\x5f\x74\151\x6d\x65"] = __TIME($order_info["\x6d\145\x6e\x74\x69\157\156\x5f\164\151\x6d\145"]); goto WmML4; Xh_Yy: $address["\160\162\x6f\166\151\x6e\x63\145"] = $pro["\156\x61\155\145"]; goto pcb96; L230o: YRWDE: goto YlNLQ; X1Wv3: return $order_info; goto L230o; Fsyvj: $order_info["\141\144\x64\162\x65\x73\x73"] = $address; goto knSSq; UAg9E: if (!(!empty($express) && $express["\145\x78\160\x72\x65\163\x73\137\143\x6f\x6d\x70\141\156\x79"] && $express["\x65\170\160\162\145\163\x73\137\156\157"])) { goto Yc3nG; } goto DoMKF; a368C: $order_info["\143\157\x6e\x73\151\x67\156\x5f\x74\x69\155\x65"] = __TIME($order_info["\x63\x6f\x6e\163\151\147\x6e\x5f\x74\x69\155\145"]); goto wCagO; mJkBK: BBqzU: goto zTPA5; knSSq: $order_info["\x67\x6f\157\x64\163"] = Db::name($this->og)->where("\x6f\x72\144\145\162\x5f\x69\x64", $order_info["\x6f\x72\144\145\x72\137\151\144"])->select(); goto wuDCl; m2KRV: $pro = Db::name($this->dq)->where("\x69\x64", $city["\160\151\x64"])->find(); goto Xh_Yy; cnHCI: $order_info = Db::name($this->o)->where($data)->where("\151\x73\137\144\145\x6c\145\x74\x65\x64", 0)->find(); goto gvQic; WmML4: $res = Db::name($this->dq)->where("\x69\144", $order_info["\162\145\143\145\x69\x76\145\162\137\141\x72\145\141"])->find(); goto V9LMm; J1Mbk: Yc3nG: goto qJYOt; wCagO: $order_info["\143\x72\145\141\164\145\x5f\164\151\155\x65"] = __TIME($order_info["\x63\x72\x65\x61\x74\145\137\164\x69\155\145"]); goto mNtnp; qJYOt: return $order_info; goto vX3yp; yjgaM: $express = Db::name("\171\142\163\143\137\157\x72\144\x65\162\x5f\x65\x78\x70\162\145\x73\x73")->where(["\x73\x68\x69\x70\x70\151\156\147\x5f\164\171\160\145" => 1, "\x6f\x72\x64\145\x72\x5f\164\171\x70\145" => 0, "\157\x72\x64\145\x72\137\x69\x64" => $order_info["\157\162\144\145\x72\137\151\x64"]])->find(); goto UAg9E; wuDCl: foreach ($order_info["\147\x6f\157\144\163"] as $k => $v) { goto Pz1cI; MXXH_: bEQa7: goto MW59R; Pz1cI: $pic = Db::name($this->i)->where("\x69\x6d\x67\x5f\151\144", $v["\x67\157\157\144\x73\137\x69\x6d\141\x67\x65\163"])->field("\151\155\x67\137\143\157\x76\145\x72\54\x69\155\x67\137\143\x6f\x76\x65\162\137\142\151\147\x2c\151\155\147\x5f\x63\x6f\x76\x65\x72\x5f\155\151\x64\x2c\151\155\147\137\x63\x6f\166\x65\x72\137\x73\155\x61\154\154")->find(); goto ylMLx; LfT80: KF685: goto MXXH_; MAYcW: $order_info["\x67\157\x6f\x64\x73"][$k]["\x70\151\x63"] = $pic; goto LfT80; ylMLx: if (!$pic) { goto KF685; } goto MAYcW; MW59R: } goto mJkBK; oH0xU: $order_info["\x70\141\171\137\x74\151\x6d\145"] = __TIME($order_info["\x70\141\x79\x5f\164\x69\155\x65"]); goto a368C; zTPA5: $order_info["\145\x78\x70\162\145\x73\x73"] = 0; goto yjgaM; HWtwl: $order_info["\x65\x78\x70\x72\145\163\163\x5f\x63\157\155\160\141\156\x79"] = $express["\145\170\160\162\x65\163\163\x5f\x63\157\x6d\x70\141\156\171"]; goto gGo4r; V9LMm: $city = Db::name($this->dq)->where("\151\144", $res["\160\151\x64"])->find(); goto m2KRV; gGo4r: $order_info["\145\x78\x70\162\145\163\x73\137\156\157"] = $express["\145\x78\x70\x72\x65\x73\x73\x5f\156\157"]; goto J1Mbk; gvQic: if (!empty($order_info)) { goto YRWDE; } goto X1Wv3; RBJyx: $address["\x64\151\163\164\x72\x69\143\x74"] = $res["\x6e\141\155\145"]; goto Fsyvj; YlNLQ: $order_info["\x73\x69\147\156\x5f\x74\151\x6d\x65"] = __TIME($order_info["\163\x69\147\x6e\137\x74\x69\x6d\145"]); goto oH0xU; DoMKF: $order_info["\145\170\160\x72\x65\163\x73"] = 1; goto HWtwl; vX3yp: } public function signOrder($data) { goto AqGm5; S4DVJ: $pp->print_order(); goto JdufB; JdufB: $rs["\x69\156\146\x6f"] = $info; goto pKNIS; j_S68: $pp = new PrinterService($data["\155\x63\150\137\x69\144"], $data["\157\x72\144\145\162\x5f\x69\x64"], "\x63\x6f\x6e\146\x69\x72\155", 0); goto S4DVJ; zkCJU: try { goto ywCmb; BMlVS: v4yLp: goto A3dno; H0cr7: $share_data = ["\155\x63\150\x5f\x69\144" => $data["\155\143\x68\137\x69\x64"], "\x6f\162\x64\145\162\x5f\151\x64" => $data["\x6f\162\x64\145\x72\x5f\x69\x64"], "\143\162\145\141\x74\x65\137\x74\151\x6d\x65" => time(), "\151\x73\x5f\144\145\x6c" => 1]; goto ctSzl; ctSzl: if (!($us["\160\x61\x72\x65\x6e\x74\137\151\144\x5f\61"] && $us["\x70\x61\162\x65\156\x74\137\151\x64\137\61"] != 0)) { goto OVXSN; } goto VcCmM; m0UBN: $info = Db::name($this->o)->where($data)->update($new_data); goto MFEDk; XwzE2: $share_data["\155\x6f\156\x65\171"] = $us["\x66\x69\x72\163\x74\x5f\x70\162\x69\x63\145"]; goto O6d7_; wEPuR: if (!$us) { goto v4yLp; } goto H0cr7; WZBOg: E6BNm: goto sg61r; dlxh7: $share_data["\165\x73\x65\162\x5f\151\144"] = $us["\160\x61\x72\145\x6e\x74\137\151\144\137\x32"]; goto G3C6b; zgEOr: NbU6q: goto lW_Ej; R1ml2: Db::name($this->u)->where("\165\151\x64", $us["\x70\x61\x72\145\156\164\137\x69\x64\137\61"])->setInc("\164\x6f\164\141\x6c\x5f\160\x72\x69\143\x65", $us["\146\151\162\x73\x74\x5f\160\162\151\x63\x65"]); goto g4Lxn; sg61r: if (!($us["\160\x61\162\145\156\x74\x5f\x69\x64\137\63"] && $us["\x70\141\162\x65\156\164\x5f\151\x64\x5f\63"] != 0)) { goto rtZOb; } goto yJ9C3; ywCmb: $new_data = array("\x6f\162\x64\x65\x72\137\x73\x74\141\164\x75\x73" => 3, "\163\x69\147\156\x5f\164\x69\155\145" => time()); goto m0UBN; mEf38: if (!($us["\x70\141\162\x65\x6e\164\x5f\151\x64\137\62"] && $us["\x70\x61\x72\x65\x6e\164\x5f\x69\144\x5f\62"] != 0)) { goto E6BNm; } goto dlxh7; jFIPE: Db::name($this->u)->where("\165\x69\x64", $us["\x70\141\162\145\156\164\x5f\x69\x64\x5f\63"])->setInc("\160\162\151\x63\x65", $us["\x74\x68\151\162\x64\137\160\162\151\143\145"]); goto ioGQC; jefLj: Db::name($this->u)->where("\165\x69\x64", $us["\160\x61\x72\145\x6e\164\137\x69\144\x5f\x32"])->setInc("\160\x72\x69\x63\145", $us["\163\145\x63\157\156\x64\137\160\162\151\143\145"]); goto WZBOg; eS2OZ: $share_data["\163\157\x75\x72\x63\x65"] = 3; goto ebMqr; nhTwy: Db::name($this->usm)->insert($share_data); goto Ea402; O6d7_: $share_data["\x73\x6f\165\x72\x63\x65"] = 1; goto dJveT; ioGQC: rtZOb: goto BMlVS; A3dno: Db::commit(); goto bbCRo; lW_Ej: $us = Db::name($this->os)->where(["\165\163\x65\162\137\151\144" => $data["\x62\x75\171\145\162\137\151\144"], "\x6f\x72\144\145\x72\137\151\x64" => $data["\157\x72\144\145\162\137\151\x64"]])->find(); goto wEPuR; Fn2d_: Db::name($this->u)->where("\165\x69\x64", $us["\x70\141\x72\145\156\x74\137\151\x64\x5f\63"])->setInc("\164\x6f\164\141\x6c\137\160\x72\151\x63\x65", $us["\164\x68\151\x72\x64\x5f\x70\x72\151\143\x65"]); goto jFIPE; yJ9C3: $share_data["\x75\x73\145\162\x5f\x69\144"] = $us["\160\141\162\x65\156\x74\x5f\151\x64\137\x33"]; goto TYVHI; TYVHI: $share_data["\x6d\157\156\145\171"] = $us["\x74\150\x69\x72\x64\x5f\x70\162\x69\143\x65"]; goto eS2OZ; qIr3l: $share_data["\163\x6f\165\x72\143\145"] = 2; goto nhTwy; jz4vk: throw new Exception("\346\223\215\344\xbd\234\345\244\xb1\xe8\xb4\245"); goto zgEOr; ebMqr: Db::name($this->usm)->insert($share_data); goto Fn2d_; VcCmM: $share_data["\165\x73\145\162\x5f\151\144"] = $us["\x70\141\x72\145\156\x74\x5f\151\x64\137\61"]; goto XwzE2; dJveT: Db::name($this->usm)->insert($share_data); goto R1ml2; g4Lxn: Db::name($this->u)->where("\x75\151\144", $us["\160\141\162\145\156\x74\137\x69\x64\x5f\x31"])->setInc("\160\162\151\x63\145", $us["\146\151\x72\x73\x74\137\x70\x72\x69\143\145"]); goto XLOcg; MFEDk: if (!empty($info)) { goto NbU6q; } goto jz4vk; XLOcg: OVXSN: goto mEf38; Ea402: Db::name($this->u)->where("\165\151\144", $us["\160\x61\x72\x65\156\164\x5f\151\x64\137\62"])->setInc("\x74\x6f\x74\141\x6c\x5f\x70\x72\x69\x63\x65", $us["\x73\145\x63\157\x6e\144\137\160\x72\x69\x63\145"]); goto jefLj; G3C6b: $share_data["\x6d\x6f\156\145\171"] = $us["\x73\145\143\x6f\x6e\x64\x5f\160\x72\151\x63\x65"]; goto qIr3l; bbCRo: } catch (\Exception $e) { goto ISQgf; MFfaM: return json_encode($rs); goto uN0DR; ISQgf: Db::rollback(); goto ZB2UF; ZB2UF: $rs["\x63\157\x64\x65"] = 1; goto fMGYt; fMGYt: $rs["\155\163\147"] = $e->getMessage(); goto MFfaM; uN0DR: } goto j_S68; LURr_: Db::startTrans(); goto zkCJU; pKNIS: return json_encode($rs); goto BPxkL; AqGm5: $rs = array("\143\157\x64\x65" => 0, "\x69\156\146\x6f" => array()); goto LURr_; BPxkL: } public function cancelOrder($data) { goto drK3e; drK3e: $info = Db::name($this->o)->where($data)->find(); goto TDJuf; BRknX: Db::startTrans(); goto m5f_I; ZHINW: zXIkR: goto l5x_v; m5f_I: try { goto EIUwT; Ujmxe: iJygF: goto mTdEY; wwEVL: foreach ($order_goods_info as $key => $value) { goto z7oLx; uLClG: PdDFo: goto jzDkd; f2hPW: Db::name($this->s)->where("\x73\x6b\165\x5f\151\x64", $value["\x73\x6b\x75\137\151\144"])->setInc("\x73\x74\x6f\x63\153", $value["\x6e\165\155"]); goto uLClG; z7oLx: Db::name($this->g)->where("\147\x6f\157\144\x73\137\151\144", $value["\x67\157\x6f\x64\163\x5f\x69\x64"])->setInc("\x73\164\x6f\143\x6b", $value["\x6e\x75\x6d"]); goto f2hPW; jzDkd: } goto Ujmxe; Acr6v: $res = Db::name($this->o)->where(["\157\x72\x64\145\162\x5f\151\x64" => $data["\157\x72\144\x65\x72\x5f\151\144"]])->update($new_data); goto wwEVL; EIUwT: $new_data = array("\157\162\x64\145\162\137\163\164\x61\164\165\x73" => -1); goto Acr6v; mTdEY: Db::commit(); goto GBQka; GBQka: } catch (\Exception $e) { Db::rollback(); return $e->getMessage(); } goto JpfaT; Xjd4B: return null; goto ZHINW; JpfaT: return $res; goto uCigP; l5x_v: $order_goods_info = Db::name($this->og)->where("\157\x72\144\x65\x72\137\151\x64", $data["\x6f\162\144\x65\162\x5f\151\144"])->select(); goto BRknX; TDJuf: if (!empty($info)) { goto zXIkR; } goto Xjd4B; uCigP: } public function delOrder($data) { goto LCYOj; LbWuz: $new_data = array("\151\x73\x5f\x64\145\x6c\145\x74\x65\144" => 1); goto J8k__; i5QCo: return $res; goto FbYkB; okEBF: if (!empty($info)) { goto l6WGx; } goto q3Y00; eF2sE: l6WGx: goto LbWuz; LCYOj: $info = Db::name($this->o)->where($data)->find(); goto okEBF; J8k__: $res = Db::name($this->o)->where(["\x6f\162\144\145\x72\x5f\x69\x64" => $data["\x6f\162\144\x65\x72\x5f\151\144"]])->update($new_data); goto i5QCo; q3Y00: return null; goto eF2sE; FbYkB: } public function refundOrder($data) { goto ArFmW; tbfsy: $res = Db::name($this->o)->where(["\x6f\x72\x64\145\162\137\151\x64" => $data["\157\162\144\x65\x72\137\151\144"]])->update($new_data); goto vUVrG; Covdm: return null; goto Aoflz; vUVrG: return $res; goto VKX0Z; lQsvo: $new_data = array("\x6f\x72\144\145\162\137\x73\x74\x61\x74\165\x73" => 4, "\x72\x65\146\x75\156\144\x5f\164\151\x6d\145" => time()); goto tbfsy; ArFmW: $info = Db::name($this->o)->where($data)->find(); goto thOke; thOke: if (!empty($info)) { goto zPWzx; } goto Covdm; Aoflz: zPWzx: goto lQsvo; VKX0Z: } }
