<?php
 namespace app\api\service; use Aliyun\DySDKLite\SignatureHelper; use think\Cache; use think\Db; require_once BASE_ROOT . "\143\157\162\145\57\x65\x78\x74\x65\156\x64\x2f\x41\154\x69\x79\x75\x6e\57\123\151\147\156\x61\164\165\x72\145\110\145\154\x70\x65\x72\x2e\160\x68\x70"; class ArlikiService { private $ali_id = ''; private $ali_token = ''; private $ali_name = ''; private $ali_code = ''; private $phone = ''; private $status = "\x32"; private $bus_id2 = ''; function __construct($mch_id) { goto WlQus; fcF3p: $this->ali_id = $re["\141\x6c\151\137\x69\144"]; goto lRFh0; oGNPJ: $this->phone = $re["\x70\x68\x6f\156\x65"]; goto SSxn9; UlrLI: $re = Db::name("\x79\x62\x73\x63\137\x73\155\163\x63\157\156\x66")->where("\x6d\143\150\137\x69\x64", $mch_id)->find(); goto fcF3p; bCyVc: $this->ali_code = $re["\141\x6c\x69\137\x63\157\144\145"]; goto oGNPJ; VTzyi: $this->ali_name = $re["\x61\x6c\x69\137\x6e\x61\x6d\145"]; goto bCyVc; SSxn9: $this->status = $re["\163\164\x61\164\x75\x73"]; goto mcYQg; WlQus: $this->bus_id2 = $mch_id; goto UlrLI; lRFh0: $this->ali_token = $re["\x61\x6c\x69\x5f\164\157\153\x65\x6e"]; goto VTzyi; mcYQg: } public function exp_load($no, $from = '') { goto C1n4o; IWraG: $i = 0; goto zt_1I; ZhxG1: $from = $this->exp_from($no); goto IWraG; qxYsB: $res = Cache::get("\x65\x78\160\137\151\156\146\157" . $no); goto G_Vde; TFpZ2: goto TNCQ4; goto GWtzs; RUouS: if (!($res["\x63\157\144\x65"] == 1)) { goto Oqk3b; } goto f9JII; l3F4Y: goto mk6r2; goto mwjEg; PrphS: if (empty($from)) { goto r0dz5; } goto yrmch; sUnQZ: if (!($i < count($from))) { goto tpfg9; } goto y88Td; FpVEz: if (!(count($from) == 0)) { goto cAXZv; } goto vCnhf; y88Td: $res = $this->exp_query($no, $from[$i]); goto RUouS; zt_1I: UoNEM: goto sUnQZ; n8weZ: vvi1M: goto RnULH; iK7TZ: return $res; goto PTN1s; OcDtD: goto tpfg9; goto pSclR; GWtzs: r0dz5: goto ZhxG1; RnULH: $i++; goto TlyrE; mwjEg: H9tGQ: goto qxYsB; TlyrE: goto UoNEM; goto wJq3O; G_Vde: mk6r2: goto iK7TZ; ePnEL: $res["\x63\x6f\144\145"] = $from; goto DPtv3; wJq3O: tpfg9: goto FpVEz; GTzqk: TNCQ4: goto l3F4Y; pSclR: Oqk3b: goto n8weZ; DPtv3: cAXZv: goto GTzqk; C1n4o: if (Cache::get("\x65\170\160\137\151\x6e\146\157" . $no)) { goto H9tGQ; } goto PrphS; f9JII: Cache::set("\145\x78\160\x5f\x69\156\146\x6f" . $no, $res, 3600); goto OcDtD; yrmch: $res = $this->exp_query($no, $from); goto TFpZ2; vCnhf: $res["\x64\141\x74\x61"] = "\345\215\x95\345\x8f\xb7\xe5\xbc\202\xe5\xb8\270\54\350\257\267\347\250\x8d\345\220\x8e\345\x86\x8d\xe8\257\x95\56"; goto ePnEL; PTN1s: } public function exp_from($no) { goto oYnks; iwJVB: $res = json_decode(get_url_content($url), true); goto koIDt; oYnks: $url = "\x68\164\x74\160\72\x2f\x2f\x6d\56\153\x75\x61\151\144\151\61\x30\60\x2e\143\x6f\x6d\57\x61\165\x74\x6f\x6e\x75\x6d\x62\x65\162\x2f\x61\x75\x74\x6f\77\156\165\155\x3d" . $no; goto iwJVB; ABvc4: $i = 0; goto iFdvz; NHAV2: if (!($i < count($res))) { goto Uf7SO; } goto pqYyb; iFdvz: aGx2m: goto NHAV2; koIDt: $re = array(); goto ABvc4; IjVpQ: return $re; goto PJGm0; pqYyb: $re[$i] = $res[$i]["\143\157\155\103\157\144\x65"]; goto Ccvj_; Ccvj_: ZcgQt: goto XPOpZ; NsD6u: goto aGx2m; goto F0s5V; XPOpZ: $i++; goto NsD6u; F0s5V: Uf7SO: goto IjVpQ; PJGm0: } private function exp_query($no, $from) { goto FEZxm; RiE4O: goto TDpGJ; goto gN1vH; akUT9: $msg["\x73\x74\141\x74\x65"] = $res["\163\x74\x61\x74\145"]; goto mlKib; F4D1F: $res = json_decode(get_url_content($url), true); goto akUT9; T951l: if ($res["\x6d\x65\163\163\x61\x67\x65"] == "\157\x6b") { goto wlA8W; } goto NUDgW; gN1vH: wlA8W: goto D59Bu; NUDgW: $msg["\x64\x61\x74\x61"] = "\xe8\x8e\267\xe5\x8f\x96\xe5\244\261\350\xb4\xa5\x2c\350\xaf\267\xe7\250\x8d\345\x90\x8e\345\x86\x8d\xe8\257\x95\56"; goto MQb2x; MQb2x: $msg["\x63\x6f\144\x65"] = 0; goto RiE4O; f80fI: return $msg; goto oXk0N; D59Bu: $msg["\x64\x61\164\141"] = $res["\144\x61\x74\x61"]; goto oQ12G; oQ12G: $msg["\x63\157\144\145"] = 1; goto WWBlY; WWBlY: TDpGJ: goto f80fI; FEZxm: $state = array(0 => "\345\x9c\250\xe9\200\224\xe4\270\255", 1 => "\xe5\267\xb2\xe6\x8f\xbd\xe6\x94\266", 2 => "\347\x96\221\351\x9a\276", 3 => "\xe5\xb7\xb2\347\255\xbe\346\x94\xb6", 4 => "\351\200\200\347\255\276", 5 => "\xe5\220\x8c\xe5\x9f\x8e\346\xb4\276\xe9\200\201\xe4\270\xad", 6 => "\xe9\200\x80\xe5\x9b\x9e", 7 => "\350\xbd\xac\xe5\x8d\x95"); goto oCudM; oCudM: $url = "\150\164\164\x70\72\57\x2f\155\56\x6b\x75\x61\x69\x64\151\61\x30\x30\x2e\x63\157\x6d\x2f\x71\x75\x65\x72\171\77\164\x79\x70\145\x3d" . $from . "\46\x70\x6f\163\164\x69\144\75" . $no . "\x26\x69\144\75\61\46\166\141\154\x69\143\x6f\144\145\x3d\46\164\145\x6d\160\75\x30\56\67\62\x32\71\x39\60\x36\x33\x31\x39\x37\65" . rand(100, 999); goto F4D1F; mlKib: $msg["\x73\x74\141\x74\x65"] = $state[$res["\x73\164\141\x74\x65"]]; goto T951l; oXk0N: } public function send_sms($data, $phone = '', $return = false) { goto thmdn; rvNsM: IyagD: goto OVW24; AbSt8: $res[$i] = $this->aliyun_send($params); goto Cntin; Hfj8h: $d["\x43\157\x64\145"] = "\60"; goto aklRv; DR5Ep: nyvFR: goto ihNrx; UTzCd: $i = 0; goto QFN6y; fXQ1p: $params["\120\x68\x6f\156\145\x4e\x75\x6d\142\145\162\163"] = $phone[$i]; goto iKlYd; RB2UF: if (!(strlen($phone[$i]) > 5)) { goto fciJS; } goto lBdBH; QFN6y: OPg9A: goto sL875; lM3Cw: wlGaR: goto UXA3E; UQYb9: QDNPM: goto CS6Lo; lBdBH: $params = array(); goto fXQ1p; n5dXl: $d["\x4d\x65\163\x73\141\147\x65"] = "\xe6\x9c\252\xe5\274\200\345\220\xaf\xe7\237\xad\xe4\xbf\241\351\200\x9a\347\237\xa5"; goto U4IhK; CB8Za: U_MH8: goto sGuDg; azg4E: $params["\x54\x65\155\x70\154\x61\164\145\x50\141\x72\x61\x6d"] = $pa; goto MYgVB; IumQn: K9ufE: goto IAAbv; aklRv: $d["\x4d\145\x73\x73\x61\147\145"] = "\345\x8f\x82\346\x95\260\344\xb8\215\345\256\214\xe6\x95\xb4"; goto hxfFO; Cntin: Db::name("\x79\x62\x73\x63\137\x73\x6d\163\143\157\156\x66")->where("\x6d\143\150\137\151\x64", $this->bus_id2)->setInc("\157\153\137\x75\x73\x65"); goto MSaaa; hxfFO: return $d; goto rvNsM; LJEgY: return $res; goto lM3Cw; MSaaa: fciJS: goto wbNAF; MYgVB: if (!(!empty($params["\x54\145\x6d\x70\154\x61\x74\x65\120\x61\162\x61\155"]) && is_array($params["\x54\145\x6d\160\154\141\x74\x65\x50\141\x72\x61\155"]))) { goto eoVgh; } goto YjZic; OVW24: if (!($this->status == 2)) { goto nyvFR; } goto Cramj; sL875: if (!($i < count($phone))) { goto QDNPM; } goto RB2UF; PhBWW: $phone = explode("\x2c", $this->phone); goto CB8Za; wY0LN: eoVgh: goto AbSt8; sGuDg: if (!is_array($data)) { goto K9ufE; } goto fzQ1g; WfRAa: $i++; goto PGwH5; SdTBM: sMZuo: goto UTzCd; jzZvF: zemjX: goto PhBWW; thmdn: if (!(empty($this->ali_id) || empty($this->ali_token))) { goto IyagD; } goto Hfj8h; wbNAF: pkHC4: goto WfRAa; IAAbv: $pa["\x6f\x72\x64\x65\162"] = $data; goto SdTBM; PGwH5: goto OPg9A; goto UQYb9; U4IhK: return $d; goto DR5Ep; YjZic: $params["\124\145\155\160\x6c\x61\164\145\120\x61\162\141\155"] = json_encode($params["\124\145\155\x70\154\141\164\145\x50\141\162\141\x6d"], JSON_UNESCAPED_UNICODE); goto wY0LN; CS6Lo: if (!$return) { goto wlGaR; } goto LJEgY; hljdB: $phone = array($phone); goto Jbwwl; YN9rv: goto sMZuo; goto IumQn; Cramj: $d["\x43\157\x64\145"] = "\60"; goto n5dXl; fzQ1g: $pa = $data; goto YN9rv; yUB9U: $params["\124\145\x6d\x70\x6c\x61\164\145\103\157\x64\145"] = $this->ali_code; goto azg4E; Jbwwl: goto U_MH8; goto jzZvF; ihNrx: if (empty($phone)) { goto zemjX; } goto hljdB; iKlYd: $params["\123\151\x67\x6e\116\x61\155\145"] = $this->ali_name; goto yUB9U; UXA3E: } public function send_test($ali_id, $ali_token, $ali_name, $ali_code, $phone) { goto N304B; t4Uwi: $params["\124\x65\x6d\x70\154\x61\164\x65\120\x61\x72\x61\155"] = json_encode($params["\x54\145\155\160\x6c\141\164\x65\120\141\162\x61\x6d"], JSON_UNESCAPED_UNICODE); goto n5jY5; WeqmJ: $params["\124\145\x6d\x70\x6c\141\164\145\x43\x6f\144\145"] = $ali_code; goto mv_zR; Ywg7W: $res = $this->aliyun_send($params, $ali_id, $ali_token); goto kOYMH; mv_zR: $params["\124\145\x6d\160\x6c\141\x74\145\x50\141\x72\x61\x6d"] = array("\x6f\162\x64\x65\162" => "\101\102\x43\104\x45\x46"); goto BdakC; pe55u: $params["\x50\x68\x6f\x6e\145\116\x75\155\142\x65\162\x73"] = $phone; goto g2k3u; N304B: $params = array(); goto pe55u; BdakC: if (!(!empty($params["\124\x65\x6d\x70\x6c\x61\164\x65\x50\141\162\x61\155"]) && is_array($params["\x54\145\155\x70\154\x61\164\145\x50\x61\162\141\x6d"]))) { goto ZkJ4O; } goto t4Uwi; n5jY5: ZkJ4O: goto Ywg7W; kOYMH: return $res; goto WtkFm; g2k3u: $params["\x53\151\x67\156\116\x61\155\145"] = $ali_name; goto WeqmJ; WtkFm: } private function aliyun_send($params, $ali_id = '', $ali_token = '') { goto GPU78; E3m32: $helper = new SignatureHelper(); goto PiqLw; fF8lr: $accessKeySecret = $ali_token; goto rXp6k; rXp6k: Ub9vs: goto yMbKJ; Iojtz: return $content; goto jpgBM; jQ3sr: $accessKeySecret = $this->ali_token; goto fp9Ev; fp9Ev: if (!(!empty($ali_id) && !empty($ali_token))) { goto Ub9vs; } goto yjcbG; GPU78: $accessKeyId = $this->ali_id; goto jQ3sr; yjcbG: $accessKeyId = $ali_id; goto fF8lr; yMbKJ: $security = false; goto E3m32; PiqLw: $content = $helper->request($accessKeyId, $accessKeySecret, "\144\171\x73\x6d\163\x61\160\x69\56\x61\x6c\x69\171\x75\x6e\x63\163\56\143\157\x6d", array_merge($params, array("\122\145\x67\x69\157\x6e\111\144" => "\x63\156\55\x68\141\156\x67\172\150\x6f\x75", "\x41\143\164\x69\x6f\x6e" => "\123\145\156\144\x53\155\163", "\x56\145\x72\163\x69\x6f\x6e" => "\x32\x30\61\x37\55\60\65\55\x32\x35")), $security); goto Iojtz; jpgBM: } }
