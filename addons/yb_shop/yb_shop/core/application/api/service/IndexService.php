<?php
 namespace app\api\service; use think\Db; use think\Cache; use think\Exception; use think\log; class IndexService { private $bb = "\x79\x62\163\x63\x5f\x62\x75\x73\137\142\x6f\x6f\153"; private $bc = "\171\x62\x73\x63\x5f\x62\x75\163\x5f\x63\x6f\x6d\155\145\x6e\x74"; private $u = "\x79\x62\x73\143\137\165\x73\145\162"; private $ut = "\x79\142\x73\x63\x5f\165\x73\145\x72\137\164\155\x70\154"; private $bt = "\171\142\x73\143\137\x62\x75\x73\137\164\x6d\x70\x6c"; private $bf = "\171\x62\x73\143\137\142\x75\x73\137\146\157\x72\x6d"; public function WriteBook($data) { goto XvSnd; XvSnd: $a = Db::name($this->bb)->where($data)->count(); goto Ru_zT; FnAOk: txnkt: goto yAMSc; Ru_zT: if (!($a > 0)) { goto txnkt; } goto un2ud; un2ud: return -1; goto FnAOk; yAMSc: $data["\x63\x72\x65\141\x74\145\x5f\x74\151\155\145"] = time(); goto xc2gD; RfQ39: return $info; goto gJu_I; xc2gD: $info = Db::name($this->bb)->insert($data); goto RfQ39; gJu_I: } public function WriteComment($data) { goto Gbx3S; dBifM: return -1; goto uvHOG; HKnBg: $info = Db::name($this->bc)->update($data); goto pp95T; PZgZu: $data["\143\x72\x65\141\164\x65\x5f\x74\151\x6d\x65"] = time(); goto HKnBg; pp95T: return $info; goto u3XVv; uvHOG: jEKwr: goto PZgZu; Gbx3S: $a = Db::name($this->bc)->where($data)->count(); goto nHl8W; nHl8W: if (!($a > 0)) { goto jEKwr; } goto dBifM; u3XVv: } public function CommentList($data, $page, $num) { goto rENik; bIJ1B: $num = Db::name($this->bc)->where($data)->avg("\x66\x72\141\143\x74\x69\157\156") * 2; goto t0bmp; AIWat: $rs["\x63\157\x75\x6e\164"] = Db::name($this->bc)->where($data)->count(); goto bIJ1B; t0bmp: $rs["\x73\162\157\143\x65"] = round($num, 2); goto cysCH; tjx9A: goto Ozacs; goto BXIjU; OqHZB: goto eZmar; goto TnhI0; rENik: if ($num == 0) { goto FrYM_; } goto Ya7w4; gSPGB: foreach ($info as $key => $value) { goto ZGGvY; pDzMd: $i = 0; goto wqu5D; FezSl: $value->user_headimg = $username["\165\163\x65\162\137\150\145\141\144\x69\x6d\147"]; goto T2lx8; R4mO9: $value->username = $username["\156\151\143\153\x5f\x6e\141\155\x65"]; goto FezSl; mPjDs: $i++; goto KVv0e; Tgy9d: $value->pic = $pic; goto sSjMm; KVv0e: goto g23h2; goto UKLIo; T2lx8: O_P7c: goto dHtP7; Vifmv: $pic = explode("\54", rtrim($value->array_pic, "\x2c")); goto pDzMd; ZGGvY: if (!($value->array_pic != '')) { goto D9yWj; } goto Vifmv; UKLIo: wNqRj: goto Tgy9d; YXkcP: n0FL4: goto mPjDs; aE9vM: if (!($i < count($pic))) { goto wNqRj; } goto ote1Z; sSjMm: D9yWj: goto O7f58; wqu5D: g23h2: goto aE9vM; ote1Z: $pic[$i] = "\150\164\x74\x70\x73\72\x2f\x2f" . $_SERVER["\110\x54\x54\120\x5f\x48\x4f\123\x54"] . "\x2f\x61\x70\151\x2f" . $pic[$i]; goto YXkcP; O7f58: $value->create_time = date("\131\55\155\55\144", $value->create_time); goto hMaAu; hMaAu: $username = $this->getUserInfo($value->user_id); goto R4mO9; dHtP7: } goto Cp2Hy; IpZ4L: $info = Db::name($this->bc)->where($data)->page($page, PAGESIZE)->order("\143\x72\145\x61\x74\145\137\164\x69\x6d\x65", "\x64\x65\x73\143")->select(); goto ULog0; CvSiP: $rs["\151\156\146\x6f"] = $info; goto ERZWk; BXIjU: gyaJq: goto gSPGB; TnhI0: FrYM_: goto IpZ4L; BsE6Z: $rs["\151\x6e\146\x6f"] = array(); goto tjx9A; Cp2Hy: Om3Eu: goto CvSiP; ERZWk: Ozacs: goto AIWat; Ya7w4: $info = Db::name($this->bc)->where($data)->limit($num)->order("\x63\162\x65\x61\x74\145\137\x74\151\155\145", "\x64\145\x73\143")->select(); goto OqHZB; ai135: if (!empty($info)) { goto gyaJq; } goto BsE6Z; cysCH: return json_encode($rs); goto y8j3Z; ULog0: eZmar: goto ai135; y8j3Z: } public function getUserInfo($uid) { $info = Db::name($this->u)->where("\165\151\x64", $uid)->find(); return $info; } public function mod_index($uid = '') { goto mk29k; Vwokx: return $m; goto Bmesx; DS7TU: $rs = array(); goto QrQ9B; mk29k: $rs = Cache::get($uid . "\155\157\144\x69\x6e\144\145\x78"); goto lT1_4; RIRlV: Cache::set($uid . "\155\157\144\x69\x6e\x64\x65\x78", $rs, CACHE_TIME); goto Mp70A; Bmesx: QMonS: goto d866z; K2kS2: if (!empty($m)) { goto QMonS; } goto Vwokx; d866z: $rs = $m["\x69\156\144\x65\170\137\x76\141\154\x75\145\163"]; goto RIRlV; sdeUk: return $rs; goto CvYRu; lT1_4: if (!($rs != false)) { goto yINcD; } goto sdeUk; QrQ9B: $m = Db::name($this->ut)->where("\155\x63\x68\x5f\x69\144\75" . $uid)->find(); goto K2kS2; CvYRu: yINcD: goto DS7TU; Mp70A: return json_decode($rs); goto UI0pJ; UI0pJ: } public function get_power($data) { goto ymwzl; c8LMt: $rs = json_decode($m["\151\156\144\x65\170\x5f\x76\x61\154\x75\145\x73"], true); goto fJN29; wYmon: return $rs; goto iwfdf; ymwzl: $m = Db::name($this->bt)->where($data)->where("\151\x73\137\144\145\154", 1)->find(); goto vvMLw; fJN29: $rs["\156\141\155\x65"] = $m["\156\141\x6d\x65"]; goto wYmon; a1vR4: return $m; goto fOWq2; fOWq2: qUBrG: goto c8LMt; vvMLw: if (!empty($m)) { goto qUBrG; } goto a1vR4; iwfdf: } public function get_menu($uid = '') { goto BkFOu; lRq0J: return json_decode($rs); goto Hhdg5; xM0kf: $rs = $m["\166\x61\x6c\165\x65\x73"]; goto lRq0J; D7hqP: return $m; goto G_YbC; WkkfZ: if (!empty($m)) { goto CRzbN; } goto D7hqP; G_YbC: CRzbN: goto xM0kf; BkFOu: $m = Db::name($this->ut)->where("\155\143\150\137\x69\144\75" . $uid)->find(); goto WkkfZ; Hhdg5: } public function get_tabbar($uid = '') { goto uf2xC; wZ0hv: if (!empty($m)) { goto VRPLm; } goto EuzbE; KQYBS: if (!empty($index_values["\x70\x61\147\145"])) { goto Z7J1b; } goto b66Kj; xjwFd: $tabbar = $index_values["\x74\x61\142\x62\141\162"]; goto MLk68; y5v4A: $rs["\x74\x61\142\x62\x61\x72"] = $tabbar; goto sFEQ7; yyzmc: $rs = array(); goto l9EMT; uf2xC: $m = Db::name($this->ut)->where("\x6d\143\x68\x5f\151\144\x3d" . $uid)->find(); goto wZ0hv; b66Kj: $rs["\155\163\147"] = "\xe9\246\226\xe9\xa1\265\346\xa8\241\346\235\277\345\xb7\xb2\345\x8d\x87\xe7\272\xa7\54\350\xaf\xb7\xe5\234\xa8\347\xb3\xbb\xe7\xbb\237\345\x90\216\345\x8f\xb0\xe9\x87\x8d\346\x96\260\344\xbf\x9d\345\xad\230\xe4\xb8\x8b\xe9\246\x96\351\241\xb5\346\250\241\xe6\x9d\xbf"; goto rXodE; A04lV: return $rs; goto z2p_W; DPnBs: $index_values = json_decode($index_values, true); goto KQYBS; Koo8b: $page = $index_values["\160\141\147\x65"]; goto xjwFd; sFEQ7: wWorN: goto A04lV; Fw17a: Z7J1b: goto Koo8b; EuzbE: return $m; goto sRj0s; l9EMT: $index_values = $m["\x69\156\x64\145\170\137\166\x61\154\x75\145\163"]; goto DPnBs; rXodE: goto wWorN; goto Fw17a; sRj0s: VRPLm: goto yyzmc; MLk68: $rs["\x70\x61\147\x65"] = $page; goto y5v4A; z2p_W: } public function get_form($data) { goto BJnCg; X2ujS: $m = Db::name($this->bf)->where($data)->find(); goto n8Rto; LM01z: return $rs; goto IaCIh; n8Rto: if (!empty($m)) { goto RSM2h; } goto GRj0U; Wz1D8: $rs["\154\x69\163\164"] = json_decode($m["\x76\x61\154\x75\x65"]); goto fymol; MReR7: RSM2h: goto Wz1D8; BJnCg: $data["\151\x73\x5f\144\x65\154"] = 1; goto X2ujS; GRj0U: return $m; goto MReR7; fymol: $rs["\164\x69\x74\x6c\145"] = $m["\164\151\x74\x6c\x65"]; goto LM01z; IaCIh: } function in_form($form, $name) { goto vuYtD; y7PE6: ebeV0: goto ZUpGu; ZUpGu: $i++; goto Himsi; wWQVM: goto V0tFX; goto p_xLD; JDhFx: $title = $form[$i]["\164\151\x74\x6c\x65"]; goto wWQVM; p_xLD: nJhAF: goto y7PE6; Ji1Qg: if (!($form[$i]["\156\141\155\x65"] == $name)) { goto nJhAF; } goto JDhFx; Himsi: goto iFO3s; goto iqb07; t2l3n: if (!($i < count($form))) { goto V0tFX; } goto Ji1Qg; iqb07: V0tFX: goto Eff1z; cCSXB: $i = 0; goto nQN8I; vuYtD: $title = ''; goto cCSXB; Eff1z: return $title; goto Vkbwa; nQN8I: iFO3s: goto t2l3n; Vkbwa: } public function submit_form($data) { goto yp3sm; r_DV9: return -1; goto qGs7g; IBW4h: eELjB: goto kHQgi; knKzu: $arr = array(); goto NhCKm; lrEyw: $form_id = Db::name("\171\x62\163\143\137\x75\x73\145\162\137\x66\157\x72\155")->insertGetId($where); goto yoh0m; nrF1w: return null; goto aIhWx; UApgp: foreach ($param as $k => $v) { goto XoPXo; OKmOP: $n++; goto FCDd2; FCDd2: iMT0Y: goto tZ0iY; VwMO5: $arr[$n]["\x76\x61\154\165\145"] = $v; goto eEgFE; XoPXo: $arr[$n]["\156\141\155\145"] = $k; goto VwMO5; eEgFE: $arr[$n]["\164\151\164\x6c\x65"] = $this->in_form($form, $k); goto OKmOP; tZ0iY: } goto IBW4h; nWhdb: $param = json_decode($data["\x70\x61\162\x61\x6d"], true); goto UGgXu; xs_R8: $form = json_decode($data["\x66\157\162\x6d"], true); goto nWhdb; yoh0m: return $form_id; goto s7wMp; yfVVm: if (!($a > 0)) { goto MJfcx; } goto r_DV9; qGs7g: MJfcx: goto zezDz; zezDz: $where["\143\x72\145\141\164\x65\x5f\x74\151\x6d\x65"] = $time; goto lrEyw; aIhWx: WdyXg: goto knKzu; UXOyk: $a = Db::name("\x79\x62\163\143\x5f\x75\163\145\x72\137\x66\157\x72\x6d")->where($where)->count(); goto yfVVm; NhCKm: $n = 0; goto UApgp; yp3sm: $time = time(); goto xs_R8; kHQgi: $where = ["\x62\x75\x73\x5f\x66\157\162\155\x5f\x69\144" => $data["\142\165\163\137\146\157\162\155\x5f\x69\144"], "\165\x73\x65\x72\137\151\144" => $data["\165\x73\145\162\137\151\144"], "\x6d\143\150\x5f\151\144" => $data["\155\x63\150\x5f\151\144"], "\160\141\162\x61\155" => json_encode($arr)]; goto UXOyk; UGgXu: if (!(count($param) == 0)) { goto WdyXg; } goto nrF1w; s7wMp: } public function get_ucenter($mch_id) { goto vFIGS; K4XGu: Na680: goto kbVqA; kbVqA: $rs = $m["\x63\x65\x6e\164\145\162\x5f\x76\x61\154\x75\145\163"]; goto unnDx; unnDx: return $rs; goto xKvCz; vFIGS: $m = Db::name($this->ut)->where("\x6d\143\150\x5f\151\144\75" . $mch_id)->find(); goto YV85z; YV85z: if (!empty($m)) { goto Na680; } goto QcLGO; QcLGO: return $m; goto K4XGu; xKvCz: } }
