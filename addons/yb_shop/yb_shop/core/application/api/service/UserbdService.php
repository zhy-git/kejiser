<?php
 namespace app\api\service; use think\Db; require_once BASE_ROOT . "\143\x6f\162\145\57\x61\160\x70\154\151\x63\x61\164\151\x6f\x6e\x2f\143\x6f\155\x6d\x6f\x6e\x2e\160\x68\160"; class UserbdService { protected $config = array("\x75\162\x6c" => "\150\x74\x74\x70\163\72\57\57\x6f\x70\x65\x6e\141\x70\151\x2e\x62\x61\x69\x64\165\56\x63\157\x6d\x2f\156\141\154\157\x67\151\x6e\57\x67\x65\164\x53\145\163\x73\x69\x6f\x6e\113\x65\171\102\171\x43\157\x64\x65", "\x61\160\x70\151\x64" => "\x79\157\x75\x72\x20\141\x70\x70\x49\144", "\x73\x65\x63\x72\x65\x74" => "\171\157\165\x72\40\x73\145\143\162\x65\164"); public function __construct() { goto bS41s; rttVJ: $param = json_decode($param, true); goto iCkZU; iCkZU: $key = $param["\x41\120\x50\x5f\x4b\x65\x79"]; goto BIkXe; bS41s: $param = Db::name("\171\142\163\143\x5f\143\x6f\156\x66\x69\147")->where("\x6b\145\x79", "\x42\x44\x41\120\x50")->where("\155\143\x68\137\x69\144", $GLOBALS["\155\x63\x68\x5f\151\x64"])->value("\166\x61\x6c\x75\145"); goto rttVJ; s0mXD: $this->config["\x73\145\x63\162\x65\x74"] = $secret; goto QWrKl; ekUxE: $this->config["\x61\x70\160\151\x64"] = $key; goto s0mXD; BIkXe: $secret = $param["\101\x50\x50\137\x53\x45\103\x52\105\x54"]; goto ekUxE; QWrKl: } public function checkUser($appId, $pid) { goto XMXY6; wTAFf: return $rs["\165\151\x64"]; goto GMmWs; GMmWs: IARsG: goto sB12l; VpH_4: G_OhK: goto NxLdz; PiJV4: if (!(!empty($rs) && $pid != 0 && $rs["\x70\x69\x64"] == 0)) { goto G_OhK; } goto Q0qtU; D242r: return null; goto Aqsra; OnKEH: SJ2rS: goto wTAFf; NxLdz: if (!empty($rs) && $rs["\165\151\x64"]) { goto SJ2rS; } goto D242r; XMXY6: $rs = Db::name("\x79\142\x73\143\x5f\165\x73\x65\x72")->where("\167\170\x5f\157\160\145\x6e\151\144", $appId)->find(); goto PiJV4; Aqsra: goto IARsG; goto OnKEH; Q0qtU: Db::name("\171\x62\x73\x63\x5f\165\163\145\x72")->where("\167\170\137\157\160\145\156\151\144", $appId)->update(["\160\x69\x64" => $pid]); goto VpH_4; sB12l: } public function addUser($data) { goto PZMKx; Iw2TD: if (!(empty($info) || $info["\154\x65\x76\145\154"] == 0)) { goto Lr3lz; } goto OjHDu; Vy03r: Lr3lz: goto Cfxyq; PZMKx: $info = Db::name("\171\142\163\143\x5f\x75\x73\x65\x72\137\x73\x68\x61\x72\x65\x5f\163\x65\164\x74\151\156\x67")->where("\155\x63\x68\x5f\x69\x64", $data["\155\x63\150\x5f\x69\144"])->find(); goto Iw2TD; Cfxyq: $rs = Db::name("\171\142\x73\x63\137\165\x73\x65\162")->insertGetId($data); goto TbIKU; OjHDu: $data["\x70\x69\x64"] = 0; goto Vy03r; TbIKU: return $rs; goto CtlLf; CtlLf: } public function getUser($uid) { $result = Db::name("\x79\142\x73\143\x5f\x75\163\x65\162")->where("\x75\151\144", $uid)->find(); return $result; } public function checkLogin($code) { goto S_621; JGdJf: $res = $this->makeRequest($this->config["\165\x72\x6c"], $params); goto FZ9oJ; S_621: $params = array("\x63\x6c\151\x65\x6e\164\137\x69\144" => $this->config["\x61\160\x70\x69\144"], "\x73\x6b" => $this->config["\163\x65\143\162\145\x74"], "\x63\157\144\145" => $code); goto JGdJf; FZ9oJ: $a = json_decode($res["\x72\145\x73\x75\x6c\x74"], true); goto fNTC9; fNTC9: return $a; goto y3EE4; y3EE4: } protected function makeRequest($url, $params = array(), $expire = 0, $extend = array(), $hostIp = '') { goto ie0TR; b3RnQ: return $result; goto Syoyj; AdTeE: ZBD_H: goto r292I; g68YF: curl_setopt($_curl, CURLOPT_POST, true); goto KQCrF; VYb2S: curl_setopt_array($_curl, $extend); goto N3M5B; bwCiu: $result["\143\157\x64\x65"] = -curl_errno($_curl); goto o1fNR; avuU5: goto f37pG; goto Z7tsd; tkWPv: if (empty($urlInfo["\150\x6f\x73\x74"])) { goto rXbYN; } goto UQdD_; mPJ33: if (empty($params)) { goto tdMmN; } goto Hf3Hq; r292I: $_curl = curl_init(); goto UhBT1; Pnauc: $_header[] = "\x48\157\163\164\72\x20{$urlInfo["\150\157\163\164"]}"; goto Xqoa3; XUDK0: $urlInfo["\x68\x6f\x73\164"] = substr(DOMAIN, 7, -1); goto EED_n; ssRKA: curl_setopt($_curl, CURLOPT_USERAGENT, "\101\120\111\40\x50\x48\x50\40\x43\125\x52\x4c"); goto b2g58; lG2rm: $result["\x63\x6f\x64\145"] = curl_getinfo($_curl, CURLINFO_HTTP_CODE); goto GmyMJ; Z7tsd: rXbYN: goto XUDK0; kqNr1: return array("\143\x6f\x64\x65" => "\61\x30\x30"); goto AdTeE; efrF_: curl_close($_curl); goto b3RnQ; o1fNR: gzHqU: goto efrF_; Gkz5h: $urlInfo = parse_url($url); goto tkWPv; bwE_a: $result["\x72\145\163\x75\x6c\x74"] = curl_exec($_curl); goto lG2rm; Hf3Hq: curl_setopt($_curl, CURLOPT_POSTFIELDS, http_build_query($params)); goto g68YF; Vs1_w: if (!($expire > 0)) { goto Ooghd; } goto z93Re; tnS41: Ooghd: goto PPV_j; UhBT1: $_header = array("\101\143\x63\145\160\x74\x2d\x4c\x61\x6e\x67\165\x61\x67\x65\72\40\x7a\150\55\103\x4e", "\103\x6f\156\x6e\145\143\164\x69\x6f\156\72\x20\x4b\x65\x65\160\x2d\x41\154\151\x76\x65", "\x43\x61\143\x68\145\55\x43\157\156\164\162\x6f\x6c\x3a\40\x6e\157\55\x63\x61\143\150\145"); goto nu_jt; UQdD_: $url = str_replace($urlInfo["\150\x6f\163\x74"], $hostIp, $url); goto avuU5; FxiW8: curl_setopt($_curl, CURLOPT_CONNECTTIMEOUT, $expire); goto tnS41; DXxwq: if (!($result["\162\145\x73\x75\x6c\164"] === false)) { goto gzHqU; } goto SMY9G; b2g58: curl_setopt($_curl, CURLOPT_HTTPHEADER, $_header); goto Vs1_w; nu_jt: if (empty($hostIp)) { goto twIvw; } goto Gkz5h; EED_n: $url = "\150\164\164\x70\72\57\57{$hostIp}{$url}"; goto va5pX; RkfvW: curl_setopt($_curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto xhmFM; SMY9G: $result["\162\x65\x73\x75\x6c\x74"] = curl_error($_curl); goto bwCiu; GmyMJ: $result["\x69\x6e\146\157"] = curl_getinfo($_curl); goto DXxwq; ZycFR: V6TvK: goto EAAQw; Xqoa3: twIvw: goto mPJ33; xhmFM: curl_setopt($_curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto ZycFR; fyMS0: curl_setopt($_curl, CURLOPT_RETURNTRANSFER, true); goto ssRKA; ie0TR: if (!empty($url)) { goto ZBD_H; } goto kqNr1; N3M5B: iIh7Z: goto bwE_a; KQCrF: tdMmN: goto CMhqc; z93Re: curl_setopt($_curl, CURLOPT_TIMEOUT, $expire); goto FxiW8; va5pX: f37pG: goto Pnauc; EAAQw: curl_setopt($_curl, CURLOPT_URL, $url); goto fyMS0; CMhqc: if (!(substr($url, 0, 8) == "\x68\164\x74\x70\163\72\57\x2f")) { goto V6TvK; } goto RkfvW; PPV_j: if (empty($extend)) { goto iIh7Z; } goto VYb2S; Syoyj: } public function get_userinfo($data) { $u = Db::name("\171\x62\x73\x63\x5f\165\x73\145\x72")->where("\x75\x69\x64", $data["\165\151\144"])->find(); return $u; } public function orderCount($data) { goto mBj4c; ccKqZ: if (!($u["\154\145\x76\x65\x6c\x5f\x69\x64"] != 0)) { goto ejPDR; } goto WITVh; yI5TV: fckGK: goto p0gzv; WITVh: $a = Db::name("\x79\142\x73\143\137\x75\163\145\162\x5f\x6c\145\x76\x65\154")->where(["\151\144" => $u["\x6c\145\166\145\x6c\137\151\144"], "\155\143\150\x5f\x69\x64" => $data["\155\143\x68\137\x69\x64"]])->find(); goto byi93; x2Uuk: goto pK_tr; goto yI5TV; u1B1w: $rs["\143\157\160\x79\x72\151\x67\x68\x74"] = ''; goto Yd0Mz; byi93: $rs["\154\x65\166\x65\154\x5f\156\141\155\145"] = $a["\154\x65\166\145\154\137\156\x61\155\145"]; goto T07zG; O9ejE: t5gfW: goto BKwmE; h1r08: $rs["\162\x65\x66\165\x6e\144"] = Db::name("\171\x62\163\x63\137\157\162\144\145\x72")->where("\x62\165\171\x65\162\137\151\x64", $data["\165\151\x64"])->where("\x69\163\x5f\144\x65\154\145\164\x65\x64", 0)->where("\155\143\x68\137\x69\144", $data["\x6d\143\x68\x5f\151\x64"])->where("\x6f\162\144\145\x72\137\163\x74\x61\164\x75\x73", 4)->count(); goto jqLdy; I9e_2: $rs["\143\157\x70\x79\x72\x69\147\x68\x74"] = ''; goto QPygg; T07zG: ejPDR: goto QCcY3; qoN_n: $u = Db::name("\x79\x62\x73\143\137\x75\x73\x65\162")->where("\165\x69\x64", $data["\x75\151\x64"])->find(); goto Z6HyA; Z6HyA: $rs["\165\163\145\162\137\154\x65\x76\145\154"] = $u["\154\x65\x76\x65\154\137\x69\x64"]; goto ccKqZ; mBj4c: $rs = array(); goto qoN_n; tD4Ns: $copy = file_get_contents("\x68\164\164\x70\72\x2f\57\x76\x69\160\56\154\x79\61\60\x30\x2e\x77\x61\x6e\147\x2f\x61\x70\x69\57\x61\160\x69\57\151\x6e\144\x65\170\x2f\x69\163\x5f\x73\x68\157\x77\137\x63\157\x70\171\162\x69\147\150\x74\77\165\156\x69\141\143\x69\x64\x3d" . $data["\141\160\160\x5f\151\x64"] . "\46\x79\x75\x6d\151\156\147\75" . $_SERVER["\x48\x54\x54\120\137\x48\117\123\x54"]); goto Ryogo; bYk_p: n7n4z: goto u1B1w; tvhLZ: $rs["\143\157\160\x79\162\151\147\x68\x74"] = $copyright["\x63\x6f\x6e\164\145\x6e\164"]; goto ys0Ox; Fvot7: TKCUx: goto xbrqe; SRTy_: $cop = Db::name("\x79\x62\163\143\x5f\165\x73\145\x72\x5f\160\145\x72\155\x69\163\x73\151\x6f\x6e")->where("\x75\x73\x65\x72\x5f\151\144", $data["\155\143\x68\x5f\151\x64"])->value("\x69\x73\x5f\x73\x68\x6f\167\x5f\x63\157\160\171\x72\x69\x67\x68\164"); goto jZ2wu; aTSS5: pK_tr: goto O9ejE; BACCd: $rs["\160\145\156\144\x69\x6e\147\137\x72\145\143\145\x69\160\x74"] = Db::name("\x79\142\163\x63\x5f\157\x72\144\145\x72")->where("\142\165\171\x65\x72\x5f\151\144", $data["\x75\x69\x64"])->where("\x69\163\x5f\144\145\x6c\145\x74\x65\144", 0)->where("\155\143\150\137\151\x64", $data["\x6d\x63\x68\137\x69\x64"])->where("\157\162\x64\145\x72\137\x73\164\x61\164\165\x73", 2)->count(); goto h1r08; Yd0Mz: peFyL: goto nPb6N; p0gzv: $copyright = Db::name("\x79\x62\x73\x63\137\143\157\160\x79\x72\151\x67\x68\x74")->where("\x69\144", 1)->find(); goto SwIxj; nPb6N: return $rs; goto nsiCP; xbrqe: if ($copy["\143\157\144\145"] == 0) { goto fckGK; } goto TeKTB; BKwmE: goto peFyL; goto bYk_p; jZ2wu: if (!empty($cop) && $cop == 1) { goto n7n4z; } goto tD4Ns; SwIxj: if (empty($copyright)) { goto NmO05; } goto tvhLZ; QCcY3: $rs["\160\145\x6e\x64\x69\156\147\137\160\x61\171\x6d\x65\x6e\164"] = Db::name("\171\x62\x73\x63\x5f\x6f\162\x64\145\x72")->where("\142\165\171\x65\162\137\151\144", $data["\165\151\x64"])->where("\151\x73\137\144\145\154\145\x74\x65\144", 0)->where("\155\x63\150\x5f\151\x64", $data["\155\x63\x68\x5f\x69\x64"])->where("\x6f\x72\x64\x65\x72\137\163\x74\141\x74\165\163", 0)->count(); goto HRw99; TeKTB: $rs["\x63\157\x70\171\x72\151\147\x68\x74"] = "\346\xb4\x9b\351\x98\xb3\345\xa3\271\xe4\xbd\260\xe7\275\x91\xe7\xbb\234\xe6\x8f\220\xe4\276\x9b\346\212\200\346\234\xaf\346\224\xaf\xe6\x8c\201"; goto x2Uuk; Ryogo: if (!empty($copy)) { goto TKCUx; } goto I9e_2; HRw99: $rs["\x70\x65\x6e\x64\151\156\147\x5f\x73\150\x69\160\x6d\x65\x6e\x74"] = Db::name("\171\x62\163\143\x5f\157\x72\144\145\x72")->where("\x62\165\x79\145\162\x5f\151\x64", $data["\x75\151\144"])->where("\x69\x73\x5f\144\x65\x6c\145\x74\145\144", 0)->where("\155\143\x68\x5f\151\x64", $data["\x6d\143\x68\x5f\151\x64"])->where("\x6f\x72\144\145\162\137\163\164\141\x74\x75\163", 1)->count(); goto BACCd; jqLdy: $rs["\x66\x61\166\157\x72\x69\164\145\x73"] = Db::name("\x79\x62\163\143\x5f\x75\x73\145\x72\137\146\x61\x76\x6f\162\151\x74\x65\x73")->where("\x75\151\144", $data["\165\x69\x64"])->count(); goto SRTy_; ys0Ox: NmO05: goto aTSS5; QPygg: goto t5gfW; goto Fvot7; nsiCP: } public function about($data) { goto z1Ns_; nKP84: $u = Db::name("\x79\142\x73\143\x5f\x75\x73\x65\162")->where($data)->find(); goto rJZF4; rJZF4: $rs["\x75\x73\x65\162\137\x6c\145\166\x65\154"] = $u["\x6c\x65\166\x65\154\x5f\151\x64"]; goto ZuhjD; nuedk: if (!($u["\154\x65\x76\x65\154\x5f\151\x64"] != 0)) { goto c4X5J; } goto vuOmB; ZuhjD: $rs["\x75\x73\145\x72\137\162\x65\x62\141\164\x65"] = 10.0; goto nuedk; vuOmB: $a = Db::name("\171\x62\x73\143\137\165\x73\145\x72\x5f\154\x65\166\145\x6c")->where(["\151\x64" => $u["\154\145\x76\145\x6c\x5f\x69\x64"], "\x6d\143\x68\x5f\151\144" => $data["\x6d\x63\150\137\x69\x64"]])->find(); goto CGqRU; kp_Q0: return $rs; goto lvWlm; hjo46: c4X5J: goto E1uFg; K8Yuz: $rs["\154\x6f\147\x6f"] = __IMG($rs["\x6c\x6f\147\x6f"]); goto EAR9f; z1Ns_: $rs = Db::name("\171\142\163\x63\x5f\x62\165\x73\x69\156\x65\163\163\x5f\x61\x62\x6f\x75\x74")->where("\x6d\143\x68\x5f\151\144", $data["\155\x63\150\x5f\x69\x64"])->find(); goto K8Yuz; E1uFg: jQloB: goto kp_Q0; hoXxZ: $rs["\165\x73\145\162\137\162\x65\142\141\164\145"] = $a["\162\145\142\x61\164\x65"]; goto zmqyV; zmqyV: l7FOZ: goto hjo46; EAR9f: if (!($data["\165\151\144"] != 0)) { goto jQloB; } goto nKP84; CGqRU: if (!$a) { goto l7FOZ; } goto hoXxZ; lvWlm: } public static $OK = 0; public static $IllegalAesKey = -41001; public static $IllegalIv = -41002; public static $IllegalBuffer = -41003; public static $DecodeBase64Error = -41004; public function decryptData($encryptedData, $sessionKey, $app_id, $iv) { goto ZAArK; GpJ2G: U62z4: goto jcOLd; lgOQo: $aesCipher = base64_decode($encryptedData); goto WXvEX; nS_l_: ikKSh: goto isyIV; vu9iG: return self::$IllegalBuffer; goto a_BYR; du0iH: if (!(strlen($iv) != 24)) { goto nMzJ7; } goto UjLI6; UjLI6: return self::$IllegalIv; goto I_Mmx; WXvEX: $result = openssl_decrypt($aesCipher, "\101\105\x53\x2d\61\62\70\x2d\103\x42\x43", $aesKey, 1, $aesIV); goto VYbWF; qzU2t: $aesIV = base64_decode($iv); goto lgOQo; VYbWF: $dataObj = json_decode($result); goto FOork; ZAArK: if (!(strlen($sessionKey) != 24)) { goto U62z4; } goto mI1e5; bWGiz: return self::$IllegalBuffer; goto nS_l_; isyIV: return $dataObj; goto hUfXu; a_BYR: su_L7: goto k1G8Y; FOork: if (!($dataObj == NULL)) { goto su_L7; } goto vu9iG; mI1e5: return self::$IllegalAesKey; goto GpJ2G; jcOLd: $aesKey = base64_decode($sessionKey); goto du0iH; k1G8Y: if (!($dataObj->watermark->appid != $app_id)) { goto ikKSh; } goto bWGiz; I_Mmx: nMzJ7: goto qzU2t; hUfXu: } }
