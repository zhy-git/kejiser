<?php
 namespace app\api\service; use app\common\model\ResOrderPayment; use app\common\model\ResOrder; use app\common\model\Goods; use app\common\model\Images; use app\common\model\ResBooked; use app\common\model\ResService; use app\common\model\ResComment; use app\common\model\User; use app\common\model\UserCoupon; use app\common\model\ResOrderGoods; use app\common\model\Resdesk; use app\common\model\Business; use think\Db; use Exception; class CateringService { function __construct() { $this->UserOrder = new \app\common\model\ResOrder(); $this->OrderGoods = new \app\common\model\ResOrderGoods(); } public function VoiceCall($data) { goto plFam; MYtAD: file_get_contents($url); goto jG7IU; plFam: $desk = new Resdesk(); goto VAaqv; d1Rmk: i2ZT6: goto S4gQw; s956g: qPPnN: goto ja71j; sj_KE: $a = $desk->where($where)->find(); goto x87JP; jG7IU: return "\xe5\267\xb2\xe9\200\x9a\347\237\xa5\xe6\234\x8d\345\x8a\xa1\345\x91\230\x2c\xe8\257\xb7\xe7\250\215\345\x90\216"; goto St_UB; VAaqv: $where = ["\151\x64" => $data["\x64\145\x73\153\x5f\x69\x64"], "\x6d\x63\x68\137\151\x64" => $data["\x6d\143\x68\x5f\151\x64"]]; goto sj_KE; kGtbN: return ["\145\162\162\137\143\x6f\x64\145" => 1, "\155\163\x67" => "\346\x89\253\xe7\xa0\x81\xe5\xbc\x82\345\270\xb8\xef\xbc\214\xe8\xaf\267\351\x87\x8d\xe8\xaf\225"]; goto s956g; AjUh3: X_ytr: goto d1Rmk; S4gQw: $url = "\x68\164\x74\x70\x73\x3a\57\57\x76\151\x70\56\x6c\x79\x31\x30\x30\56\x77\141\156\147\57\x61\x70\151\57\141\160\x70\57\101\154\151\171\x75\x6e\x2f\x70\x75\163\x68\x3f\x6d\143\x68\x5f\151\144\x3d" . $data["\155\x63\x68\x5f\x69\x64"] . "\x26\164\x69\164\x6c\145\75" . $title . "\x26\143\x6f\156\164\x65\156\164\75" . $content; goto MYtAD; ja71j: switch ($data["\x63\141\x6c\x6c\137\x74\171\160\145"]) { case 1: goto bG2YA; bG2YA: $title = "\345\x82\xac\xe4\277\203\xe4\xb8\x8a\350\217\x9c"; goto gwCXV; gwCXV: $content = $a["\x6e\141\155\145"] . "\xe5\x8f\xb7\346\241\214\345\202\xac\xe4\277\x83\344\270\212\350\217\x9c"; goto FFodt; FFodt: goto i2ZT6; goto sUN_P; sUN_P: case 2: goto oB01w; dpwdu: $content = $a["\156\141\x6d\x65"] . "\xe5\x8f\xb7\xe6\xa1\214\xe5\221\xbc\xe5\217\253\346\234\x8d\345\x8a\xa1\345\x91\230"; goto wFMeg; wFMeg: goto i2ZT6; goto QRTlM; oB01w: $title = "\xe5\x91\274\xe5\x8f\xab\346\x9c\215\xe5\x8a\xa1\xe5\221\230"; goto dpwdu; QRTlM: case 3: goto p6veV; y2a6B: goto i2ZT6; goto dQMmI; BlWSp: $content = $a["\x6e\141\155\x65"] . "\xe5\x8f\267\346\241\214\xe9\x9c\x80\350\246\201\345\212\xa0\347\xb1\263\351\245\255"; goto y2a6B; p6veV: $title = "\xe5\x8a\xa0\347\xb1\263\xe9\245\255"; goto BlWSp; dQMmI: case 4: goto kWKdY; DOwkW: goto i2ZT6; goto G4C4W; kWKdY: $title = "\345\212\240\xe6\xb0\xb4"; goto bHMQm; bHMQm: $content = $a["\156\x61\x6d\x65"] . "\345\x8f\xb7\xe6\xa1\x8c\xe9\x9c\x80\xe8\xa6\x81\345\x8a\240\xe6\xb0\264"; goto DOwkW; G4C4W: default: return ["\x65\162\x72\137\x63\x6f\x64\x65" => 1, "\x6d\x73\147" => "\xe5\x8f\x82\346\x95\260\xe5\274\202\xe5\xb8\270\xef\274\x8c\350\xaf\xb7\xe6\xb1\202\xe5\xa4\261\xe8\264\245"]; } goto AjUh3; x87JP: if (!empty($a)) { goto qPPnN; } goto kGtbN; St_UB: } public function createOrder($data) { goto VF0rk; cSL3l: return $order->order_id; goto HruSi; WPtFN: try { goto sAjRe; nUOd_: Db::commit(); goto MkFuT; eX3vy: $good = new ResOrderGoods(); goto dy7vD; M8qZj: L2rcH: goto QpVEK; r8rKR: $UserCoupon = new UserCoupon(); goto E3lUb; E3lUb: $coupon_data = array("\163\164\141\x74\165\163" => 1, "\x75\163\145\x5f\164\151\155\145" => time()); goto VKaYa; wGIBX: IY7Zr: goto xr0r5; LQNc3: if (!empty($c)) { goto IY7Zr; } goto T_FPj; T_FPj: throw new \think\Exception("\x73\150\x69\x62\x61\x69"); goto wGIBX; IZyAW: $b = $pay->save($pay_data); goto rD2cc; c60h7: if (!($data["\143\x6f\x75\160\x6f\x6e\137\x69\x64"] != 0)) { goto oiWER; } goto r8rKR; rD2cc: if (!empty($b)) { goto gATbI; } goto fu_ym; Mg1BC: $a = $order->data($data)->allowField(true)->save(); goto XPC7X; GoWsa: CzCRV: goto bd4AV; ZWE6G: gATbI: goto QCpKz; BMzHT: QTdjx: goto nUOd_; KmOVO: throw new \think\Exception("\x73\x68\151\x62\x61\151"); goto GoWsa; bd4AV: if (!($data["\x70\x61\171\137\164\x79\x70\145"] == 1)) { goto bZODH; } goto DgW06; kM8eb: $dish = json_decode($data["\x6f\162\144\x65\x72\x5f\144\151\x73\x68\x5f\x6a\x73\157\156"], true); goto P3DVC; MJe7e: $pay_data = array("\x6f\165\x74\x5f\164\162\141\144\145\137\156\157" => $data["\157\165\164\137\164\x72\x61\144\x65\137\156\x6f"], "\164\x79\160\145\137\x61\x6c\x69\163\x5f\151\144" => $order->order_id, "\x70\141\171\137\x62\x6f\144\171" => "\xe7\224\250\xe6\210\267\xe6\224\xaf\344\273\x98", "\x70\x61\x79\137\144\x65\x74\x61\x69\x6c" => "\347\x94\xa8\xe6\210\267\xe8\264\255\xe4\xb9\260\xe5\x95\206\xe5\223\201", "\160\141\171\137\x6d\157\x6e\x65\171" => $data["\160\141\171\x5f\x6d\x6f\x6e\x65\171"], "\x63\x72\x65\x61\x74\x65\x5f\x74\x69\155\x65" => time()); goto IZyAW; VKaYa: $c = $UserCoupon->save($coupon_data, "\151\x64\x3d" . $data["\x63\157\165\160\157\156\137\x69\x64"]); goto LQNc3; QpVEK: $order_good = new Goods(); goto eX3vy; XPC7X: if (!empty($a)) { goto CzCRV; } goto KmOVO; dy7vD: $time = time(); goto jLALU; QCpKz: bZODH: goto c60h7; jLALU: foreach ($dish as $k => $v) { goto wyZcg; st4Mb: $new_data = ["\157\x72\144\145\162\x5f\151\144" => $order->order_id, "\147\x6f\157\x64\163\x5f\x6e\x61\155\x65" => $info["\147\x6f\x6f\144\x73\137\156\141\x6d\x65"], "\160\162\x69\143\145" => $info["\160\162\151\x63\145"], "\x6d\143\150\x5f\151\x64" => $info["\155\143\150\137\x69\x64"], "\x75\163\x65\162\x5f\151\x64" => $data["\165\163\x65\162\137\151\x64"], "\x69\x6d\147" => $info["\151\155\x61\147\x65\x73"], "\x67\157\157\144\x73\137\151\144" => $k, "\156\165\x6d\142\145\x72" => $v, "\164\x79\x70\145" => 0, "\x63\x72\x65\x61\164\x65\137\x74\x69\155\145" => $time]; goto jHu0H; pBqXQ: if (!$info) { goto FwB06; } goto st4Mb; E02oa: $info = $order_good->where("\147\x6f\157\144\163\137\x69\144", $k)->find(); goto pBqXQ; eCrAp: eVU8U: goto MPNSA; osRdp: lMXT3: goto ZO65v; jHu0H: $d = $good->insert($new_data); goto WiEuL; WiEuL: if (!empty($d)) { goto eVU8U; } goto NN1Ng; wyZcg: $order_good->where("\x67\x6f\x6f\144\163\137\x69\x64", $k)->setInc("\x72\x65\141\154\x5f\163\141\x6c\x65\163", $v); goto E02oa; MPNSA: FwB06: goto osRdp; NN1Ng: throw new \think\Exception("\163\150\151\x62\141\151"); goto eCrAp; ZO65v: } goto BMzHT; xr0r5: oiWER: goto kM8eb; sAjRe: $order = new ResOrder(); goto Mg1BC; Jl9VV: throw new \think\Exception("\163\x68\151\x62\x61\151"); goto M8qZj; fu_ym: throw new Exception("\x73\x68\x69\x62\x61\x69"); goto ZWE6G; P3DVC: if (!empty($dish)) { goto L2rcH; } goto Jl9VV; DgW06: $pay = new ResOrderPayment(); goto MJe7e; MkFuT: } catch (\Exception $e) { Db::rollback(); return null; } goto cSL3l; VF0rk: Db::startTrans(); goto WPtFN; HruSi: } public function orderList($data, $page = 1) { goto eEkq9; yf1xb: URk0m: goto vp0w_; Or9pz: if (!empty($order_list)) { goto URk0m; } goto NXp30; PJo83: $info["\x70\x61\x79\x5f\x74\171\x70\145"] = $a["\x70\x61\171\x6d\x65\156\x74\x5f\x6d\145\x74\150\x6f\x64"]; goto rnDFh; CEsEu: $a = $bus->field("\151\x64\54\160\141\171\x6d\x65\x6e\164\137\155\145\164\x68\157\x64")->where("\x69\x64", $data["\x6d\143\150\137\151\144"])->find(); goto PJo83; rnDFh: $order = new ResOrder(); goto Yz3r6; q7ZUB: return $info; goto ZMCX8; NXp30: return $info; goto yf1xb; TEoLr: Zullp: goto q7ZUB; eEkq9: $bus = new Business(); goto CEsEu; W3uTJ: $order_list = $order->where($data)->where("\151\163\x5f\x64\145\154\x65\164\145\144", 0)->page($page, PAGE_NUM)->order("\x63\x72\145\141\164\145\137\164\x69\155\x65", "\x64\x65\163\x63")->select(); goto cW1z3; vp0w_: foreach ($order_list as $key => $value) { goto iW1C9; VCVA1: $value->create_time = __TIME($value->create_time); goto kWiYz; sgC1g: RV8xF: goto VCVA1; z4Act: $value->goods = $a; goto kZG_j; iW1C9: $Resdesk = new Resdesk(); goto bMLHO; yNtSR: $a = $good->where("\157\x72\144\145\162\x5f\151\x64", $value->order_id)->select(); goto I9HVr; GZ9tS: $value->finish_time = __TIME($value->finish_time); goto KdLb9; kZG_j: IhYWi: goto JqhKd; wGPzu: GMBZU: goto z4Act; KdLb9: $good = new ResOrderGoods(); goto yNtSR; kWiYz: $value->pay_time = __TIME($value->pay_time); goto GZ9tS; r2Sov: if (!$desk) { goto RV8xF; } goto NAvdZ; NAvdZ: $value->desk_name = $desk["\x6e\141\155\x65"]; goto sgC1g; bMLHO: $desk = $Resdesk->where("\x69\x64", $value->desk_id)->find(); goto r2Sov; I9HVr: foreach ($a as $k => $v) { goto w53Mx; lOQlf: if (!$pic) { goto ePhpX; } goto jVk8A; avkjB: ePhpX: goto A0ySQ; w53Mx: $imgas = new Images(); goto QwMOQ; doQMg: Gt4Rl: goto FcE9b; jVk8A: foreach ($pic->toArray() as $p_k => $p_v) { $pic[$p_k] = __IMG($p_v); JjBxi: } goto doQMg; FcE9b: $v["\160\151\x63"] = $pic; goto avkjB; QwMOQ: $pic = $imgas->where("\x69\x6d\147\137\x69\x64", $v->img)->field("\151\155\147\x5f\143\x6f\x76\x65\162\x5f\x62\151\x67\54\x69\x6d\147\x5f\143\x6f\166\x65\x72\137\155\151\x64\54\x69\x6d\x67\137\143\x6f\166\x65\162\x5f\x73\155\x61\x6c\x6c")->find(); goto lOQlf; A0ySQ: vVnAn: goto ZaHBt; ZaHBt: } goto wGPzu; JqhKd: } goto TEoLr; Yz3r6: $order_list = null; goto W3uTJ; cW1z3: $info["\x69\x6e\x66\x6f"] = $order_list; goto Or9pz; ZMCX8: } public function getOrder($data) { goto aBZ1C; dE_Md: $good = new ResOrderGoods(); goto a2x2k; a2x2k: $a = $good->where("\157\162\x64\145\x72\x5f\x69\144", $order_info["\x6f\162\144\145\162\137\151\x64"])->select(); goto cwexz; RWEXc: if (!empty($order_info)) { goto AnhxV; } goto P3oRV; q_3ZJ: $order_info = null; goto cIiIR; bgTN8: $order_info["\x67\x6f\157\144\x73"] = $a; goto dKuz2; aBZ1C: $order = new ResOrder(); goto q_3ZJ; dKuz2: return $order_info; goto ygtNM; rBAFr: AnhxV: goto cP4nO; TcYSm: $order_info["\162\145\146\x75\x6e\144\137\164\x69\155\x65"] = __TIME($order_info["\162\x65\146\165\156\x64\x5f\164\151\x6d\x65"]); goto bgH1C; cP4nO: $Resdesk = new Resdesk(); goto woZXf; woZXf: $desk = $Resdesk->where("\151\144", $order_info["\144\145\163\153\137\151\144"])->find(); goto sgSwi; Q2Rcz: uzZIc: goto bgTN8; ogZF2: $order_info["\x66\151\x6e\151\163\x68\137\x74\x69\155\145"] = __TIME($order_info["\x66\x69\156\151\163\x68\x5f\x74\151\x6d\x65"]); goto YiwQP; cwexz: foreach ($a as $k => $v) { goto krMIG; gswj1: U9gWe: goto zDsV5; siCQ8: if (!$pic) { goto dfObH; } goto y6BUB; krMIG: $imgas = new Images(); goto Nch0_; Jbfga: dfObH: goto iU0R9; Nch0_: $pic = $imgas->where("\151\155\x67\x5f\x69\144", $v->img)->field("\151\155\x67\x5f\x63\157\x76\x65\162\137\142\x69\x67\x2c\x69\x6d\x67\x5f\143\x6f\166\x65\x72\137\155\x69\144\54\x69\155\x67\x5f\x63\x6f\x76\x65\x72\137\x73\x6d\x61\154\x6c")->find(); goto siCQ8; iU0R9: IfvjY: goto UXdkc; zDsV5: $v["\160\x69\x63"] = $pic; goto Jbfga; y6BUB: foreach ($pic->toArray() as $p_k => $p_v) { $pic[$p_k] = __IMG($p_v); Dn0C2: } goto gswj1; UXdkc: } goto Q2Rcz; sgSwi: if (!$desk) { goto EhFkr; } goto CoyFB; CoyFB: $order_info["\144\x65\163\x6b\x5f\x6e\141\x6d\x65"] = $desk["\156\141\x6d\x65"]; goto EXkkE; DQsCG: $order_info["\160\x61\171\137\164\x69\155\x65"] = __TIME($order_info["\x70\141\x79\137\164\151\x6d\145"]); goto ogZF2; bgH1C: $order_info["\x72\145\x66\x75\x6e\x64\137\x6f\153\137\x74\151\155\x65"] = __TIME($order_info["\x72\145\x66\x75\x6e\x64\x5f\157\153\137\x74\x69\155\x65"]); goto dE_Md; P3oRV: return $order_info; goto rBAFr; EXkkE: EhFkr: goto DQsCG; YiwQP: $order_info["\143\162\145\141\164\145\x5f\x74\x69\155\x65"] = __TIME($order_info["\x63\162\145\x61\x74\x65\x5f\164\151\155\x65"]); goto TcYSm; cIiIR: $order_info = $order->where($data)->where("\151\x73\x5f\x64\145\x6c\145\x74\x65\144", 0)->find(); goto RWEXc; ygtNM: } public function signOrder($data) { goto ZzxIl; E8cYo: Z9szi: goto vb5KV; vb5KV: $new_data = array("\x6f\x72\x64\x65\x72\x5f\163\164\141\x74\165\x73" => 3, "\x66\x69\x6e\151\x73\150\137\164\151\155\x65" => time()); goto FGuL1; ZzxIl: $order = new ResOrder(); goto g37Uc; FGuL1: $res = $order->save($new_data, ["\157\x72\x64\145\x72\x5f\151\144" => $data["\x6f\x72\144\x65\162\x5f\x69\x64"]]); goto SzgNR; g37Uc: $info = $order->where($data)->find(); goto Laxjg; Laxjg: if (!empty($info)) { goto Z9szi; } goto GpUNt; GpUNt: return null; goto E8cYo; SzgNR: return $res; goto hoR7u; hoR7u: } public function cancelOrder($data) { goto A96Qa; VIvnR: m6eQJ: goto IhTt_; NHdw7: $info = $order->where($data)->find(); goto djw8U; djw8U: if (!empty($info)) { goto m6eQJ; } goto UEoWf; mDfBs: $res = $order->save($new_data, ["\x6f\x72\x64\145\162\x5f\151\x64" => $data["\x6f\162\x64\x65\162\137\151\x64"]]); goto IVeVz; IVeVz: return $res; goto CXgjZ; IhTt_: $new_data = array("\157\162\144\145\x72\137\x73\x74\x61\164\165\x73" => -1); goto mDfBs; UEoWf: return null; goto VIvnR; A96Qa: $order = new ResOrder(); goto NHdw7; CXgjZ: } public function delOrder($data) { goto kPI84; CIq9Z: $new_data = array("\151\x73\137\x64\x65\x6c\145\x74\145\x64" => 1); goto iJ2i2; kPI84: $order = new ResOrder(); goto sm2Pu; PZEsx: return $res; goto yk52l; LvET2: if (!empty($info)) { goto EVVmM; } goto YTlgO; CcmfC: EVVmM: goto CIq9Z; YTlgO: return null; goto CcmfC; sm2Pu: $info = $order->where($data)->find(); goto LvET2; iJ2i2: $res = $order->save($new_data, ["\x6f\162\144\x65\x72\x5f\x69\144" => $data["\157\x72\144\x65\x72\137\151\144"]]); goto PZEsx; yk52l: } public function refundOrder($data) { goto S2wlh; MK0D3: if (!empty($info)) { goto BukkU; } goto Ge9Xu; Hz4L4: return $res; goto yvYJ8; wHX9Z: $res = $order->save($new_data, ["\x6f\162\x64\145\x72\137\151\144" => $data["\157\x72\x64\145\x72\137\151\144"]]); goto Hz4L4; DhbUD: $info = $order->where($data)->find(); goto MK0D3; S2wlh: $order = new ResOrder(); goto DhbUD; Ge9Xu: return null; goto x0Haj; zV0xQ: $new_data = array("\157\162\144\145\162\137\163\x74\x61\164\165\x73" => 4, "\162\x65\x66\165\156\144\137\x74\x69\x6d\x65" => time()); goto wHX9Z; x0Haj: BukkU: goto zV0xQ; yvYJ8: } public function Book($data) { goto sPszk; sPszk: $book = new ResBooked(); goto KtuHh; KtuHh: $info = $book->save($data); goto h4VcH; h4VcH: return $info; goto w45IP; w45IP: } public function Booklist($data, $page) { goto eMC77; eMC77: $book = new ResBooked(); goto KlUpi; H39Fz: return $rs; goto VguXz; Sb8SQ: $rs = $info; goto H39Fz; KlUpi: $info = $book->where($data)->where("\163\164\141\164\x75\163", ["\151\x6e", [1, 2]])->page($page, PAGE_NUM)->order("\143\162\145\x61\164\x65\137\x74\151\155\145", "\x64\x65\x73\x63")->select(); goto wV6ui; R3I3g: PsvP7: goto oT2b_; wV6ui: if (!empty($info)) { goto PsvP7; } goto YMbHa; YMbHa: return $info; goto R3I3g; Ati_r: XTtcw: goto Sb8SQ; oT2b_: foreach ($info as $key => $value) { $value->create_time = __TIME($value->create_time); JrJh6: } goto Ati_r; VguXz: } public function cancelBook($data) { goto M4PvL; V3b9R: return $info; goto PBTP3; S1exB: $info = $book->save($data, ["\x69\x64" => $data["\151\x64"]]); goto V3b9R; M4PvL: $book = new ResBooked(); goto S1exB; PBTP3: } public function ShopService($data) { goto LVt9X; ZGsyU: return array(); goto Hu02D; Yo3Fu: $info = $book->where($data)->find(); goto SBAU7; LVt9X: $book = new ResService(); goto Yo3Fu; SBAU7: if (!(isset($info["\x61\162\162\x61\171\x5f\x76\141\x6c\x75\x65\163"]) && $info["\x61\x72\x72\x61\x79\137\x76\x61\x6c\165\145\163"] != null)) { goto MtaU_; } goto n6xSp; uuBhJ: MtaU_: goto ZGsyU; n6xSp: return $info["\141\162\x72\x61\171\137\x76\141\154\x75\145\163"]; goto uuBhJ; Hu02D: } public function WriteComment($data) { goto Hf4FK; ycwVu: $info = $comment->save($data); goto MOqse; Hf4FK: $comment = new ResComment(); goto ycwVu; MOqse: return $info; goto i9bS_; i9bS_: } public function CommentList($data, $page) { goto RxoJG; E38zw: qz985: goto Ie90c; h4mdK: $rs["\x69\156\146\157"] = array(); goto BU83Y; eceoQ: $rs["\143\157\x75\x6e\164"] = $book->where($data)->count(); goto IH5y5; IH5y5: $num = $book->where($data)->avg("\x66\x72\x61\143\x74\151\x6f\x6e") * 2; goto CnFya; BU83Y: goto kWzVp; goto U44dA; hbmA9: if (!empty($info)) { goto ELpIg; } goto h4mdK; vbrGc: $info = $book->where($data)->page($page, PAGE_NUM)->order("\143\x72\145\x61\164\x65\x5f\164\151\155\x65", "\x64\x65\163\x63")->select(); goto hbmA9; CnFya: $rs["\163\x72\157\143\145"] = round($num, 2); goto MiqeR; Jrx46: kWzVp: goto eceoQ; RxoJG: $book = new ResComment(); goto vbrGc; MiqeR: return json_encode($rs); goto fjeEO; vQkQV: foreach ($info as $key => $value) { goto c2IVZ; XyDjD: $pic[$i] = "\x68\164\164\x70\163\72\x2f\57" . $_SERVER["\110\x54\124\x50\137\x48\x4f\x53\x54"] . "\x2f\x61\x70\151\57" . $pic[$i]; goto czrXA; Pjbq_: $username = $this->getUserInfo($value->user_id); goto gzFQ5; gx_nC: $i++; goto vMng2; vk1rP: if (!($i < count($pic))) { goto vjNB3; } goto XyDjD; vMng2: goto nNlmI; goto RfdeD; nPAhw: $i = 0; goto Io1z9; MJMag: $value->pic = $pic; goto EpBpf; c2IVZ: if (!($value->array_pic != '')) { goto SHAIe; } goto oPWEQ; gzFQ5: $value->username = $username["\156\x69\x63\153\x5f\156\x61\155\x65"]; goto nFolt; czrXA: vyhgd: goto gx_nC; pg5dJ: TrLaU: goto tLdvT; Io1z9: nNlmI: goto vk1rP; RfdeD: vjNB3: goto MJMag; R7TSn: $value->create_time = date("\x59\55\155\x2d\144", $value->create_time); goto Pjbq_; EpBpf: SHAIe: goto R7TSn; nFolt: $value->user_headimg = $username["\x75\163\145\162\137\150\x65\x61\144\x69\x6d\x67"]; goto pg5dJ; oPWEQ: $pic = explode("\x2c", rtrim($value->array_pic, "\x2c")); goto nPAhw; tLdvT: } goto E38zw; Ie90c: $rs["\151\156\146\x6f"] = $info; goto Jrx46; U44dA: ELpIg: goto vQkQV; fjeEO: } public function getUserInfo($uid) { goto EpaMs; EpaMs: $User = new User(); goto cF16Q; cF16Q: $info = $User->where("\165\151\144", $uid)->find(); goto hI9Ck; hI9Ck: return $info; goto jpGlD; jpGlD: } public function addOrder($data, $json) { goto b5Yv7; s2IML: if (!empty($info)) { goto zr3iY; } goto EB0DB; gUiNs: try { goto erOA1; GuFc5: HdXcu: goto cW_wd; vm8ph: if (!empty($dish)) { goto HdXcu; } goto Ar2gV; M54l9: if (!empty($c)) { goto AyA6T; } goto sHFOW; Okd6d: $c = $this->UserOrder->where("\x6f\162\144\145\162\x5f\x69\144", $data["\x6f\162\144\145\162\137\151\144"])->setInc("\160\x61\171\x5f\155\157\156\x65\171", $data["\141\144\144\137\160\162\151\x63\145"]); goto M54l9; u1BlN: $dish = json_decode($json, true); goto vm8ph; JnhSE: throw new Exception("\350\xae\xa2\xe5\215\225\345\210\233\345\xbb\xba\xe5\xa4\261\350\xb4\245\x30\x30\61"); goto aTbUS; Ar2gV: throw new Exception("\350\x8f\x9c\xe5\x8d\x95\xe4\xb8\215\xe8\x83\xbd\344\xb8\272\xe7\251\272"); goto GuFc5; QpYBU: if (!empty($a)) { goto eBi2G; } goto JnhSE; E5cBG: ua2mi: goto D9QU_; D9QU_: $this->UserOrder->commit(); goto kvUz2; BG78X: $order_good = new Goods(); goto Zh_Hl; Zh_Hl: foreach ($dish as $k => $v) { goto cx3rz; KOwH1: $new_data = ["\x6f\162\x64\x65\162\137\x69\x64" => $data["\157\162\x64\145\162\137\x69\144"], "\147\157\157\144\163\x5f\x6e\x61\155\145" => $info["\x67\157\157\144\163\137\156\141\x6d\x65"], "\x70\162\151\x63\145" => $info["\160\x72\x69\x63\145"], "\x6d\x63\x68\x5f\151\144" => $info["\155\143\x68\137\151\144"], "\165\163\x65\162\x5f\x69\x64" => $data["\165\x73\145\162\137\151\x64"], "\x69\155\147" => $info["\x69\x6d\x61\x67\x65\163"], "\x67\157\x6f\144\163\137\x69\144" => $k, "\156\165\x6d\142\145\162" => $v, "\x74\171\160\145" => 1, "\143\x72\x65\141\x74\x65\x5f\164\x69\x6d\x65" => $time]; goto PAOS9; PAOS9: $d = $this->OrderGoods->insert($new_data); goto pf9wj; pf9wj: if (!empty($d)) { goto D7e8G; } goto Qt4T_; LD0t9: if (!$info) { goto s9hvI; } goto KOwH1; V9fZ2: s9hvI: goto Ip5n8; oubYf: D7e8G: goto V9fZ2; cx3rz: $info = $order_good->where("\147\157\x6f\x64\x73\x5f\x69\144", $k)->find(); goto LD0t9; Qt4T_: throw new Exception("\350\x8f\x9c\345\215\x95\xe5\206\231\345\205\245\xe5\xa4\261\xe8\264\xa5"); goto oubYf; Ip5n8: mE8x4: goto Nh6g4; Nh6g4: } goto E5cBG; jW_d9: l_NUn: goto Okd6d; Q7Tdh: AyA6T: goto u1BlN; aTbUS: eBi2G: goto tRCIo; CJyzv: if (!empty($b)) { goto l_NUn; } goto g2xnC; g2xnC: throw new Exception("\350\xae\242\xe5\215\x95\xe5\x88\x9b\xe5\xbb\xba\345\xa4\261\xe8\xb4\xa5\x30\x30\x32"); goto jW_d9; sHFOW: throw new Exception("\xe8\xae\xa2\345\215\225\345\x88\233\xe5\xbb\272\xe5\xa4\xb1\xe8\264\245\x30\60\x33"); goto Q7Tdh; erOA1: $a = $this->UserOrder->where("\x6f\162\144\x65\x72\x5f\x69\x64", $data["\x6f\162\144\x65\x72\137\x69\x64"])->setInc("\x74\x6f\164\141\154", $data["\164\157\164\x61\x6c"]); goto QpYBU; cW_wd: $time = time(); goto BG78X; tRCIo: $b = $this->UserOrder->where("\157\x72\x64\145\x72\x5f\x69\x64", $data["\157\162\144\145\x72\x5f\x69\144"])->setInc("\141\144\x64\x5f\x70\x72\x69\x63\145", $data["\x61\x64\144\137\x70\x72\151\143\145"]); goto CJyzv; kvUz2: } catch (Exception $e) { $this->UserOrder->rollback(); return ["\x65\162\x72\137\x63\x6f\x64\x65" => 1, "\x6d\x73\x67" => $e->getMessage()]; } goto KEqAk; b5Yv7: $where["\157\x72\x64\x65\x72\137\163\x74\141\164\165\x73"] = 1; goto kIUV4; EB0DB: return ["\x65\x72\162\x5f\143\x6f\x64\145" => 1, "\x6d\x73\147" => "\350\xaf\xa5\350\xae\xa2\xe5\x8d\x95\xe4\270\215\xe5\xad\x98\xe5\234\xa8"]; goto ND4zV; KEqAk: return "\345\x8a\240\xe8\217\234\346\210\220\345\x8a\x9f"; goto PjgFe; ND4zV: zr3iY: goto ntN89; ntN89: $this->UserOrder->startTrans(); goto gUiNs; kIUV4: $where["\x6f\x72\144\145\162\x5f\151\x64"] = $data["\x6f\162\x64\145\x72\137\x69\144"]; goto ktd4i; fXm7R: $info = $this->UserOrder->where($where)->find(); goto s2IML; ktd4i: $where["\x75\163\145\x72\137\x69\144"] = $data["\x75\x73\145\x72\137\x69\144"]; goto fXm7R; PjgFe: } public function tuiOrder($data, $json) { goto jpq9q; y0n5t: $info = $this->UserOrder->where($where)->find(); goto GSR4Y; AHspG: $where["\165\x73\145\x72\137\x69\144"] = $data["\165\163\145\162\x5f\x69\144"]; goto y0n5t; S36SF: J5Fkn: goto PGWBD; NUmg8: $where["\x6f\x72\144\x65\x72\x5f\151\x64"] = $data["\x6f\x72\144\x65\x72\x5f\151\x64"]; goto AHspG; X2Ypg: return "\351\200\200\xe8\x8f\234\346\210\x90\xe5\212\x9f"; goto ywENr; t9tIj: try { goto ZYF01; e4bAw: throw new Exception("\xe8\256\242\345\215\225\xe5\x88\233\xe5\273\272\xe5\244\xb1\350\264\xa5\x30\60\61"); goto f7bfF; f7bfF: Ve2Nc: goto evjQA; HVej3: throw new Exception("\350\256\xa2\345\215\x95\xe5\x88\x9b\345\273\xba\xe5\244\261\xe8\264\245\60\60\x32"); goto HRZKL; wv9b8: $order_good = new Goods(); goto tV2DU; ZYF01: $a = $this->UserOrder->where("\157\x72\x64\145\162\x5f\x69\144", $data["\x6f\162\144\145\162\x5f\x69\144"])->setDec("\164\x6f\164\141\x6c", $data["\x74\x6f\164\141\154"]); goto E_29A; E8Swi: if (!empty($b)) { goto PLK2w; } goto HVej3; q5dRk: N7Ot6: goto K8N0t; tV2DU: foreach ($dish as $k => $v) { goto MQbYl; nsnwP: throw new Exception("\350\217\x9c\xe5\x8d\x95\345\206\231\345\205\245\xe5\244\261\xe8\xb4\245"); goto n7V0y; rmX5D: $d = $this->OrderGoods->insert($new_data); goto H8c14; dxpQv: fDc1e: goto ns_7J; WELvn: if (!$info) { goto fDc1e; } goto YsS9l; YsS9l: $new_data = ["\157\162\144\x65\162\x5f\151\144" => $data["\x6f\x72\144\x65\x72\137\x69\144"], "\x67\157\157\144\x73\x5f\156\141\155\x65" => $info["\x67\x6f\x6f\x64\163\137\156\x61\155\x65"], "\160\x72\x69\143\x65" => $info["\160\x72\x69\x63\x65"], "\155\143\x68\137\x69\144" => $info["\x6d\143\x68\137\151\x64"], "\x75\163\x65\162\x5f\151\x64" => $data["\165\x73\x65\162\137\151\x64"], "\x69\x6d\x67" => $info["\151\x6d\141\147\145\x73"], "\x67\x6f\157\x64\163\x5f\x69\144" => $k, "\x6e\165\155\x62\x65\x72" => $v, "\x74\x79\160\x65" => 2, "\143\162\x65\141\164\x65\137\164\x69\155\x65" => $time]; goto rmX5D; ns_7J: sA1wB: goto XYw0h; n7V0y: Ld1xd: goto dxpQv; H8c14: if (!empty($d)) { goto Ld1xd; } goto nsnwP; MQbYl: $info = $order_good->where("\x67\x6f\x6f\144\163\x5f\151\144", $k)->find(); goto WELvn; XYw0h: } goto zSpX0; ss5Uo: D5CiE: goto VJsTW; kBcGO: $c = $this->UserOrder->where("\x6f\162\144\145\162\x5f\151\x64", $data["\x6f\x72\144\x65\162\x5f\151\x64"])->setDec("\160\x61\x79\x5f\x6d\x6f\x6e\145\171", $data["\x72\145\144\x75\143\145\x5f\x70\162\x69\143\x65"]); goto DpetN; rcDgM: throw new Exception("\350\217\234\xe5\215\225\344\270\215\350\x83\275\xe4\xb8\xba\347\xa9\xba"); goto ss5Uo; VJsTW: $time = time(); goto wv9b8; DpetN: if (!empty($c)) { goto Ve2Nc; } goto e4bAw; y3ppB: $this->UserOrder->commit(); goto Jxxgu; HRZKL: PLK2w: goto kBcGO; PmHqK: if (!empty($dish)) { goto D5CiE; } goto rcDgM; evjQA: $dish = json_decode($json, true); goto PmHqK; zSpX0: aW9GR: goto y3ppB; E_29A: if (!empty($a)) { goto N7Ot6; } goto sDIpn; K8N0t: $b = $this->UserOrder->where("\157\x72\x64\145\x72\137\x69\144", $data["\157\x72\x64\x65\x72\x5f\x69\144"])->setInc("\162\145\144\165\x63\x65\137\x70\x72\x69\x63\x65", $data["\x72\145\x64\165\x63\145\137\160\162\x69\x63\x65"]); goto E8Swi; sDIpn: throw new Exception("\350\xae\xa2\xe5\x8d\x95\xe5\210\x9b\xe5\xbb\xba\xe5\xa4\261\350\264\xa5\x30\x30\x31"); goto q5dRk; Jxxgu: } catch (Exception $e) { $this->UserOrder->rollback(); return ["\145\162\x72\137\x63\x6f\144\145" => 1, "\155\x73\147" => $e->getMessage()]; } goto X2Ypg; dabwl: return ["\145\162\162\137\143\x6f\144\145" => 1, "\155\163\x67" => "\xe8\xaf\245\350\xae\xa2\345\215\225\344\270\x8d\345\xad\x98\xe5\x9c\xa8"]; goto S36SF; GSR4Y: if (!empty($info)) { goto J5Fkn; } goto dabwl; PGWBD: $this->UserOrder->startTrans(); goto t9tIj; jpq9q: $where["\x6f\162\x64\145\x72\x5f\x73\164\x61\164\165\163"] = 1; goto NUmg8; ywENr: } public function tuigoodslist($data) { goto uqwy6; jXedn: return $list; goto YFBy0; o_Ka1: foreach ($list as $k => $v) { goto TtyGV; MIxSx: $v->total = $v->all_num - $a["\141\154\x6c\137\156\x75\x6d"]; goto o92Ru; WaC3q: fm9F0: goto MIxSx; o92Ru: CFpa0: goto qnrWZ; AXthV: $v["\x70\151\143"] = $pic["\151\x6d\147\x5f\x63\157\x76\145\x72\137\155\151\144"]; goto W3t33; Cyli0: cETqz: goto SnQRy; oiSGU: $pic = $imgas->where("\151\155\x67\137\151\x64", $v->img)->field("\151\155\147\137\x63\157\166\145\x72\137\142\x69\x67\54\151\155\x67\x5f\x63\157\166\x65\162\x5f\155\151\144\54\x69\155\x67\x5f\x63\x6f\x76\x65\162\137\x73\155\x61\x6c\154")->find(); goto vvS40; O3FbU: $v->total = $v->all_num; goto W0gEh; qJN7H: $a = $this->OrderGoods->where($data)->where($where)->field("\x67\157\157\144\x73\x5f\x69\x64\54\163\165\155\50\x6e\x75\155\x62\145\162\x29\x20\x61\x73\x20\141\x6c\x6c\x5f\x6e\x75\x6d")->group("\147\157\157\x64\163\137\151\144")->find(); goto B4MwZ; W0gEh: goto CFpa0; goto WaC3q; TtyGV: $where = ["\x74\x79\x70\x65" => 2, "\147\157\157\x64\163\137\x69\x64" => $v->goods_id]; goto PQnoZ; qYqrd: NM4UC: goto AXthV; VWOU2: foreach ($pic->toArray() as $p_k => $p_v) { $pic[$p_k] = __IMG($p_v); YY9Rk: } goto qYqrd; B4MwZ: if ($a) { goto fm9F0; } goto O3FbU; PQnoZ: $imgas = new Images(); goto oiSGU; qnrWZ: $v->wri_total = $v->total; goto Cyli0; vvS40: if (!$pic) { goto iwodc; } goto VWOU2; W3t33: iwodc: goto qJN7H; SnQRy: } goto WDj2W; WDj2W: v_N0c: goto jXedn; uqwy6: $list = $this->OrderGoods->where($data)->where("\164\x79\160\x65", "\x69\156", "\60\54\61")->field("\147\157\x6f\x64\163\x5f\x69\x64\x2c\147\x6f\x6f\144\163\137\156\141\155\x65\x2c\151\x6d\147\54\x70\162\x69\143\x65\x2c\x73\x75\x6d\x28\156\165\x6d\x62\x65\162\51\x20\x61\x73\40\141\x6c\x6c\x5f\156\x75\x6d")->group("\147\157\157\144\x73\x5f\x69\x64")->select(); goto o_Ka1; YFBy0: } }
