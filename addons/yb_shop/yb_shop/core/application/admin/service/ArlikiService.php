<?php
 namespace app\admin\service; use Aliyun\DySDKLite\SignatureHelper; use think\Cache; use think\Db; require EXTEND_PATH . "\101\154\151\171\165\156\57\x53\x69\x67\156\x61\x74\165\x72\145\110\x65\154\x70\x65\162\56\160\150\160"; class ArlikiService extends Base { private $ali_id = ''; private $ali_token = ''; private $ali_name = ''; private $ali_code = ''; private $phone = ''; private $status = "\62"; private $bus_id2 = ''; function __construct($mch_id) { goto fmqog; KOZqa: $this->ali_id = $re["\x61\x6c\x69\137\x69\144"]; goto V5iXI; h9MRU: $this->ali_name = $re["\141\154\151\x5f\156\x61\x6d\145"]; goto NYy88; dXyNG: $this->phone = $re["\160\150\157\x6e\145"]; goto efFex; DoE5X: $re = Db::name("\x79\142\x73\143\x5f\x73\x6d\163\143\x6f\x6e\146")->where("\x6d\143\150\137\x69\x64", $this->bus_id2)->find(); goto KOZqa; fmqog: parent::__construct(); goto WeT10; WeT10: $this->bus_id2 = $mch_id; goto DoE5X; NYy88: $this->ali_code = $re["\x61\154\151\137\143\x6f\x64\x65"]; goto dXyNG; efFex: $this->status = $re["\163\x74\x61\164\165\x73"]; goto s_1Ep; V5iXI: $this->ali_token = $re["\141\x6c\151\x5f\x74\x6f\153\x65\156"]; goto h9MRU; s_1Ep: } public function exp_load($no, $from = '') { goto MpHBG; Vl0yK: $i++; goto CyLY_; z6eUh: return $res; goto X9l1y; SxPCu: $res["\144\x61\x74\x61"] = "\xe5\x8d\225\xe5\x8f\xb7\xe5\xbc\x82\xe5\xb8\270\54\350\257\xb7\xe7\250\x8d\345\220\216\xe5\206\x8d\xe8\xaf\x95\56"; goto dq4_T; suxqU: if (!($res["\143\157\x64\145"] == 1)) { goto NMrJ2; } goto R_Dod; WbVsF: goto rnYOe; goto AD3RP; VWJ1H: goto C9Ppx; goto eaKL2; HGmZ6: if (!($i < count($from))) { goto C9Ppx; } goto yFsN_; MpHBG: if (Cache::get("\x65\x78\160\x5f\x69\156\x66\157" . $no)) { goto q4Fcd; } goto dX9A8; DHP_n: RJ9n8: goto Vl0yK; dq4_T: $res["\143\x6f\x64\145"] = $from; goto YFA87; NOlUZ: OT7qg: goto p00F2; p00F2: $from = $this->exp_from($no); goto qMq2v; vy2Jb: C9Ppx: goto qDgdV; EPVwF: $res = $this->exp_query($no, $from); goto UZt9I; qMq2v: $i = 0; goto FN1a1; rIci7: rnYOe: goto z6eUh; qDgdV: if (!(count($from) == 0)) { goto WgrAe; } goto SxPCu; YFA87: WgrAe: goto B3Tbm; FN1a1: QLaBy: goto HGmZ6; R_PhJ: $res = Cache::get("\145\170\160\137\151\156\146\x6f" . $no); goto rIci7; R_Dod: Cache::set("\145\170\x70\x5f\x69\156\x66\157" . $no, $res, 3600); goto VWJ1H; UZt9I: goto hrfIu; goto NOlUZ; yFsN_: $res = $this->exp_query($no, $from[$i]); goto suxqU; dX9A8: if (empty($from)) { goto OT7qg; } goto EPVwF; B3Tbm: hrfIu: goto WbVsF; CyLY_: goto QLaBy; goto vy2Jb; eaKL2: NMrJ2: goto DHP_n; AD3RP: q4Fcd: goto R_PhJ; X9l1y: } public function exp_from($no) { goto mjGMy; mjGMy: $url = "\150\164\x74\160\x3a\57\x2f\x6d\56\153\x75\141\x69\x64\x69\x31\x30\60\56\x63\157\x6d\x2f\x61\165\164\157\x6e\x75\x6d\x62\x65\x72\57\x61\x75\164\x6f\77\156\x75\x6d\75" . $no; goto iOx3V; Pamws: mzsQT: goto LQKAv; LQKAv: $i++; goto Xjy7v; nIlUi: LLhH9: goto CfAGL; iOx3V: $res = json_decode(get_url_content($url), true); goto hyGHZ; nHnsd: $re[$i] = $res[$i]["\x63\157\x6d\103\x6f\144\145"]; goto Pamws; CfAGL: if (!($i < count($res))) { goto XuTX0; } goto nHnsd; ZPjFS: XuTX0: goto ggLUm; q3II1: $i = 0; goto nIlUi; hyGHZ: $re = array(); goto q3II1; ggLUm: return $re; goto X1JSG; Xjy7v: goto LLhH9; goto ZPjFS; X1JSG: } private function exp_query($no, $from) { goto Hee1n; cOTGh: yj3cB: goto g_2s6; Hee1n: $state = array(0 => "\xe5\234\250\351\200\x94\xe4\270\255", 1 => "\xe5\xb7\262\346\217\275\xe6\224\266", 2 => "\xe7\226\x91\xe9\232\276", 3 => "\345\xb7\xb2\xe7\255\xbe\346\x94\266", 4 => "\xe9\200\x80\xe7\255\xbe", 5 => "\345\220\214\xe5\237\x8e\xe6\xb4\xbe\351\200\x81\344\xb8\255", 6 => "\351\x80\x80\345\x9b\236", 7 => "\xe8\xbd\xac\xe5\x8d\225"); goto xXmR6; Kwe_J: $msg["\x73\x74\x61\164\x65"] = $res["\163\164\141\x74\x65"]; goto A6BZ3; uNxZZ: VDH5P: goto Mvvfy; FQcop: $msg["\x64\x61\x74\141"] = "\350\216\xb7\xe5\x8f\226\345\xa4\261\350\264\xa5\x2c\xe8\xaf\267\347\250\x8d\xe5\220\216\345\206\215\350\xaf\225\56"; goto aTDaW; aTDaW: $msg["\143\157\x64\x65"] = 0; goto bnvZ8; hGRmP: if ($res["\155\x65\x73\163\x61\x67\x65"] == "\157\153") { goto yj3cB; } goto FQcop; g_2s6: $msg["\144\141\x74\x61"] = $res["\x64\x61\164\x61"]; goto Vzyoi; A6BZ3: $msg["\163\x74\141\x74\x65"] = $state[$res["\x73\164\141\x74\x65"]]; goto hGRmP; xXmR6: $url = "\x68\x74\x74\x70\72\x2f\57\155\x2e\x6b\165\141\151\144\151\61\60\60\56\x63\x6f\155\x2f\161\165\145\x72\x79\x3f\x74\171\x70\145\x3d" . $from . "\46\160\x6f\x73\x74\151\x64\x3d" . $no . "\x26\x69\144\x3d\61\x26\x76\x61\154\x69\143\x6f\144\x65\75\46\x74\145\x6d\160\x3d\60\56\x37\62\62\x39\71\x30\66\63\x31\71\x37\65" . rand(100, 999); goto c0Ygg; c0Ygg: $res = json_decode(get_url_content($url), true); goto Kwe_J; Vzyoi: $msg["\x63\157\x64\x65"] = 1; goto uNxZZ; Mvvfy: return $msg; goto saIJD; bnvZ8: goto VDH5P; goto cOTGh; saIJD: } public function send_sms($data, $phone = '', $return = false) { goto rAKU2; iOwPb: $phone = explode("\54", $this->phone); goto BMGqb; vlkuE: return $d; goto Oimgv; hl9Pb: goto pN_tr; goto nL_qA; kuwru: $params["\x53\151\x67\x6e\116\x61\x6d\145"] = $this->ali_name; goto fuusA; jsp5p: lJ3y6: goto rtrlg; mfCAs: goto EbywS; goto DnYHC; ahECY: $d["\103\x6f\144\x65"] = "\x30"; goto t0Mn2; AYtz6: lCumb: goto lkjb5; fuusA: $params["\x54\145\x6d\160\154\141\164\x65\x43\x6f\x64\145"] = $this->ali_code; goto ARSF8; AcEjU: rtoAw: goto nqmSX; D55dI: $d["\x43\157\144\x65"] = "\60"; goto l1HVu; l1HVu: $d["\115\145\x73\x73\x61\x67\x65"] = "\346\x9c\252\345\xbc\x80\xe5\220\xaf\347\237\xad\344\277\241\351\200\232\xe7\x9f\245"; goto vlkuE; BqBNw: return $res; goto W8K__; rAKU2: if (!(empty($this->ali_id) || empty($this->ali_token))) { goto MIW77; } goto ahECY; xCHpo: MIW77: goto Oo0hq; Uv3VJ: pN_tr: goto KreXw; hyniU: $res[$i] = $this->aliyun_send($params); goto xb2wy; nqmSX: Q2PsO: goto sWx69; nL_qA: pAUaZ: goto ewzgY; qoqda: $params["\120\x68\157\156\145\116\165\155\142\x65\x72\x73"] = $phone[$i]; goto kuwru; howxE: if (!(!empty($params["\x54\x65\x6d\x70\154\141\x74\x65\120\x61\162\141\155"]) && is_array($params["\124\x65\155\x70\154\x61\164\145\x50\141\162\x61\x6d"]))) { goto ZnZ4M; } goto Ygx2S; ARSF8: $params["\x54\145\x6d\160\x6c\x61\x74\x65\120\x61\162\141\x6d"] = $pa; goto howxE; lWf7E: goto lJ3y6; goto AYtz6; xb2wy: Db::name("\x79\142\163\143\x5f\x73\x6d\163\x63\x6f\156\x66")->where("\155\x63\x68\x5f\x69\144", $this->bus_id2)->setInc("\x6f\153\x5f\x75\x73\x65"); goto AcEjU; Oimgv: uI9Oo: goto Vm9Bz; W8K__: LK8hr: goto x0kXP; t0Mn2: $d["\115\145\163\163\141\x67\145"] = "\xe5\217\202\346\225\xb0\344\xb8\215\xe5\256\214\346\225\264"; goto L_P9d; qy4aJ: $params = array(); goto qoqda; ewzgY: if (!$return) { goto LK8hr; } goto BqBNw; HxtsM: if (!is_array($data)) { goto lCumb; } goto fcL8V; BAN7Q: if (!(strlen($phone[$i]) > 5)) { goto rtoAw; } goto qy4aJ; C236O: $phone = array($phone); goto mfCAs; iJZp_: ZnZ4M: goto hyniU; sWx69: $i++; goto hl9Pb; fcL8V: $pa = $data; goto lWf7E; KreXw: if (!($i < count($phone))) { goto pAUaZ; } goto BAN7Q; lkjb5: $pa["\157\162\144\145\x72"] = $data; goto jsp5p; Ygx2S: $params["\124\145\155\160\154\x61\164\x65\120\141\162\141\155"] = json_encode($params["\x54\x65\155\x70\x6c\x61\164\145\120\141\x72\x61\155"], JSON_UNESCAPED_UNICODE); goto iJZp_; Oo0hq: if (!($this->status == 2)) { goto uI9Oo; } goto D55dI; DnYHC: rC3Tn: goto iOwPb; rtrlg: $i = 0; goto Uv3VJ; BMGqb: EbywS: goto HxtsM; Vm9Bz: if (empty($phone)) { goto rC3Tn; } goto C236O; L_P9d: return $d; goto xCHpo; x0kXP: } public function send_test($ali_id, $ali_token, $ali_name, $ali_code, $phone) { goto ennd5; ou9KP: $params["\124\x65\x6d\160\154\141\x74\x65\103\157\x64\145"] = $ali_code; goto zr59_; ennd5: $params = array(); goto iER7u; ZuY8C: aWShx: goto vOs7g; v001N: $params["\124\145\155\160\154\141\164\145\120\x61\162\x61\155"] = json_encode($params["\x54\145\155\x70\x6c\x61\x74\x65\x50\141\x72\141\x6d"], JSON_UNESCAPED_UNICODE); goto ZuY8C; iER7u: $params["\120\x68\157\x6e\x65\116\x75\x6d\x62\x65\162\x73"] = $phone; goto oberI; zr59_: $params["\x54\x65\155\x70\x6c\x61\164\145\x50\141\x72\141\155"] = array("\157\x72\144\x65\162" => "\101\102\x43\x44\105\x46"); goto xM0Gn; oberI: $params["\x53\151\147\x6e\116\x61\155\x65"] = $ali_name; goto ou9KP; vOs7g: $res = $this->aliyun_send($params, $ali_id, $ali_token); goto nMnUi; nMnUi: return $res; goto FOFjB; xM0Gn: if (!(!empty($params["\124\x65\x6d\x70\x6c\x61\x74\x65\120\x61\162\141\155"]) && is_array($params["\124\145\155\x70\x6c\141\x74\145\120\141\x72\x61\155"]))) { goto aWShx; } goto v001N; FOFjB: } private function aliyun_send($params, $ali_id = '', $ali_token = '') { goto gMsrC; McKS5: $accessKeyId = $ali_id; goto vzMss; DgVkZ: $security = false; goto GN81e; HuC6i: $content = $helper->request($accessKeyId, $accessKeySecret, "\144\x79\x73\155\x73\141\160\151\x2e\141\154\x69\x79\165\x6e\143\163\x2e\143\157\155", array_merge($params, array("\x52\x65\147\151\157\156\x49\x64" => "\x63\156\x2d\150\x61\x6e\147\x7a\150\x6f\x75", "\x41\143\x74\x69\157\156" => "\x53\145\x6e\x64\123\x6d\163", "\x56\145\x72\163\151\157\156" => "\x32\60\61\67\x2d\60\65\x2d\x32\x35")), $security); goto dQSCf; gMsrC: $accessKeyId = $this->ali_id; goto pstMG; ZMX0a: if (!(!empty($ali_id) && !empty($ali_token))) { goto kPCzk; } goto McKS5; pstMG: $accessKeySecret = $this->ali_token; goto ZMX0a; GN81e: $helper = new SignatureHelper(); goto HuC6i; ZnIwR: kPCzk: goto DgVkZ; dQSCf: return $content; goto DKXYS; vzMss: $accessKeySecret = $ali_token; goto ZnIwR; DKXYS: } }
