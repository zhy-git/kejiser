<?php
 namespace app\admin\service; use app\common\model\Images; class GoodsCate extends Base { private $goods_cate; protected $taobao_cate = false; function __construct() { parent::__construct(); $this->goods_cate = new \app\common\model\GoodsCate(); } public function getGoodsGroupList($condition = '') { goto a7AxH; kCMQ_: ytMVu: goto NMwpa; a7AxH: $list = $this->goods_cate->getQuerys($condition, "\x2a", ''); goto UNbcp; NMwpa: return $list; goto NB6lQ; UNbcp: foreach ($list as $k => $v) { goto R22x4; m10Mm: OlFQt: goto e87uW; mIv91: $pic_info = array(); goto W9zQw; rKRt2: $list[$k]["\x70\x69\x63\x74\x75\x72\145"] = $pic_info; goto m10Mm; kNSyN: if (empty($v["\x67\162\157\165\x70\137\x70\x69\143"])) { goto vioON; } goto sva23; oxMpd: vioON: goto rKRt2; sva23: $pic_info = $img->get($v["\147\x72\x6f\x75\x70\137\x70\x69\x63"]); goto oxMpd; W9zQw: $pic_info["\x70\x69\143\137\x63\157\166\x65\x72"] = ''; goto kNSyN; R22x4: $img = new Images(); goto mIv91; e87uW: } goto kCMQ_; NB6lQ: } public function getFormatGoodsCategoryList($mch_id) { $one_list = $this->getCategoryTreeUseInShopIndex($mch_id); return $one_list; } public function getCategoryTreeUseInShopIndex($mch_id) { goto FrnBd; ZsjeL: CJVkZ: goto eHubp; s5W82: uJtmd: goto MuYMN; WUmOJ: $goods_category_one = $goods_category_model->getQuerys(["\154\145\166\x65\154" => 1, "\155\143\150\x5f\151\x64" => $mch_id], "\143\141\164\145\x5f\151\144\x2c\143\141\x74\x65\x5f\x6e\141\155\145\x2c\151\163\x5f\x76\x69\x73\x69\142\x6c\x65\x2c\163\150\x6f\162\164\137\x6e\x61\x6d\145\x2c\x70\151\144\x2c\143\x61\x74\145\x5f\x70\x69\143\x2c\x73\x6f\x72\164", "\163\x6f\x72\x74"); goto EKvc2; MuYMN: U_jW7: goto NN4CV; nrq7m: foreach ($goods_category_one as $k_cat_one => $v_cat_one) { goto khM2R; GtrbJ: nu5Iv: goto qhCFs; q6Nst: SCq9K: goto GtrbJ; HjX_W: PPep4: goto SgHeL; pc9Gh: $v_cat_one["\143\x6f\x75\156\x74"] = count($goods_category_two_list); goto ZOqgZ; ZOqgZ: if (empty($goods_category_two_list)) { goto nu5Iv; } goto G_uvZ; qhCFs: $v_cat_one["\143\150\151\x6c\144\x5f\154\x69\x73\164"] = $goods_category_two_list; goto HjX_W; G_uvZ: foreach ($goods_category_two_list as $k_cat_two => $v_cat_two) { goto J1GTv; J1GTv: $cat_three_list = $goods_category_model->getQuerys(["\x6c\x65\x76\x65\154" => 3, "\160\151\144" => $v_cat_two["\143\141\x74\x65\137\x69\144"]], "\143\141\164\x65\x5f\x69\144\x2c\x63\x61\164\145\x5f\156\141\x6d\145\x2c\163\150\x6f\x72\x74\137\x6e\x61\155\x65\x2c\x70\x69\x64\54\x69\163\137\x76\x69\x73\151\142\x6c\145\x2c\143\141\x74\145\137\160\x69\143\54\163\157\x72\x74", "\163\x6f\162\164"); goto uyCBg; uyCBg: $v_cat_two["\143\x6f\165\x6e\164"] = count($cat_three_list); goto vNNp1; mrLKB: Ss3mA: goto Hd9et; vNNp1: $v_cat_two["\143\150\151\154\x64\x5f\154\151\x73\x74"] = $cat_three_list; goto mrLKB; Hd9et: } goto q6Nst; khM2R: $goods_category_two_list = $goods_category_model->getQuerys(["\154\x65\166\145\154" => 2, "\160\151\144" => $v_cat_one["\x63\x61\164\145\137\x69\x64"]], "\143\x61\x74\x65\137\x69\144\54\x63\x61\164\x65\137\156\141\155\145\54\x73\150\x6f\162\164\x5f\156\141\x6d\145\x2c\160\151\144\54\151\163\x5f\166\151\x73\x69\x62\x6c\145\54\x63\x61\x74\145\x5f\160\151\x63\x2c\x73\157\x72\x74", "\x73\157\x72\164"); goto pc9Gh; SgHeL: } goto fxycg; eHubp: if (!($i < count($tao))) { goto uJtmd; } goto jiCO3; EKvc2: if (!$this->taobao_cate) { goto VxoAQ; } goto Cs7ef; s2Ncm: BT7Hj: goto w4gUl; KGChD: $i = 0; goto ZsjeL; hQDpm: goto CJVkZ; goto s5W82; zRr_K: if (empty($goods_category_one)) { goto dPpjs; } goto nrq7m; Cs7ef: $tao = $goods_category_model->getQuerys(["\x6c\145\x76\x65\x6c" => 1, "\x6d\x63\x68\137\x69\x64" => "\55\x31"], "\143\141\x74\145\x5f\x69\x64\x2c\143\141\x74\145\137\156\141\155\145\54\x69\163\137\x76\x69\x73\x69\x62\x6c\145\x2c\163\150\x6f\x72\x74\x5f\156\141\155\x65\54\160\x69\144\x2c\143\141\x74\145\x5f\x70\x69\x63\x2c\163\157\162\164", "\163\157\162\164"); goto qKbbG; w4gUl: $i++; goto hQDpm; jiCO3: array_push($goods_category_one, $tao[$i]); goto s2Ncm; fxycg: C4e9o: goto NX3pm; NN4CV: VxoAQ: goto zRr_K; qKbbG: if (empty($tao)) { goto U_jW7; } goto KGChD; NX3pm: dPpjs: goto W5Kn7; FrnBd: $goods_category_model = new \app\common\model\GoodsCate(); goto WUmOJ; W5Kn7: return $goods_category_one; goto Nrpo1; Nrpo1: } public function ModifyGoodsCategoryField($category_id, $field_name, $field_value) { $res = $this->goods_cate->ModifyTableField("\x63\x61\164\x65\x5f\x69\144", $category_id, $field_name, $field_value); return $res; } public function getGoodsCategoryTree($pid, $mch_id) { goto F8753; svxKK: JFh1M: goto dX7Li; oBken: $one_list = $this->getGoodsCategoryListByParentId($pid, $mch_id); goto kA0Dx; kA0Dx: foreach ($one_list as $k1 => $v1) { goto EceVi; EceVi: $two_list = array(); goto JOK78; JOK78: $two_list = $this->getGoodsCategoryListByParentId($v1["\x63\141\164\x65\137\151\x64"], $mch_id); goto Vj4NC; Vj4NC: $one_list[$k1]["\143\150\151\x6c\x64\x5f\x6c\151\x73\x74"] = $two_list; goto Gg9Uy; Gg9Uy: hEee1: goto iSX1A; iSX1A: } goto svxKK; yOXQY: return $list; goto HvUot; F8753: $list = array(); goto oBken; dX7Li: $list = $one_list; goto yOXQY; HvUot: } public function InfiniteCate($cate_id) { goto Xr2el; j_dbf: return $cate_list["\143\141\x74\x65\x5f\x69\x64"]; goto QGTza; YMjtU: goto p3I0z; goto CrZlo; LTxFm: $cate_list = $cate->where("\x63\x61\x74\145\x5f\x69\144", $cate_list["\x70\151\x64"])->find(); goto K3GOi; i2EZw: return $cate_list["\x63\x61\x74\x65\137\151\144"]; goto Q5Vv_; Xr2el: $cate = new \app\common\model\GoodsCate(); goto NWVjd; mlc_V: $cate_list = $cate->where("\x63\x61\164\x65\x5f\151\144", $cate_list["\x70\151\x64"])->find(); goto tYDt2; Kad0F: return $cate_list["\143\141\164\145\x5f\151\144"]; goto LEtOF; CrZlo: T8xmp: goto i2EZw; E8XgN: goto wzvoD; goto XZZu6; LEtOF: wzvoD: goto tApwT; Q5Vv_: p3I0z: goto E8XgN; K3GOi: if (!($cate_list["\160\x69\x64"] == 0)) { goto YiWur; } goto j_dbf; XZZu6: uJXHT: goto Kad0F; QGTza: YiWur: goto YMjtU; tYDt2: if ($cate_list["\x70\151\x64"] == 0) { goto T8xmp; } goto LTxFm; XbpUd: if ($cate_list["\160\x69\x64"] == 0) { goto uJXHT; } goto mlc_V; NWVjd: $cate_list = $cate->where("\143\141\164\145\137\151\x64", $cate_id)->find(); goto XbpUd; tApwT: } public function getGoodsCategoryListByParentId($pid, $mch_id) { goto evJyo; ZeESC: LlO1y: goto Vd0w6; DKA2K: if (empty($list)) { goto jMqKs; } goto BBnnH; sti7K: gWxgm: goto bAy0k; A37kZ: if (!empty($child_list) && $child_list["\164\x6f\164\141\154\x5f\143\157\165\156\164"] > 0) { goto LlO1y; } goto FuB4Q; qQwM6: goto lMbvj; goto MioyM; ETSV7: goto i8t7t; goto ZeESC; u1NIK: $list = $this->getGoodsCategoryList(1, 0, $where, "\x70\x69\x64\54\x73\157\162\x74"); goto DKA2K; waANO: $parent_id = $list["\x64\141\164\x61"][$i]["\143\141\x74\145\137\x69\144"]; goto HQuDJ; FuB4Q: $list["\144\141\164\x61"][$i]["\151\x73\x5f\x70\x61\x72\x65\156\164"] = 0; goto ETSV7; HQuDJ: $child_list = $this->getGoodsCategoryList(1, 1, "\x70\151\144\75" . $parent_id, "\160\x69\x64\x2c\x73\157\x72\x74"); goto A37kZ; MioyM: Sn3Ms: goto DU9fG; J8idE: if (!($i < count($list["\144\141\x74\x61"]))) { goto Sn3Ms; } goto waANO; DU9fG: jMqKs: goto qlify; XMkSe: lMbvj: goto J8idE; Vd0w6: $list["\144\x61\x74\x61"][$i]["\151\163\x5f\160\x61\x72\145\x6e\164"] = 1; goto H1pHP; K0Ie6: $where["\155\143\x68\137\151\144"] = array("\145\x71", $mch_id); goto u1NIK; BBnnH: $i = 0; goto XMkSe; H1pHP: i8t7t: goto sti7K; qlify: return $list["\x64\x61\164\x61"]; goto HYMAU; evJyo: $where["\x70\151\144"] = array("\145\161", $pid); goto K0Ie6; bAy0k: $i++; goto qQwM6; HYMAU: } public function getGoodsCategoryList($page_index = 1, $page_size = 0, $condition = '', $order = '', $field = "\52") { $list = $this->goods_cate->pageQuery($page_index, $page_size, $condition, $order, $field); return $list; } public function addOrEditGoodsCategory($cate_id, $cate_name, $short_name, $pid, $is_visible, $keywords = '', $description = '', $sort = 0, $cate_pic, $mch_id) { goto zzmVW; R4iQD: $result = $this->goods_cate->save($data); goto Y5hGR; Ee7I1: $res = $this->goods_cate->cate_id; goto dx0fT; agIgu: $data = array("\143\x61\x74\145\x5f\x6e\x61\x6d\145" => $cate_name, "\163\x68\x6f\162\164\x5f\156\x61\155\x65" => $short_name, "\160\x69\x64" => $pid, "\x6c\145\166\145\154" => $level, "\151\x73\137\166\151\163\x69\x62\154\x65" => $is_visible, "\153\145\171\167\x6f\x72\x64\x73" => $keywords, "\144\x65\x73\143\162\151\160\164\x69\x6f\x6e" => $description, "\x73\x6f\x72\164" => $sort, "\143\141\164\x65\137\160\151\x63" => $cate_pic, "\143\x72\x65\x61\164\145\137\x74\x69\x6d\145" => time(), "\x6d\x63\x68\137\x69\x64" => $mch_id); goto JolSL; tnr70: return $res; goto bbW07; oiLul: $res = $this->goods_cate->getError(); goto hsdVm; SO2Hu: VY0jQ: goto R4iQD; iiEF4: if ($cate_id == 0) { goto XUmdA; } goto wrEO8; dx0fT: kGXEh: goto o2trb; z6Smc: $res = $this->goods_cate->getError(); goto bwada; hVOTN: goto K0ba2; goto xQKyr; JolSL: $dd = array("\143\x61\164\x65\x5f\x6e\141\x6d\145" => $cate_name, "\x70\x69\x64" => $pid, "\154\145\x76\145\x6c" => $level, "\x6d\x63\150\x5f\x69\x64" => $mch_id); goto iiEF4; jsoUR: return $res; goto DULQ6; mRoaU: if ($res !== false) { goto syQXW; } goto z6Smc; uA4w8: $find = $this->goods_cate->where($dd)->find(); goto eK5Hb; RKG4L: return "\xe5\xb7\xb2\xe6\234\x89\xe6\xad\xa4\345\x88\x86\xe7\261\273\54\346\x97\240\xe6\xb3\225\xe9\x87\x8d\xe5\xa4\x8d\xe5\210\x9b\xe5\273\272"; goto SO2Hu; DULQ6: KuRpJ: goto JfgDZ; JfgDZ: goto YEhi5; goto W4nLT; wrEO8: $res = $this->goods_cate->save($data, ["\x63\141\164\x65\x5f\x69\144" => $cate_id]); goto mRoaU; Y5hGR: if ($result) { goto AqEmG; } goto oiLul; W4nLT: XUmdA: goto uA4w8; eK5Hb: if (empty($find)) { goto VY0jQ; } goto RKG4L; DEQIh: syQXW: goto pptMe; pptMe: $this->goods_cate->save(["\x6c\x65\x76\x65\x6c" => $level + 1], ["\x70\151\144" => $cate_id]); goto jsoUR; zzmVW: if ($pid == 0) { goto ov3pL; } goto SwyWD; SwyWD: $level = $this->getGoodsCategoryDetail($pid)["\154\x65\x76\145\x6c"] + 1; goto hVOTN; hsdVm: goto kGXEh; goto mr7q4; xQKyr: ov3pL: goto l3167; OhrUZ: K0ba2: goto agIgu; mr7q4: AqEmG: goto Ee7I1; o2trb: YEhi5: goto tnr70; bwada: goto KuRpJ; goto DEQIh; l3167: $level = 1; goto OhrUZ; bbW07: } public function getGoodsCategoryDetail($pid) { $res = $this->goods_cate->get($pid); return $res; } public function deleteGoodsCategory($cate_id, $mch_id) { goto FJxfC; FJxfC: $sub_list = $this->getGoodsCategoryListByParentId($cate_id, $mch_id); goto OquGZ; UGggF: $res = SYSTEM_DELETE_FAIL; goto Pqbq8; a5Zch: $res = $this->goods_cate->destroy($cate_id); goto BwxqF; Pqbq8: Ctumr: goto UEbjX; BwxqF: goto Ctumr; goto TS3Wo; OquGZ: if (!empty($sub_list)) { goto c_k2O; } goto a5Zch; UEbjX: return $res; goto ajjbi; TS3Wo: c_k2O: goto UGggF; ajjbi: } public function getGoodsCateV1($condition = '', $field = "\52", $order = '') { $list = $this->goods_cate->getQuerys($condition, $field, $order); return $list; } }
