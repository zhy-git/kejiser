<?php
 namespace app\admin\service; class FeieYun { var $host; var $port; var $path; var $method; var $postdata = ''; var $cookies = array(); var $referer; var $accept = "\x74\x65\x78\x74\57\170\x6d\x6c\54\141\160\160\x6c\x69\143\141\x74\x69\157\156\x2f\170\155\x6c\54\141\160\160\154\x69\143\x61\x74\x69\157\156\x2f\170\x68\164\155\x6c\53\x78\x6d\154\x2c\164\145\170\x74\57\150\164\x6d\154\x2c\164\x65\x78\164\x2f\160\154\x61\151\x6e\54\x69\155\141\x67\x65\x2f\x70\156\147\x2c\151\x6d\x61\x67\145\x2f\x6a\160\145\147\x2c\151\x6d\141\147\x65\x2f\147\x69\x66\x2c\x2a\x2f\x2a"; var $accept_encoding = "\147\x7a\x69\x70"; var $accept_language = "\x65\x6e\55\165\163"; var $user_agent = "\111\156\x63\x75\164\151\157\x20\x48\x74\x74\160\103\x6c\x69\x65\156\x74\40\166\60\x2e\x39"; var $timeout = 20; var $use_gzip = true; var $persist_cookies = true; var $persist_referers = true; var $debug = false; var $handle_redirects = true; var $max_redirects = 5; var $headers_only = false; var $username; var $password; var $status; var $headers = array(); var $content = ''; var $errormsg; var $redirect_count = 0; var $cookie_host = ''; function __construct($host, $port = 80) { $this->host = $host; $this->port = $port; } function get($path, $data = false) { goto SUfxj; El0FZ: return $this->doRequest(); goto xDtS7; Y929p: if (!$data) { goto xlM7m; } goto Sdy_Q; SUfxj: $this->path = $path; goto lfag9; Sdy_Q: $this->path .= "\x3f" . $this->buildQueryString($data); goto Wh_0Z; Wh_0Z: xlM7m: goto El0FZ; lfag9: $this->method = "\x47\x45\124"; goto Y929p; xDtS7: } function post($path, $data) { goto WT2UM; WT2UM: $this->path = $path; goto LBxN9; LBxN9: $this->method = "\x50\x4f\123\124"; goto E8mVS; E8mVS: $this->postdata = $this->buildQueryString($data); goto D68ss; D68ss: return $this->doRequest(); goto RWmAW; RWmAW: } function buildQueryString($data) { goto xL1iV; il6iD: if (is_array($data)) { goto Gcw7p; } goto JM21W; xL1iV: $querystring = ''; goto il6iD; RpHqb: goto yuwGz; goto Cwb0L; GLFDJ: $querystring = substr($querystring, 0, -1); goto PQ5OK; PQ5OK: yuwGz: goto O0IpJ; Cwb0L: Gcw7p: goto kvVvE; aBrpV: JUOe_: goto GLFDJ; kvVvE: foreach ($data as $key => $val) { goto UwqNI; lVAHr: $querystring .= urlencode($key) . "\x3d" . urlencode($val) . "\46"; goto M8VVw; UgjgI: lTDPH: goto gQ5WA; UwqNI: if (is_array($val)) { goto Q4CnR; } goto lVAHr; B7cop: foreach ($val as $val2) { $querystring .= urlencode($key) . "\x3d" . urlencode($val2) . "\x26"; abRfA: } goto UgjgI; M8VVw: goto K7t4M; goto js64y; gQ5WA: K7t4M: goto Uxvxr; js64y: Q4CnR: goto B7cop; Uxvxr: xzSYU: goto MGJ0A; MGJ0A: } goto aBrpV; O0IpJ: return $querystring; goto xNaV2; JM21W: $querystring = $data; goto RpHqb; xNaV2: } function doRequest() { goto fuveK; m_11a: if (!$this->headers_only) { goto YvbH6; } goto LO2GY; EUQhz: $this->content = ''; goto KcWK9; B9vjt: AqQJg: goto SpxLx; IJbVM: fwrite($fp, $request); goto mDjlV; fuveK: if ($fp = @fsockopen($this->host, $this->port, $errno, $errstr, $this->timeout)) { goto Vx4ev; } goto acEar; Fm1c5: $cookies = $this->headers["\163\x65\x74\55\143\157\x6f\x6b\151\x65"]; goto J7EWH; oO4hG: $this->errormsg = "\x53\164\x61\x74\165\x73\40\143\157\x64\145\40\x6c\151\x6e\x65\x20\x69\156\x76\141\x6c\x69\x64\x3a\40" . htmlentities($line); goto EFfIp; JAq24: $inHeaders = false; goto ipPpJ; uu4bs: J_Gkn: goto S63OT; dakaN: if (!$this->handle_redirects) { goto NnZmU; } goto bwCqo; IlO5E: LHY6J: goto ZseOW; XFkZC: $inHeaders = true; goto k4ITj; jxQSJ: $this->redirect_count = 0; goto q4ITq; dOILa: $http_version = $m[1]; goto BmMUl; BDfEa: $key = strtolower(trim($m[1])); goto B2z5x; Yqhqa: $line = fgets($fp, 4096); goto EIBYa; kWAob: xeS0U: goto BDfEa; yvE5H: I7q7K: goto V35z6; haqXE: $this->content = gzinflate($this->content); goto Ej0ou; OXIkO: $url = parse_url($location . $uri); goto i1BCl; E4fdI: $this->debug("\x50\x65\x72\163\x69\163\164\x69\x6e\x67\x20\162\x65\x66\x65\162\145\x72\72\40" . $this->getRequestURL()); goto yF7jL; YUkfQ: if (!$inHeaders) { goto sLJvb; } goto mtS6m; NtVdz: fltgB: goto o3OOc; aDrJK: $this->content .= $line; goto l2zkv; acEar: switch ($errno) { case -3: $this->errormsg = "\123\x6f\x63\x6b\145\x74\40\x63\x72\x65\x61\164\x69\x6f\156\40\x66\141\151\154\x65\x64\x20\x28\x2d\x33\51"; case -4: $this->errormsg = "\104\x4e\x53\x20\154\157\x6f\x6b\x75\x70\40\146\141\151\x6c\165\x72\145\x20\50\55\64\x29"; case -5: $this->errormsg = "\x43\157\x6e\156\x65\x63\164\x69\x6f\156\40\x72\x65\x66\x75\163\145\x64\40\157\x72\x20\x74\151\155\145\x64\x20\x6f\165\x74\x20\x28\55\65\51"; default: goto q1u15; qw3kK: $this->errormsg .= "\40" . $errstr; goto Pkgl7; Pkgl7: $this->debug($this->errormsg); goto O1_Ct; q1u15: $this->errormsg = "\x43\x6f\156\x6e\145\x63\x74\151\x6f\156\x20\x66\x61\151\x6c\x65\144\40\50" . $errno . "\x29"; goto qw3kK; O1_Ct: } goto iy8oV; SS3Ko: if (!($this->persist_cookies && isset($this->headers["\x73\x65\164\x2d\143\x6f\x6f\x6b\151\145"]) && $this->host == $this->cookie_host)) { goto Hy0FM; } goto Fm1c5; KcWK9: $this->errormsg = ''; goto XFkZC; aclb1: Hy0FM: goto nvhYU; g2iz9: if (isset($this->headers[$key])) { goto Bgq91; } goto Hs0NF; SrP6q: Oz1Gn: goto SHNKa; Azxt0: goto Oz1Gn; goto yvE5H; mDjlV: $this->headers = array(); goto EUQhz; JZQ4a: vEIob: goto xZ1Gw; SHNKa: if (feof($fp)) { goto I65F9; } goto Yqhqa; GpSXy: $status_string = $m[3]; goto t8kqA; V35z6: if (preg_match("\x2f\x28\133\136\x3a\x5d\x2b\x29\72\x5c\x73\52\50\56\x2a\x29\57", $line, $m)) { goto xeS0U; } goto uLlA5; k4ITj: $atStart = true; goto SrP6q; q4ITq: return false; goto jjzRg; F3Adx: socket_set_timeout($fp, $this->timeout); goto MzwAC; EFfIp: $this->debug($this->errormsg); goto AdToL; H_5GQ: if (is_array($this->headers[$key])) { goto AqQJg; } goto Wdt9L; i1BCl: return $this->get($url["\160\141\x74\x68"]); goto BJm_N; Wdt9L: $this->headers[$key] = array($this->headers[$key], $val); goto SFh_x; J7EWH: if (is_array($cookies)) { goto fltgB; } goto M0xAK; B2z5x: $val = trim($m[2]); goto g2iz9; D01rC: I65F9: goto u3SaR; SFh_x: goto NGz7M; goto B9vjt; G_Wgn: goto vEIob; goto cf5UO; FI_Lt: e5sdu: goto YUkfQ; M0xAK: $cookies = array($cookies); goto NtVdz; MzwAC: $request = $this->buildRequest(); goto Dnn46; VYLbv: goto Oz1Gn; goto FI_Lt; BmMUl: $this->status = $m[2]; goto GpSXy; xxcj0: if (preg_match("\x2f\110\x54\x54\x50\134\x2f\50\134\x64\134\56\134\144\x29\134\163\x2a\x28\x5c\x64\x2b\x29\x5c\163\52\50\56\x2a\51\x2f", $line, $m)) { goto c21xI; } goto oO4hG; bwCqo: if (!(++$this->redirect_count >= $this->max_redirects)) { goto CjNVW; } goto Q1p62; gIRXU: $uri = isset($this->headers["\x75\x72\151"]) ? $this->headers["\165\x72\151"] : ''; goto uPYtM; xUB1D: Vx4ev: goto F3Adx; o3OOc: foreach ($cookies as $cookie) { goto weBMF; yPQhq: T9zTE: goto a6CQ5; sglVm: CfedM: goto yPQhq; weBMF: if (!preg_match("\57\x28\133\136\75\135\53\51\75\50\x5b\x5e\x3b\135\53\x29\73\57", $cookie, $m)) { goto CfedM; } goto Ov5pT; Ov5pT: $this->cookies[$m[1]] = $m[2]; goto sglVm; a6CQ5: } goto uu4bs; ax22H: $atStart = false; goto xxcj0; E0307: orjzq: goto dakaN; LO2GY: goto I65F9; goto jJgVW; u3SaR: fclose($fp); goto E5FvU; URxHZ: c21xI: goto dOILa; uLlA5: goto Oz1Gn; goto kWAob; mtS6m: if (!(trim($line) == '')) { goto I7q7K; } goto JAq24; tLlSP: $this->debug($this->errormsg); goto jxQSJ; xZ1Gw: goto Oz1Gn; goto kq1CF; ZseOW: return false; goto xUB1D; uPYtM: if (!($location || $uri)) { goto GTQ1P; } goto OXIkO; Dnn46: $this->debug("\122\145\x71\x75\x65\x73\164", $request); goto IJbVM; jjzRg: CjNVW: goto nhXhY; EIBYa: if (!$atStart) { goto e5sdu; } goto ax22H; BJm_N: GTQ1P: goto Sq1qd; Hs0NF: $this->headers[$key] = $val; goto G_Wgn; Sq1qd: NnZmU: goto N3YAd; cf5UO: Bgq91: goto H_5GQ; nhXhY: $location = isset($this->headers["\x6c\x6f\143\x61\164\151\157\x6e"]) ? $this->headers["\154\157\143\x61\x74\151\157\156"] : ''; goto gIRXU; kq1CF: sLJvb: goto aDrJK; iy8oV: P3LHV: goto IlO5E; hs13W: $this->debug("\x43\x6f\x6e\x74\x65\156\x74\40\x69\x73\40\147\x7a\x69\160\40\x65\156\x63\157\144\x65\x64\54\x20\x75\156\172\151\x70\160\x69\x6e\147\40\x69\164"); goto QwDYl; yF7jL: $this->referer = $this->getRequestURL(); goto E0307; ipPpJ: $this->debug("\x52\x65\x63\x65\x69\x76\x65\x64\40\110\x65\141\x64\x65\x72\163", $this->headers); goto m_11a; SpxLx: $this->headers[$key][] = $val; goto uNyOY; QwDYl: $this->content = substr($this->content, 10); goto haqXE; Q1p62: $this->errormsg = "\116\165\155\142\x65\x72\40\157\x66\x20\162\145\144\x69\162\x65\143\x74\163\x20\145\170\x63\x65\x65\x64\145\144\40\x6d\141\170\x69\155\165\155\40\50" . $this->max_redirects . "\x29"; goto tLlSP; jJgVW: YvbH6: goto Azxt0; nvhYU: if (!$this->persist_referers) { goto orjzq; } goto E4fdI; E5FvU: if (!(isset($this->headers["\x63\x6f\156\x74\145\156\x74\55\145\156\x63\x6f\144\151\156\x67"]) && $this->headers["\x63\157\x6e\x74\x65\156\164\x2d\145\156\143\x6f\x64\x69\x6e\147"] == "\147\172\x69\x70")) { goto IWmur; } goto hs13W; N3YAd: return true; goto zXU06; t8kqA: $this->debug(trim($line)); goto VYLbv; AdToL: return false; goto URxHZ; Ej0ou: IWmur: goto SS3Ko; l2zkv: goto Oz1Gn; goto D01rC; uNyOY: NGz7M: goto JZQ4a; S63OT: $this->cookie_host = $this->host; goto aclb1; zXU06: } function buildRequest() { goto bA56l; muEH9: $headers[] = $cookie; goto bHmpv; jUUVy: JNmiN: goto Y4EMU; AVp27: $headers[] = "\101\165\x74\x68\x6f\162\x69\x7a\x61\164\151\x6f\156\72\x20\102\101\x53\111\103\x20" . base64_encode($this->username . "\72" . $this->password); goto TtzA5; Y4EMU: if (!$this->cookies) { goto kHfVg; } goto uuaMc; ZGhCW: y5ILE: goto Z9tja; rDdV6: return $request; goto MppVj; nP960: $headers[] = "\125\163\x65\162\x2d\x41\147\145\x6e\164\72\x20{$this->user_agent}"; goto oVFWy; qDbGQ: $headers[] = "{$this->method}\x20{$this->path}\40\x48\124\x54\x50\x2f\61\x2e\60"; goto fPZIE; eKv4G: if (!$this->postdata) { goto y5ILE; } goto aQcbH; TtzA5: AJP7t: goto eKv4G; aQcbH: $headers[] = "\x43\x6f\x6e\x74\x65\156\x74\55\124\x79\160\145\72\x20\141\160\160\x6c\151\143\x61\164\x69\157\156\x2f\170\55\x77\167\x77\55\x66\157\162\155\55\165\162\154\x65\156\x63\157\144\145\x64"; goto cMDlP; uuaMc: $cookie = "\x43\x6f\157\x6b\x69\x65\x3a\x20"; goto kvr8z; dkPeX: if (!($this->username && $this->password)) { goto AJP7t; } goto AVp27; F6uGT: RiWXv: goto wV2KC; Z9tja: $request = implode("\15\xa", $headers) . "\xd\12\xd\xa" . $this->postdata; goto rDdV6; KC_Bl: if (!$this->use_gzip) { goto RiWXv; } goto ZTsLn; bHmpv: kHfVg: goto dkPeX; cMDlP: $headers[] = "\x43\x6f\x6e\164\145\156\x74\55\114\x65\x6e\147\164\x68\72\40" . strlen($this->postdata); goto ZGhCW; oVFWy: $headers[] = "\x41\x63\143\145\x70\x74\72\40{$this->accept}"; goto KC_Bl; kvr8z: foreach ($this->cookies as $key => $value) { $cookie .= "{$key}\x3d{$value}\x3b\x20"; CbEb7: } goto r5HVq; bA56l: $headers = array(); goto qDbGQ; rT0Jx: $headers[] = "\122\x65\x66\145\162\x65\x72\72\x20{$this->referer}"; goto jUUVy; wV2KC: $headers[] = "\101\x63\143\145\160\164\x2d\154\141\156\x67\165\141\x67\x65\x3a\40{$this->accept_language}"; goto IZvJL; r5HVq: EQ6kw: goto muEH9; IZvJL: if (!$this->referer) { goto JNmiN; } goto rT0Jx; fPZIE: $headers[] = "\x48\157\163\164\72\40{$this->host}"; goto nP960; ZTsLn: $headers[] = "\101\x63\143\145\160\x74\x2d\145\x6e\143\157\x64\x69\x6e\x67\x3a\x20{$this->accept_encoding}"; goto F6uGT; MppVj: } function getStatus() { return $this->status; } function getContent() { return $this->content; } function getHeaders() { return $this->headers; } function getHeader($header) { goto Wo0au; Wo0au: $header = strtolower($header); goto ODeKx; ODeKx: if (isset($this->headers[$header])) { goto F4mFo; } goto VEr92; DvQhI: Z7p9N: goto vdm0Y; VEr92: return false; goto TNjBd; TNjBd: goto Z7p9N; goto pKkB9; Kk0oC: return $this->headers[$header]; goto DvQhI; pKkB9: F4mFo: goto Kk0oC; vdm0Y: } function getError() { return $this->errormsg; } function getCookies() { return $this->cookies; } function getRequestURL() { goto MuTz0; xsHoY: $url .= $this->path; goto znXPT; DzTIn: if (!($this->port != 80)) { goto kBpXw; } goto qArcr; MuTz0: $url = "\150\164\164\x70\x3a\57\57" . $this->host; goto DzTIn; qArcr: $url .= "\x3a" . $this->port; goto OK3U3; OK3U3: kBpXw: goto xsHoY; znXPT: return $url; goto zreG3; zreG3: } function setUserAgent($string) { $this->user_agent = $string; } function setAuthorization($username, $password) { $this->username = $username; $this->password = $password; } function setCookies($array) { $this->cookies = $array; } function useGzip($boolean) { $this->use_gzip = $boolean; } function setPersistCookies($boolean) { $this->persist_cookies = $boolean; } function setPersistReferers($boolean) { $this->persist_referers = $boolean; } function setHandleRedirects($boolean) { $this->handle_redirects = $boolean; } function setMaxRedirects($num) { $this->max_redirects = $num; } function setHeadersOnly($boolean) { $this->headers_only = $boolean; } function setDebug($boolean) { $this->debug = $boolean; } function quickGet($url) { goto S1V1h; FcSKx: goto tu8VY; goto detsH; HpXjM: R0MTI: goto YMv1Q; ieCrb: if (!isset($bits["\x71\165\145\162\x79"])) { goto R0MTI; } goto iQW5q; peHD5: $port = isset($bits["\160\157\x72\164"]) ? $bits["\x70\x6f\162\x74"] : 80; goto kyNyC; w7Yap: return $client->getContent(); goto FcSKx; kRehM: tu8VY: goto a6rRk; h_v2n: if (!$client->get($path)) { goto iHVVQ; } goto w7Yap; OZ252: return false; goto kRehM; S1V1h: $bits = parse_url($url); goto tpUKl; tpUKl: $host = $bits["\150\x6f\x73\164"]; goto peHD5; kyNyC: $path = isset($bits["\160\141\164\150"]) ? $bits["\160\141\164\x68"] : "\57"; goto ieCrb; detsH: iHVVQ: goto OZ252; iQW5q: $path .= "\x3f" . $bits["\x71\x75\x65\162\x79"]; goto HpXjM; YMv1Q: $client = new HttpClient($host, $port); goto h_v2n; a6rRk: } function quickPost($url, $data) { goto pwYSp; Hw7_P: return false; goto AviLC; yKfO0: $client = new HttpClient($host, $port); goto PXZhe; PXZhe: if (!$client->post($path, $data)) { goto wSzXK; } goto CZ6vR; CZ6vR: return $client->getContent(); goto eibNO; eibNO: goto G5X0W; goto LckED; AviLC: G5X0W: goto dyFM5; AZqSS: $host = $bits["\150\x6f\163\x74"]; goto i__Lg; pwYSp: $bits = parse_url($url); goto AZqSS; i__Lg: $port = isset($bits["\x70\157\x72\x74"]) ? $bits["\x70\157\x72\x74"] : 80; goto yhGAf; LckED: wSzXK: goto Hw7_P; yhGAf: $path = isset($bits["\160\x61\x74\x68"]) ? $bits["\160\141\164\150"] : "\57"; goto yKfO0; dyFM5: } function debug($msg, $object = false) { goto DcGfV; yDFC_: jIlgQ: goto A7ojB; Puv6h: print "\x3c\160\162\145\76" . $content . "\x3c\x2f\x70\x72\145\76"; goto yDFC_; DcGfV: if (!$this->debug) { goto AOvM7; } goto nZprK; MIovl: if (!$object) { goto jIlgQ; } goto DXMuk; A7ojB: print "\74\57\144\151\x76\76"; goto tnxob; nZprK: print "\74\144\151\166\40\x73\x74\171\x6c\145\x3d\42\142\157\x72\x64\x65\x72\72\x20\x31\x70\x78\x20\x73\157\154\151\144\x20\162\145\144\73\40\160\141\x64\x64\151\x6e\x67\x3a\x20\x30\56\x35\145\155\x3b\40\x6d\x61\x72\x67\x69\x6e\x3a\40\60\56\65\145\x6d\x3b\42\x3e\x3c\163\x74\x72\157\x6e\147\x3e\110\x74\164\160\103\154\x69\x65\x6e\x74\x20\104\x65\x62\x75\x67\72\x3c\57\x73\164\x72\x6f\156\147\76\40" . $msg; goto MIovl; tk01e: $content = htmlentities(ob_get_contents()); goto xxoK6; DXMuk: ob_start(); goto n3ZWs; tnxob: AOvM7: goto rM_aa; n3ZWs: print_r($object); goto tk01e; xxoK6: ob_end_clean(); goto Puv6h; rM_aa: } }
