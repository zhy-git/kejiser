<?php
 namespace app\admin\service; class Yprint { public function generateSign($params, $apiKey, $msign) { goto yXcT1; yXcT1: ksort($params); goto MDwkU; aprmL: foreach ($params as $k => $v) { $stringToBeSigned .= urldecode($k . $v); eHZnR: } goto Aiq2i; YJANl: $stringToBeSigned .= $msign; goto DsInt; MDwkU: $stringToBeSigned = $apiKey; goto aprmL; DsInt: return strtoupper(md5($stringToBeSigned)); goto t3tAe; Aiq2i: MasQf: goto FCTaw; FCTaw: unset($k, $v); goto YJANl; t3tAe: } public function getStr($param) { goto WGC1M; WGC1M: $str = ''; goto f_kqP; f_kqP: foreach ($param as $key => $value) { $str = $str . $key . "\75" . $value . "\46"; nd6Na: } goto dojY0; d5Peh: $str = rtrim($str, "\46"); goto wprpQ; dojY0: GxwfV: goto d5Peh; wprpQ: return $str; goto bml3b; bml3b: } public function action_print($partner, $machine_code, $content, $apiKey, $msign) { goto NlqF4; NlqF4: $param = array("\160\141\162\164\156\x65\x72" => $partner, "\155\141\x63\x68\151\x6e\145\x5f\143\157\144\145" => $machine_code, "\164\x69\x6d\x65" => time()); goto nvFHH; nvFHH: $param["\x73\x69\147\156"] = $this->generateSign($param, $apiKey, $msign); goto b4eWz; AJ5OV: return $this->sendCmd("\150\164\x74\160\72\57\57\x6f\x70\x65\x6e\x2e\61\x30\163\x73\x2e\x6e\145\164\72\70\70\70\70", $str); goto MJLP_; op2zk: $str = $this->getStr($param); goto AJ5OV; b4eWz: $param["\x63\157\x6e\164\145\156\x74"] = $content; goto op2zk; MJLP_: } public function action_addprint($partner, $machine_code, $username, $printname, $mobilephone, $apiKey, $msign) { goto BBC7T; KNOk7: return $this->sendCmd("\150\x74\x74\160\x3a\57\x2f\x6f\160\x65\156\x2e\x31\60\163\x73\56\156\145\164\72\x38\70\x38\x38\x2f\141\144\x64\x70\x72\x69\156\x74\56\160\150\x70", $str); goto m2kYf; PFlMd: $str = $this->getStr($param); goto KNOk7; pAq5S: $param["\163\x69\147\x6e"] = $this->generateSign($param, $apiKey, $msign); goto WUZMR; BBC7T: $param = array("\x70\141\162\164\x6e\x65\x72" => $partner, "\155\141\143\150\151\x6e\145\x5f\x63\157\x64\x65" => $machine_code, "\165\163\x65\x72\x6e\x61\x6d\x65" => $username, "\160\x72\151\156\164\x6e\141\x6d\145" => $printname, "\155\157\142\x69\x6c\x65\x70\150\x6f\156\145" => $mobilephone); goto pAq5S; WUZMR: $param["\x6d\x73\151\147\x6e"] = $msign; goto PFlMd; m2kYf: } public function action_removeprinter($partner, $machine_code, $apiKey, $msign) { goto z2Zh3; rMkY0: $str = $this->getStr($param); goto Q0dj7; fvOZs: $param["\163\x69\x67\x6e"] = $this->generateSign($param, $apiKey, $msign); goto rMkY0; Q0dj7: return $this->sendCmd("\150\164\164\160\x3a\x2f\57\x6f\x70\145\156\x2e\61\60\x73\163\56\156\x65\164\72\70\x38\x38\70\x2f\x72\145\x6d\x6f\166\x65\x70\x72\151\x6e\x74\x2e\160\150\x70", $str); goto r1I1r; z2Zh3: $param = array("\x70\141\162\164\x6e\145\162" => $partner, "\155\x61\x63\150\151\156\145\x5f\x63\x6f\x64\x65" => $machine_code); goto fvOZs; r1I1r: } public function sendCmd($url, $data) { goto Ojfkf; SwJ5s: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2); goto s9pl6; i1WCk: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto lsnjS; pz9nc: return $tmpInfo; goto ro4LE; FA20G: curl_setopt($curl, CURLOPT_HEADER, 0); goto i1WCk; lsnjS: $tmpInfo = curl_exec($curl); goto SJfus; OOy1f: wVGAD: goto Q4Fkf; Lz2jV: curl_setopt($curl, CURLOPT_POSTFIELDS, $data); goto bYRIX; Ojfkf: $curl = curl_init(); goto hHW8y; buka1: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0); goto SwJ5s; Q4Fkf: curl_close($curl); goto pz9nc; B9WcB: curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); goto cNbcv; cNbcv: curl_setopt($curl, CURLOPT_AUTOREFERER, 1); goto iZUWC; bYRIX: curl_setopt($curl, CURLOPT_TIMEOUT, 30); goto FA20G; s9pl6: curl_setopt($curl, CURLOPT_HTTPHEADER, array("\x45\170\160\145\x63\164\x3a")); goto B9WcB; SJfus: if (!curl_errno($curl)) { goto wVGAD; } goto wtQI8; wtQI8: \Yii::trace("\346\211\223\xe5\x8d\xb0\xe5\x87\272\351\224\231\357\xbc\x9a" . curl_error($curl)); goto OOy1f; iZUWC: curl_setopt($curl, CURLOPT_POST, 1); goto Lz2jV; hHW8y: curl_setopt($curl, CURLOPT_URL, $url); goto buka1; ro4LE: } }
