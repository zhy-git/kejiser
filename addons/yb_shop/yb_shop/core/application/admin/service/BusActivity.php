<?php
 namespace app\admin\service; use think\db; class BusActivity extends Base { private $contr_order_status = array("\55\x31" => "\345\xb7\xb2\345\217\x96\346\xb6\210", "\x30" => "\xe5\xbe\205\xe6\x94\257\xe4\xbb\x98", "\61" => "\xe5\xbe\205\345\x8f\221\350\264\xa7", "\62" => "\xe5\276\205\xe6\x94\xb6\350\xb4\247", "\63" => "\345\267\xb2\xe5\256\214\xe6\210\x90", "\64" => "\351\x80\200\346\xac\276\xe4\270\xad", "\65" => "\345\xb7\xb2\xe9\200\x80\xe6\254\276"); function __construct() { parent::__construct(); $this->bus_activity = new \app\common\model\BusActivity(); } public function getActivityAll($condition = '', $search_text = '', $order = '') { $list = $this->bus_activity->getPageLisy($condition, $search_text, $order); return $list; } public function addActivity($activity_name, $satisfy_money, $discount_money, $star_time, $end_time, $is_use, $mch_id) { goto AXgSl; UeSzF: return $res; goto qOBVh; nqVRj: $res = $this->bus_activity->save($data); goto UeSzF; AXgSl: $data = array("\x61\x63\164\151\x76\x69\164\171\137\x6e\141\x6d\x65" => $activity_name, "\x73\x61\x74\x69\x73\x66\171\x5f\155\x6f\x6e\145\x79" => $satisfy_money, "\x64\151\x73\143\x6f\165\x6e\164\137\x6d\x6f\x6e\145\171" => $discount_money, "\163\164\x61\162\137\164\151\x6d\x65" => $star_time, "\145\x6e\144\x5f\x74\151\x6d\x65" => $end_time, "\x69\x73\137\165\x73\145" => $is_use, "\x6d\x63\150\137\x69\x64" => $mch_id); goto nqVRj; qOBVh: } public function editActivity($id, $activity_name, $satisfy_money, $discount_money, $star_time, $end_time, $is_use, $mch_id) { goto te41u; te41u: $data = array("\141\x63\x74\151\x76\151\164\171\137\x6e\x61\155\x65" => $activity_name, "\163\x61\164\151\163\x66\x79\137\155\157\156\x65\171" => $satisfy_money, "\144\x69\163\x63\157\x75\x6e\164\137\x6d\157\x6e\145\x79" => $discount_money, "\x73\164\141\x72\x5f\x74\x69\x6d\x65" => $star_time, "\145\156\x64\x5f\x74\x69\x6d\145" => $end_time, "\x69\x73\x5f\x75\163\x65" => $is_use, "\x6d\x63\x68\x5f\x69\x64" => $mch_id); goto p63yZ; gq15w: return $res; goto LQpqk; p63yZ: $res = $this->bus_activity->save($data, ["\151\x64" => $id]); goto gq15w; LQpqk: } public function getActivityInfo($id) { goto WDBcw; tatvX: $list["\x65\x6e\x64\137\x74\151\x6d\145"] = date("\131\55\155\x2d\x64\x20\x48\72\x69\72\x73", $list["\x65\156\144\x5f\x74\x69\x6d\x65"]); goto kV2M4; kV2M4: return $list; goto Hub7s; BXKMC: $list["\163\164\141\x72\137\164\151\155\x65"] = date("\131\55\155\x2d\x64\x20\x48\72\151\72\x73", $list["\x73\x74\x61\162\137\164\x69\155\145"]); goto tatvX; WDBcw: $list = $this->bus_activity->getInfo(["\x69\144" => $id]); goto BXKMC; Hub7s: } public function delActivity($id, $mch_id) { $list = $this->bus_activity->destroy(["\x69\144" => $id, "\155\x63\150\x5f\151\x64" => $mch_id]); return $list; } public function offActivity($id) { goto PC7O3; sj7_m: return $res; goto LJWI9; PC7O3: $data = array("\151\x73\x5f\165\x73\145" => 2); goto Z4eqY; Z4eqY: $res = $this->bus_activity->save($data, ["\151\144" => $id]); goto sj7_m; LJWI9: } public function onActivity($id) { goto BNbF6; QVvPc: $res = $this->bus_activity->save($data, ["\x69\144" => $id]); goto XL9No; XL9No: return $res; goto kyBzQ; BNbF6: $data = array("\151\163\137\165\163\x65" => 1); goto QVvPc; kyBzQ: } public function get_order_list($condition, $order_no = '') { goto jGszs; FwbGU: isQ5m: goto sYnvj; VM0d3: $condition["\x6f\x2e\x6f\162\x64\145\162\x5f\151\x64"] = $num_list[$s]["\x6f\x72\144\x65\x72\x5f\x69\x64"]; goto JXGr9; P3wEf: $list[$i]["\163\x68\x61\162\x65\137\144\145\164\x61\x69\x6c"] = $this->get_share_detail($list[$i]["\163\150\141\x72\145\x5f\144\x65\x74\141\x69\x6c"][$i]); goto qwSQ9; uu751: $a = $num_list[$s]; goto B2hUC; bu32g: $list[$i]["\x73\150\x61\162\145\137\x64\145\x74\141\x69\x6c"][$i]["\x73\x70\162\151\143\145"] = $list[$i]["\x73\x70\162\x69\x63\145"]; goto PYROT; Px7jK: $s++; goto yvfBS; SlOfw: $num_list = db::name("\x79\x62\x73\143\137\157\x72\144\x65\x72\x5f\147\x6f\157\144\x73")->alias("\147")->join("\171\x62\x73\143\x5f\157\162\144\x65\162\x5f\x73\150\x61\x72\x65\x20\x73", "\x73\56\157\162\x64\145\x72\x5f\151\x64\x3d\x67\56\x6f\162\144\145\162\x5f\151\x64")->field("\x67\x2e\x6f\x72\x64\145\x72\x5f\151\144\54\143\157\165\156\x74\x28\x27\x73\x2e\x6f\162\144\145\x72\x5f\151\144\x27\x29\x20\x6e\x75\x6d\163")->where($condition)->group("\x73\x2e\x6f\162\x64\145\162\x5f\x69\x64")->order("\x73\56\157\162\144\145\162\x5f\151\144\40\x64\145\163\143")->paginate(10, false, $config = ["\161\165\x65\x72\171" => ["\x73" => $url, "\x73\x65\x61\162\x63\x68\137\x74\x65\x78\164" => $order_no]]); goto vE107; oC52a: gsP0Q: goto uqGYP; gdvD0: $a["\147\157\x6f\144\x73\x5f\x5f"][$j]["\147\157\x6f\x64\x73\137\156\141\x6d\x65"] = $list[$j]["\147\157\x6f\x64\x73\x5f\156\x61\x6d\145"]; goto Ltj1Q; O7M3z: unset($list[$i]["\x70\151\x64\63"]); goto cfvKo; B2hUC: $a["\x67\157\157\x64\163\x5f\x6e\x61\155\x65"] = "\55\x39\x39"; goto puNve; dWs8k: D9ZVt: goto cUgd3; PYROT: $list[$i]["\x73\x68\141\x72\145\137\144\145\164\x61\151\154"][$i]["\x74\x70\x72\x69\x63\x65"] = $list[$i]["\164\160\x72\x69\143\x65"]; goto P3wEf; KilB_: $a = array(); goto CewCV; iUe5s: $url = explode("\x26", $url[1]); goto NQSFs; ZHEYs: $i = 0; goto oC52a; cUgd3: Ke_wa: goto Px7jK; VXkfu: $a["\147\157\157\x64\163\x5f\x5f"][$j]["\x6e\165\x6d"] = $list[$j]["\156\x75\155"]; goto iJ4Oh; fWNK4: $url = explode("\x3d\x2f", $url); goto iUe5s; sYnvj: if (!($j < count($list))) { goto axpWu; } goto Pmb_X; nH7Kh: $list[$i]["\x73\150\141\162\x65\137\x64\145\x74\x61\x69\154"][$i]["\x70\x69\x64\x33"] = $list[$i]["\x70\x69\144\x33"]; goto KS4Ra; uqGYP: if (!($i < count($list))) { goto fUssn; } goto DPjcE; B5PTo: $lists = $num_list[$s]["\156\x75\x6d\163"]; goto emWs4; D8YG3: $j++; goto pij2Z; qwSQ9: unset($list[$i]["\x70\x69\x64\61"]); goto c6I4y; DPjcE: $list[$i]["\x73\150\141\162\x65\137\144\x65\164\141\x69\154"][$i]["\160\151\144\61"] = $list[$i]["\x70\x69\x64\61"]; goto bIXLH; IMnuY: if (!($s < count($num_list))) { goto bDH2q; } goto VM0d3; emWs4: $num_list[$s] = $list[0]; goto KilB_; Ltj1Q: $a["\147\x6f\x6f\144\x73\x5f\x5f"][$j]["\160\162\x69\x63\145"] = $list[$j]["\160\162\151\x63\x65"]; goto VXkfu; Pmb_X: $a["\x67\157\157\x64\x73\x5f\137"][$j]["\151\x6d\x67\137\x70\141\x74\x68"] = $list[$j]["\151\155\147\x5f\160\141\x74\150"]; goto gdvD0; cfvKo: unset($list[$i]["\146\160\x72\151\x63\145"]); goto D6S3T; puNve: $j = 0; goto FwbGU; bIXLH: $list[$i]["\163\x68\141\162\145\137\144\x65\x74\141\x69\154"][$i]["\160\151\x64\62"] = $list[$i]["\160\151\144\62"]; goto nH7Kh; vfaKp: hgAF0: goto JCO3m; aFw6d: goto gsP0Q; goto d6kd_; AwDvs: unset($list[$i]["\x74\x70\x72\151\x63\x65"]); goto YN6gp; eDFe9: axpWu: goto g0Bls; NQSFs: $url = "\x2f" . $url[0]; goto ChKJW; yvfBS: goto JmisV; goto u5KrR; s3HoR: $list[$i]["\157\x72\144\x65\162\137\163\x74\141\x74\165\163"] = $status[strval($list[$i]["\157\x72\x64\145\x72\x5f\x73\164\x61\x74\x75\163"])]; goto vfaKp; wIMMf: JmisV: goto IMnuY; jGszs: $url = request()->query(); goto fWNK4; KS4Ra: $list[$i]["\163\150\x61\x72\x65\137\144\145\x74\141\x69\154"][$i]["\146\x70\162\x69\x63\145"] = $list[$i]["\146\x70\162\151\143\x65"]; goto bu32g; pij2Z: goto isQ5m; goto eDFe9; ff_31: return $num_list; goto G_kqd; d6kd_: fUssn: goto B5PTo; ChKJW: $status = $this->contr_order_status; goto SlOfw; YN6gp: $list[$i]["\157\x72\144\145\162\x5f\x74\151\x6d\x65"] = date("\131\55\155\55\144\40\x48\72\x69\72\x73", $list[$i]["\x6f\x72\x64\x65\162\137\x74\x69\155\145"]); goto s3HoR; iJ4Oh: wZA4A: goto D8YG3; vE107: $s = 0; goto wIMMf; D6S3T: unset($list[$i]["\x73\x70\x72\x69\x63\145"]); goto AwDvs; u5KrR: bDH2q: goto ff_31; JCO3m: $i++; goto aFw6d; c6I4y: unset($list[$i]["\160\x69\x64\x32"]); goto O7M3z; g0Bls: $num_list[$s] = $a; goto dWs8k; JXGr9: $list = db::name("\171\142\x73\143\137\157\x72\x64\x65\162")->alias("\x6f")->join("\171\x62\x73\143\x5f\x75\163\145\x72\x20\165", "\x6f\x2e\x62\165\x79\145\x72\x5f\x69\x64\75\165\x2e\165\x69\144")->join("\171\x62\x73\143\x5f\157\x72\x64\x65\162\137\163\x68\x61\x72\x65\x20\163", "\163\x2e\x6f\x72\144\x65\x72\x5f\151\x64\x3d\157\56\x6f\162\x64\x65\x72\137\151\x64")->join("\x79\x62\163\143\x5f\x6f\162\x64\145\162\x5f\147\x6f\x6f\x64\x73\40\147", "\147\x2e\x6f\162\x64\145\162\x5f\151\x64\75\157\x2e\x6f\x72\144\x65\162\137\x69\x64")->join("\x79\x62\x73\x63\x5f\151\x6d\141\147\x65\163\x20\151", "\151\x2e\151\x6d\x67\x5f\151\144\x3d\x67\56\147\x6f\157\144\x73\137\x69\x6d\141\147\145\163")->field("\157\x2e\x6f\162\x64\x65\x72\137\151\x64\54\x67\x2e\x67\157\157\144\163\137\156\141\155\145\x2c\x69\56\x69\x6d\x67\x5f\143\157\x76\x65\x72\40\x69\x6d\x67\x5f\160\x61\164\x68\x2c\157\56\x6f\x72\x64\x65\x72\137\156\157\54\x6f\56\157\x75\x74\x5f\x74\162\x61\144\x65\137\x6e\157\x2c\163\56\x63\x72\145\x61\164\145\x5f\164\151\x6d\x65\40\157\x72\144\x65\162\137\x74\151\x6d\x65\54\x67\56\160\x72\151\143\x65\x2c\147\x2e\156\165\155\54\165\56\156\151\143\x6b\137\156\141\155\145\54\157\56\x70\x61\171\137\155\x6f\x6e\x65\171\54\x6f\x2e\x6f\x72\144\x65\x72\x5f\x73\x74\141\x74\165\x73\54\x73\56\160\141\x72\145\156\x74\x5f\151\144\137\61\x20\160\151\x64\61\54\163\56\160\141\x72\x65\x6e\x74\x5f\151\144\x5f\x32\40\160\151\x64\x32\54\x73\56\160\x61\162\x65\x6e\x74\x5f\151\144\137\63\40\x70\151\x64\x33\54\x73\56\x66\151\x72\163\164\x5f\160\x72\x69\143\x65\x20\x66\x70\x72\151\x63\x65\54\x73\56\x73\x65\x63\x6f\156\144\x5f\x70\x72\151\x63\x65\40\x73\160\x72\x69\x63\x65\x2c\163\56\x74\150\151\162\144\x5f\160\162\151\143\145\40\x74\x70\162\151\x63\145\54\x73\56\162\145\x62\x61\x74\145")->order("\157\56\x6f\x72\x64\x65\x72\137\x69\x64\40\x64\x65\x73\143")->where($condition)->select(); goto ZHEYs; CewCV: if (!($lists > 1)) { goto D9ZVt; } goto uu751; G_kqd: } public function get_share_detail($arr) { goto qTLB1; kUB_n: $i++; goto DhcNR; AFRUS: $res[$i]["\x73\x68\141\x72\145"] = $share["\163\156\x61\155\145"]; goto EKcLw; kFZwL: jE5Du: goto rCJZW; tNKFO: $res = array(); goto mP0Fr; mP0Fr: if (!($arr["\160\x69\x64\x31"] > 0)) { goto jE5Du; } goto pkCW5; EKcLw: $res[$i]["\160\162\x69\143\x65"] = $arr["\x73\160\162\151\x63\x65"]; goto kUB_n; DhcNR: n2c3R: goto bYT1q; YaFKw: $res[$i]["\x70\x72\x69\x63\x65"] = $arr["\146\x70\162\151\143\x65"]; goto CYldn; BzH8Y: $res[$i]["\163\150\141\x72\x65"] = $share["\x66\156\x61\x6d\145"]; goto YaFKw; CYldn: $i++; goto kFZwL; KYhQ3: $res[$i]["\156\x61\155\x65"] = $name["\156\151\x63\x6b\x5f\x6e\141\x6d\x65"]; goto BzH8Y; MkLH8: $res[$i]["\x73\150\141\162\145"] = $share["\164\156\x61\155\x65"]; goto TSZmT; rCJZW: if (!($arr["\160\x69\144\x32"] > 0)) { goto n2c3R; } goto aX2Qx; oNOHy: YNMDC: goto Ur6Mz; TSZmT: $res[$i]["\x70\x72\151\x63\x65"] = $arr["\x74\x70\x72\x69\x63\x65"]; goto oNOHy; aX2Qx: $name = db::name("\171\142\x73\143\x5f\x75\x73\x65\x72")->field("\x6e\151\x63\153\137\156\141\x6d\x65")->where("\165\x69\x64", $arr["\160\151\x64\x32"])->find(); goto jUYZq; cCEyF: $res[$i]["\156\x61\x6d\x65"] = $name["\156\x69\143\x6b\137\x6e\x61\x6d\145"]; goto MkLH8; XU2aj: $share = db::name("\171\x62\163\143\x5f\165\163\x65\162\137\x73\x68\x61\x72\145\x5f\x73\145\164\164\151\156\x67")->field("\146\x69\162\x73\x74\x5f\x6e\141\155\x65\x20\x66\156\141\x6d\x65\54\163\x65\143\157\x6e\x64\137\156\x61\x6d\x65\x20\x73\x6e\x61\x6d\145\54\x74\150\151\162\x64\137\156\x61\x6d\145\x20\164\x6e\x61\155\145")->where("\x6d\x63\150\137\151\144", $conid)->find(); goto MZJzm; bYT1q: if (!($arr["\x70\x69\144\63"] > 0)) { goto YNMDC; } goto TDrYe; jUYZq: $res[$i]["\x6e\141\x6d\145"] = $name["\x6e\151\x63\153\x5f\x6e\x61\x6d\145"]; goto AFRUS; MZJzm: $i = 0; goto tNKFO; TDrYe: $name = db::name("\171\x62\x73\x63\137\x75\x73\145\162")->field("\x6e\x69\143\153\137\156\x61\155\x65")->where("\165\x69\144", $arr["\x70\151\x64\63"])->find(); goto cCEyF; qTLB1: $conid = $this->bus_id; goto XU2aj; pkCW5: $name = db::name("\171\142\x73\143\x5f\165\x73\x65\x72")->field("\156\x69\143\x6b\137\x6e\141\x6d\145")->where("\165\x69\144", $arr["\160\151\144\x31"])->find(); goto KYhQ3; Ur6Mz: return $res; goto Nl620; Nl620: } public function get_child_share($pid, $chioce = "\x2d\61", $deep = 3) { goto bv42u; lEQ8y: if (!($chioce >= 1 && $chioce != "\55\61")) { goto czhDu; } goto f_3Vl; pd84f: d6kUG: goto gCmL7; hHMIA: $i = 0; goto pd84f; aZJUf: if (!($s < count($pids))) { goto CgBMP; } goto g2786; IsCob: $res[$i + 1]["\x63\x6e\165\155"] = count($child); goto Vn3o0; zl8Pt: $child = array(); goto AnHxJ; sjTai: if (!($pid == 0)) { goto GkFZI; } goto rLoaG; ac8Zd: pCgPf: goto lEQ8y; GSMpj: Z4fdY: goto aZJUf; NMuRJ: return $res[$chioce]; goto cBbbI; QLGcX: $child = db::name("\x79\x62\163\143\137\x75\x73\145\x72")->field("\165\151\x64\54\x6e\x69\x63\153\x5f\156\141\155\x65\x2c\162\x65\147\x5f\x74\151\155\145\54\164\x6f\164\141\x6c\x5f\160\162\151\143\145\54\x70\151\144")->where($condition)->select(); goto sCuC9; cBbbI: czhDu: goto oXq3W; f_3Vl: unset($res[$chioce]["\x63\x6e\165\x6d"]); goto NMuRJ; gCmL7: if (!($i < $deep)) { goto pCgPf; } goto zl8Pt; rLoaG: goto pCgPf; goto XsLzJ; bv42u: $res = array(); goto kWzMY; sCuC9: $res[$i + 1] = $child; goto IsCob; g2786: $pid = $pid . $pids[$s]["\x75\x69\x64"] . "\54"; goto GdrL9; oj88B: $condition["\160\151\x64"] = ["\x69\156", $pid]; goto QLGcX; AnHxJ: $condition = array(); goto oj88B; PB0DO: $s = 0; goto GSMpj; GKAg_: goto d6kUG; goto ac8Zd; C05WD: $pid = ''; goto PB0DO; kWzMY: $old_id = $pid; goto hHMIA; Q6b4D: $i++; goto GKAg_; GdrL9: aJp1R: goto Xuepr; Xuepr: $s++; goto lrz7H; oXq3W: return $res; goto kRC2C; lrz7H: goto Z4fdY; goto TiTyS; igMux: $pid = substr($pid, 0, strlen($pid) - 1); goto sjTai; PvAcN: IXkkq: goto Q6b4D; XsLzJ: GkFZI: goto PvAcN; Vn3o0: $pids = db::name("\171\142\x73\143\x5f\x75\163\145\162")->field("\165\x69\144")->where($condition)->select(); goto C05WD; TiTyS: CgBMP: goto igMux; kRC2C: } public function screen_id($db_name, $id_arr, $id_name, $check_num, $check_name) { goto MeB1H; wITcV: if (!($verify[$check_name] == $check_num)) { goto kqfdW; } goto KW3qZ; ZJvjh: HbnX6: goto ZNiRd; Qv71x: $i = 0; goto B3Bhf; B3Bhf: UDhxe: goto EkYvX; Vvyhy: return implode("\54", $res); goto SDf_G; ZNiRd: $i++; goto hToX6; EkYvX: if (!($i < count($id_arr))) { goto k9S9S; } goto wzgtV; wzgtV: $verify = db::name($db_name)->field($check_name)->where($id_name, $id_arr[$i])->find(); goto wITcV; JicZu: kqfdW: goto ZJvjh; KW3qZ: array_push($res, $id_arr[$i]); goto JicZu; q4GSk: is_array($id_arr) ? '' : ($id_arr = explode("\54", $id_arr)); goto Qv71x; vgM_N: k9S9S: goto Vvyhy; hToX6: goto UDhxe; goto vgM_N; MeB1H: $res = array(); goto q4GSk; SDf_G: } }
