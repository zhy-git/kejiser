<?php
 namespace app\admin\service; use app\common\model\AdminGroup; use app\common\model\AdminModule; use think\Session; class Admin extends Base { function __construct() { goto hGzPB; MPy94: $this->admin_module = new AdminModule(); goto Ag7gj; szIY0: $this->admin = new \app\common\model\Admin(); goto MPy94; hGzPB: parent::__construct(); goto szIY0; Ag7gj: } private function initLoginInfo($user_info) { goto i3Jj7; Dc35Y: $auth_group = new AdminGroup(); goto gDDN6; NGCsZ: Session::set("\151\163\137\x61\144\x6d\x69\x6e", $user_info["\x69\x73\x5f\x61\x64\155\x69\156"]); goto Dc35Y; Uv5_V: Session::set("\155\x6f\x64\165\x6c\x65\137\151\144\x5f\x61\x72\162\x61\171", $no_control . $auth["\x6d\157\x64\165\x6c\145\137\x69\x64\137\x61\x72\162\x61\x79"]); goto JU2gN; xu3qU: $no_control = $this->getNoControlAuth(); goto Uv5_V; gDDN6: $auth = $auth_group->get($user_info["\162\157\x6c\145\x5f\x69\144\137\x61\162\162\x61\171"]); goto xu3qU; i3Jj7: Session::set("\x61\144\155\x69\x6e\137\151\144", $user_info["\151\x64"]); goto NGCsZ; JU2gN: } public function getAdminLisy($condition, $search_text) { $list = $this->admin->getAdminLisy($condition, $search_text); return $list; } public function deleteAdminUser($admin_id) { goto OJ4Xb; pCFXI: return $retval; goto ujq5Y; ujq5Y: Bx6r6: goto Zniaj; HuwQn: goto Bx6r6; goto TpQbB; YyGqy: if ($admin_user_info["\151\163\x5f\x61\x64\155\151\x6e"] == 0) { goto lxux2; } goto TwnWx; OJ4Xb: $admin_user_info = $this->admin->getInfo(["\x69\x64" => $admin_id]); goto YyGqy; TwnWx: return 0; goto HuwQn; tKbii: $retval = $this->admin->destroy($admin_id); goto pCFXI; TpQbB: lxux2: goto tKbii; Zniaj: } public function resetUserPassword($admin_id) { $retval = $this->admin->save(["\160\x61\x73\163\167\157\x72\144" => md5(123456)], ["\151\144" => $admin_id]); return $retval; } public function login($user_name, $password = '') { goto G1lRc; eED18: $condition = array("\x75\163\145\162\x5f\156\x61\155\145" => $user_name, "\160\x61\x73\x73\167\157\162\x64" => md5($password), "\141\144\155\x69\x6e\137\x73\164\x61\164\165\x73" => 1); goto f3SSK; ugbRL: return 1; goto pf1u4; pf1u4: wS_OL: goto Mix0h; RiQPj: HSSFp: goto QoR52; QoR52: $this->initLoginInfo($user_info); goto ugbRL; R3TUw: if (!empty($user_info)) { goto HSSFp; } goto VCNKE; VCNKE: return 0; goto qAKhy; qAKhy: goto wS_OL; goto RiQPj; f3SSK: $user_info = $this->admin->getInfo($condition, $field = "\x69\144\54\x75\x73\x65\x72\137\156\141\x6d\145\54\151\x73\137\x61\x64\155\x69\156\54\x72\157\x6c\145\x5f\x69\144\137\x61\162\x72\x61\x79"); goto R3TUw; G1lRc: $this->Logout(); goto eED18; Mix0h: } public function addAdminUser($user_name, $group_id, $password, $info) { goto NTOmw; wUXYc: return $res; goto TdLmh; W55QH: $res = $this->admin->save($data_admin); goto wUXYc; NTOmw: $data_admin = array("\x75\x73\145\162\x5f\156\x61\x6d\x65" => $user_name, "\156\x61\x6d\145" => $user_name, "\x72\157\x6c\x65\x5f\x69\x64\137\141\162\162\141\171" => $group_id, "\160\141\x73\163\x77\x6f\x72\x64" => md5($password), "\141\144\x6d\x69\156\137\163\164\x61\x74\x75\163" => 1, "\x69\x6e\x66\157" => $info, "\143\x72\x65\x61\164\145\137\164\x69\x6d\145" => time()); goto W55QH; TdLmh: } public function editAdminUser($admin_id, $user_name, $group_id, $info, $admin_status) { goto UNhsa; LcLqa: return $res; goto ET5IR; UNhsa: $res = $this->ModifyUserName($admin_id, $user_name); goto th40k; Z42ZO: PwBp8: goto LcLqa; th40k: if (!$res) { goto PwBp8; } goto NRi5o; NRi5o: $data = array("\165\163\x65\x72\x5f\156\141\155\x65" => $user_name, "\x72\157\154\x65\137\x69\144\x5f\x61\x72\x72\141\x79" => $group_id, "\141\144\x6d\x69\x6e\x5f\x73\164\141\x74\x75\x73" => $admin_status, "\x69\x6e\x66\x6f" => $info); goto DzWGK; DzWGK: $res = $this->admin->save($data, ["\151\144" => $admin_id]); goto Z42ZO; ET5IR: } public function ModifyUserName($admin_id, $user_name) { goto XjAO6; Ecxwe: return USER_REPEAT; goto ku_La; MvXnh: if (!($info["\x75\x73\x65\162\x5f\156\141\x6d\145"] == $user_name)) { goto jYDtv; } goto SJM2H; ku_La: d8Qal: goto NUUmf; Wpkp8: $count = $this->admin->where(["\x75\x73\x65\162\137\156\x61\155\x65" => $user_name])->count(); goto JmrQn; kezpr: jYDtv: goto Wpkp8; XjAO6: $info = $this->admin->get($admin_id); goto MvXnh; SJM2H: return 1; goto kezpr; JmrQn: if (!($count > 0)) { goto d8Qal; } goto Ecxwe; NUUmf: } public function Logout() { goto vIX8p; X0Dbn: Session::set("\151\x73\x5f\x61\144\x6d\151\156", ''); goto kZPWp; kZPWp: Session::set("\162\x6f\x6c\145\x5f\x69\x64\137\x61\162\x72\141\x79", ''); goto m74Zj; vIX8p: Session::set("\141\144\155\151\x6e\137\151\x64", ''); goto X0Dbn; m74Zj: } public function adminLock($admin_id) { $retval = $this->admin->save(["\141\144\155\151\x6e\x5f\x73\164\x61\x74\x75\x73" => 0], ["\x69\144" => $admin_id]); return $retval; } public function adminUnlock($admin_id) { $retval = $this->admin->save(["\141\144\155\x69\156\x5f\x73\164\x61\164\165\x73" => 1], ["\x69\144" => $admin_id]); return $retval; } private function getNoControlAuth() { goto Zane9; izAob: return $str; goto ykZeG; Zane9: $moudle = new AdminModule(); goto h111S; PcSrf: $str = ''; goto HRVV9; h111S: $list = $moudle->getQuerys(["\151\163\137\x63\157\x6e\164\x72\x6f\154\x5f\141\165\164\x68" => 0], "\155\x6f\x64\x75\154\x65\x5f\x69\x64", ''); goto PcSrf; HRVV9: foreach ($list as $v) { $str .= $v["\155\x6f\144\165\154\145\x5f\x69\x64"] . "\54"; Hjqy4: } goto uM6q9; uM6q9: CI4Wq: goto izAob; ykZeG: } public function getSessionAdminId() { return $this->admin_id; } public function getchildModuleQuery($moduleid) { goto Y5h0_; H_cfF: return $new_list; goto dmTGk; SOjSG: $list = $auth_group->getAuthList($moduleid); goto Q_26_; Y5h0_: $auth_group = new AdminModule(); goto SOjSG; Q_26_: $new_list = $list; goto H_cfF; dmTGk: } public function selectAll() { goto b3AjK; DB1fn: return $list; goto PbegA; Iem7J: $list = $auth_group->getAuthListLevel(2); goto DB1fn; b3AjK: $auth_group = new AdminModule(); goto Iem7J; PbegA: } public function checkAuth($module_id) { goto QMRaf; ajMm2: y1lg5: goto crG58; crG58: return 1; goto pbXuZ; C_ch6: return 1; goto Wh2S7; NZjZS: U3FR4: goto C_ch6; dr6Nm: if (in_array($module_id, $module_id_array)) { goto U3FR4; } goto eIG2_; Wh2S7: ICHOd: goto EhaBc; QMRaf: if ($this->is_admin) { goto y1lg5; } goto ria5T; eIG2_: return 0; goto NObgd; EhaBc: goto GYWlv; goto ajMm2; ria5T: $module_id_array = explode("\54", $this->module_id_array); goto dr6Nm; NObgd: goto ICHOd; goto NZjZS; pbXuZ: GYWlv: goto EdSUt; EdSUt: } public function getModuleIdByModule($controller, $action) { $res = $this->admin_module->getModuleIdByModule($controller, $action); return $res; } public function getAdminInfo() { $res = $this->admin->getInfo("\x69\144\75" . $this->admin_id, "\52"); return $res; } public function getAdminUserInfo($condition, $field = "\52") { $admin_user_info = $this->admin->getInfo($condition, $field = "\52"); return $admin_user_info; } public function getSystemModuleInfo($module_id, $field = "\x2a") { $res = $this->admin_module->getInfo(array("\155\157\x64\165\154\x65\x5f\151\144" => $module_id), $field); return $res; } public function getModuleRootAndSecondMenu($module_id) { goto m8J8d; X_gHt: goto PQBXU; goto Vln0j; m8J8d: $count = $this->admin_module->where(["\x6d\x6f\x64\165\154\x65\137\151\x64" => $module_id])->count(); goto t8Y3d; wEmo0: $pid = $module["\x70\x69\144"]; goto X_gHt; LQk5K: goto Rt1Gu; goto Qqm6o; sTSbL: return array($module["\160\x69\x64"], $module["\x6d\x6f\144\x75\x6c\x65\137\151\x64"]); goto Tzm8x; Qqm6o: jjGo7: goto PT4Vv; Nmgyk: $module = $this->admin_module->getInfo(["\x6d\x6f\x64\x75\154\x65\137\151\144" => $pid, "\x70\151\x64" => array("\156\145\161", 0)], "\x70\x69\144\54\x20\155\x6f\144\x75\x6c\x65\x5f\151\144\x2c\x20\154\x65\166\145\x6c"); goto p3sJT; l09cT: $pid = $info["\x70\151\144"]; goto J3YOV; EgAKT: Rt1Gu: goto aaT9_; Vln0j: uS0Mw: goto jYV1b; JX2go: if (empty($info)) { goto jjGo7; } goto HWGDJ; Jr1lj: goto WIMcP; goto iCS30; Tzm8x: PQBXU: goto Jr1lj; f7P1k: PBRyP: goto LQk5K; W0EGw: Ss3Xl: goto hFflk; t8Y3d: if (!($count == 0)) { goto DN5S1; } goto wdwNK; PT4Vv: return array($module_id, 0); goto EgAKT; p3sJT: if ($module["\154\145\166\x65\x6c"] == 2) { goto uS0Mw; } goto wEmo0; jYV1b: $pid = 0; goto sTSbL; iCS30: v5TfX: goto zpgxn; zpgxn: goto PBRyP; goto W0EGw; LXm7y: $info = $this->admin_module->getInfo(["\155\x6f\x64\165\x6c\x65\137\151\x64" => $module_id, "\160\151\144" => array("\x6e\145\x71", 0)], "\x70\x69\x64\54\x20\154\145\166\x65\154"); goto JX2go; hFflk: return array($info["\x70\151\144"], $module_id); goto f7P1k; vJZRD: DN5S1: goto LXm7y; HWGDJ: if ($info["\x6c\145\166\x65\154"] == 2) { goto Ss3Xl; } goto l09cT; J3YOV: WIMcP: goto MdO3m; MdO3m: if (!($pid != 0)) { goto v5TfX; } goto Nmgyk; wdwNK: return array(0, 0); goto vJZRD; aaT9_: } }
