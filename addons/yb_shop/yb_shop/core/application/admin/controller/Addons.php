<?php
 namespace app\admin\controller; use app\admin\service\AdminModel; use app\common\model\AdminModule; use app\common\model\Module; use think\Db; class Addons extends Base { protected $addons; public function __construct() { $this->addons = new \app\admin\service\Addons(); parent::__construct(); } public function index() { goto wZWKA; ijMR7: $this->assign("\154\151\163\x74", $list); goto q1YYA; nKeKG: $list = $addons->getAddonsList(); goto ijMR7; q1YYA: return view("\x61\x64\144\157\156\x73\57\x69\x6e\x64\x65\170"); goto WlpVa; wZWKA: $addons = new \app\admin\service\Addons(); goto nKeKG; WlpVa: } public function install() { goto Fwgv_; lS4rD: if ($res) { goto g33DN; } goto k_2_Q; m_H8F: wrD9c: goto Nx8VU; CfWTt: if (class_exists($class)) { goto eErYl; } goto Bu6SL; pKS7q: if ($hooks_update) { goto xYu83; } goto q7Nxy; g3qOL: cache("\x68\157\157\x6b\163", null); goto NddXR; OfHQJ: if ($install_flag) { goto HGQeH; } goto R39eW; zclEY: $this->error("\346\233\264\346\226\260\xe9\x92\251\xe5\255\220\345\xa4\x84\xe6\217\222\344\xbb\266\345\xa4\261\xe8\xb4\245\54\xe8\xaf\xb7\xe5\x8d\270\xe8\xbd\275\xe5\x90\216\345\260\x9d\xe8\257\x95\xe9\207\215\346\x96\260\xe5\256\x89\xe8\243\x85"); goto Zyr_o; NddXR: $this->success("\xe5\256\211\xe8\243\205\346\210\220\xe5\x8a\x9f"); goto ZE3cf; WQCHq: eErYl: goto NKLXI; Wacjk: $module_model = new Module(); goto BXWpm; E2ik4: $res = $this->addons->addAddons($info["\156\141\155\145"], $info["\x74\x69\x74\x6c\x65"], $info["\144\145\x73\143"], $info["\163\x74\x61\x74\x75\163"], $info["\x63\157\156\146\x69\x67"], $info["\x61\x75\x74\150\x6f\x72"], $info["\x76\145\x72\163\151\x6f\x6e"], $info["\143\157\156\164\x65\156\164"]); goto lS4rD; Bu6SL: $this->error("\346\217\222\xe4\xbb\266\xe4\xb8\215\xe5\xad\230\345\234\xa8"); goto WQCHq; Fwgv_: $addons = new \app\admin\service\Addons(); goto RGHkT; BXWpm: foreach ($menu as $k => $v) { goto Syket; ixoqr: $method = "\155\x65\x6e\x75\x5f" . $controller; goto DTirW; bKY6x: goto m0po9; goto nMU0M; bp3jU: juoZH: goto lAP6z; qdnXS: $res = $website->addSytemModule($v["\x6d\x6f\144\165\x6c\x65\x5f\x6e\141\155\145"], $controller, $method, $parent_module_info["\x6d\x6f\x64\x75\154\145\x5f\x69\x64"], $url, $v["\151\x73\x5f\155\x65\156\165"], $last_module_id["\x73\157\x72\164"], $v["\151\143\157\156\x5f\x63\x6c\x61\x73\x73"], $v["\x64\145\163\143"], $v["\151\x73\x5f\x63\157\156\x74\x72\x6f\x6c\137\141\165\164\150"]); goto z83hJ; H0a3B: m0po9: goto ixoqr; GC7TS: if (empty($parent_module_info)) { goto cSomJ; } goto vhJGJ; DTirW: $url = "\x41\144\144\x6f\156\163" . "\x2f\x6d\145\x6e\165\137" . $controller . "\77\x61\144\x64\157\x6e\163\x3d" . $v["\150\157\x6f\x6b\x5f\156\x61\x6d\x65"]; goto tcK4e; lAP6z: xT2f9: goto UcKDu; xVzBk: $this->error("\xe5\xae\211\350\243\205\xe8\x8f\234\xe5\215\225\xe6\x93\215\344\275\234\xe5\xa4\261\350\264\245\357\xbc\214\xe8\257\267\xe6\xa3\x80\xe6\x9f\245\350\x8f\x9c\345\215\x95\351\x85\x8d\347\275\256"); goto rz6cf; RlLqH: $controller = $v["\160\x61\x72\x65\x6e\x74\x5f\155\x6f\144\165\154\145\137\x6e\x61\155\145"]; goto H0a3B; W2ZUs: $addons->uninstall(); goto xVzBk; vhJGJ: $controller = $parent_module_info["\x63\157\156\164\x72\x6f\x6c\x6c\145\x72"]; goto bKY6x; Syket: $parent_module_info = $module_model->getInfo(["\x6d\x6f\x64\165\x6c\145\137\x6e\x61\155\145" => $v["\x70\141\162\145\x6e\164\137\x6d\x6f\144\x75\x6c\x65\137\156\x61\155\x65"]], "\155\157\x64\165\x6c\145\137\x69\144\x2c\x20\143\157\x6e\x74\x72\x6f\154\x6c\x65\162"); goto GC7TS; rz6cf: goto wrD9c; goto bp3jU; tcK4e: $last_module_id = $module_model->getInfo(["\x6d\x6f\144\x75\x6c\x65\137\x6e\141\155\145" => $v["\154\x61\163\164\x5f\155\157\x64\165\154\x65\137\x6e\141\155\x65"]], "\155\157\x64\165\154\145\137\151\x64\x2c\x20\163\x6f\162\x74"); goto qdnXS; z83hJ: if ($res) { goto juoZH; } goto W2ZUs; nMU0M: cSomJ: goto RlLqH; UcKDu: } goto m_H8F; SDNIA: session("\141\144\144\x6f\x6e\x73\x5f\151\156\x73\164\141\x6c\x6c\137\145\x72\x72\x6f\x72", null); goto ixcVt; A_F9B: $class = get_addon_class($addon_name); goto CfWTt; AJ_Zq: $website = new AdminModel(); goto Wacjk; ayGwO: g33DN: goto p0yxd; p0yxd: $hooks_update = $this->addons->updateHooks($addon_name); goto pKS7q; R39eW: $this->error("\xe6\211\xa7\350\xa1\x8c\xe6\x8f\x92\344\xbb\266\xe9\242\x84\xe5\256\211\350\243\x85\346\223\215\xe4\275\x9c\345\244\261\xe8\xb4\245" . session("\141\x64\x64\x6f\156\163\x5f\151\156\x73\164\x61\x6c\154\137\145\x72\162\x6f\x72")); goto bGrMj; iIkcN: $info["\x63\x6f\x6e\146\x69\147"] = json_encode($addons->getOneConfig()); goto E2ik4; ZE3cf: X5Q2t: goto ZDIod; Zyr_o: goto X5Q2t; goto XmMmG; Nx8VU: lSVOy: goto iIkcN; rZ_84: $menu = $addons->menu_info; goto AJ_Zq; ZDIod: V3EeN: goto NnwUI; BJRbX: $info = $addons->info; goto nAtmE; bGrMj: HGQeH: goto qKlet; k_2_Q: $this->error("\345\206\x99\345\x85\xa5\xe6\217\222\344\273\266\346\225\xb0\xe6\x8d\256\xe5\xa4\261\xe8\264\245"); goto NnfK0; aAK9v: $this->error("\346\x8f\222\344\xbb\266\344\xbf\241\346\x81\xaf\347\274\272\xe5\244\261"); goto GXr0a; nAtmE: if ($info) { goto xhSm8; } goto aAK9v; RGHkT: $addon_name = trim(request()->get("\x61\144\x64\x6f\x6e\137\156\141\155\x65", '')); goto A_F9B; GXr0a: xhSm8: goto SDNIA; NnfK0: goto V3EeN; goto ayGwO; NKLXI: $addons = new $class(); goto BJRbX; XmMmG: xYu83: goto g3qOL; ixcVt: $install_flag = $addons->install(); goto OfHQJ; q7Nxy: $this->addons->deleteAddons(["\156\x61\155\145" => $addon_name]); goto zclEY; qKlet: if (!(is_array($addons->menu_info) && $addons->menu_info !== array())) { goto lSVOy; } goto rZ_84; NnwUI: } public function uninstall() { goto RZ4KP; yBPXQ: if ($delete === false) { goto d5Gff; } goto iwx2f; As1Mp: cache("\x68\157\157\x6b\163", null); goto xYPW_; qekEW: UBwqn: goto As1Mp; zjfn1: if (!(!$db_addons || !class_exists($class))) { goto hogIv; } goto ywmkq; RN31U: $module_model = new AdminModule(); goto h9YY6; R3yl7: $uninstall_flag = $addons->uninstall(); goto E0TE0; WmW8d: if (!($hooks_update === false)) { goto UBwqn; } goto buAdw; oQsHA: $class = get_addon_class($db_addons["\x6e\141\155\145"]); goto zjfn1; PB3_c: session("\141\x64\144\157\156\163\x5f\x75\x6e\151\156\x73\164\141\154\154\x5f\145\x72\x72\157\x72", null); goto leUlt; HbSbp: d5Gff: goto D61wj; IAi6o: HD6yS: goto Kttbd; Kttbd: if (!(is_array($addons->menu_info) && $addons->menu_info !== array())) { goto oUK9b; } goto zChRG; zChRG: $menu = $addons->menu_info; goto RN31U; W5jZP: oUK9b: goto T3W8B; R9O1d: $this->error("\346\x89\xa7\xe8\xa1\214\xe6\x8f\x92\344\273\266\xe9\xa2\x84\345\215\xb8\350\275\xbd\xe6\223\215\xe4\275\x9c\xe5\244\261\xe8\xb4\245" . session("\141\144\x64\157\x6e\163\137\x75\156\x69\156\x73\164\141\154\x6c\137\145\x72\162\157\x72")); goto IAi6o; xYPW_: $delete = $this->addons->deleteAddons(["\156\x61\x6d\x65" => $db_addons["\156\x61\x6d\145"]]); goto yBPXQ; buAdw: $this->error("\345\x8d\270\xe8\275\275\xe6\x8f\x92\xe4\xbb\266\346\211\200\xe6\214\x82\xe8\275\275\347\232\204\xe9\222\251\xe5\255\220\346\x95\260\346\x8d\256\xe5\244\261\350\xb4\245"); goto qekEW; hWorF: hogIv: goto PB3_c; iwx2f: $this->success("\345\215\270\xe8\xbd\275\346\x88\220\xe5\x8a\237"); goto H7Zkt; E0TE0: if ($uninstall_flag) { goto HD6yS; } goto R9O1d; D61wj: $this->error("\xe5\x8d\xb8\350\275\275\346\217\222\xe4\xbb\266\345\xa4\261\xe8\264\xa5"); goto rnMfM; h9YY6: foreach ($menu as $k => $v) { goto KFJSR; KFJSR: $method = "\155\145\156\165\x5f\101\x64\x64\157\156\x73"; goto NM4We; D9Xkf: Zqcj8: goto jeDnH; NM4We: $module_model->destroy(["\155\157\x64\x75\154\145\x5f\156\141\155\145" => $v["\155\157\x64\165\x6c\x65\137\156\x61\x6d\x65"], "\x6d\145\x74\x68\x6f\144" => $method]); goto D9Xkf; jeDnH: } goto OGjXB; leUlt: $addons = new $class(); goto R3yl7; H7Zkt: goto iNKvH; goto HbSbp; T3W8B: $hooks_update = $this->addons->removeHooks($db_addons["\x6e\141\155\x65"]); goto WmW8d; ywmkq: $this->error("\xe6\217\222\344\273\266\344\270\215\xe5\255\x98\xe5\x9c\xa8"); goto hWorF; gD_3u: $db_addons = $this->addons->getAddonsInfo(["\x69\144" => $id], "\52"); goto oQsHA; OGjXB: C8hw1: goto W5jZP; rnMfM: iNKvH: goto b8j1B; RZ4KP: $id = trim(request()->get("\x69\x64", 0)); goto gD_3u; b8j1B: } public function menu_addons() { goto NcC3p; u5MJR: $this->assign("\x68\x6f\157\153\137\x6e\x61\155\145", $addons); goto jH1jg; YEPbH: $params = request()->get("\160\141\x72\141\x6d\x73", ''); goto Haq76; Haq76: $this->assign("\160\141\x72\x61\155\163", json_decode($params, true)); goto u5MJR; jH1jg: return view("\151\x6e\144\x65\x78\57\141\144\144\157\x6e\x6d\145\x6e\x75"); goto oB3Z1; NcC3p: $addons = request()->param("\x61\x64\x64\157\156\x73"); goto YEPbH; oB3Z1: } public function execute($addons = null, $controller = null, $action = null, $addons_type = null) { goto seByt; AKTQ8: return \think\App::invokeMethod([$class, $action]); goto veCKi; pV6sy: if (!($model === false)) { goto XXx26; } goto JlrYP; VrhHU: JrBOc: goto JrJYc; qM95i: goto aqFDf; goto PqPwq; JlrYP: $this->error(lang("\141\144\x64\157\156\40\151\x6e\x69\x74\x20\146\141\x69\154")); goto jK3IB; TgC0H: $this->error(lang("\xe6\x8e\247\xe5\x88\266\xe5\231\xa8\xe4\xb8\215\345\255\230\345\234\250" . $class)); goto qM95i; Okiuq: if (class_exists($class)) { goto l4OwJ; } goto TgC0H; PqPwq: l4OwJ: goto pV6sy; IEa2S: NGcTC: goto Okiuq; icQKr: n_da8: goto Rr8FK; seByt: if (!(!empty($addons) && !empty($controller) && !empty($action))) { goto n_da8; } goto MzbJB; Qvt8x: $class = get_addon_class($addons_type, $addons, $controller); goto A1B9u; jK3IB: XXx26: goto AKTQ8; A1B9u: goto NGcTC; goto VrhHU; veCKi: aqFDf: goto icQKr; JrJYc: $class = get_addon_class($addons, "\141\x64\144\x6f\156\137\143\x6f\156\x74\162\x6f\x6c\x6c\145\x72", $controller); goto IEa2S; MzbJB: if ($addons_type == null) { goto JrBOc; } goto Qvt8x; Rr8FK: } }
