<?php
 namespace app\admin\controller; use app\admin\service\Images; use app\common\model\ImagesGroup; load()->func("\x66\151\154\145"); global $_W; $_W = $_SESSION["\167\x65\67\x5f\167"]; use think\Controller; use think\config; use think\Db; use think\Image; use think\Session; define("\125\x50\x4c\117\x41\x44\137\x56\x49\x44\x45\x4f", Config::get("\x76\x69\x65\167\137\x72\x65\x70\x6c\141\x63\145\137\x73\164\162\56\x55\x50\x4c\x4f\x41\104\x5f\x56\x49\104\105\117")); class Upload extends Controller { private $return = array(); private $file_path = ''; private $file_name = ''; private $file_size = 0; private $file_type = ''; private $upload_type = 2; public function uploadFile() { goto SaIL5; mrhS7: if (empty($_W["\163\145\x74\164\x69\156\147"]["\162\x65\x6d\157\164\x65"]["\x74\171\160\145"])) { goto epcmJ; } goto nqb2r; l4Htp: $this->return["\x63\157\144\x65"] = 1; goto AwqVH; msJYR: goto lV21w; goto Dni1m; QFFva: $image_size = getimagesize($_W["\163\x69\x74\x65\162\x6f\x6f\164"] . "\141\x64\x64\157\156\x73\57\x79\142\x5f\163\x68\157\x70\x2f\x63\157\162\x65\57" . $ok["\x70\x61\x74\x68"]); goto bMisC; yHtAh: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto kGCsB; } goto I0LtG; zZvLO: if ($old_path == "\x67\157\x6f\144\163\x2f") { goto j0eI8; } goto XY2PA; ypNJE: $name = $file_name_explode[0]; goto wIFzf; UIHb5: $pic_name = request()->post("\x69\155\x67\137\156\x61\155\145", $guid); goto P0cv4; fHgNx: VGgBz: goto l4Htp; tNb9s: QZ1e0: goto rZix5; LJCEe: W909I: goto xblVW; u8pvU: $this->return["\x63\157\x64\145"] = 1; goto cDhp2; xjDb0: Ev2eB: goto UwaYn; AwqVH: $this->return["\144\x61\x74\x61"] = $_W["\x73\151\x74\x65\x72\x6f\x6f\x74"] . "\x61\x64\x64\157\156\163\x2f\x79\142\x5f\163\x68\157\160\x2f\x63\x6f\x72\x65\x2f" . $ok["\x70\x61\164\150"]; goto KyImk; xblVW: epcmJ: goto r5rDW; u3Jtd: if ($retval > 0) { goto W6pBD; } goto CyO0p; TLOR6: return "\350\xbf\x9c\xe7\250\x8b\351\231\204\344\273\266\xe4\xb8\212\344\274\xa0\xe5\xa4\xb1\350\264\xa5\xef\xbc\214\350\257\267\346\xa3\x80\346\237\245\xe9\205\215\xe7\xbd\xae\345\271\xb6\351\x87\215\xe6\226\260\xe4\xb8\212\xe4\274\240"; goto LJCEe; if1kJ: tY_wQ: goto u_64j; sSFiK: $upload_flag = request()->post("\165\x70\154\157\141\144\x5f\x66\154\141\147", ''); goto nBncx; eLEMH: W6pBD: goto ojyTY; UwaYn: goto aIENa; goto fHgNx; u_64j: $this->file_name = $_FILES["\146\x69\x6c\145\x5f\x75\160\x6c\x6f\x61\x64"]["\x6e\x61\155\145"]; goto sOAs6; cDhp2: $this->return["\x64\141\164\141"] = $remoteurl; goto LFYNP; XY2PA: $this->return["\x63\157\x64\145"] = 1; goto e0R38; G3bSv: $this->file_type = $_FILES["\146\x69\x6c\x65\x5f\x75\x70\x6c\157\x61\x64"]["\164\171\160\145"]; goto fND1F; j9G8d: $this->return["\x6d\145\x73\x73\141\x67\145"] = "\350\257\267\xe6\243\x80\xe6\237\245\346\x82\250\347\232\204\xe4\xb8\x8a\xe4\274\xa0\345\217\202\346\225\xb0\351\205\x8d\xe7\xbd\256\xe6\210\226\xe4\270\212\344\274\xa0\347\x9a\204\xe6\226\x87\xe4\xbb\xb6\xe6\230\257\345\220\xa6\346\234\211\350\xaf\xaf"; goto p64YK; VaSsW: $mode = intval("\x30\x37\67\x37", 8); goto UDL6d; fND1F: if (!($this->file_size == 0)) { goto unhKv; } goto B1p5C; LFYNP: $this->return["\155\x65\x73\x73\x61\x67\x65"] = "\xe4\xb8\212\344\274\240\xe6\210\x90\xe5\212\237"; goto WdA3i; o6pem: $suffix = count($file_name_explode) - 1; goto gr7FF; fA6Wy: goto UQGW3; goto tNb9s; j_7WK: $_W = $_SESSION["\x77\145\67\137\x77"]; goto mrhS7; tPj4K: $height = $image_size[1]; goto ypNJE; rZix5: if (strstr(UPLOAD_VIDEO, $this->file_path)) { goto EIDgz; } goto kPtuT; N_tNT: $type = request()->post("\x74\x79\x70\x65", ''); goto UIHb5; e0R38: $this->return["\144\141\x74\141"] = $_W["\163\x69\x74\x65\x72\157\x6f\x74"] . "\x61\x64\x64\157\x6e\x73\57\171\142\x5f\163\x68\x6f\x70\x2f\x63\157\162\145\x2f" . $ok["\x70\141\x74\x68"]; goto eILcw; IDNqy: global $_W; goto j_7WK; ozZer: $ok = $this->moveUploadFile($_FILES["\x66\x69\x6c\x65\x5f\165\x70\x6c\x6f\x61\144"]["\164\155\160\x5f\156\141\x6d\x65"], $this->file_path . $newfile); goto Gqhtx; cmvOy: $old_path = request()->post("\x66\x69\154\145\x5f\160\x61\164\150", ''); goto FdNDF; q_PTK: LeWiN: goto bXKHP; r5rDW: if ($ok["\143\x6f\x64\x65"]) { goto QZ1e0; } goto KAzvB; g6HgB: $this->return["\x6d\145\x73\163\x61\147\x65"] = "\xe6\226\207\344\xbb\xb6\350\xb7\257\xe5\xbe\x84\xe4\270\215\xe8\203\275\xe4\xb8\272\347\xa9\272"; goto Oy0r_; eILcw: $this->return["\x6d\x65\163\163\141\x67\x65"] = "\344\xb8\x8a\344\274\240\xe6\210\x90\345\212\x9f"; goto msJYR; nBncx: $retval = $this->photoCreate($this->file_path, $_W["\163\x69\x74\145\x72\157\x6f\164"] . "\141\144\144\x6f\156\163\57\x79\142\137\x73\x68\157\x70\x2f\143\157\x72\145\57" . $ok["\160\141\x74\x68"], "\x2e" . $file_name_explode[$suffix], $type, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $ok["\144\157\155\141\151\156"], $ok["\x62\x75\143\x6b\145\164"]); goto u3Jtd; KyImk: $this->return["\x6d\145\163\163\141\147\x65"] = "\xe4\xb8\x8a\344\xbc\xa0\346\210\x90\345\x8a\x9f"; goto Jl82y; bXKHP: lV21w: goto xjDb0; FdNDF: $this->file_path = "\x70\165\x62\154\x69\x63\x2f\165\x70\154\x6f\x61\x64\x2f" . $mch_id . "\57" . $old_path; goto C98GO; Oy0r_: return $this->ajaxFileReturn(); goto ooXei; bMisC: if ($image_size) { goto lKKQQ; } goto j9G8d; WdA3i: return json_encode($this->return); goto xwqm9; q9KOB: if ($this->validationFile()) { goto hhm5m; } goto dgfzF; uQasI: $file_name_explode = explode("\56", $this->file_name); goto o6pem; wIFzf: $group = new ImagesGroup(); goto WtF8m; obUi6: $remotestatus = file_remote_upload($pathname); goto gy_uO; Jl82y: aIENa: goto rs8Lj; xwqm9: goto W909I; goto gimGr; P0cv4: $album_id = $group_id["\x67\162\x6f\x75\x70\137\151\x64"]; goto myKtp; WtF8m: $group_id = $group->getInfo(["\x6d\x63\150\x5f\x69\x64" => $mch_id, "\151\163\x5f\x64\145\x66\141\x75\x6c\x74" => "\x31"]); goto zZvLO; kPtuT: @unlink($_FILES["\146\151\154\x65\137\165\x70\154\x6f\x61\144"]); goto dyda2; e1V5s: hhm5m: goto O2r2U; dyda2: if ($old_path == "\x76\x69\x64\x65\x6f\57\x76\x69\x64\145\157\57") { goto VGgBz; } goto QFFva; C98GO: if (!($this->file_path == '')) { goto SgDb3; } goto g6HgB; nqb2r: $pathname = $ok["\160\x61\164\x68"]; goto obUi6; o_U1e: return $this->ajaxFileReturn(); goto fY3V2; B1p5C: $this->return["\x6d\145\x73\163\x61\147\145"] = "\346\x96\207\344\xbb\266\345\xa4\xa7\xe5\260\217\344\xb8\272\x30\x4d\x42"; goto CnPUB; pI729: $this->return["\x6d\x65\x73\163\141\147\x65"] = "\xe4\xb8\212\344\274\xa0\xe6\210\220\xe5\x8a\237"; goto sVtul; fY3V2: kGCsB: goto IDNqy; ooXei: SgDb3: goto wCQpP; SaIL5: $mch_id = Session::get("\142\165\163\x5f\x69\x64"); goto cmvOy; CnPUB: return $this->ajaxFileReturn(); goto ql1B5; Sgvvl: lKKQQ: goto LMI8t; Rjsmo: $newfile = $guid . $ext; goto ozZer; Gqhtx: $mimetype = exif_imagetype($ok["\x70\x61\x74\x68"]); goto yHtAh; LMI8t: $width = $image_size[0]; goto tPj4K; f2a0j: UQGW3: goto D_ndo; dgfzF: return $this->ajaxFileReturn(); goto e1V5s; gK9Wr: goto LeWiN; goto eLEMH; gimGr: EJ4aH: goto TLOR6; I0LtG: $this->return["\155\x65\163\x73\141\x67\x65"] = "\346\x96\x87\xe4\xbb\266\xe6\240\274\345\xbc\x8f\351\224\x99\xe8\257\xaf"; goto o_U1e; rs8Lj: EIDgz: goto f2a0j; Dni1m: j0eI8: goto N_tNT; D_ndo: return $this->ajaxFileReturn(); goto k4O57; p64YK: goto Ev2eB; goto Sgvvl; KAzvB: $this->return["\155\145\x73\x73\141\x67\145"] = "\xe8\257\267\346\243\200\xe6\237\245\xe6\202\xa8\347\232\x84\xe4\xb8\212\xe4\274\240\xe5\217\x82\xe6\225\260\351\x85\x8d\347\275\256\346\x88\x96\344\xb8\x8a\xe4\xbc\240\xe7\232\204\346\x96\x87\344\273\266\346\230\xaf\345\x90\246\xe6\234\211\350\xaf\xaf"; goto fA6Wy; myKtp: $pic_tag = request()->post("\151\155\147\137\164\x61\147", $name); goto eFOyS; gr7FF: $ext = "\x2e" . $file_name_explode[$suffix]; goto Rjsmo; O2r2U: $guid = md5(time()); goto uQasI; ojyTY: $this->return["\143\157\144\145"] = $retval; goto pI729; sVtul: $this->return["\x64\x61\164\141"] = $_W["\163\x69\x74\145\x72\x6f\157\164"] . "\x61\x64\144\157\156\x73\57\x79\142\137\163\150\157\160\x2f\143\x6f\x72\x65\57" . $ok["\160\x61\164\150"]; goto q_PTK; SLzwN: $remoteurl = tomedia($ok["\160\141\x74\150"]); goto u8pvU; UDL6d: mkdir($this->file_path, $mode, true); goto if1kJ; eFOyS: $pic_id = request()->post("\151\x6d\147\x5f\151\144", ''); goto sSFiK; gy_uO: if (is_error($remotestatus)) { goto EJ4aH; } goto SLzwN; sOAs6: $this->file_size = $_FILES["\146\x69\x6c\145\137\x75\160\154\157\141\x64"]["\163\151\172\145"]; goto G3bSv; wCQpP: if (file_exists($this->file_path)) { goto tY_wQ; } goto VaSsW; ql1B5: unhKv: goto q9KOB; CyO0p: $this->return["\x6d\145\163\x73\x61\x67\145"] = "\344\270\212\344\xbc\240\xe5\xa4\xb1\xe8\xb4\245"; goto gK9Wr; k4O57: } private function ajaxFileReturn() { goto ujlV3; LxRE0: ssyJt: goto X6Amr; s_Bkx: if (!(empty($this->return["\x6d\145\x73\x73\x61\147\x65"]) || null == $this->return["\x6d\145\x73\x73\x61\147\145"] || '' == $this->return["\155\145\x73\163\x61\147\145"])) { goto ssyJt; } goto fnqXZ; cIqIC: $this->return["\143\x6f\x64\x65"] = 0; goto Vr4Ab; Vr4Ab: uciVJ: goto s_Bkx; X3ios: Az3k7: goto bv7h5; fnqXZ: $this->return["\155\x65\163\163\x61\x67\145"] = ''; goto LxRE0; ujlV3: if (!(empty($this->return["\x63\157\144\x65"]) || null == $this->return["\x63\157\144\145"] || '' == $this->return["\143\157\x64\x65"])) { goto uciVJ; } goto cIqIC; bv7h5: return $this->return; goto GYdVj; X6Amr: if (!(empty($this->return["\144\x61\164\141"]) || null == $this->return["\x64\141\164\141"] || '' == $this->return["\144\x61\x74\x61"])) { goto Az3k7; } goto trVmi; trVmi: $this->return["\144\141\x74\x61"] = ''; goto X3ios; GYdVj: } private function validationFile() { goto XIT2u; S5146: $this->return["\155\145\163\163\x61\147\x65"] = "\xe6\x96\x87\xe4\xbb\xb6\xe7\261\xbb\xe5\236\x8b\xe9\x94\x99\350\257\257"; goto VZ5qp; VZ5qp: $flag = false; goto Rk7po; blhrN: ZjGEM: goto rHqWw; achd6: $flag = false; goto blhrN; SE_2W: if (in_array($this->file_type, $alltype)) { goto nxAPb; } goto S5146; al8Er: $this->return["\155\145\163\x73\141\147\145"] = "\xe6\x96\x87\xe4\273\266\344\270\212\xe4\xbc\xa0\345\244\261\xe8\264\245\54\350\xaf\xb7\xe6\243\200\xe6\237\xa5\346\x82\250\xe4\xb8\x8a\xe4\xbc\xa0\347\232\x84\xe6\x96\207\xe4\xbb\xb6\347\261\273\345\236\x8b\54\xe6\226\207\xe4\273\xb6\xe5\xa4\xa7\xe5\xb0\x8f\344\270\x8d\xe8\203\xbd\xe8\266\205\xe8\277\207\x31\x30\115\102"; goto achd6; Rk7po: nxAPb: goto G_Fs4; rHqWw: $alltype = ["\x69\x6d\141\x67\145\57\152\160\x67", "\151\x6d\x61\147\145\x2f\152\160\145\147", "\x69\x6d\141\147\x65\57\160\156\147", "\151\155\x61\147\x65\57\x67\151\146"]; goto SE_2W; G_Fs4: return $flag; goto BIj2Y; XIT2u: $flag = true; goto AsSj5; AsSj5: if (!($this->file_size > 10000000)) { goto ZjGEM; } goto al8Er; BIj2Y: } public function photoCreate($upFilePath, $photoPath, $ext, $type = 0, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $domain, $bucket) { goto v9Zqn; GCYEF: $image = \think\Image::open($photoPath); goto mxanf; v9Zqn: global $_W; goto qDLf1; O04Gk: T3eyB: goto Y18Y3; mxanf: $photoArray["\x62\x69\147\x50\x61\x74\x68"]["\x70\141\x74\150"] = $upFilePath . md5(time() . $pic_tag) . "\61" . $ext; goto y9j7w; nPuHR: foreach ($photoArray as $v) { goto EigDJ; EigDJ: if (!stristr($type, $v["\x74\171\160\145"])) { goto GfYtP; } goto VMsV8; a8Dqo: xQOHc: goto BpA6z; VMsV8: $image->thumb($v["\x77\151\x64\164\150"], $v["\150\x65\x69\147\150\x74"], \think\Image::m4sSY)->save($v["\x70\141\x74\150"]); goto ihnAU; ihnAU: GfYtP: goto a8Dqo; BpA6z: } goto JqyYz; qDLf1: $_W = $_SESSION["\167\145\67\137\167"]; goto VWrsh; Y18Y3: return $retval; goto nehj8; zqsQG: DxIZh: goto sX49D; f77v5: NShN3: goto ffkyV; VWrsh: $photoArray = array("\x62\151\x67\x50\141\164\x68" => array("\x70\141\x74\150" => '', "\x77\x69\x64\164\x68" => 700, "\x68\x65\x69\x67\150\164" => 700, "\x74\x79\160\145" => "\61"), "\155\151\144\144\x6c\145\120\141\164\150" => array("\x70\141\x74\x68" => '', "\x77\x69\x64\164\150" => 360, "\150\x65\151\x67\150\x74" => 360, "\x74\x79\160\x65" => "\x32"), "\x73\155\141\154\x6c\x50\x61\x74\x68" => array("\x70\141\164\x68" => '', "\167\x69\x64\x74\x68" => 240, "\150\x65\x69\147\150\164" => 240, "\164\171\160\x65" => "\63"), "\x6c\151\164\164\x6c\x65\120\141\x74\150" => array("\x70\x61\164\x68" => '', "\x77\x69\x64\x74\x68" => 60, "\150\145\x69\x67\x68\x74" => 60, "\x74\x79\160\145" => "\x34")); goto FjG6D; Z_Kmp: goto T3eyB; goto f77v5; UMZrc: $retval = $pic_id; goto Z_Kmp; Ghey1: $photoArray["\154\151\x74\x74\x6c\x65\x50\141\164\150"]["\x70\x61\164\x68"] = $upFilePath . md5(time() . $pic_tag) . "\x34" . $ext; goto nPuHR; WDe2Z: if ($pic_id == '') { goto NShN3; } goto Szj8Y; y9j7w: $photoArray["\x6d\x69\x64\144\x6c\145\120\x61\x74\x68"]["\x70\141\164\150"] = $upFilePath . md5(time() . $pic_tag) . "\x32" . $ext; goto b0MIO; b0MIO: $photoArray["\163\155\141\x6c\154\x50\141\x74\150"]["\x70\x61\164\150"] = $upFilePath . md5(time() . $pic_tag) . "\63" . $ext; goto Ghey1; Szj8Y: $retval = $album->ModifyAlbumPicture($pic_id, $_W["\x73\x69\164\145\x72\157\157\x74"] . "\x61\144\x64\x6f\x6e\163\x2f\171\142\x5f\163\150\x6f\160\57\x63\x6f\x72\145\x2f" . $photoPath, $width . "\54" . $height, $width . "\54" . $height, $photoArray["\x62\151\147\120\x61\x74\x68"]["\x70\141\164\x68"], $photoArray["\142\151\147\120\141\164\150"]["\167\151\x64\164\150"] . "\x2c" . $photoArray["\x62\151\x67\120\x61\164\x68"]["\x68\145\151\147\150\164"], $photoArray["\142\151\147\x50\x61\x74\150"]["\x77\151\144\x74\x68"] . "\54" . $photoArray["\x62\151\x67\120\x61\164\150"]["\x68\145\x69\x67\150\x74"], $photoArray["\155\x69\x64\x64\154\145\x50\x61\x74\x68"]["\160\x61\x74\x68"], $photoArray["\x6d\151\x64\144\x6c\145\120\141\x74\150"]["\167\x69\144\x74\150"] . "\x2c" . $photoArray["\x6d\151\144\144\x6c\145\x50\x61\164\x68"]["\150\145\151\x67\x68\164"], $photoArray["\155\x69\144\144\x6c\x65\120\141\x74\150"]["\167\151\x64\164\x68"] . "\54" . $photoArray["\x6d\151\144\144\x6c\x65\x50\x61\164\150"]["\150\x65\151\147\150\164"], $photoArray["\x73\x6d\x61\154\x6c\x50\x61\164\150"]["\x70\141\x74\x68"], $photoArray["\163\x6d\141\x6c\154\x50\x61\x74\150"]["\167\151\144\x74\150"] . "\54" . $photoArray["\163\x6d\141\x6c\154\120\141\164\x68"]["\150\x65\x69\x67\150\x74"], $photoArray["\x73\155\x61\154\154\120\x61\x74\150"]["\167\151\x64\x74\150"] . "\54" . $photoArray["\163\x6d\141\x6c\154\x50\x61\x74\150"]["\x68\x65\151\147\x68\x74"], $photoArray["\154\151\164\x74\x6c\x65\x50\141\164\x68"]["\x70\141\164\150"], $photoArray["\154\x69\x74\x74\x6c\145\x50\141\x74\150"]["\x77\x69\144\164\150"] . "\x2c" . $photoArray["\x6c\151\x74\x74\154\145\120\x61\164\x68"]["\x68\145\151\x67\150\x74"], $photoArray["\154\x69\x74\x74\x6c\x65\120\x61\164\x68"]["\167\x69\144\x74\150"] . "\x2c" . $photoArray["\x6c\151\x74\x74\x6c\145\x50\141\x74\x68"]["\150\x65\x69\x67\x68\x74"], $this->instance_id, $this->upload_type, $domain, $bucket); goto UMZrc; sX49D: $album = new Images(); goto WDe2Z; JqyYz: SwXRi: goto zqsQG; ffkyV: $retval = $album->addPicture($album_id, $pic_name, $pic_tag, $_W["\163\x69\x74\145\x72\x6f\x6f\164"] . "\141\x64\144\157\x6e\x73\57\171\142\x5f\x73\150\157\160\57\143\x6f\x72\145\57" . $photoPath, $width . "\x2c" . $height, $width . "\54" . $height, $photoArray["\x62\151\147\x50\141\164\x68"]["\160\x61\164\150"], $photoArray["\142\x69\147\x50\x61\164\x68"]["\167\x69\x64\164\x68"] . "\x2c" . $photoArray["\142\x69\x67\120\141\x74\150"]["\x68\x65\x69\x67\x68\164"], $photoArray["\x62\151\x67\x50\141\164\150"]["\x77\x69\x64\x74\150"] . "\x2c" . $photoArray["\142\x69\x67\120\141\x74\x68"]["\150\145\151\x67\x68\x74"], $photoArray["\155\151\x64\144\x6c\x65\120\141\164\150"]["\x70\x61\164\150"], $photoArray["\155\x69\x64\x64\154\145\x50\x61\x74\150"]["\x77\151\144\164\x68"] . "\54" . $photoArray["\155\151\x64\x64\154\145\120\x61\x74\x68"]["\150\x65\151\147\x68\164"], $photoArray["\x6d\151\x64\144\x6c\x65\120\141\x74\150"]["\167\x69\144\x74\x68"] . "\54" . $photoArray["\155\151\144\x64\x6c\x65\x50\141\x74\x68"]["\150\x65\x69\147\150\x74"], $photoArray["\163\155\141\154\x6c\x50\x61\x74\150"]["\160\141\x74\x68"], $photoArray["\163\x6d\141\154\154\120\x61\x74\150"]["\x77\x69\144\x74\150"] . "\54" . $photoArray["\163\155\x61\x6c\x6c\x50\x61\x74\150"]["\150\x65\x69\x67\x68\164"], $photoArray["\x73\x6d\x61\x6c\x6c\x50\141\164\150"]["\x77\x69\x64\x74\150"] . "\x2c" . $photoArray["\163\x6d\141\x6c\154\x50\x61\164\x68"]["\x68\145\151\147\x68\x74"], $photoArray["\x6c\x69\164\164\x6c\145\x50\x61\x74\150"]["\x70\141\164\150"], $photoArray["\x6c\x69\164\164\x6c\145\120\141\164\150"]["\x77\x69\144\x74\x68"] . "\54" . $photoArray["\154\x69\x74\x74\154\x65\x50\x61\164\150"]["\150\x65\151\x67\150\164"], $photoArray["\x6c\151\164\x74\154\145\120\141\x74\x68"]["\x77\x69\x64\164\x68"] . "\x2c" . $photoArray["\x6c\151\x74\x74\x6c\x65\x50\141\x74\x68"]["\x68\145\x69\x67\x68\164"], $this->upload_type, $domain, $bucket); goto O04Gk; FjG6D: if (!($this->upload_type == 1)) { goto DxIZh; } goto GCYEF; nehj8: } public function moveUploadFile($file_path, $key) { goto u5Lr3; IuOyz: $ok = @move_uploaded_file($file_path, $key); goto iLpb_; iLpb_: $result = ["\143\x6f\144\x65" => $ok, "\160\141\164\150" => $key, "\x64\x6f\x6d\141\151\x6e" => '', "\142\165\x63\x6b\145\x74" => '']; goto qYFtC; qYFtC: aCfg5: goto YL3zy; YL3zy: return $result; goto VrtwY; u5Lr3: if (!($this->upload_type == 2)) { goto aCfg5; } goto IuOyz; VrtwY: } public function photoAlbumUpload() { goto GQCPE; d68mS: $image_size = @getimagesize($ok["\x70\x61\164\x68"]); goto g8ciq; Y6xaP: gHBpU: goto zO_HE; whWPX: mkdir($this->file_path, $mode, true); goto iHYnX; xoeYj: $type = request()->post("\x74\171\160\x65", ''); goto DnuLw; iHYnX: T1pDI: goto CmMZ0; TWjhO: unset($tmp_array[$suffix]); goto Gt8GQ; oqYrL: @unlink($_FILES["\x66\151\154\x65\x5f\x75\160\x6c\x6f\x61\144"]); goto d68mS; wOu2p: return $this->ajaxFileReturn(); goto ols2a; RTrMa: $data["\x63\x6f\144\x65"] = 1; goto zEM_Q; CGVkX: WRBYa: goto eW9mi; suXEu: goto AMqwI; goto CGVkX; Gdfz2: $data["\x73\164\141\164\145"] = "\61"; goto RTrMa; nmfgk: if (empty($_W["\x73\x65\x74\x74\x69\x6e\147"]["\x72\145\155\x6f\164\x65"]["\164\171\160\x65"])) { goto gHBpU; } goto dkrge; BCNdB: return $this->ajaxFileReturn(); goto suXEu; eQtWb: $data["\146\x69\x6c\145\137\x70\x61\164\x68"] = $remoteurl; goto ZyE3G; sP9vt: $this->return["\x6d\145\x73\x73\141\147\x65"] = "\xe6\226\207\xe4\xbb\xb6\xe8\267\257\345\276\204\xe4\xb8\x8d\xe8\x83\275\xe4\270\xba\xe7\xa9\xba"; goto OsIcZ; xWUBm: $data["\x66\x69\x6c\145\137\156\x61\155\x65"] = $picture_info["\x69\155\147\x5f\x6e\x61\155\145"]; goto M3NtB; oyrgW: $this->file_path = "\160\165\x62\154\x69\143\x2f\x75\160\154\157\141\x64\x2f" . $mch_id . "\x2f" . $old_path; goto BWl4o; ZyE3G: $res = Db::name("\171\142\163\143\x5f\151\155\141\147\x65\163")->insertGetId(["\x75\x70\154\x6f\x61\144\137\164\x69\155\x65" => time(), "\x67\x72\x6f\x75\x70\x5f\x69\144" => $album_id, "\151\155\x67\137\x6e\141\155\145" => $newfile, "\x69\x6d\147\x5f\x74\x61\x67" => '', "\x69\155\x67\x5f\x63\x6f\166\x65\x72" => $remoteurl]); goto CclG1; IO7C6: LVRCU: goto Y6xaP; lJmK5: $width = $image_size[0]; goto QSpyb; dkrge: $pathname = $ok["\x70\x61\x74\150"]; goto oN73G; ols2a: goto qMGBP; goto LmhQo; yLKaa: $suffix = count($file_name_explode) - 1; goto yjwFU; JaRWj: $this->return["\x6d\x65\x73\x73\141\x67\145"] = "\xe5\233\xbe\xe7\211\207\344\xb8\212\344\xbc\240\xe5\244\261\350\xb4\xa5"; goto BgBcj; LmhQo: C24Gb: goto OFrNP; ez39X: if (file_exists($this->file_path)) { goto T1pDI; } goto waUrR; Sq8_a: return "\xe8\xbf\234\347\250\x8b\xe9\x99\x84\xe4\273\xb6\xe4\xb8\x8a\344\274\240\xe5\xa4\261\350\264\245\xef\xbc\214\xe8\257\267\xe6\xa3\x80\xe6\x9f\xa5\351\205\x8d\347\xbd\xae\xe5\271\xb6\xe9\207\215\xe6\x96\xb0\xe4\270\212\344\xbc\xa0"; goto IO7C6; BdiV0: $mch_id = Session::get("\142\165\163\137\x69\144"); goto uwgcE; CclG1: $data["\x73\164\141\164\145"] = 1; goto JW2mr; OsIcZ: return $this->ajaxFileReturn(); goto A6IJL; l2wpq: $this->return["\155\x65\x73\x73\x61\147\145"] = "\xe5\233\276\347\x89\207\344\xb8\x8a\344\274\xa0\xe5\xa4\xb1\350\xb4\xa5"; goto BCNdB; UwjZw: $data["\146\151\x6c\x65\x5f\156\x61\155\145"] = ''; goto cpICu; LkZcP: eQWvU: goto g0s1Q; m2PGj: Mu9er: goto pw7za; R0J8f: global $_W; goto a3gWh; eK8x4: kfjgD: goto PFo13; SjbfL: Qg4Xw: goto oqYrL; Oo90y: $this->return["\155\x65\163\x73\x61\147\145"] = "\346\226\207\xe4\273\266\345\244\xa7\345\260\x8f\344\xb8\x8d\350\x83\275\350\266\x85\xe8\277\207\65\115\102"; goto rew1C; M3NtB: $data["\x6f\162\x69\147\151\x6e\137\146\151\154\x65\x5f\156\x61\155\x65"] = $this->file_name; goto FMyVN; ue2Al: $group_id = $group->getInfo(["\x6d\x63\150\137\151\144" => $mch_id, "\x69\163\137\144\x65\146\x61\x75\x6c\164" => "\61"]); goto lJmK5; QSpyb: $height = $image_size[1]; goto Devi5; g8ciq: if ($image_size) { goto C24Gb; } goto XDWhs; Fs_BH: goto QXbQM; goto SjbfL; pyGty: $file_name_explode = explode("\x2e", $this->file_name); goto yLKaa; cpICu: return $data; goto VkNsj; DnuLw: $pic_name = request()->post("\151\x6d\147\137\x6e\141\155\x65", $file_new_name . $guid); goto dC19J; rCR_3: qMGBP: goto cFfa3; mt3SO: CGK1w: goto R0J8f; hBd8u: $this->file_size = $_FILES["\x66\151\x6c\145\137\165\x70\154\x6f\x61\x64"]["\x73\151\x7a\x65"]; goto qhB16; ZAQSs: $retval = $this->photoCreate($this->file_path, $ok["\160\141\164\x68"], "\x2e" . $file_name_explode[$suffix], $type, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $ok["\x64\157\155\141\x69\156"], $ok["\x62\165\x63\x6b\145\x74"]); goto Ky3lD; MdJD1: $data["\x66\x69\x6c\145\x5f\151\144"] = $retval; goto xWUBm; Ky3lD: if ($retval > 0) { goto WRBYa; } goto l2wpq; zEM_Q: return $data; goto sbNhO; rew1C: return $this->ajaxFileReturn(); goto m2PGj; ikOkI: if (!($this->file_size == 0)) { goto kfjgD; } goto rMpSy; KksgT: $pic_id = request()->post("\151\155\x67\137\151\x64", ''); goto zKisp; IAgUc: $old_path = $this->file_path = request()->post("\146\151\x6c\145\137\160\141\164\x68", ''); goto oyrgW; dC19J: $album_id = request()->post("\147\162\157\165\160\x5f\151\144", ''); goto ajMhy; tc_BL: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto CGK1w; } goto IO1BQ; A6IJL: umWfV: goto ez39X; cFfa3: QXbQM: goto h0TgE; NqvAw: if (is_error($remotestatus)) { goto ZAlY0; } goto jr9AO; aZnyh: $data["\146\x69\x6c\x65\x5f\x69\144"] = $res; goto UwjZw; BWl4o: if (!($this->file_path == '')) { goto umWfV; } goto sP9vt; zKisp: $upload_flag = request()->post("\x75\160\x6c\157\141\x64\137\146\154\x61\147", ''); goto ZAQSs; uwgcE: $album_id = request()->post("\147\162\157\165\160\x5f\151\x64", ''); goto IAgUc; JW2mr: $data["\143\157\x64\x65"] = 1; goto aZnyh; OXMPU: return $this->ajaxFileReturn(); goto LkZcP; jr9AO: $remoteurl = tomedia($ok["\160\x61\164\x68"]); goto gyb3T; neel0: return $this->ajaxFileReturn(); goto mt3SO; VCH2e: $album_id = $group_id["\x67\162\157\165\160\137\151\144"]; goto AM_qS; qhB16: $this->file_type = $_FILES["\x66\151\154\145\x5f\165\x70\154\157\x61\144"]["\164\x79\160\145"]; goto ikOkI; rcF0Y: return $this->ajaxFileReturn(); goto eK8x4; GQCPE: $data = array(); goto BdiV0; Gt8GQ: $file_new_name = implode("\56", $tmp_array); goto pjsyd; a3gWh: $_W = $_SESSION["\x77\145\x37\137\x77"]; goto nmfgk; g0s1Q: $guid = md5(time()); goto pyGty; IO1BQ: $this->return["\x6d\x65\163\163\x61\x67\x65"] = "\346\x96\207\344\273\xb6\xe6\240\274\xe5\xbc\x8f\xe9\224\231\xe8\257\257"; goto neel0; OFrNP: $group = new ImagesGroup(); goto ue2Al; ajMhy: if (!empty($album_id)) { goto ZPG73; } goto VCH2e; XDWhs: $this->return["\155\145\163\163\x61\147\x65"] = "\xe5\x9b\xbe\xe7\x89\x87\344\270\x8a\344\xbc\240\345\244\261\350\264\245"; goto wOu2p; PFo13: if (!($this->file_size > 5000000)) { goto Mu9er; } goto Oo90y; eW9mi: $album = new Images(); goto LEiy0; AM_qS: ZPG73: goto P9kma; FMyVN: $data["\146\x69\x6c\x65\137\x70\x61\164\150"] = $_W["\x73\151\x74\x65\x72\157\x6f\164"] . "\141\x64\x64\157\156\x73\x2f\171\x62\x5f\x73\x68\x6f\160\x2f\143\x6f\162\145\57" . $this->file_path . $newfile; goto Gdfz2; rMpSy: $this->return["\155\145\163\x73\x61\147\145"] = "\xe6\226\x87\344\xbb\266\345\244\xa7\xe5\260\217\xe4\270\272\x30\115\102"; goto rcF0Y; pSIsA: ZAlY0: goto Sq8_a; yjwFU: $ext = "\56" . $file_name_explode[$suffix]; goto mHSh5; P9kma: $pic_tag = request()->post("\x69\x6d\147\137\164\141\x67", $file_new_name); goto KksgT; Devi5: $name = $file_name_explode[0]; goto xoeYj; VkNsj: goto LVRCU; goto pSIsA; oN73G: $remotestatus = file_remote_upload($pathname); goto NqvAw; sbNhO: AMqwI: goto rCR_3; CmMZ0: $this->file_name = $_FILES["\146\x69\x6c\x65\137\165\160\154\x6f\141\x64"]["\156\x61\155\x65"]; goto hBd8u; BgBcj: return $this->ajaxFileReturn(); goto Fs_BH; gyb3T: $data["\x6f\x72\x69\147\151\x6e\137\x66\x69\154\x65\137\156\141\x6d\x65"] = $this->file_name; goto eQtWb; zO_HE: if ($ok["\143\x6f\x64\145"]) { goto Qg4Xw; } goto JaRWj; waUrR: $mode = intval("\x30\67\x37\x37", 8); goto whWPX; JhpSK: $ok = $this->moveUploadFile($_FILES["\146\x69\x6c\145\137\x75\160\154\157\141\x64"]["\x74\155\160\137\x6e\x61\155\x65"], $this->file_path . $newfile); goto dCZW1; LEiy0: $picture_info = $album->getAlubmPictureDetail(["\151\x6d\x67\x5f\x69\144" => $retval]); goto MdJD1; pw7za: if ($this->validationFile()) { goto eQWvU; } goto OXMPU; dCZW1: $mimetype = exif_imagetype($ok["\160\141\164\x68"]); goto tc_BL; pjsyd: $newfile = md5($file_new_name . $guid) . $ext; goto JhpSK; mHSh5: $tmp_array = $file_name_explode; goto TWjhO; h0TgE: } }
