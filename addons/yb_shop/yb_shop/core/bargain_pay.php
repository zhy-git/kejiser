<?php
 error_reporting(0); define("\111\116\137\x49\x41", ''); date_default_timezone_set("\101\x73\151\141\57\x63\150\x6f\x6e\147\161\x69\x6e\147"); define("\101\x50\x50\137\x50\101\x54\x48", __DIR__ . "\57\141\x70\x70\x6c\x69\143\141\164\x69\157\156\x2f"); define("\103\x4f\x4e\106\x5f\120\x41\124\x48", APP_PATH); define("\x45\x58\124\x45\x4e\104\137\x50\101\x54\x48", __DIR__ . "\57\x65\x78\164\x65\x6e\144\x2f"); require __DIR__ . "\57\164\x68\x69\156\153\x70\x68\x70\x2f\x62\141\x73\145\x2e\x70\150\160"; require EXTEND_PATH . "\127\x78\160\141\x79\x2f\127\x78\120\x61\171\x2e\x41\x70\x69\56\160\x68\160"; require __DIR__ . "\x2f\x61\160\160\x6c\151\143\141\x74\x69\157\x6e\57\141\144\155\x69\156\x2f\163\x65\x72\166\151\143\145\x2f\120\162\x69\156\x74\145\162\123\x65\162\166\151\x63\x65\56\160\x68\x70"; use app\admin\service\PrinterService; use think\config; use think\Db; use think\Log; goto SFK4k; QA6Vd: $pp->print_order(); goto OF7He; Pd62S: $a = Db::name("\x79\142\x73\143\x5f\x62\141\x72\x67\141\151\156\137\157\x72\x64\x65\162")->where(["\x6f\165\x74\x5f\164\162\141\144\x65\x5f\x6e\x6f" => $out_trade_no, "\x6f\x72\144\145\x72\137\163\164\x61\x74\165\x73" => 0])->find(); goto YJwhX; OF7He: Db::startTrans(); goto FwGi5; U9ZFg: $out_trade_no = $doc->getElementsByTagName("\157\x75\164\x5f\x74\162\x61\144\x65\x5f\156\157")->item(0)->nodeValue; goto Tm_0E; DPsP6: $notify_data = isset($GLOBALS["\x48\x54\x54\120\x5f\x52\101\x57\x5f\120\x4f\123\x54\137\x44\x41\x54\x41"]) ? $GLOBALS["\110\124\124\x50\137\122\x41\x57\137\120\117\123\x54\x5f\x44\101\124\101"] : file_get_contents("\160\150\160\72\57\57\x69\156\x70\x75\x74"); goto X_vVE; oDVhf: Config::load($filename, "\144\x61\164\141\x62\141\x73\145"); goto MQ31b; wSfoH: $data_pay = array("\x70\141\171\x5f\x73\x74\141\164\165\x73" => 1, "\x70\141\x79\x5f\x74\x69\x6d\x65" => time()); goto Pd62S; SFK4k: $filename = APP_PATH . "\x64\141\164\x61\x62\x61\x73\x65\x2e\x70\x68\160"; goto oDVhf; X_vVE: if ($notify_data) { goto xO3qo; } goto AZEL7; VWEIl: $doc->loadXML($notify_data); goto U9ZFg; Tm_0E: $data = array("\157\x72\144\x65\162\x5f\x73\x74\141\x74\x75\163" => 1, "\160\141\171\137\x73\x74\141\x74\165\163" => 1, "\160\141\x79\137\x74\x79\160\x65" => 1, "\160\141\171\137\164\x69\155\x65" => time()); goto wSfoH; AZEL7: exit("\346\x9c\xaa\346\224\266\345\x88\xb0\345\x9b\236\350\260\203"); goto h2g2h; h2g2h: xO3qo: goto TiSPg; TiSPg: $doc = new \DOMDocument(); goto VWEIl; vLkTs: $pp = new PrinterService($a["\155\143\x68\x5f\x69\x64"], $a["\x6f\x72\x64\x65\x72\x5f\151\144"], "\x70\141\171", 1); goto QA6Vd; MQ31b: error_reporting(0); goto DPsP6; YJwhX: if (!$a) { goto bEj19; } goto vLkTs; FwGi5: try { goto YINOo; YINOo: $res = Db::name("\x79\142\x73\x63\137\142\x61\162\147\141\x69\x6e\x5f\x6f\162\x64\x65\x72")->where(["\157\165\164\137\x74\x72\141\144\x65\137\156\x6f" => $out_trade_no, "\157\162\x64\x65\162\x5f\163\x74\141\x74\165\163" => 0])->update($data); goto tLuDA; gPDOz: Db::commit(); goto OaMkE; tLuDA: Db::name("\171\x62\163\143\137\142\x61\162\147\x61\151\156\137\157\162\x64\x65\x72\x5f\x70\x61\x79\155\x65\156\x74")->where(["\157\x75\164\x5f\164\x72\x61\x64\x65\x5f\156\157" => $out_trade_no, "\160\x61\171\x5f\163\x74\141\x74\165\163" => 0])->update($data_pay); goto gPDOz; OaMkE: Log::write($out_trade_no . "\x2c\346\224\xaf\344\273\x98\xe7\x8a\xb6\346\200\x81\346\233\xb4\346\224\xb9\346\210\220\xe5\212\x9f", "\142\x61\162\147\141\151\x6e\137\x70\141\171\137\163\x74\141\164\145\x5f\x63\150\141\156\147\145\137\163\165\x63\x63\x65\x73\x73"); goto itnEu; itnEu: } catch (\Exception $e) { Db::rollback(); Log::write($out_trade_no . "\x2c\xe6\x94\xaf\xe4\xbb\230\347\212\xb6\346\200\x81\xe6\233\xb4\346\224\xb9\xe5\xa4\261\350\264\245" . $e, "\142\x61\x72\147\141\x69\156\137\x70\x61\171\x5f\x73\x74\141\164\145\x5f\x63\x68\141\x6e\147\x65\x5f\x66\141\151\x6c"); } goto mxnYg; mxnYg: bEj19:
