(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["yb_shop-pages-member-address-post"],{"067d":function(e,t,i){"use strict";var a=i("e62d"),n=i.n(a);n.a},"1a95":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.show?i("v-uni-view",{staticClass:"page"},[i("v-uni-view",{staticClass:"fui-cell-group",staticStyle:{"margin-top":"0",margin:"0 auto",background:"#f4f4f4"}},[i("v-uni-view",{staticClass:"post_box"},[i("v-uni-view",{staticClass:"post_tit"},[e._v("收货人")]),i("v-uni-view",{staticClass:"fui-cell"},[i("v-uni-view",{staticClass:"fui-cell-label"},[e._v("姓名")]),i("v-uni-view",{staticClass:"fui-cell-info"},[i("v-uni-input",{staticClass:"fui-input",attrs:{"data-type":"consigner",placeholder:"收件人",value:e.detail.consigner},on:{input:function(t){t=e.$handleEvent(t),e.onChange(t)}}})],1)],1),i("v-uni-view",{staticClass:"fui-cell"},[i("v-uni-view",{staticClass:"fui-cell-label"},[e._v("手机")]),i("v-uni-view",{staticClass:"fui-cell-info"},[i("v-uni-input",{staticClass:"fui-input",attrs:{"data-type":"phone",type:"number",placeholder:"手机号码",value:e.detail.phone},on:{input:function(t){t=e.$handleEvent(t),e.onChange(t)}}})],1)],1)],1),i("v-uni-view",{staticClass:"post_box"},[i("v-uni-view",{staticClass:"post_tit"},[e._v("收货地址")]),i("v-uni-view",{staticClass:"fui-cell"},[i("v-uni-view",{staticClass:"fui-cell-label"},[e._v("所在地区")]),i("mpvue-city-picker",{ref:"mpvueCityPicker",attrs:{id:"city_choose",themeColor:"#007AFF"},on:{onConfirm:function(t){t=e.$handleEvent(t),e.onConfirm(t)}}}),i("v-uni-view",{staticClass:"fui-cell-info",attrs:{"data-area":e.detail.province+" "+e.detail.city+" "+e.detail.area},on:{click:function(t){t=e.$handleEvent(t),e.selectArea(t)}}},[e._v("\n\t\t\t\t\t"+e._s(e.detail.province&&e.detail.city?e.detail.province+" "+e.detail.city+" "+e.detail.area:"请选择所在地区")+"\n\t\t\t\t")])],1),i("v-uni-view",{staticClass:"fui-cell"},[i("v-uni-view",{staticClass:"fui-cell-label"},[e._v("详细地址")]),i("v-uni-view",{staticClass:"fui-cell-info"},[i("v-uni-input",{staticClass:"fui-input",attrs:{"data-type":"address",placeholder:"街道，楼牌号等",value:e.detail.address},on:{input:function(t){t=e.$handleEvent(t),e.onChange(t)}}})],1)],1)],1)],1),i("v-uni-view",{class:"fui-mask "+(e.showPicker?"show":"")}),i("v-uni-view",{staticClass:"btn btn-danger block",style:"margin:1rem auto;width:90%;height:86rpx;line-height:86rpx;font-size:30rpx;background:"+("#000000"!=e.config.selectedColor?e.config.selectedColor:e.config.background)+";color:"+("#000000"==e.config.selectedColor&&"black"==e.config.font_color?"#000000":"#ffffff")+";border:1px solid "+("#000000"!=e.config.selectedColor?e.config.selectedColor:e.config.background)+";",attrs:{"data-type":"add"==e.type?"add":"save"},on:{click:function(t){t=e.$handleEvent(t),e.submit(t)}}},[e._v("\n\t"+e._s(e.subtext)+"\n\t")]),i("v-uni-view",{class:"fui-toast "+(e.FoxUIToast.show?"in":"out")},[i("v-uni-view",{staticClass:"text"},[e._v(e._s(e.FoxUIToast.text))])],1)],1):e._e()},n=[],r=i("ca7b"),o=i("a9c3"),s=i("6db2"),c=getApp(),l=c.core,d=c.check,u={extends:r["a"],data:function(){return{id:"",posting:!1,subtext:"保存地址",detail:{consigner:"",phone:"",area:"",address:"",areaid:""},showPicker:!1,pvalOld:[0,0,0],pval:[0,0,0],areas:[{city:[{area:[{name:""}],name:""}],name:""}],street:[],streetIndex:0,noArea:!1,show:!0,type:"",running:!1,FoxUIToast:{}}},components:{city_picker:o["a"],mpvueCityPicker:s["a"]},onLoad:function(e){l.setting(),this.setData({id:e.id,type:e.type,order:e.order,config:getApp().config}),this.getDetail(),e.id||wx.setNavigationBarTitle({title:"添加收货地址"});var t=this;l.get("area/GetArea",{},function(i){t.setData({areas:i.areas,type:e.type})})},methods:{selectArea:function(e){var t=this.$refs.mpvueCityPicker;console.log(this.$refs),console.log(this.$refs.mpvueCityPicker),console.log(this.$refs.mpvueCityPicker.show),t.show()},get_wx_address:function(){var e=this,t=e.detail;wx.chooseAddress({success:function(i){t.consigner=i.userName,t.phone=i.telNumber,t.address=i.detailInfo,t.province=i.provinceName,t.city=i.cityName,t.area=i.countyName;var a=t.province+" "+t.city+" "+t.area,n=e.getIndex(a,e.areas);t.areaid=e.getareaid(a,e.areas),null==t.areaid?l.alert("该地址无法自动获取,请手动选择"):e.setData({pvalOld:n,pval:n,detail:t})}})},getDetail:function(){var e=this,t=e.id;l.get("user/SingleAddress",{id:t,uid:getApp().getCache("userinfo").uid},function(t){var i={show:!0};if(!d.isEmptyObject(t.info)){wx.setNavigationBarTitle({title:"编辑收货地址"});var a=t.info.province+" "+t.info.city+" "+t.info.district,n=e.getIndex(a,e.areas);i.pval=n,i.pvalOld=n,i.detail=t.info,i.detail.area=t.info.district}e.setData(i)})},submit:function(e){var t=this,i=this.id,a=l.pdata(e).type,n=t.detail;if(!t.running){if(n.uid=getApp().getCache("userinfo").uid,""==n.consigner||!n.consigner)return l.toast("请填写收件人"),!1;if(""==n.phone||!n.phone)return l.toast("请填写联系电话"),!1;if(""==n.city||!n.city)return l.toast("请选择所在地区"),!1;if(""==n.address||!n.address)return l.toast("请填写详细地址"),!1;t.setData({posting:!0}),"add"==a?(console.log(n),l.get("user/CreateAddress",n,function(e){if(0!=e.code)return t.setData({posting:!1}),void l.alert(e.msg);t.running=!0,l.success("添加成功！"),setTimeout(function(){"add"==t.type&&1==t.order?wx.redirectTo({url:"/yb_shop/pages/member/address/select"}):wx.navigateBack()},1e3)})):(n.id=i,l.get("user/UpdateAddress",n,function(e){if(0!=e.code)return t.setData({posting:!1}),void l.alert(e.msg);l.success("修改成功！"),t.running=!0,setTimeout(function(){"member"==t.type&&2==t.order?wx.redirectTo({url:"/yb_shop/pages/member/address/select"}):wx.navigateBack()},1e3)}))}},getStreet:function(e,t){if(e&&t){var i=this;if(i.detail.province&&i.detail.city&&this.openstreet)e[t[0]].city[t[1]].code,e[t[0]].city[t[1]].area[t[2]].code}},bindChange:function(e){var t=this.pvalOld,i=e.detail.value;t[0]!=i[0]&&(i[1]=0),t[1]!=i[1]&&(i[2]=0),this.setData({pval:i,pvalOld:i})},getIndex:function(e,t){if(""==d.trim(e)||!d.isArray(t))return[0,0,0];var i=e.split(" "),a=[0,0,0];for(var n in t)if(t[n].name==i[0]){for(var r in a[0]=Number(n),t[n].city)if(t[n].city[r].name==i[1]){for(var o in a[1]=Number(r),t[n].city[r].area)if(t[n].city[r].area[o].name==i[2]){a[2]=Number(o);break}break}break}return console.log(a),a},getareaid:function(e,t){var i=null;if(""==d.trim(e)||!d.isArray(t))return i;var a=e.split(" ");for(var n in console.log(t),t)if(t[n].name==a[0]){for(var r in t[n].city)if(t[n].city[r].name==a[1]){for(var o in t[n].city[r].area)if(t[n].city[r].area[o].name==a[2]){console.log(t[n].city[r].area[o]),i=t[n].city[r].area[o].id;break}break}break}return console.log(i),i},onChange:function(e){var t=this,i=t.detail,a=e.currentTarget.dataset.type,n=d.trim(e.detail.value);i[a]=n,t.setData({detail:i})},onCancel:function(e){this.setData({showPicker:!1})},onConfirm:function(e){var t=e.label,i=t.split("-"),a=this;a.detail.province=i[0],a.detail.city=i[1],a.detail.area=i[2],l.get("User/getAreaId",{areacode:e.cityCode},function(e){0==e.code&&(a.detail.areaid=e.info.id)})}}},v=u,f=(i("067d"),i("2877")),p=Object(f["a"])(v,a,n,!1,null,"c23166d6",null);p.options.__file="post.vue";t["default"]=p.exports},"8a6e":function(e,t,i){var a=i("b8eb");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("65bfc100",a,!0,{sourceMap:!1,shadowMode:!1})},a757:function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,'\nuni-page-body[data-v-c23166d6]{background:#f4f4f4\n}\n.picker-modal[data-v-c23166d6]{background:#fefefe;height:260px;position:fixed;bottom:0;left:0;right:0;z-index:1000;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)\n}\n.picker-modal.city-picker[data-v-c23166d6]{z-index:2000\n}\n.picker-modal.in[data-v-c23166d6]{-webkit-transform:translateZ(0);transform:translateZ(0)\n}\n.picker-modal.in[data-v-c23166d6],.picker-modal.out[data-v-c23166d6]{-webkit-transition-duration:.3s;-o-transition-duration:.3s;transition-duration:.3s\n}\n.picker-modal.out[data-v-c23166d6]{-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)\n}\n.picker-modal .picker-control[data-v-c23166d6]{display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:40px;border-bottom:1px solid #f1f1f1;padding:0 %?30?%;font-size:%?32?%\n}\n.picker-modal .picker-control .cancel[data-v-c23166d6]{width:50%;text-align:left;color:#666\n}\n.picker-modal .picker-control .confirm[data-v-c23166d6]{width:50%;text-align:right;color:#20b21f\n}\n.picker-modal .picker[data-v-c23166d6]{width:100%;height:220px\n}\n.picker-modal .picker .item[data-v-c23166d6]{line-height:40px\n}\nuni-picker-view-column[data-v-c23166d6]{text-align:center\n}\n.post_box[data-v-c23166d6]{width:90%;margin:0 auto\n}\n.post_tit[data-v-c23166d6]{height:2rem;line-height:2rem;padding-left:1rem;font-size:%?28?%;margin-top:%?20?%;color:#666\n}\n.fui-cell[data-v-c23166d6]{background:#fff\n}\n.fui-cell-group[data-v-c23166d6]:after{border-bottom:0\n}\n.fui-cell-group .fui-cell[data-v-c23166d6]:before{border-top:0\n}\n.fui-cell-group .fui-cell[data-v-c23166d6]:after{content:" ";position:absolute;left:%?0?%;right:%?0?%;top:0;height:1px;border-bottom:1px solid #e0dfdf;color:#e0dfdf;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scaleY(.5);-ms-transform:scaleY(.5);transform:scaleY(.5)\n}\nbody.?%PAGE?%[data-v-c23166d6]{background:#f4f4f4\n}',""])},a9c3:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.showPicker,expression:"showPicker"}],class:"picker-modal city-picker "+(e.showPicker?"in":"out")},[i("v-uni-view",{staticClass:"picker-control"},[i("v-uni-view",{staticClass:"cancel",on:{click:function(t){t=e.$handleEvent(t),e.onCancel(t)}}},[e._v("取消")]),i("v-uni-view",{staticClass:"confirm",on:{click:function(t){t=e.$handleEvent(t),e.onConfirm(t)}}},[e._v("确定")])],1),e.noArea?e._e():i("v-uni-picker-view",{attrs:{"indicator-class":"picker","indicator-style":"height: 40px;",value:e.pval},on:{change:function(t){t=e.$handleEvent(t),e.bindChange(t)}}},[i("v-uni-picker-view-column",{attrs:{"indicator-style":"height: 40px;"}},e._l(e.areas,function(t,a){return i("v-uni-view",[i("v-uni-view",{staticClass:"item"},[e._v(e._s(t.name))])],1)})),i("v-uni-picker-view-column",e._l(e.areas[e.pval[0]].city,function(t,a){return i("v-uni-view",[i("v-uni-view",{staticClass:"item"},[e._v(e._s(t.name))])],1)})),i("v-uni-picker-view-column",e._l(e.areas[e.pval[0]].city[e.pval[1]].area,function(t,a){return i("v-uni-view",[i("v-uni-view",{staticClass:"item"},[e._v(e._s(t.name))])],1)}))],1),e.noArea?i("v-uni-picker-view",{attrs:{"indicator-class":"picker","indicator-style":"height: 40px;",value:e.pval},on:{change:function(t){t=e.$handleEvent(t),e.bindChange(t)}}},[i("v-uni-picker-view-column",e._l(e.areas,function(t,a){return i("v-uni-view",[i("v-uni-view",{staticClass:"item"},[e._v(e._s(t.name))])],1)})),i("v-uni-picker-view-column",e._l(e.areas[e.pval[0]].city,function(t,a){return i("v-uni-view",[i("v-uni-view",{staticClass:"item"},[e._v(e._s(t.name))])],1)}))],1):e._e()],1)],1)},n=[],r=i("ca7b"),o={extends:r["a"],Component:{},props:{showPicker:!1,noArea:!1,areas:{type:Array},pval:{type:Array}},data:function(){return{}}},s=o,c=(i("f5b6"),i("2877")),l=Object(c["a"])(s,a,n,!1,null,"9377d82e",null);l.options.__file="city-picker.vue";t["a"]=l.exports},b8eb:function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,"\n.picker-modal[data-v-9377d82e]{background:#fefefe;height:260px;position:fixed;bottom:0;left:0;right:0;z-index:1000;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)\n}\n.picker-modal.city-picker[data-v-9377d82e]{z-index:2000\n}\n.picker-modal.in[data-v-9377d82e]{-webkit-transform:translateZ(0);transform:translateZ(0)\n}\n.picker-modal.in[data-v-9377d82e],.picker-modal.out[data-v-9377d82e]{-webkit-transition-duration:.3s;-o-transition-duration:.3s;transition-duration:.3s\n}\n.picker-modal.out[data-v-9377d82e]{-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)\n}\n.picker-modal .picker-control[data-v-9377d82e]{display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:40px;border-bottom:1px solid #f1f1f1;padding:0 %?30?%;font-size:%?32?%\n}\n.picker-modal .picker-control .cancel[data-v-9377d82e]{width:50%;text-align:left;color:#666\n}\n.picker-modal .picker-control .confirm[data-v-9377d82e]{width:50%;text-align:right;color:#20b21f\n}\n.picker-modal .picker[data-v-9377d82e]{width:100%;height:220px\n}\n.picker-modal .picker .item[data-v-9377d82e]{line-height:40px\n}\nuni-picker-view-column[data-v-9377d82e]{text-align:center\n}\n.uni-picker__content[data-v-9377d82e],uni-picker-view[data-v-9377d82e]{height:220px\n}",""])},e62d:function(e,t,i){var a=i("a757");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("2490d01b",a,!0,{sourceMap:!1,shadowMode:!1})},f5b6:function(e,t,i){"use strict";var a=i("8a6e"),n=i.n(a);n.a}}]);