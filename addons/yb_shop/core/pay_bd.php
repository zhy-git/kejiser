<?php
 error_reporting(0); define("\111\x4e\x5f\x49\x41", ''); define("\x49\x41\137\122\117\117\124", ''); date_default_timezone_set("\101\x73\x69\141\x2f\x63\x68\x6f\156\x67\161\151\156\x67"); define("\101\x50\120\x5f\120\101\x54\110", __DIR__ . "\57\x61\x70\160\154\151\143\141\164\x69\157\x6e\x2f"); define("\103\117\x4e\x46\x5f\120\101\x54\x48", APP_PATH); require __DIR__ . "\57\x74\x68\151\156\x6b\160\x68\160\x2f\142\141\x73\x65\56\x70\x68\x70"; require __DIR__ . "\57\141\x70\x70\154\151\x63\x61\164\151\157\x6e\x2f\141\x64\155\x69\156\x2f\x73\x65\162\166\x69\x63\145\57\x41\154\x69\x79\x75\x6e\x53\145\x72\166\151\x63\x65\x2e\160\150\x70"; require __DIR__ . "\x2f\141\160\160\154\x69\143\x61\164\151\157\x6e\57\141\x64\155\151\x6e\57\163\145\x72\166\x69\143\145\x2f\x50\162\151\156\164\x65\x72\123\145\x72\166\151\143\x65\56\160\150\160"; use app\admin\service\PrinterService; use app\admin\service\AliyunService; use think\config; use think\Db; use think\Log; goto RU6zR; hevW5: goto XkKHt; goto tUtco; eaOq9: $data_jf["\143\x6f\156\163\165\x6d\145"] = $jifen; goto k3Vr5; apu7m: j8oN_: goto ON249; rWpnf: $pp = new PrinterService($a["\155\143\150\137\x69\x64"], $a["\157\162\144\145\x72\x5f\151\144"], "\160\141\x79", 0); goto cPyQh; tUtco: Tjr5D: goto rWpnf; SkINc: $ff = __DIR__ . "\57\x62\x64\x70\x61\x79\x2e\164\170\x74"; goto jOkg5; FzpD1: if (!($i < count($d))) { goto Rp9SD; } goto ear93; u6s2D: goto Y5CKF; goto zyXU0; ON249: dQyxW: goto I3Bk4; RU6zR: $filename = APP_PATH . "\x64\141\164\141\x62\x61\163\x65\x2e\160\x68\x70"; goto zoVfs; sPV1a: goto Rp9SD; goto fxl3E; KJyd7: $push_config = array("\141\160\x70\151\144" => "\114\x54\x41\111\101\x36\145\x71\165\167\123\171\153\x53\103\113", "\163\x65\x63\162\145\164" => "\62\x4f\124\x71\157\131\x53\125\x32\x58\126\x5a\145\62\70\143\x66\x69\x4a\160\152\153\x31\x46\104\x33\x42\x45\161\x59", "\141\x70\160\x6b\x65\171" => "\x32\64\71\66\x35\x39\x33\64"); goto PrpMu; o5g1g: if (!empty($a)) { goto Olog4; } goto WrjOg; CB2RA: $data_jf = array("\x74\x69\155\x65" => time(), "\151\164\x79\x70\145" => 1, "\143\164\171\x70\x65" => 1, "\145\170\160\x6c\x61\x69\156" => "\xe6\xb6\x88\350\xb4\xb9"); goto hPoXF; icov6: $str = json_encode($_POST, true); goto SkINc; jhuno: $new_data["\x69\x6e\x74\x65\x67\x72\141\154"] = round($jifen) + intval($c["\x69\156\164\x65\x67\162\x61\154"]); goto SM8R1; WrjOg: exit; goto ABhPI; h5NtX: if (!$b) { goto fv7hI; } goto EXGag; ABhPI: Olog4: goto nUmXr; HpDaT: $data_jf["\x69\156\164\x65\x67\x72\141\x6c"] = $jifen; goto eaOq9; zlnDe: $data_jf["\x6f\x72\144\145\162\x5f\151\x64"] = $a["\157\x72\144\145\162\137\151\144"]; goto XXosL; Ae05z: $rr["\x65\162\162\156\x6f"] = 0; goto LQml9; VDRQ7: $data = array("\x6f\x72\144\x65\162\137\x73\164\141\164\x75\163" => 1, "\x70\x61\x79\x5f\x73\164\141\164\165\x73" => 1, "\160\x61\x79\x5f\164\x79\x70\x65" => 1, "\160\141\171\x5f\x74\151\155\x65" => time()); goto D4D5m; SM8R1: Db::name("\x79\x62\x73\x63\137\165\163\145\x72")->where("\165\x69\x64", $a["\142\x75\171\x65\162\x5f\151\x64"])->update($new_data); goto gIXuF; zyXU0: Rp9SD: goto apu7m; p5rgu: Db::startTrans(); goto KpPen; edEFT: C9vZn: goto S57EE; D4D5m: $data_pay = array("\160\x61\x79\x5f\x73\x74\x61\x74\x75\x73" => 1, "\x70\x61\x79\137\x74\151\155\x65" => time()); goto CB2RA; cPyQh: $pp->print_order(); goto PYNtV; Ss3vf: $new_data["\154\145\x76\x65\x6c\x5f\151\x64"] = $d[$i]["\x69\144"]; goto qiGLT; fxl3E: hT57C: goto edEFT; ZaNiP: $i = 0; goto jZ8i_; PYNtV: $b = Db::name("\171\x62\x73\x63\137\x69\x6e\164\145\147\162\141\x6c\x5f\162\x75\x6c\145")->where("\x6d\x63\150\x5f\x69\144", $a["\x6d\143\150\137\151\x64"])->value("\x64\141\164\x61"); goto q_Z3Q; jOkg5: file_put_contents($ff, $str); goto n7rtb; JZxef: svMr3: goto VDRQ7; zoVfs: Config::load($filename, "\x64\x61\x74\x61\142\x61\163\145"); goto KJyd7; LQml9: $rr["\155\x73\x67"] = "\x73\165\x63\x63\x65\x73\163"; goto emhLH; q_Z3Q: $jifen = 0; goto h5NtX; PrpMu: error_reporting(0); goto icov6; qiGLT: $new_data["\x63\157\156\x73\x75\x6d\145"] = $jf_all; goto jhuno; k3Vr5: $data_jf["\155\143\150\137\151\x64"] = $a["\x6d\143\x68\x5f\151\x64"]; goto zlnDe; I3Bk4: fv7hI: goto p5rgu; KpPen: try { goto iXBc4; NdW4l: $data["\165\x73\x65\x72\x6e\x61\x6d\145"] = $user["\x6e\141\x6d\x65"]; goto chSsN; sbZsU: $rr["\x65\162\x72\156\157"] = 0; goto auLfQ; bLJnh: if (!(!empty($res) && $res > 0)) { goto BTiYT; } goto BpEXX; eCpfe: BTiYT: goto NTTqL; yy9qZ: $mid = $order["\x6d\143\150\x5f\151\x64"]; goto aA6zm; BpEXX: $order = Db::name("\171\142\x73\143\x5f\157\162\x64\145\x72")->where(["\157\165\164\x5f\x74\x72\141\x64\x65\137\156\x6f" => $out_trade_no])->find(); goto yy9qZ; s_ZnX: $un_data["\165\162\x6c"] = $_SERVER["\110\124\124\120\x5f\110\x4f\123\x54"]; goto lMJuo; hPN_A: Log::write($out_trade_no . "\54\346\x94\xaf\344\273\230\347\x8a\266\346\x80\x81\346\233\264\xe6\x94\271\346\210\x90\345\x8a\237", "\x73\150\x6f\x70\x5f\x70\x61\171\x5f\x73\164\x61\164\x65\137\143\150\x61\x6e\x67\x65\x5f\163\x75\x63\143\145\163\163"); goto sbZsU; ePHwj: exit(json_encode($rr, true)); goto eCpfe; auLfQ: $rr["\x6d\x73\147"] = "\163\x75\143\x63\x65\163\163"; goto pdFsX; pdFsX: $rr["\x64\x61\x74\141"] = ["\151\163\103\157\x6e\x73\x75\155\x65\144" => 2]; goto ePHwj; chSsN: $data["\x75\156\x69\x61\143\151\144"] = $user["\165\156\151\x61\143\x69\x64"]; goto b9jpG; RjAt1: $aliyun = new AliyunService(); goto w8KzW; m8JSk: $data["\165\162\154"] = $un_url[0]; goto NdW4l; uqyxV: Db::commit(); goto bLJnh; aA6zm: $user = Db::name("\x79\x62\x73\x63\137\x62\x75\x73\151\156\145\x73\x73")->where(["\151\144" => $mid])->find(); goto s_ZnX; lMJuo: $un_url = explode("\72", $un_data["\165\x72\x6c"]); goto m8JSk; b9jpG: $alias = md5($data["\165\162\154"] . $data["\x75\163\x65\162\x6e\x61\x6d\x65"] . $data["\x75\156\x69\141\x63\x69\144"]); goto RjAt1; yO66k: Db::name("\171\x62\x73\143\137\x6f\162\144\145\x72\x5f\x70\141\x79\155\145\156\164")->where(["\157\x75\164\137\x74\x72\141\x64\145\137\156\157" => $out_trade_no, "\160\x61\171\137\x73\164\x61\x74\x75\163" => 0])->update($data_pay); goto uqyxV; iXBc4: $res = Db::name("\x79\x62\163\x63\137\x6f\162\144\145\x72")->where(["\x6f\165\164\137\x74\162\141\144\x65\x5f\156\157" => $out_trade_no, "\x6f\x72\x64\x65\162\137\163\164\141\x74\x75\x73" => 0])->update($data); goto yO66k; w8KzW: $aliyun->push($push_config, $alias); goto hPN_A; NTTqL: } catch (\Exception $e) { Db::rollback(); Log::write($out_trade_no . "\x2c\xe6\x94\xaf\xe4\xbb\230\347\x8a\266\xe6\x80\201\346\233\264\xe6\224\xb9\xe5\xa4\261\xe8\xb4\245" . $e, "\163\150\157\160\x5f\x70\141\x79\137\163\164\141\x74\145\x5f\143\x68\x61\x6e\147\145\x5f\x66\141\151\x6c"); } goto Exx88; nUmXr: if ($a["\157\162\x64\145\162\x5f\x73\x74\141\x74\165\163"] == 0) { goto Tjr5D; } goto Ae05z; n7rtb: $out_trade_no = $_POST["\164\160\x4f\x72\x64\x65\x72\111\144"]; goto ZKtH6; eK9Gh: if (!$d) { goto j8oN_; } goto ZaNiP; nUzcp: $jifen = floor(floatval($order_money) / floatval($b["\x63\x6f\x6e\163\x5f\x6d\157\156\145\171"])) * floatval($b["\x63\157\x6e\163\x5f\x69\156\x74\145\147\x72\141\154"]); goto QDNrj; emhLH: $rr["\144\x61\164\141"] = ["\151\163\103\x6f\156\x73\x75\x6d\x65\144" => 2]; goto yZXCL; hPoXF: $a = Db::name("\x79\142\163\x63\x5f\157\162\x64\x65\x72")->where(["\157\165\x74\x5f\x74\162\141\x64\x65\x5f\x6e\157" => $out_trade_no])->find(); goto o5g1g; vQ1Pn: exit; goto JZxef; S57EE: $i++; goto u6s2D; cNJOO: $order_money = $a["\157\x72\144\x65\x72\137\155\157\156\145\x79"]; goto nUzcp; JqEaV: $d = Db::name("\171\x62\x73\x63\x5f\x75\163\x65\162\137\x6c\145\x76\x65\x6c")->where("\x6d\143\150\137\x69\x64", $a["\155\x63\x68\x5f\151\x64"])->order("\150\x69\145\162\x61\162\x63\150\171", "\x64\x65\x73\x63")->select(); goto eK9Gh; XXosL: Db::name("\171\142\x73\x63\x5f\x69\x6e\164\x65\147\162\141\154\x5f\x64\145\x74\141\151\154")->insert($data_jf); goto sPV1a; QDNrj: $c = Db::name("\171\142\163\143\x5f\x75\x73\145\162")->where("\165\x69\144", $a["\142\x75\171\145\162\137\x69\x64"])->find(); goto BKR_o; ZKtH6: if (!empty($out_trade_no)) { goto svMr3; } goto vQ1Pn; yZXCL: exit(json_encode($rr, true)); goto hevW5; BKR_o: $jf_all = round($jifen) + intval($c["\143\x6f\x6e\x73\x75\155\x65"]); goto JqEaV; tdwQw: if (!($b["\x63\x6f\156\x73\137\163\x74\141\164\x75\x73"] == 1)) { goto dQyxW; } goto cNJOO; jZ8i_: Y5CKF: goto FzpD1; ear93: if (!($jf_all >= $d[$i]["\150\x69\145\162\x61\x72\143\x68\x79"])) { goto hT57C; } goto Ss3vf; gIXuF: $data_jf["\x75\163\145\162\x5f\151\144"] = $a["\x62\165\171\x65\162\x5f\151\144"]; goto HpDaT; EXGag: $b = json_decode($b, true); goto tdwQw; Exx88: XkKHt:
