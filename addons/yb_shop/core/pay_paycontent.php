<?php
 error_reporting(0); define("\111\x4e\x5f\x49\x41", ''); define("\111\x41\x5f\122\x4f\x4f\x54", ''); date_default_timezone_set("\x41\x73\x69\141\x2f\x63\x68\x6f\156\x67\x71\151\x6e\x67"); define("\x41\120\120\x5f\120\101\x54\110", __DIR__ . "\x2f\141\160\x70\x6c\x69\143\x61\x74\x69\x6f\x6e\x2f"); define("\x43\x4f\x4e\x46\x5f\x50\x41\x54\110", APP_PATH); define("\105\x58\x54\x45\116\x44\x5f\120\101\x54\110", __DIR__ . "\57\145\170\164\145\156\x64\57"); require __DIR__ . "\57\164\x68\x69\156\153\x70\150\x70\57\x62\141\x73\145\56\x70\150\x70"; require EXTEND_PATH . "\x57\170\x70\141\x79\57\127\170\120\x61\171\56\x41\x70\x69\56\x70\x68\160"; use think\config; use think\Db; use think\Log; use think\Exception; goto H25Mq; emFd1: if (!$info) { goto dhHBH; } goto OgM83; OgM83: Db::startTrans(); goto g2vsO; g_kJe: zNmOt: goto M7w1u; zGUlv: $data_pay = array("\x70\x61\x79\x5f\x73\164\141\x74\x75\163" => 1, "\x70\141\x79\x5f\x74\x69\155\145" => time()); goto gFwVa; qeyMD: $data = array("\151\x73\120\141\171" => 1, "\x70\141\171\x54\151\x6d\x65" => time()); goto zGUlv; M7w1u: libxml_disable_entity_loader(true); goto Cn3qP; g2vsO: try { goto SppyH; mvrd_: Db::name("\171\x62\x73\x63\x5f\160\x61\171\x63\157\x6e\x74\145\156\164\137\x75\x73\x65\x72")->insert($udata); goto dox11; xoV4d: Db::name("\171\x62\163\143\137\x70\x61\171\x63\157\x6e\x74\145\x6e\164\x5f\165\x73\x65\162")->where(["\165\151\x64" => $info["\165\x69\x64"], "\155\143\150\137\151\144" => $info["\155\x63\150\x5f\151\144"]])->update(["\145\x78\160\x69\x72\x65" => $expire]); goto s45Hw; SppyH: Db::name("\171\x62\x73\x63\x5f\x70\x61\171\x63\157\x6e\164\x65\156\x74\137\x70\141\171\x6d\145\156\164")->where(["\x6f\x75\x74\x5f\164\162\x61\144\x65\x5f\156\157" => $out_trade_no, "\x70\x61\171\137\163\164\141\x74\165\163" => 0])->update($data_pay); goto dcJyC; s45Hw: goto gAAHn; goto L85hZ; eTfBL: $user = Db::name("\171\142\163\x63\137\160\141\x79\x63\x6f\x6e\x74\x65\x6e\x74\137\165\x73\145\162")->where(["\x75\151\144" => $info["\x75\x69\x64"], "\155\x63\x68\x5f\151\x64" => $info["\x6d\143\x68\137\x69\x64"]])->find(); goto RZjgh; nf0Ad: $udata["\165\151\x64"] = $info["\x75\151\x64"]; goto bkxQx; jkYvC: if (empty($user)) { goto Y5K0u; } goto xaSTA; h23Ku: $expire = $user["\145\170\160\151\x72\145"] + $info["\144\141\x79"] * 24 * 60 * 60 * $info["\156\x75\x6d"]; goto xoV4d; ZMkEd: Db::name("\x79\142\163\x63\137\160\141\171\x63\x6f\156\164\x65\156\x74")->where(["\151\x64" => $info["\x63\x6f\x6e\164\x65\156\164\x5f\151\x64"], "\x6d\x63\150\x5f\151\x64" => $info["\155\143\150\137\x69\x64"]])->setInc("\x62\x75\x79\137\143\x6f\165\156\164\137\x72\145\x61\x6c"); goto Az2au; RZjgh: $time = time(); goto jkYvC; Qvxod: $udata["\x65\170\x70\x69\162\145"] = $time + $info["\144\141\171"] * 24 * 60 * 60 * $info["\x6e\165\155"]; goto mvrd_; JSc1j: if (!($info["\x70\x72\151\143\145\x5f\151\x64"] > 0)) { goto aMMiH; } goto eTfBL; xaSTA: $user["\145\170\160\x69\162\145"] = $user["\145\x78\160\x69\x72\x65"] < $time ? $time : $user["\145\x78\160\x69\162\x65"]; goto h23Ku; dox11: gAAHn: goto PljLp; PljLp: aMMiH: goto ZMkEd; dcJyC: $res = Db::name("\171\x62\163\x63\x5f\x70\x61\171\x63\157\156\164\x65\x6e\164\137\x6f\162\x64\145\162\163")->where(["\x6f\165\x74\137\164\x72\x61\144\145\x5f\156\157" => $out_trade_no, "\x69\x73\x50\141\171" => 0])->update($data); goto JSc1j; Az2au: Db::commit(); goto beKkn; bkxQx: $udata["\x6d\x63\150\137\x69\x64"] = $info["\155\143\x68\x5f\x69\x64"]; goto Qvxod; L85hZ: Y5K0u: goto nf0Ad; beKkn: } catch (\Exception $e) { Db::rollback(); Log::write($out_trade_no . "\54\346\x94\xaf\xe4\xbb\230\xe7\x8a\xb6\xe6\200\x81\346\x9b\264\346\224\271\xe5\xa4\261\xe8\xb4\xa5" . $e, "\160\141\171\x63\x6f\x6e\x74\145\x6e\x74\x5f\x70\141\x79\137\x73\x74\141\x74\x65\137\x63\150\141\x6e\x67\145\x5f\x66\141\151\x6c"); } goto Z0hWE; gFwVa: $info = Db::name("\171\x62\x73\143\137\160\141\171\x63\x6f\x6e\164\x65\x6e\x74\x5f\x6f\x72\x64\145\162\x73")->where(["\157\165\164\137\164\x72\x61\144\145\x5f\156\x6f" => $out_trade_no, "\x69\x73\x50\x61\171" => 0])->find(); goto emFd1; Cn3qP: $doc = new \DOMDocument(); goto kbV7U; NRrx5: exit("\346\234\xaa\xe6\224\xb6\xe5\x88\260\xe5\233\236\xe8\xb0\x83"); goto g_kJe; P65c1: $out_trade_no = $doc->getElementsByTagName("\157\165\x74\x5f\164\x72\x61\144\145\137\156\x6f")->item(0)->nodeValue; goto qeyMD; Fn4ur: Config::load($filename, "\144\x61\x74\x61\x62\141\163\145"); goto d4frh; kbV7U: $doc->loadXML($notify_data); goto P65c1; H25Mq: $filename = APP_PATH . "\x64\141\164\141\142\x61\163\145\56\x70\150\x70"; goto Fn4ur; IFzix: $notify_data = isset($GLOBALS["\x48\124\x54\x50\137\x52\101\x57\137\120\117\x53\x54\x5f\x44\x41\x54\x41"]) ? $GLOBALS["\x48\124\x54\x50\x5f\x52\101\127\x5f\120\117\x53\124\x5f\104\x41\124\x41"] : file_get_contents("\x70\150\160\x3a\x2f\x2f\151\156\160\x75\164"); goto aDg1X; aDg1X: if ($notify_data) { goto zNmOt; } goto NRrx5; d4frh: error_reporting(0); goto IFzix; Z0hWE: dhHBH:
