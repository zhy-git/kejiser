<?php
 define("\111\x4e\x5f\x49\101", ''); define("\x49\x41\137\122\117\117\124", ''); date_default_timezone_set("\101\163\x69\141\57\143\150\157\156\x67\x71\151\x6e\147"); define("\101\120\x50\x5f\120\x41\124\110", __DIR__ . "\x2f\x61\160\x70\x6c\x69\x63\141\164\151\157\x6e\57"); define("\x43\117\116\106\137\120\x41\124\110", APP_PATH); define("\105\x58\124\x45\x4e\x44\x5f\x50\101\124\110", __DIR__ . "\x2f\x65\170\164\x65\x6e\144\x2f"); define("\102\x41\123\x45\137\x52\117\117\124", str_replace("\x63\157\162\x65\57", '', __DIR__ . "\x2f")); require __DIR__ . "\x2f\x74\150\151\156\153\160\150\x70\57\142\141\x73\x65\56\160\x68\x70"; require EXTEND_PATH . "\127\170\160\141\171\x2f\127\170\x50\x61\171\x2e\101\160\x69\56\160\150\160"; require __DIR__ . "\57\141\x70\160\x6c\x69\143\x61\x74\x69\x6f\156\x2f\141\x70\151\x2f\163\145\162\166\x69\143\145\x2f\101\x72\x6c\x69\153\151\123\x65\162\x76\x69\x63\145\56\160\150\x70"; use app\api\service\ArlikiService; use think\config; use think\Db; use think\Log; goto Bts3l; rMB8d: $notify_data = file_get_contents("\160\x68\x70\72\57\57\x69\x6e\x70\165\164"); goto SKUAX; z1VRV: Db::startTrans(); goto WlJOu; Tc9ee: libxml_disable_entity_loader(true); goto cTIxx; RDfvF: rr35c: goto jP1N5; jdcMy: $data_pay = array("\x70\141\x79\137\x73\x74\141\x74\165\x73" => 1, "\160\141\171\137\164\151\155\145" => time()); goto z1VRV; Bts3l: $filename = APP_PATH . "\144\141\x74\141\x62\x61\163\x65\x2e\160\x68\x70"; goto PXIlT; srHQG: $out_trade_no = $doc->getElementsByTagName("\x6f\x75\x74\x5f\164\162\141\144\x65\x5f\156\157")->item(0)->nodeValue; goto q5QZk; Mu1O7: MFfxb: goto Tc9ee; QAVBE: $notify_data = $GLOBALS["\x48\124\x54\x50\x5f\x52\101\127\x5f\x50\117\x53\x54\x5f\104\101\124\101"] ?: ''; goto RDfvF; jP1N5: if ($notify_data) { goto MFfxb; } goto lRO3b; SKUAX: if ($notify_data) { goto rr35c; } goto QAVBE; PXIlT: Config::load($filename, "\x64\141\164\141\142\141\163\x65"); goto rMB8d; q5QZk: $data = array("\x6f\162\x64\x65\162\x5f\163\x74\x61\x74\x75\163" => 1, "\160\x61\171\x5f\x73\164\x61\164\x75\x73" => 1, "\160\141\x79\x5f\x74\x79\x70\x65" => 1, "\x70\x61\171\137\x74\151\x6d\x65" => time()); goto jdcMy; lRO3b: exit("\346\234\xaa\xe6\x94\266\xe5\x88\260\xe5\x9b\x9e\350\260\x83"); goto Mu1O7; cTIxx: $doc = new \DOMDocument(); goto QhcSl; QhcSl: $doc->loadXML($notify_data); goto srHQG; WlJOu: try { goto HdH2C; BBFgp: Log::write($out_trade_no . "\x2c\xe6\x94\257\xe4\273\x98\xe7\x8a\xb6\346\x80\x81\xe6\233\xb4\346\x94\271\xe6\x88\x90\xe5\x8a\x9f", "\155\163\x5f\x70\141\x79\137\x73\164\141\x74\x65\x5f\x63\x68\x61\x6e\x67\x65\x5f\x73\x75\x63\143\145\x73\163"); goto SFuOx; i4Ild: Db::commit(); goto BBFgp; fG4Gu: $res = Db::name("\171\142\x73\143\137\x61\x63\x74\x69\x76\151\x74\171\x5f\x6f\162\x64\x65\x72")->where(["\x6f\x75\164\x5f\x74\x72\141\x64\x65\137\x6e\x6f" => $out_trade_no, "\x6f\x72\144\145\162\137\163\164\141\x74\165\163" => 0])->update($data); goto WM2kq; SFuOx: $sms = new ArlikiService($info["\155\143\150\137\151\144"]); goto gEbJp; HdH2C: $info = Db::name("\171\142\x73\x63\137\141\x63\x74\x69\166\151\x74\171\137\x6f\162\144\145\162")->where(["\157\x75\x74\137\x74\162\x61\144\145\137\156\x6f" => $out_trade_no, "\157\162\x64\145\162\x5f\163\x74\x61\x74\165\x73" => 0])->find(); goto fG4Gu; gEbJp: $r = $sms->send_sms($info["\x6f\162\x64\145\162\137\x6e\x6f"] . "\50\347\247\222\346\x9d\x80\51", 2); goto IJnHV; WM2kq: Db::name("\171\142\x73\x63\x5f\141\143\164\151\166\151\x74\x79\137\157\162\x64\x65\x72\137\x70\x61\171\x6d\145\x6e\164")->where(["\157\x75\164\137\164\x72\141\x64\x65\137\x6e\x6f" => $out_trade_no, "\160\141\x79\x5f\x73\x74\141\x74\x75\x73" => 0])->update($data_pay); goto i4Ild; IJnHV: } catch (\Exception $e) { Db::rollback(); Log::write($out_trade_no . "\x2c\xe6\x94\257\xe4\273\230\347\x8a\266\xe6\x80\x81\346\233\264\346\x94\xb9\345\244\261\350\264\xa5" . $e, "\155\x73\x5f\160\141\x79\x5f\163\164\141\x74\145\137\143\150\x61\x6e\x67\145\x5f\146\141\x69\x6c"); }
