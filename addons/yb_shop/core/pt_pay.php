<?php
 error_reporting(0); define("\x49\116\x5f\111\x41", ''); define("\x49\x41\x5f\x52\117\117\124", ''); date_default_timezone_set("\x41\163\x69\141\x2f\x63\150\157\156\x67\161\x69\156\x67"); define("\x41\120\x50\137\x50\x41\124\x48", __DIR__ . "\x2f\x61\160\160\x6c\151\143\x61\164\151\x6f\156\x2f"); define("\103\x4f\116\x46\137\120\x41\124\x48", APP_PATH); define("\105\x58\124\105\116\x44\137\120\x41\x54\x48", __DIR__ . "\57\145\x78\x74\x65\x6e\144\57"); define("\x42\x41\x53\105\137\x52\117\117\124", str_replace("\143\157\x72\145\x2f", '', __DIR__ . "\57")); require __DIR__ . "\57\164\x68\151\x6e\153\x70\x68\x70\x2f\142\x61\163\145\56\x70\150\x70"; require EXTEND_PATH . "\x57\170\160\141\171\57\127\x78\x50\141\171\x2e\101\x70\151\56\160\x68\160"; require __DIR__ . "\x2f\x61\x70\160\x6c\x69\143\x61\x74\151\157\156\57\141\160\x69\137\x63\157\x6d\155\x6f\156\56\x70\150\160"; require __DIR__ . "\x2f\x61\160\x70\154\151\143\x61\x74\151\x6f\156\57\x61\x70\151\x2f\163\145\162\166\151\x63\145\x2f\101\162\x6c\x69\x6b\151\x53\x65\162\166\x69\143\x65\x2e\160\x68\160"; use app\api\service\ArlikiService; use think\config; use think\Db; use think\Log; use think\Exception; goto UQe0U; BJhpL: $notify_data = isset($GLOBALS["\x48\124\124\x50\x5f\x52\101\127\x5f\x50\x4f\123\124\x5f\104\x41\x54\x41"]) ? $GLOBALS["\110\x54\124\x50\137\122\101\x57\137\x50\117\x53\124\x5f\104\x41\x54\101"] : file_get_contents("\x70\x68\160\x3a\x2f\x2f\151\x6e\x70\165\164"); goto m0ZKI; q0RAT: try { goto SLBbV; YdQdO: U_MYr: goto zkEei; ty8ro: eRauA: goto Cmx23; zkEei: cvOXk: goto SzThU; dDH8o: if ($groupNum == $count + 2) { goto Ci6wo; } goto LEzVz; G8I2D: if (!($info["\160\x69\144"] != 0 && $info["\x69\x73\107\162\157\165\160"] == 1)) { goto U_MYr; } goto qsEPK; WwP_e: $data = json_encode($params, true); goto qpnhK; ifuNk: Log::write($out_trade_no . "\x2c\346\213\xbc\345\x9b\xa2\346\216\250\351\200\201" . var_dump($result), "\160\x74\137\160\141\x79\137\x70\165\163\x68"); goto viCN5; QlK5P: $new_data["\164\145\x6d\x70\x6c\x61\x74\x65\x5f\x69\144"] = $template_id; goto p1a3_; wuxFq: $groupNum = Db::name("\171\x62\163\143\137\x70\164\x5f\x67\x6f\x6f\x64\163")->where("\x69\144", $info["\147\x69\144"])->value("\147\162\157\x75\x70\x4e\165\155"); goto YFMVv; ja7Md: if ($info["\x69\x73\x47\162\157\x75\160"] == 0) { goto HJBdg; } goto gfIVz; v3sqM: if (!((int) $groupNum == $count)) { goto LMvoe; } goto RPzXO; Ao1w4: LMvoe: goto qoB2Y; AiX2t: Log::write($out_trade_no . "\54\346\224\257\344\xbb\x98\xe7\x8a\266\346\x80\201\346\x9b\264\xe6\224\xb9\346\210\x90\xe5\x8a\x9f\x5f\x6c\141\x73\164", "\160\164\x5f\160\x61\x79\137\163\x74\x61\164\145\137\143\x68\x61\x6e\147\x65\x5f\x73\165\x63\x63\145\x73\x73\x32"); goto g5Yda; gMcw4: if (!$aa) { goto RxDtt; } goto CR2bx; ny5wr: if (!($temp && !empty($order))) { goto qkoJ0; } goto uGjFk; xiwFM: Ci6wo: goto wex87; p1a3_: $new_data["\160\141\147\x65"] = "\x79\x62\x5f\x74\165\x61\x6e\x67\157\165\x2f\160\x61\x67\x65\x73\57\151\x6e\144\x65\170\57\x69\x6e\144\x65\x78"; goto n0ZuH; zv1S1: if (!$res) { goto XKNsV; } goto AiX2t; YNSHd: $push_url = "\150\164\x74\x70\163\x3a\x2f\57\141\x70\151\56\x77\x65\x69\x78\x69\x6e\56\x71\161\56\143\x6f\155\x2f\x63\x67\151\x2d\142\x69\156\57\155\x65\163\163\x61\x67\145\x2f\x77\x78\157\160\x65\156\57\164\x65\x6d\x70\x6c\141\x74\145\57\163\145\156\144\77\141\143\x63\145\x73\163\137\x74\157\x6b\145\156\x3d" . $access_token["\141\x63\143\x65\x73\x73\137\164\157\153\x65\156"]; goto WwP_e; VjSwt: goto cvOXk; goto XTKHi; Qxcqt: $order_p = Db::name("\x79\142\163\143\137\160\x74\137\x6f\x72\144\145\x72\163")->where(["\155\143\150\x5f\151\144" => $info["\x6d\x63\x68\137\151\144"], "\151\x64" => $info["\x70\151\x64"]])->find(); goto bF3ak; T0BME: $access_token = getWxAccessToken($info["\x6d\143\150\137\151\144"]); goto aKNZp; SzThU: goto zS_c9; goto fI7uY; ERJ2J: $template_id = $temp["\101\124\x30\x30\x35\61"]; goto kN_X_; xKhOU: CiQsH: goto v4aGc; XTKHi: zoDq4: goto fkFjN; dg79D: Db::commit(); goto dHbbg; aTzRy: Log::write($out_trade_no . "\54\xe6\224\xaf\344\273\x98\xe7\x8a\xb6\xe6\200\x81\xe6\x9b\xb4\346\224\271\346\x88\x90\xe5\x8a\237\x5f\x6c\141\163\x74", "\x70\x74\137\x70\141\x79\137\163\x74\141\164\145\x5f\143\x68\x61\x6e\147\145\137\x73\x75\143\x63\145\x73\x73\x32"); goto xKhOU; cCuka: qkoJ0: goto MAKYO; CFA5B: $data["\157\x72\x64\x65\x72\137\163\x74\141\164\165\x73"] = 3; goto n1vKb; P2EpX: Av7oZ: goto YdQdO; YFMVv: $count = Db::name("\171\x62\x73\x63\137\x70\164\x5f\157\x72\x64\x65\162\163")->where(["\x6d\x63\x68\137\x69\x64" => $info["\x6d\x63\x68\x5f\151\144"], "\151\x64\174\160\151\144" => $info["\x70\x69\144"], "\x69\163\x50\x61\171" => 1])->count(); goto v3sqM; kN_X_: $flag = true; goto BJERl; BJERl: l0btc: goto cCuka; OVviB: if (!$res) { goto CiQsH; } goto aTzRy; dHPo0: $new_data["\146\x6f\162\155\151\144"] = $order_p["\160\162\145\160\141\x79\x49\144"]; goto PL__4; RPzXO: $order = Db::name("\171\142\163\x63\x5f\160\164\x5f\157\162\x64\145\x72\x73")->where(["\x6d\x63\x68\x5f\x69\x64" => $info["\x6d\x63\x68\x5f\151\x64"], "\x69\x64\x7c\x70\x69\144" => $info["\x70\151\x64"]])->select(); goto n_0fj; ZHxhL: if (!$res) { goto eRauA; } goto Sx0JV; viCN5: rxy3C: goto fbayu; fI7uY: HJBdg: goto CFA5B; n0ZuH: $new_data["\x6f\x70\145\x6e\x69\144"] = Db::name("\171\142\x73\143\137\165\x73\x65\162")->where("\x75\151\144", $order_p["\x75\x69\x64"])->value("\x77\170\x5f\x6f\160\x65\156\x69\144"); goto dHPo0; ctOBd: $data_arr = array("\153\145\x79\x77\x6f\162\x64\x31" => array("\x76\x61\x6c\165\145" => $good["\x67\162\x6f\165\160\116\x75\155"], "\143\x6f\x6c\157\162" => "\x23\x34\x33\x34\63\64\63"), "\x6b\145\171\x77\x6f\x72\144\x32" => array("\166\141\x6c\165\x65" => $order_p["\x74\x6f\164\x61\x6c\x50\162\x69\x63\145"], "\143\157\154\157\x72" => "\x23\x39\x34\71\x34\71\x34"), "\x6b\145\x79\167\157\x72\144\63" => array("\166\x61\154\165\145" => $good["\156\141\x6d\145"], "\x63\x6f\154\x6f\x72" => "\x23\71\64\x39\x34\71\x34"), "\153\x65\171\x77\x6f\162\x64\x34" => array("\x76\x61\154\165\x65" => date("\x59\x2d\155\55\x64\40\110\x3a\151\72\x73", $order_p["\160\x61\171\124\x69\155\145"]), "\143\x6f\154\157\162" => "\x23\71\64\71\x34\71\64"), "\x6b\145\x79\167\x6f\x72\x64\65" => array("\x76\x61\154\x75\145" => date("\x59\x2d\155\x2d\x64\40\x48\x3a\151\72\x73", time()), "\x63\x6f\x6c\157\162" => "\43\71\64\71\64\x39\x34"), "\153\x65\171\167\x6f\162\144\66" => array("\x76\141\x6c\x75\x65" => "\xe6\213\274\xe5\233\xa2\345\267\xb2\xe6\210\220\345\212\237\xef\xbc\214\345\x95\206\345\223\201\345\x8d\xb3\345\260\x86\xe5\x8f\221\xe8\xb4\xa7\xef\xbc\x81", "\143\157\x6c\157\162" => "\43\71\x34\71\x34\71\x34")); goto QlK5P; Sx0JV: Log::write($out_trade_no . "\x2c\346\224\xaf\344\xbb\x98\347\x8a\266\xe6\200\x81\346\x9b\xb4\xe6\x94\xb9\xe6\x88\220\345\x8a\x9f\x5f\154\141\x73\x74", "\160\x74\137\x70\x61\x79\x5f\163\164\141\x74\x65\x5f\143\150\141\156\x67\145\137\163\165\143\x63\145\x73\x73\62"); goto ty8ro; B7ynl: if (empty($access_token["\x61\143\143\x65\x73\163\x5f\164\157\153\x65\x6e"])) { goto rxy3C; } goto YNSHd; g5Yda: XKNsV: goto VjSwt; qoB2Y: FYbGc: goto Qh0A8; Cmx23: zS_c9: goto dg79D; PL__4: $params = array("\164\x6f\x75\x73\145\162" => $new_data["\157\160\145\x6e\x69\144"], "\164\x65\x6d\x70\x6c\141\164\145\137\x69\x64" => $new_data["\x74\x65\x6d\x70\x6c\141\164\x65\137\151\x64"], "\x70\x61\147\145" => $new_data["\x70\141\x67\145"], "\x66\157\x72\x6d\x5f\x69\x64" => $new_data["\x66\157\x72\x6d\151\144"], "\144\x61\x74\x61" => $data_arr); goto T0BME; wex87: $aa = Db::name("\171\142\163\143\x5f\x70\x74\137\157\162\x64\145\162\x73")->where("\151\x64", $info["\x70\151\x64"])->whereOr("\x70\x69\x64", $info["\160\x69\144"])->update(["\x6f\162\x64\145\162\137\163\x74\141\x74\x75\163" => 3, "\x67\x72\157\x75\160\x54\x69\x6d\x65" => time(), "\x69\x73\120\x61\171" => 1]); goto gMcw4; HVdi_: if (empty($info)) { goto FYbGc; } goto wuxFq; qpnhK: $result = post_data2($push_url, $data, false); goto ifuNk; d9YXI: $r = $sms->send_sms($out_trade_no . "\50\xe6\213\xbc\xe5\x9b\242\x29", 2); goto HVdi_; gfIVz: if ($info["\160\151\144"] != 0) { goto zoDq4; } goto MBEBx; LEzVz: $res = Db::name("\171\x62\x73\x63\137\160\x74\137\157\162\x64\145\162\x73")->where(["\157\162\144\145\x72\x4e\x75\155" => $out_trade_no, "\157\162\x64\x65\x72\137\163\164\141\164\x75\x73" => 1, "\151\x73\x50\141\171" => 0])->update($data); goto OVviB; n1vKb: $res = Db::name("\x79\142\163\x63\x5f\160\164\137\x6f\162\x64\145\x72\163")->where(["\157\x72\x64\x65\162\116\165\x6d" => $out_trade_no, "\157\x72\144\x65\x72\137\163\164\x61\164\x75\163" => 1, "\151\x73\x50\141\x79" => 0])->update($data); goto ZHxhL; riQK8: $flag = false; goto ny5wr; n_0fj: $temp = Db::name("\171\142\x73\143\x5f\164\x6d\160\154\x5f\x64\x6f\x70\145")->where("\155\143\150\137\x69\144", $info["\155\x63\x68\137\x69\x64"])->value("\164\x65\x6d\160"); goto riQK8; dHbbg: $sms = new ArlikiService($info["\155\x63\150\137\151\144"]); goto d9YXI; v4aGc: goto Av7oZ; goto xiwFM; JF_rL: if (!$temp["\x41\x54\60\60\65\61"]) { goto l0btc; } goto ERJ2J; SLBbV: Db::name("\171\x62\x73\x63\137\160\x74\x5f\x6f\162\144\x65\162\137\x70\x61\171\x6d\145\x6e\x74")->where(["\x6f\165\164\x5f\x74\x72\141\x64\x65\137\156\157" => $out_trade_no, "\x70\x61\x79\137\163\164\141\x74\x75\163" => 0])->update($data_pay); goto ja7Md; CR2bx: Log::write($out_trade_no . "\54\346\x8b\274\345\x9b\xa2\xe7\x8a\266\xe6\x80\x81\346\233\264\346\224\271", "\160\164\x5f\x70\x61\171\137\x73\164\x61\164\x65\137\x63\150\141\x6e\x67\145\x5f\x73\165\x63\143\x65\x73\163\x31"); goto MwJda; MAKYO: if (!$flag) { goto Bus3p; } goto Qxcqt; MwJda: RxDtt: goto P2EpX; MBEBx: $res = Db::name("\x79\x62\163\x63\x5f\x70\164\x5f\x6f\x72\144\x65\x72\x73")->where(["\x6f\x72\144\145\x72\116\x75\x6d" => $out_trade_no, "\157\162\x64\x65\x72\x5f\163\164\141\x74\x75\x73" => 1, "\x69\163\x50\x61\x79" => 0])->update($data); goto zv1S1; uGjFk: $temp = json_decode($temp, true); goto JF_rL; aKNZp: Log::write($out_trade_no . "\x2c\346\213\274\345\x9b\xa2\xe6\x8e\250\xe9\x80\x81" . var_dump($access_token), "\x70\x74\x5f\160\x61\x79\137\160\x75\x73\x68\137\141\143\143\145\163\x73\137\x74\x6f\x6b\x65\x6e"); goto B7ynl; fkFjN: $groupNum = Db::name("\171\142\x73\143\137\x70\x74\x5f\147\157\x6f\x64\163")->where("\x69\144", $info["\x67\151\x64"])->value("\147\162\x6f\165\160\116\x75\x6d"); goto G8I2D; bF3ak: $good = Db::name("\x79\142\163\x63\137\x70\x74\x5f\147\x6f\157\144\163")->where(["\x69\144" => $order_p["\x67\x69\x64"]])->find(); goto ctOBd; qsEPK: $count = Db::name("\x79\x62\163\x63\137\x70\164\137\157\x72\144\145\x72\163")->where(["\160\151\x64" => $info["\160\151\144"], "\151\x73\120\x61\x79" => 1])->count(); goto dDH8o; fbayu: Bus3p: goto Ao1w4; Qh0A8: } catch (\Exception $e) { Db::rollback(); Log::write($out_trade_no . "\54\346\224\257\344\xbb\x98\xe7\x8a\xb6\346\x80\x81\xe6\x9b\xb4\346\x94\xb9\345\xa4\xb1\350\264\245" . $e, "\160\x74\x5f\x70\141\171\x5f\x73\x74\141\x74\145\x5f\143\x68\x61\156\x67\145\137\146\x61\151\154"); } goto GIOjE; hKG1k: libxml_disable_entity_loader(true); goto sg_tS; Mfgsg: exit("\346\x9c\xaa\346\x94\266\345\210\260\xe5\x9b\x9e\xe8\xb0\x83"); goto WRjGn; sg_tS: $doc = new \DOMDocument(); goto W0lZy; kNG7b: $data = array("\157\x72\144\x65\x72\137\163\x74\x61\164\165\x73" => 2, "\151\x73\120\141\x79" => 1, "\160\141\171\124\151\155\x65" => time()); goto DusRe; m0ZKI: if ($notify_data) { goto OORP0; } goto Mfgsg; yYVis: if (!$info) { goto bjjCi; } goto hgevV; UQe0U: $filename = APP_PATH . "\x64\141\x74\x61\x62\x61\163\145\x2e\160\150\x70"; goto zW8J2; nPadM: error_reporting(0); goto BJhpL; hgevV: Db::startTrans(); goto q0RAT; rLRvh: Config::load($filename, "\144\x61\x74\x61\x62\x61\163\x65"); goto nPadM; W0lZy: $doc->loadXML($notify_data); goto QCgLs; WRjGn: OORP0: goto hKG1k; DusRe: $data_pay = array("\x70\x61\171\137\163\164\141\x74\165\x73" => 1, "\160\141\x79\x5f\164\x69\x6d\x65" => time()); goto Dvphd; zW8J2: Log::write("\x31\x30\61"); goto rLRvh; QCgLs: $out_trade_no = $doc->getElementsByTagName("\157\165\x74\x5f\164\162\x61\144\145\137\156\157")->item(0)->nodeValue; goto kNG7b; Dvphd: $info = Db::name("\x79\142\x73\x63\137\x70\x74\137\x6f\x72\144\x65\162\163")->where(["\x6f\x72\x64\x65\x72\x4e\x75\x6d" => $out_trade_no, "\x69\x73\120\141\x79" => 0])->find(); goto yYVis; GIOjE: bjjCi:
