<?php
 error_reporting(0); define("\x49\x4e\x5f\111\x41", ''); define("\111\101\137\122\x4f\117\x54", ''); date_default_timezone_set("\101\x73\151\x61\57\143\150\x6f\x6e\x67\161\151\156\x67"); define("\x41\x50\x50\x5f\120\x41\124\x48", __DIR__ . "\x2f\x61\x70\x70\x6c\151\x63\x61\164\x69\157\x6e\x2f"); define("\x43\x4f\116\x46\137\x50\101\124\x48", APP_PATH); define("\x45\130\x54\105\x4e\x44\x5f\x50\101\124\x48", __DIR__ . "\57\x65\x78\164\x65\x6e\x64\57"); require __DIR__ . "\x2f\x74\150\151\156\x6b\x70\x68\x70\57\142\x61\163\145\x2e\x70\150\160"; require EXTEND_PATH . "\127\170\160\x61\x79\x2f\x57\x78\120\x61\171\x2e\x41\160\x69\56\160\x68\160"; use think\config; use think\Db; use think\Log; use think\Exception; goto Q0SM4; X_PZi: $data_jf = array("\x74\x69\x6d\x65" => time(), "\151\164\171\160\x65" => 1, "\143\x74\171\160\x65" => 1, "\145\x78\160\x6c\x61\x69\x6e" => "\344\xbc\x9a\xe5\x91\x98\xe5\205\x85\345\x80\xbc"); goto Pj8sX; aHqjC: $out_trade_no = $doc->getElementsByTagName("\157\165\164\x5f\164\x72\x61\x64\x65\x5f\156\x6f")->item(0)->nodeValue; goto vATy2; zL16Y: $data_pay = array("\160\x61\x79\137\163\x74\141\x74\x75\163" => 1, "\160\x61\x79\x5f\x74\151\155\145" => time()); goto X_PZi; U81xq: if ($notify_data) { goto PA5RK; } goto x9sGr; WDJMK: Db::startTrans(); goto zpz8C; Pj8sX: $info = Db::name("\x79\142\163\143\137\x75\163\145\162\137\x63\141\162\x64\137\157\162\x64\145\162\163")->where(["\157\165\x74\x5f\x74\x72\141\144\145\137\x6e\x6f" => $out_trade_no, "\151\163\160\x61\x79" => 0])->find(); goto YT7nq; pSYzf: $notify_data = isset($GLOBALS["\110\x54\124\120\x5f\122\101\x57\137\120\x4f\x53\124\x5f\104\x41\124\101"]) ? $GLOBALS["\110\x54\124\x50\137\x52\101\x57\137\120\x4f\x53\124\137\104\101\124\x41"] : file_get_contents("\160\x68\160\x3a\57\x2f\x69\x6e\x70\x75\164"); goto U81xq; Y5uor: if (!$info) { goto KgnqJ; } goto WDJMK; YT7nq: $user_id = Db::name("\171\142\x73\143\x5f\x75\163\x65\x72\137\143\141\x72\144")->where(["\151\x64" => $info["\x63\141\x72\x64\137\x69\144"]])->value("\x75\x73\x65\x72\137\x69\144"); goto Y5uor; kowQE: $doc = new \DOMDocument(); goto EYL16; MJASt: libxml_disable_entity_loader(true); goto kowQE; x9sGr: exit("\346\234\xaa\346\224\266\345\210\260\345\233\x9e\xe8\xb0\203"); goto VdOW6; MDCiR: error_reporting(0); goto pSYzf; Q0SM4: $filename = APP_PATH . "\x64\141\164\141\x62\x61\x73\145\56\160\x68\x70"; goto Sn6L6; VdOW6: PA5RK: goto MJASt; Sn6L6: Config::load($filename, "\x64\x61\x74\141\x62\x61\163\x65"); goto MDCiR; vATy2: $data = array("\x69\163\160\141\x79" => 1, "\160\x61\x79\x74\151\155\x65" => time()); goto zL16Y; zpz8C: try { goto IiEx5; xwg9o: B0Klq: goto JkJXr; EqCxd: if (!($info["\x69\156\164\145\x67\x72\x61\154"] && intval($info["\x69\x6e\164\x65\147\162\x61\154"]) > 0)) { goto B0Klq; } goto QUU_z; L0H_x: X8f2p: goto AplvC; se7rS: if (!($level == 1)) { goto dK803; } goto AZBpM; sJ2tk: $lxm1 = Db::name("\x79\x62\x73\x63\137\x69\x6e\164\x65\147\x72\141\x6c\137\144\145\164\x61\x69\154")->insert($new_data); goto WgdBk; djVD4: MVA13: goto wSxHy; gvY3p: if (!$d) { goto aTt5h; } goto dVBF_; XbT8U: if (!($user_data["\143\x6f\156\x73\165\x6d\145"] >= $d[$i]["\150\x69\x65\x72\141\162\143\x68\x79"])) { goto MVA13; } goto u9kw8; EIJa3: Db::name("\x79\x62\163\143\137\165\x73\145\x72\x5f\x63\x61\162\x64")->where(["\x69\144" => $info["\143\141\162\x64\137\x69\x64"], "\x69\x73\x5f\144\145\x6c" => 1])->setInc("\155\x6f\x6e\x65\x79", $money); goto n9jEC; u9kw8: $level_id = $d[$i]["\x69\144"]; goto BjbPW; j0YxH: e2TZk: goto xwg9o; e2aaH: if (!($level == 1)) { goto e2TZk; } goto ln1Qr; wSxHy: x_tUg: goto BIfZ9; dVBF_: $i = 0; goto xgB7B; eD6cl: $res = Db::name("\x79\142\x73\143\137\165\x73\145\x72\137\x63\141\x72\144\x5f\x6f\x72\x64\145\162\x73")->where(["\157\165\164\x5f\x74\x72\x61\x64\x65\137\156\x6f" => $out_trade_no, "\151\x73\160\141\x79" => 0])->update($data); goto XlXkH; BjbPW: Db::name("\171\142\x73\x63\137\x75\x73\145\162")->where("\x75\x69\144", $data["\x75\x69\x64"])->update(["\x6c\x65\166\x65\154\x5f\151\x64" => $level_id]); goto OZvuC; ln1Qr: $d = Db::name("\171\x62\163\x63\x5f\165\163\145\x72\x5f\154\x65\166\x65\154")->where("\x6d\x63\x68\137\151\x64", $data["\x6d\143\x68\137\151\144"])->order("\150\151\x65\162\141\x72\143\150\x79", "\x64\x65\163\143")->select(); goto gvY3p; QUU_z: $new_data = ["\164\x69\155\x65" => time(), "\151\x74\171\160\x65" => 1, "\143\164\x79\160\145" => 1, "\x6e\165\155\137\161\144" => 5, "\157\162\x64\145\162\137\151\144" => 0, "\165\163\145\x72\x5f\151\144" => $user_id, "\155\x63\x68\x5f\151\144" => $data["\155\x63\150\137\x69\x64"], "\x69\x6e\x74\145\147\162\x61\154" => intval($info["\x69\x6e\x74\x65\x67\162\x61\154"]), "\143\x6f\156\x73\x75\155\145" => $level == 1 ? intval($info["\151\x6e\x74\x65\x67\x72\141\154"]) : 0, "\164\x79\x70\x65\137\154\x78\x6d" => 1, "\145\170\160\154\x61\x69\156" => "\344\274\232\xe5\221\x98\345\205\x85\xe5\x80\xbc"]; goto sJ2tk; m3DuT: dK803: goto sjuvy; WgdBk: $c = Db::name("\x79\x62\x73\x63\137\165\x73\x65\x72")->where("\165\x69\x64", $data["\165\x69\x64"])->find(); goto WaJ4l; AplvC: aTt5h: goto j0YxH; WaJ4l: $user_data["\x69\156\x74\145\x67\x72\141\x6c"] = intval($c["\151\156\164\x65\x67\162\x61\x6c"]) + intval($new_data["\x69\156\164\x65\147\162\x61\154"]); goto se7rS; sjuvy: $lxm2 = Db::name("\171\x62\163\143\137\x75\x73\x65\x72")->where("\165\x69\x64", $user_id)->update($user_data); goto e2aaH; n9jEC: $level = Db::name("\171\x62\x73\143\x5f\165\x73\145\162\x5f\143\x61\162\x64\x5f\163\145\164\x74\x69\x6e\x67")->where(["\x6d\x63\150\x5f\x69\144" => $info["\155\143\x68\x5f\151\x64"]])->value("\154\145\166\145\x6c"); goto EqCxd; Id7xP: if (!($i < count($d))) { goto X8f2p; } goto XbT8U; AZBpM: $user_data["\143\x6f\x6e\163\165\x6d\145"] = intval($c["\x63\157\x6e\x73\x75\x6d\145"]) + intval($new_data["\x63\x6f\156\x73\x75\x6d\145"]); goto m3DuT; JkJXr: Db::commit(); goto SCdbx; OZvuC: goto X8f2p; goto djVD4; BdU3A: goto jnk6y; goto L0H_x; IiEx5: Db::name("\171\142\x73\143\137\x75\163\x65\x72\x5f\143\x61\162\144\x5f\160\141\x79\155\145\x6e\164")->where(["\157\x75\x74\137\x74\162\141\144\x65\x5f\x6e\x6f" => $out_trade_no, "\160\x61\171\137\x73\164\141\164\x75\x73" => 0])->update($data_pay); goto eD6cl; xgB7B: jnk6y: goto Id7xP; XlXkH: $money = floatval($info["\x70\141\171\x70\162\151\x63\145"]) + floatval($info["\147\151\x76\145\160\162\151\143\145"]); goto EIJa3; BIfZ9: $i++; goto BdU3A; SCdbx: } catch (\Exception $e) { Db::rollback(); Log::write($out_trade_no . "\x2c\xe6\x94\xaf\xe4\xbb\230\347\x8a\266\xe6\x80\201\xe6\x9b\264\346\224\271\xe5\xa4\xb1\350\xb4\245" . $e, "\143\x61\x72\x64\137\160\141\171\x5f\x73\x74\141\x74\145\x5f\x63\x68\141\x6e\x67\145\x5f\x66\141\x69\x6c"); } goto Y7a0V; EYL16: $doc->loadXML($notify_data); goto aHqjC; Y7a0V: KgnqJ:
