<?php
 namespace app\admin\service; class Yprint { public function generateSign($params, $apiKey, $msign) { goto oLgdR; anxjc: foreach ($params as $k => $v) { $stringToBeSigned .= urldecode($k . $v); Ly3QN: } goto m0V2N; E8rzr: return strtoupper(md5($stringToBeSigned)); goto bQHKl; oLgdR: ksort($params); goto Uh9Ov; Uh9Ov: $stringToBeSigned = $apiKey; goto anxjc; m0V2N: zKy0w: goto M6245; ICxUn: $stringToBeSigned .= $msign; goto E8rzr; M6245: unset($k, $v); goto ICxUn; bQHKl: } public function getStr($param) { goto Mx3Ss; zP992: return $str; goto jB_kd; gyL4z: foreach ($param as $key => $value) { $str = $str . $key . "\x3d" . $value . "\46"; CQVW9: } goto VoUcf; VTyGP: $str = rtrim($str, "\x26"); goto zP992; VoUcf: H9QnY: goto VTyGP; Mx3Ss: $str = ''; goto gyL4z; jB_kd: } public function action_print($partner, $machine_code, $content, $apiKey, $msign) { goto BwGPo; IFW6z: $str = $this->getStr($param); goto p_YHh; YxVlw: $param["\x63\157\156\164\x65\156\164"] = $content; goto IFW6z; p_YHh: return $this->sendCmd("\x68\x74\x74\x70\72\x2f\x2f\x6f\160\145\x6e\56\x31\x30\163\163\56\x6e\145\x74\x3a\70\x38\70\x38", $str); goto PZXNb; iopCv: $param["\163\151\x67\x6e"] = $this->generateSign($param, $apiKey, $msign); goto YxVlw; BwGPo: $param = array("\160\x61\162\x74\156\145\162" => $partner, "\155\141\143\x68\x69\x6e\x65\137\143\157\144\x65" => $machine_code, "\x74\151\155\x65" => time()); goto iopCv; PZXNb: } public function action_addprint($partner, $machine_code, $username, $printname, $mobilephone, $apiKey, $msign) { goto E4U6C; KWeKd: return $this->sendCmd("\x68\x74\164\160\x3a\57\x2f\157\x70\x65\x6e\56\61\x30\163\163\x2e\156\x65\164\72\x38\70\70\x38\57\141\144\x64\x70\162\x69\x6e\x74\x2e\x70\150\160", $str); goto NxV83; mv8UR: $param["\163\x69\147\156"] = $this->generateSign($param, $apiKey, $msign); goto qWhU_; AqdkY: $str = $this->getStr($param); goto KWeKd; qWhU_: $param["\x6d\163\151\147\156"] = $msign; goto AqdkY; E4U6C: $param = array("\x70\x61\x72\164\156\145\162" => $partner, "\155\x61\143\x68\x69\x6e\145\x5f\143\x6f\144\145" => $machine_code, "\x75\x73\x65\162\x6e\141\x6d\145" => $username, "\160\x72\151\156\164\156\x61\155\145" => $printname, "\155\157\x62\151\x6c\145\160\150\x6f\156\145" => $mobilephone); goto mv8UR; NxV83: } public function action_removeprinter($partner, $machine_code, $apiKey, $msign) { goto tKUmJ; tKUmJ: $param = array("\160\141\x72\x74\156\x65\162" => $partner, "\155\x61\143\x68\151\156\x65\x5f\143\157\x64\x65" => $machine_code); goto e6wup; e6wup: $param["\163\x69\x67\156"] = $this->generateSign($param, $apiKey, $msign); goto R_Bxo; VsySF: return $this->sendCmd("\150\x74\164\x70\72\x2f\x2f\x6f\160\x65\x6e\x2e\x31\60\x73\x73\x2e\x6e\x65\x74\x3a\x38\x38\70\x38\57\162\145\x6d\x6f\x76\145\160\162\x69\x6e\164\x2e\160\x68\160", $str); goto xHiWH; R_Bxo: $str = $this->getStr($param); goto VsySF; xHiWH: } public function sendCmd($url, $data) { goto Vnz70; Vnz70: $curl = curl_init(); goto DMJL6; mriI8: curl_setopt($curl, CURLOPT_POST, 1); goto EvrgK; fqenR: curl_setopt($curl, CURLOPT_HTTPHEADER, array("\x45\170\160\x65\143\x74\72")); goto P4DeG; T_mCG: curl_setopt($curl, CURLOPT_HEADER, 0); goto EapRv; P4DeG: curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); goto CU53B; kKzGW: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0); goto KYjwh; EyYJk: \Yii::trace("\346\x89\223\xe5\215\xb0\345\207\xba\xe9\x94\231\357\274\232" . curl_error($curl)); goto z2Sjs; aEQDL: curl_close($curl); goto IgTB1; CU53B: curl_setopt($curl, CURLOPT_AUTOREFERER, 1); goto mriI8; fcpuT: if (!curl_errno($curl)) { goto UXXJq; } goto EyYJk; IgTB1: return $tmpInfo; goto ki0x_; rcnlo: $tmpInfo = curl_exec($curl); goto fcpuT; z2Sjs: UXXJq: goto aEQDL; viBsW: curl_setopt($curl, CURLOPT_TIMEOUT, 30); goto T_mCG; EvrgK: curl_setopt($curl, CURLOPT_POSTFIELDS, $data); goto viBsW; EapRv: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto rcnlo; KYjwh: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2); goto fqenR; DMJL6: curl_setopt($curl, CURLOPT_URL, $url); goto kKzGW; ki0x_: } }
