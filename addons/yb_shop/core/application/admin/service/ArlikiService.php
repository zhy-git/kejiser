<?php
 namespace app\admin\service; use Aliyun\DySDKLite\SignatureHelper; use think\Cache; use think\Db; require EXTEND_PATH . "\101\x6c\151\171\x75\156\57\123\151\x67\x6e\x61\x74\x75\162\145\x48\x65\x6c\160\x65\x72\x2e\160\150\x70"; require EXTEND_PATH . "\x45\170\x70\x72\145\163\163\x2f\x4b\144\x6e\151\141\x6f\56\x41\x70\151\56\160\150\x70"; class ArlikiService extends Base { private $ali_id = ''; private $ali_token = ''; private $ali_name = ''; private $ali_code = ''; private $phone = ''; private $status = "\x32"; private $bus_id2 = ''; function __construct($mch_id) { goto azsT3; vyOTn: $this->ali_name = $re["\x61\154\151\x5f\156\141\155\x65"]; goto RNJGf; WxbGQ: $this->status = $re["\163\164\x61\x74\165\x73"]; goto z_F3A; azsT3: parent::__construct(); goto w3R4D; fByW4: $this->phone = $re["\x70\150\157\156\x65"]; goto WxbGQ; EgQJ3: $re = Db::name("\171\x62\163\x63\x5f\163\x6d\163\143\157\156\146")->where("\x6d\143\150\x5f\x69\x64", $this->bus_id2)->find(); goto DIW8H; DIW8H: $this->ali_id = $re["\x61\x6c\x69\x5f\x69\x64"]; goto CJDcV; RNJGf: $this->ali_code = $re["\x61\154\151\x5f\143\157\144\145"]; goto fByW4; CJDcV: $this->ali_token = $re["\141\154\151\137\x74\157\153\145\x6e"]; goto vyOTn; w3R4D: $this->bus_id2 = $mch_id; goto EgQJ3; z_F3A: } public function exp_load($no, $from = '') { goto Pw0AA; rJzRA: $res = $kdniao->getOrderTracesByJson($no); goto kxgLo; Pw0AA: $kdniao = new \KdniaoApi($this->bus_id2); goto rJzRA; kxgLo: return $res; goto Q8nmC; Q8nmC: } public function exp_from($no) { goto YBc4b; uwVyZ: sDpgX: goto OnGlv; tMw8U: goto OikAF; goto uwVyZ; YBc4b: $url = "\x68\x74\164\160\72\x2f\57\x6d\56\153\x75\x61\151\144\x69\61\60\60\56\143\x6f\x6d\x2f\x61\x75\x74\x6f\x6e\165\155\x62\145\162\57\141\x75\x74\x6f\x3f\x6e\165\155\75" . $no; goto fjbq1; NqqZc: if (!($i < count($res))) { goto sDpgX; } goto U1X6o; ESYTW: $i = 0; goto OLuQn; aRPM1: m_F8s: goto BcvRQ; OLuQn: OikAF: goto NqqZc; BcvRQ: $i++; goto tMw8U; U1X6o: $re[$i] = $res[$i]["\x63\157\x6d\x43\157\x64\x65"]; goto aRPM1; OnGlv: return $re; goto P0GK6; z02XM: $re = array(); goto ESYTW; fjbq1: $res = json_decode(get_url_content($url), true); goto z02XM; P0GK6: } private function exp_query($no, $from) { goto uyXQj; IsPUj: $msg["\163\164\x61\164\145"] = $state[$res["\x73\164\x61\164\145"]]; goto w12g0; MYq1m: $msg["\144\x61\164\141"] = $res["\x64\141\164\141"]; goto Ki2cC; B8w3P: $msg["\x73\x74\x61\x74\x65"] = $res["\163\164\141\164\x65"]; goto IsPUj; ydLyN: cXFpM: goto tD2Bm; uyXQj: $state = array(0 => "\xe5\x9c\250\351\200\x94\xe4\270\xad", 1 => "\345\xb7\262\xe6\217\275\xe6\x94\266", 2 => "\xe7\x96\x91\xe9\x9a\xbe", 3 => "\345\xb7\xb2\347\255\xbe\xe6\224\xb6", 4 => "\351\x80\x80\xe7\255\xbe", 5 => "\345\x90\x8c\345\237\216\xe6\xb4\xbe\xe9\200\201\xe4\xb8\xad", 6 => "\xe9\x80\200\xe5\x9b\x9e", 7 => "\xe8\275\254\xe5\215\x95"); goto ud7hz; TDJ5Z: $res = json_decode(get_url_content($url), true); goto B8w3P; Cdcqk: CRWSs: goto MYq1m; DXafS: $msg["\144\x61\164\x61"] = "\xe8\216\267\xe5\217\x96\345\xa4\xb1\350\xb4\245\x2c\xe8\257\xb7\347\250\x8d\345\x90\216\345\x86\x8d\xe8\257\x95\56"; goto fDA2I; Ki2cC: $msg["\x63\157\x64\x65"] = 1; goto ydLyN; tD2Bm: return $msg; goto XMZmE; ud7hz: $url = "\150\164\x74\160\x3a\x2f\x2f\x6d\x2e\x6b\165\141\151\144\151\61\60\60\x2e\143\x6f\x6d\x2f\161\x75\x65\x72\171\x3f\x74\x79\160\145\75" . $from . "\46\160\157\x73\164\151\144\x3d" . $no . "\46\x69\144\x3d\61\x26\166\x61\x6c\151\143\x6f\144\145\75\x26\164\x65\x6d\x70\x3d\x30\x2e\67\62\62\71\x39\60\x36\x33\x31\71\x37\x35" . rand(100, 999); goto TDJ5Z; fDA2I: $msg["\x63\x6f\144\145"] = 0; goto J_u7d; J_u7d: goto cXFpM; goto Cdcqk; w12g0: if ($res["\155\145\163\x73\x61\x67\145"] == "\157\x6b") { goto CRWSs; } goto DXafS; XMZmE: } public function send_sms($data, $phone = '', $return = false) { goto rfglU; NaS2B: HX_rK: goto xHMRX; WE0Xg: $params["\x53\x69\x67\x6e\x4e\x61\155\145"] = $this->ali_name; goto FAaBe; Wy3i2: $phone = array($phone); goto MfFFs; zWPtQ: if (!$return) { goto eWz92; } goto XeTfS; kaCrR: return $d; goto KXKBC; ZyKdk: Db::name("\x79\142\163\143\137\163\155\163\x63\x6f\x6e\x66")->where("\x6d\x63\150\137\x69\144", $this->bus_id2)->setInc("\x6f\x6b\137\165\163\145"); goto j70nw; fEdgG: $d["\x4d\x65\163\163\x61\147\x65"] = "\xe6\234\xaa\345\xbc\x80\xe5\x90\xaf\347\x9f\255\344\xbf\xa1\xe9\200\x9a\xe7\237\245"; goto kaCrR; HK6st: $res[$i] = $this->aliyun_send($params); goto ZyKdk; j70nw: mwsjA: goto y3Swi; EK2Y8: if (empty($phone)) { goto ftl3N; } goto Wy3i2; jEqAB: return $d; goto NaS2B; ZGqxf: $params["\120\x68\x6f\156\x65\x4e\165\155\142\x65\x72\x73"] = $phone[$i]; goto WE0Xg; yLtTf: if (!(!empty($params["\x54\x65\x6d\x70\x6c\x61\x74\x65\x50\x61\x72\x61\x6d"]) && is_array($params["\x54\145\x6d\x70\154\141\164\x65\120\141\162\141\x6d"]))) { goto yVfSH; } goto IO83A; FAaBe: $params["\x54\x65\155\160\x6c\x61\x74\145\x43\157\144\x65"] = $this->ali_code; goto e4z_Y; p0HkK: if (!($i < count($phone))) { goto OVNZN; } goto WETRI; xHMRX: if (!($this->status == 2)) { goto nNbQj; } goto ADZf9; w6fMh: OVNZN: goto zWPtQ; vWsqV: $phone = explode("\x2c", $this->phone); goto TuTQE; KXKBC: nNbQj: goto EK2Y8; UrXO2: eWz92: goto Ec6oZ; B2lAf: $d["\115\x65\x73\163\141\147\145"] = "\xe5\x8f\x82\346\x95\260\344\270\215\345\256\214\346\x95\264"; goto jEqAB; Z8d71: yVfSH: goto HK6st; XeTfS: return $res; goto UrXO2; a0oIS: LqK2O: goto Uy05y; cx2_X: goto aOAQF; goto w6fMh; DMrv3: $d["\x43\157\x64\x65"] = "\x30"; goto B2lAf; IO83A: $params["\x54\x65\155\x70\x6c\x61\164\x65\120\141\x72\x61\155"] = json_encode($params["\124\x65\155\x70\x6c\x61\x74\145\120\141\x72\x61\x6d"], JSON_UNESCAPED_UNICODE); goto Z8d71; LqMkh: $pa["\x6f\x72\x64\145\162"] = $data; goto a0oIS; Uy05y: $i = 0; goto t_a5n; y3Swi: l7ldz: goto YjXBM; WETRI: if (!(strlen($phone[$i]) > 5)) { goto mwsjA; } goto IacFr; IacFr: $params = array(); goto ZGqxf; S686y: if (!is_array($data)) { goto Udukt; } goto Mo7MP; fk9qv: goto LqK2O; goto zB4NY; MfFFs: goto NyN2I; goto LHvpS; rfglU: if (!(empty($this->ali_id) || empty($this->ali_token))) { goto HX_rK; } goto DMrv3; zB4NY: Udukt: goto LqMkh; Mo7MP: $pa = $data; goto fk9qv; TuTQE: NyN2I: goto S686y; LHvpS: ftl3N: goto vWsqV; ADZf9: $d["\103\x6f\144\145"] = "\x30"; goto fEdgG; t_a5n: aOAQF: goto p0HkK; YjXBM: $i++; goto cx2_X; e4z_Y: $params["\x54\x65\155\x70\x6c\x61\x74\x65\120\141\x72\x61\155"] = $pa; goto yLtTf; Ec6oZ: } public function send_test($ali_id, $ali_token, $ali_name, $ali_code, $phone) { goto jS6DT; pLH9A: $params["\x54\x65\x6d\160\x6c\x61\x74\x65\120\x61\x72\x61\x6d"] = json_encode($params["\x54\145\155\160\154\141\x74\145\120\x61\x72\141\x6d"], JSON_UNESCAPED_UNICODE); goto ovQXA; AZbSE: $params["\120\150\x6f\156\x65\x4e\165\x6d\x62\x65\162\x73"] = $phone; goto OkXgX; YrgQq: $params["\124\145\x6d\x70\x6c\141\164\x65\103\157\144\x65"] = $ali_code; goto qMUPM; jS6DT: $params = array(); goto AZbSE; qMUPM: $params["\124\145\x6d\x70\154\x61\164\x65\x50\141\x72\x61\x6d"] = array("\x6f\162\144\145\x72" => "\101\102\103\x44\105\x46"); goto i9Rh4; OkXgX: $params["\123\x69\x67\156\x4e\x61\x6d\145"] = $ali_name; goto YrgQq; ovQXA: wq1i2: goto dx5C0; fCGOO: return $res; goto RjMvM; i9Rh4: if (!(!empty($params["\x54\145\155\x70\154\x61\x74\145\120\x61\x72\141\x6d"]) && is_array($params["\x54\145\155\x70\154\x61\164\145\120\x61\162\141\x6d"]))) { goto wq1i2; } goto pLH9A; dx5C0: $res = $this->aliyun_send($params, $ali_id, $ali_token); goto fCGOO; RjMvM: } private function aliyun_send($params, $ali_id = '', $ali_token = '') { goto zqVW2; q2v0Q: $content = $helper->request($accessKeyId, $accessKeySecret, "\x64\x79\163\155\163\x61\x70\x69\56\x61\x6c\151\171\165\x6e\x63\163\56\x63\x6f\155", array_merge($params, array("\122\x65\147\x69\157\156\x49\144" => "\143\x6e\x2d\150\x61\156\147\x7a\x68\157\x75", "\101\143\x74\151\157\x6e" => "\123\145\156\x64\123\155\x73", "\x56\145\x72\x73\151\x6f\156" => "\x32\x30\x31\67\55\60\x35\55\62\x35")), $security); goto yCgJ4; apG46: if (!(!empty($ali_id) && !empty($ali_token))) { goto OIjea; } goto hZbK_; gKA7P: $accessKeySecret = $ali_token; goto bI_ei; hZbK_: $accessKeyId = $ali_id; goto gKA7P; bI_ei: OIjea: goto Q56t0; zqVW2: $accessKeyId = $this->ali_id; goto KEHqd; X0j31: $helper = new SignatureHelper(); goto q2v0Q; yCgJ4: return $content; goto kABaj; KEHqd: $accessKeySecret = $this->ali_token; goto apG46; Q56t0: $security = false; goto X0j31; kABaj: } }
