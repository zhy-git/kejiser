<?php
 namespace app\admin\service; use think\db; class BusActivity extends Base { private $contr_order_status = array("\55\x31" => "\xe5\xb7\xb2\xe5\217\226\346\266\x88", "\x30" => "\345\xbe\x85\346\x94\xaf\xe4\xbb\230", "\x31" => "\345\276\205\xe5\x8f\x91\350\264\xa7", "\62" => "\345\xbe\x85\346\224\266\xe8\xb4\xa7", "\63" => "\xe5\xb7\xb2\345\256\214\xe6\x88\x90", "\64" => "\351\x80\x80\346\254\276\344\xb8\255", "\65" => "\345\xb7\xb2\xe9\x80\x80\xe6\254\276"); function __construct() { parent::__construct(); $this->bus_activity = new \app\common\model\BusActivity(); } public function getActivityAll($condition = '', $search_text = '', $order = '') { $list = $this->bus_activity->getPageLisy($condition, $search_text, $order); return $list; } public function addActivity($activity_name, $satisfy_money, $discount_money, $star_time, $end_time, $is_use, $mch_id) { goto v3zns; mvS_a: $res = $this->bus_activity->save($data); goto isHrh; v3zns: $data = array("\141\x63\164\151\166\151\x74\171\x5f\156\x61\155\x65" => $activity_name, "\x73\141\x74\x69\163\146\x79\137\155\157\156\x65\x79" => $satisfy_money, "\144\x69\163\x63\157\x75\156\164\x5f\x6d\x6f\156\145\x79" => $discount_money, "\x73\164\x61\162\137\164\x69\155\x65" => $star_time, "\x65\156\144\x5f\164\x69\x6d\x65" => $end_time, "\x69\x73\137\165\163\x65" => $is_use, "\155\x63\150\x5f\x69\144" => $mch_id); goto mvS_a; isHrh: return $res; goto qOV7W; qOV7W: } public function editActivity($id, $activity_name, $satisfy_money, $discount_money, $star_time, $end_time, $is_use, $mch_id) { goto mRhOh; A4oEt: $res = $this->bus_activity->save($data, ["\x69\x64" => $id]); goto U6wVl; mRhOh: $data = array("\x61\143\164\x69\166\x69\x74\171\137\x6e\141\x6d\x65" => $activity_name, "\x73\141\x74\151\163\x66\171\137\155\157\x6e\x65\x79" => $satisfy_money, "\144\x69\x73\x63\157\165\156\x74\x5f\155\x6f\156\145\x79" => $discount_money, "\163\x74\141\162\137\x74\151\155\145" => $star_time, "\145\156\144\x5f\164\x69\155\x65" => $end_time, "\x69\x73\137\165\x73\x65" => $is_use, "\155\x63\x68\137\151\144" => $mch_id); goto A4oEt; U6wVl: return $res; goto N_Kns; N_Kns: } public function getActivityInfo($id) { goto Opr9l; Opr9l: $list = $this->bus_activity->getInfo(["\x69\144" => $id]); goto O80q2; SGswy: return $list; goto VEgYN; O80q2: $list["\x73\x74\x61\x72\x5f\164\151\x6d\145"] = date("\131\x2d\x6d\55\x64\x20\x48\x3a\x69\x3a\x73", $list["\x73\x74\x61\162\137\164\x69\155\x65"]); goto lFQrp; lFQrp: $list["\x65\156\144\x5f\x74\151\x6d\x65"] = date("\131\x2d\x6d\55\x64\40\x48\x3a\151\x3a\x73", $list["\145\156\x64\137\x74\151\x6d\145"]); goto SGswy; VEgYN: } public function delActivity($id, $mch_id) { $list = $this->bus_activity->destroy(["\x69\144" => $id, "\155\x63\150\x5f\x69\x64" => $mch_id]); return $list; } public function offActivity($id) { goto gXCia; BGQ2g: return $res; goto oyxAx; gXCia: $data = array("\x69\163\x5f\165\163\145" => 2); goto Ekkq3; Ekkq3: $res = $this->bus_activity->save($data, ["\151\144" => $id]); goto BGQ2g; oyxAx: } public function onActivity($id) { goto fTz9w; crpGr: return $res; goto U1jHY; fTz9w: $data = array("\151\163\x5f\165\163\x65" => 1); goto Cu5uq; Cu5uq: $res = $this->bus_activity->save($data, ["\151\x64" => $id]); goto crpGr; U1jHY: } public function get_order_list($condition, $order_no = '') { goto pfT3x; osnfK: C0BcP: goto T_j5b; o1RoO: $num_list[$s] = $list[0]; goto CGoAf; zg65B: $s = 0; goto UKZe0; CWH1t: goto GUfVm; goto wl3XQ; getlg: k8y9l: goto v1ymu; pfT3x: $url = request()->query(); goto APzqk; p2suB: unset($list[$i]["\146\x70\162\x69\x63\145"]); goto naYFO; oQm22: $condition["\157\56\157\162\144\x65\x72\x5f\x69\x64"] = $num_list[$s]["\157\162\144\145\x72\x5f\151\x64"]; goto Z0S01; lPBCq: goto i98Vq; goto oKgbZ; sXpWc: $list[$i]["\163\x68\141\x72\145\x5f\x64\x65\x74\141\x69\x6c"][$i]["\160\x69\144\61"] = $list[$i]["\160\151\144\61"]; goto LPtld; v1ymu: if (!($j < count($list))) { goto C0BcP; } goto mfHFm; U1Rvj: $i++; goto lPBCq; e6ZSI: $i = 0; goto OJ8N0; ZoyaL: $a["\x67\157\157\x64\163\x5f\137"][$j]["\x70\x72\151\x63\x65"] = $list[$j]["\x70\x72\x69\x63\x65"]; goto x5aQa; Ndojl: $a = $num_list[$s]; goto Kq432; S7n3z: $list[$i]["\163\x68\x61\162\145\137\144\x65\164\x61\x69\x6c"][$i]["\x70\151\x64\63"] = $list[$i]["\x70\151\x64\x33"]; goto Ycv5M; naYFO: unset($list[$i]["\163\x70\x72\x69\x63\x65"]); goto dlwMb; WxIhU: $j = 0; goto getlg; U9VHd: $list[$i]["\157\162\x64\x65\x72\x5f\163\164\x61\164\x75\163"] = $status[strval($list[$i]["\157\x72\x64\x65\162\137\163\164\141\164\165\163"])]; goto XR6oV; Q_H4R: $list[$i]["\x73\x68\x61\162\x65\x5f\x64\145\x74\x61\151\154"][$i]["\164\160\162\x69\x63\x65"] = $list[$i]["\164\x70\162\151\143\x65"]; goto QXhZj; BlL28: $status = $this->contr_order_status; goto jlgh1; SKbge: return $num_list; goto NTMy4; wLEDK: $j++; goto MTYzk; dlwMb: unset($list[$i]["\164\160\162\151\143\x65"]); goto k_Y2r; NZYMk: $s++; goto CWH1t; APzqk: $url = explode("\x3d\x2f", $url); goto AeiBq; NFIRU: $lists = $num_list[$s]["\x6e\x75\x6d\163"]; goto o1RoO; x5aQa: $a["\147\x6f\x6f\x64\x73\x5f\137"][$j]["\x6e\165\x6d"] = $list[$j]["\156\165\155"]; goto Y52ja; Ycv5M: $list[$i]["\x73\150\141\162\x65\x5f\144\x65\x74\141\x69\154"][$i]["\x66\x70\162\x69\x63\145"] = $list[$i]["\x66\160\x72\x69\143\x65"]; goto oPs0x; CGoAf: $a = array(); goto Dzb4Y; mfHFm: $a["\x67\157\x6f\x64\x73\137\137"][$j]["\151\155\147\x5f\160\x61\x74\x68"] = $list[$j]["\x69\155\x67\x5f\x70\141\x74\x68"]; goto OYz6R; T_j5b: $num_list[$s] = $a; goto JWIlq; Dzb4Y: if (!($lists > 1)) { goto UyORG; } goto Ndojl; jlgh1: $num_list = db::name("\x79\142\163\x63\x5f\157\x72\144\145\162\137\x67\157\157\x64\163")->alias("\147")->join("\x79\142\x73\143\x5f\157\x72\x64\x65\x72\137\x73\x68\x61\162\145\40\163", "\x73\x2e\157\x72\x64\x65\162\137\x69\x64\75\x67\56\x6f\162\144\x65\x72\x5f\x69\144")->join("\x79\x62\x73\x63\x5f\157\162\144\145\162\40\157", "\x6f\x2e\157\162\x64\145\162\x5f\151\x64\x3d\147\x2e\x6f\162\144\x65\x72\137\x69\144")->field("\x67\56\157\x72\144\x65\x72\137\x69\x64\x2c\143\x6f\x75\156\x74\50\47\163\56\157\162\x64\145\x72\137\x69\x64\x27\51\40\x6e\x75\x6d\163")->where($condition)->group("\163\56\x6f\x72\x64\x65\x72\x5f\151\x64")->order("\x73\x2e\157\x72\x64\145\x72\137\151\x64\x20\144\145\x73\143")->paginate(10, false, $config = ["\161\x75\145\x72\x79" => ["\163" => $url, "\163\x65\141\x72\143\150\x5f\x74\x65\170\x74" => $order_no]]); goto zg65B; UKZe0: GUfVm: goto Y2KNC; LPtld: $list[$i]["\x73\150\141\162\145\137\144\145\164\141\x69\x6c"][$i]["\160\151\x64\x32"] = $list[$i]["\x70\x69\x64\x32"]; goto S7n3z; XR6oV: BZxO5: goto U1Rvj; Y2KNC: if (!($s < count($num_list))) { goto H2tZs; } goto oQm22; cve7e: unset($list[$i]["\x70\x69\144\63"]); goto p2suB; QXhZj: $list[$i]["\163\x68\x61\x72\145\x5f\x64\145\x74\x61\151\154"] = $this->get_share_detail($list[$i]["\163\x68\141\x72\x65\x5f\144\145\164\x61\x69\x6c"][$i]); goto pCs0H; amb_U: $url = "\x2f" . $url[0]; goto BlL28; AeiBq: $url = explode("\x26", $url[1]); goto amb_U; Kq432: $a["\147\x6f\157\x64\x73\x5f\156\141\155\145"] = "\x2d\71\71"; goto WxIhU; Y52ja: x8_cl: goto wLEDK; oPs0x: $list[$i]["\163\150\x61\162\145\137\144\145\164\141\151\154"][$i]["\163\x70\x72\151\143\145"] = $list[$i]["\163\160\162\151\143\145"]; goto Q_H4R; oKgbZ: hoyox: goto NFIRU; j4yr9: tHj3R: goto NZYMk; JWIlq: UyORG: goto j4yr9; k_Y2r: $list[$i]["\157\x72\144\x65\162\137\164\x69\155\145"] = date("\131\55\x6d\55\x64\40\x48\72\x69\x3a\163", $list[$i]["\157\162\x64\x65\162\x5f\x74\151\155\x65"]); goto U9VHd; MTYzk: goto k8y9l; goto osnfK; Z0S01: $list = db::name("\x79\x62\163\x63\137\x6f\x72\144\145\x72")->alias("\x6f")->join("\x79\x62\163\x63\x5f\165\163\145\162\x20\165", "\x6f\x2e\142\165\171\x65\162\x5f\x69\x64\x3d\x75\56\165\x69\144")->join("\x79\142\x73\143\x5f\157\162\x64\145\x72\137\163\150\141\162\145\x20\163", "\x73\56\x6f\x72\144\145\162\137\x69\144\x3d\157\x2e\157\162\144\x65\162\x5f\151\x64")->join("\x79\142\x73\x63\x5f\157\x72\x64\x65\x72\x5f\x67\x6f\x6f\x64\163\40\147", "\x67\x2e\157\x72\144\145\x72\137\151\x64\x3d\157\x2e\157\x72\x64\145\162\137\x69\144")->join("\171\x62\x73\143\137\151\155\x61\x67\x65\163\x20\151", "\x69\x2e\x69\155\x67\137\x69\x64\x3d\x67\56\147\157\157\x64\163\137\x69\155\x61\x67\145\163")->field("\x6f\x2e\x6f\x72\x64\145\162\137\151\x64\x2c\x67\56\x67\157\x6f\144\x73\137\156\141\155\x65\54\151\x2e\x69\x6d\147\x5f\143\x6f\166\x65\x72\40\x69\x6d\x67\x5f\160\141\x74\x68\x2c\157\x2e\x6f\162\x64\x65\162\137\x6e\157\54\x6f\x2e\157\x75\164\x5f\164\x72\x61\x64\x65\137\x6e\x6f\x2c\163\x2e\143\x72\x65\141\x74\145\137\164\x69\155\145\x20\x6f\162\x64\145\162\x5f\164\x69\x6d\145\x2c\x67\x2e\160\162\x69\143\145\54\147\56\156\x75\155\x2c\165\56\156\x69\143\x6b\x5f\x6e\141\155\145\x2c\157\x2e\x70\x61\171\137\x6d\x6f\156\x65\171\x2c\x6f\56\x6f\x72\144\x65\x72\x5f\163\164\141\x74\x75\x73\x2c\163\56\x70\141\162\145\x6e\x74\137\151\x64\x5f\61\40\160\151\x64\61\54\x73\56\x70\141\x72\x65\156\164\x5f\x69\x64\137\x32\40\160\x69\x64\x32\x2c\x73\x2e\160\141\x72\x65\x6e\x74\x5f\x69\x64\137\x33\40\160\151\144\63\54\x73\56\x66\x69\162\163\x74\137\x70\162\151\143\145\40\146\160\x72\x69\143\x65\x2c\163\x2e\x73\x65\143\x6f\156\x64\137\x70\162\x69\x63\x65\40\163\160\x72\151\143\x65\54\163\56\164\x68\151\x72\144\x5f\160\x72\x69\x63\x65\40\164\x70\x72\151\143\x65\x2c\163\56\x72\x65\142\141\x74\145")->order("\157\56\157\162\x64\145\162\137\151\144\40\144\145\163\x63")->where($condition)->select(); goto e6ZSI; pCs0H: unset($list[$i]["\x70\x69\x64\61"]); goto tjxI5; g577A: if (!($i < count($list))) { goto hoyox; } goto sXpWc; OJ8N0: i98Vq: goto g577A; wl3XQ: H2tZs: goto SKbge; OYz6R: $a["\x67\157\157\144\x73\x5f\137"][$j]["\147\x6f\157\x64\163\137\156\141\x6d\x65"] = $list[$j]["\x67\157\x6f\144\163\137\x6e\x61\x6d\x65"]; goto ZoyaL; tjxI5: unset($list[$i]["\x70\x69\144\62"]); goto cve7e; NTMy4: } public function get_share_detail($arr) { goto M53EN; NIXcr: $res[$i]["\x70\162\x69\143\145"] = $arr["\146\x70\x72\151\143\145"]; goto bK4W2; PLFv9: return $res; goto eAhLY; HwMZz: idufU: goto tGlSE; bK4W2: $i++; goto I50ld; tGlSE: if (!($arr["\160\151\144\x33"] > 0)) { goto g1rl5; } goto EQBAa; wifuT: $name = db::name("\171\x62\163\x63\137\165\x73\x65\162")->field("\156\x69\x63\153\137\156\141\x6d\x65")->where("\x75\x69\x64", $arr["\x70\x69\x64\62"])->find(); goto esZoK; hiN3d: $i = 0; goto wB8_L; v8UCy: $share = db::name("\x79\142\163\x63\x5f\x75\163\x65\162\137\x73\150\x61\162\145\x5f\x73\145\x74\x74\151\x6e\147")->field("\x66\151\162\x73\164\137\x6e\x61\x6d\x65\40\146\156\x61\x6d\x65\x2c\x73\x65\x63\157\156\x64\137\156\x61\x6d\145\x20\x73\156\x61\x6d\x65\x2c\x74\x68\151\x72\x64\x5f\156\x61\x6d\145\x20\164\x6e\x61\155\x65")->where("\155\143\x68\137\x69\144", $conid)->find(); goto hiN3d; p95Yw: $res[$i]["\163\150\141\162\145"] = $share["\x73\x6e\x61\155\x65"]; goto Cu1p_; kvs03: $i++; goto HwMZz; EQBAa: $name = db::name("\x79\142\163\x63\137\x75\163\145\162")->field("\156\x69\143\153\x5f\x6e\141\x6d\x65")->where("\x75\151\144", $arr["\160\x69\144\63"])->find(); goto vmkjU; LZr85: $res[$i]["\156\141\155\x65"] = $name["\156\x69\143\x6b\x5f\x6e\x61\x6d\x65"]; goto Z_ENP; YJToL: $res[$i]["\163\150\141\x72\x65"] = $share["\164\x6e\141\155\x65"]; goto v4fZh; ko3zK: g1rl5: goto PLFv9; I50ld: w2Mcv: goto f2EwM; oW5OR: if (!($arr["\160\151\x64\61"] > 0)) { goto w2Mcv; } goto WYRoJ; Z_ENP: $res[$i]["\163\150\141\162\x65"] = $share["\x66\x6e\x61\x6d\145"]; goto NIXcr; M53EN: $conid = $this->bus_id; goto v8UCy; wB8_L: $res = array(); goto oW5OR; WYRoJ: $name = db::name("\x79\x62\x73\143\137\165\163\x65\x72")->field("\156\x69\x63\153\137\156\x61\x6d\145")->where("\165\x69\144", $arr["\160\x69\144\61"])->find(); goto LZr85; f2EwM: if (!($arr["\x70\x69\144\62"] > 0)) { goto idufU; } goto wifuT; v4fZh: $res[$i]["\160\162\151\143\145"] = $arr["\x74\x70\162\x69\x63\x65"]; goto ko3zK; Cu1p_: $res[$i]["\160\162\x69\143\x65"] = $arr["\163\x70\162\x69\143\x65"]; goto kvs03; vmkjU: $res[$i]["\x6e\x61\155\x65"] = $name["\156\151\x63\153\x5f\x6e\141\155\145"]; goto YJToL; esZoK: $res[$i]["\156\141\155\x65"] = $name["\156\151\143\153\x5f\156\141\155\x65"]; goto p95Yw; eAhLY: } public function get_child_share($pid, $chioce = "\x2d\61", $deep = 3) { goto rxfMK; fqQvd: $condition = array(); goto U6m0f; Rimz9: $res[$i + 1] = $child; goto dkmIf; LDcMi: $pid = substr($pid, 0, strlen($pid) - 1); goto MfuIK; WCybO: PayTP: goto gns1l; PU7bN: NR1Db: goto LwhDu; LwhDu: return $res; goto Oz6tW; F0XhZ: $old_id = $pid; goto iCeMS; P1Tzq: $pid = ''; goto iYxxp; b2aKx: if (!($i < $deep)) { goto m_fsb; } goto WI2E1; iCeMS: $i = 0; goto AE6rP; u0z2Y: UzxYb: goto LDcMi; AE6rP: x0Dka: goto b2aKx; rxfMK: $res = array(); goto F0XhZ; MfuIK: if (!($pid == 0)) { goto PayTP; } goto VyAW1; vDewW: $s++; goto r1hF8; gns1l: ecXrK: goto rXVNo; WI2E1: $child = array(); goto fqQvd; hUpEa: unset($res[$chioce]["\x63\156\x75\x6d"]); goto G5xiL; U6m0f: $condition["\160\151\x64"] = ["\x69\x6e", $pid]; goto aiHKV; LzR2C: mtNlV: goto RSIYl; lA1qn: $pids = db::name("\x79\142\163\x63\x5f\165\163\145\x72")->field("\x75\151\x64")->where($condition)->select(); goto P1Tzq; nmmy2: goto x0Dka; goto tG2cC; rXVNo: $i++; goto nmmy2; tG2cC: m_fsb: goto She1u; h53bJ: $pid = $pid . $pids[$s]["\165\x69\144"] . "\x2c"; goto A93BX; r1hF8: goto mtNlV; goto u0z2Y; iYxxp: $s = 0; goto LzR2C; VyAW1: goto m_fsb; goto WCybO; G5xiL: return $res[$chioce]; goto PU7bN; She1u: if (!($chioce >= 1 && $chioce != "\x2d\x31")) { goto NR1Db; } goto hUpEa; RSIYl: if (!($s < count($pids))) { goto UzxYb; } goto h53bJ; dkmIf: $res[$i + 1]["\143\x6e\165\155"] = count($child); goto lA1qn; aiHKV: $child = db::name("\171\142\x73\x63\x5f\165\x73\145\162")->field("\165\151\x64\x2c\x6e\151\x63\153\x5f\x6e\141\155\x65\54\x72\145\x67\137\164\151\x6d\145\54\x74\x6f\164\141\x6c\x5f\160\x72\151\x63\x65\x2c\160\x69\144")->where($condition)->select(); goto Rimz9; A93BX: c2D_X: goto vDewW; Oz6tW: } public function screen_id($db_name, $id_arr, $id_name, $check_num, $check_name) { goto WlvDQ; NVl9L: $verify = db::name($db_name)->field($check_name)->where($id_name, $id_arr[$i])->find(); goto YH_7r; yegiK: $i++; goto ZWPxb; WlvDQ: $res = array(); goto OkzSW; ZWPxb: goto EnhSA; goto ufK3f; F1t5J: zz2vx: goto yegiK; ePCuW: return implode("\54", $res); goto Ja2Ia; Uqg9U: $i = 0; goto L7NYi; OkzSW: is_array($id_arr) ? '' : ($id_arr = explode("\54", $id_arr)); goto Uqg9U; E95oG: array_push($res, $id_arr[$i]); goto XTFMh; rJGit: if (!($i < count($id_arr))) { goto MjctD; } goto NVl9L; XTFMh: SpZWT: goto F1t5J; ufK3f: MjctD: goto ePCuW; YH_7r: if (!($verify[$check_name] == $check_num)) { goto SpZWT; } goto E95oG; L7NYi: EnhSA: goto rJGit; Ja2Ia: } }
