<?php
 namespace app\admin\service; use think\Db; class VideoService extends Base { public function getVideoClass($data) { $class_list = Db::name("\171\x62\164\x63\x5f\x76\x69\x64\145\x6f\x5f\143\154\141\163\x73")->where($data)->order("\163\x6f\x72\164", "\144\145\163\143")->paginate(20); return $class_list; } public function addVideoClass($data) { $class = Db::name("\x79\x62\x74\143\x5f\x76\151\x64\x65\157\137\x63\154\141\x73\163")->insert($data); return $class; } public function getVideoClassById($class_id) { $info = Db::name("\x79\142\x74\143\x5f\166\151\144\145\157\137\x63\x6c\x61\163\163")->where(["\143\x6c\x61\163\163\x5f\151\144" => $class_id])->find(); return $info; } public function updateVideoClass($data) { $info = Db::name("\x79\x62\164\x63\x5f\x76\x69\144\x65\x6f\x5f\143\x6c\x61\x73\x73")->where("\143\x6c\x61\x73\x73\137\x69\144", $data["\x63\154\x61\163\163\x5f\x69\x64"])->update($data); return $info; } public function delVideoClass($data) { goto ZyrIL; ZyrIL: Db::startTrans(); goto K20kD; olS4A: return $class; goto I0dXu; K20kD: try { goto UBT3X; UBT3X: $class = Db::name("\x79\142\x74\x63\x5f\x76\x69\x64\x65\157\x5f\143\154\141\x73\x73")->where("\x63\154\141\x73\163\x5f\151\x64", $data)->delete(); goto FpJND; Hf8u9: Db::commit(); goto cB2N3; FpJND: Db::name("\x79\x62\x74\x63\137\166\151\144\145\x6f")->where("\x63\x6c\x61\163\163\x5f\x69\x64", $data)->delete(); goto Hf8u9; cB2N3: } catch (\Exception $e) { Db::rollback(); return null; } goto olS4A; I0dXu: } public function getVideo($data) { $class_list = Db::name("\171\x62\164\143\137\x76\151\x64\x65\157")->where($data)->order("\163\x6f\x72\164", "\144\145\163\143")->paginate(20); return $class_list; } public function getClass($mch_id) { $class_list = Db::name("\171\x62\x74\143\137\x76\x69\144\145\x6f\x5f\143\154\141\163\163")->where("\x6d\x63\x68\137\x69\x64", $mch_id)->order("\163\157\162\x74", "\144\145\163\143")->select(); return $class_list; } public function addVideo($data) { goto DKUEA; DKUEA: Db::startTrans(); goto yG_Bg; yG_Bg: try { goto O66WF; fnWcD: Db::commit(); goto eh6bz; O66WF: $class = Db::name("\171\142\164\143\137\x76\x69\144\x65\x6f")->insert($data); goto CzKWm; CzKWm: Db::name("\171\142\164\143\137\x76\151\x64\x65\157\x5f\143\x6c\x61\163\163")->where("\x63\x6c\141\163\x73\137\151\x64", $data["\143\154\141\x73\163\137\x69\x64"])->update(["\165\160\144\x61\164\x65\x5f\164\151\x6d\x65" => time()]); goto fnWcD; eh6bz: } catch (\Exception $e) { Db::rollback(); return null; } goto ObAIh; ObAIh: return $class; goto DJpCU; DJpCU: } public function getVideoById($video_id) { $info = Db::name("\171\x62\x74\x63\137\x76\x69\144\145\x6f")->where(["\x76\151\x64\145\157\137\x69\144" => $video_id])->find(); return $info; } public function updateVideo($data) { $info = Db::name("\x79\x62\164\143\x5f\166\151\144\x65\157")->where("\166\151\x64\x65\157\137\x69\x64", $data["\x76\x69\144\x65\x6f\137\151\144"])->update($data); return $info; } public function VideoDel($data) { $class = Db::name("\171\x62\x74\x63\x5f\x76\151\144\145\x6f")->where("\166\151\144\145\157\x5f\151\144", $data)->delete(); return $class; } }
