<?php
 namespace app\admin\controller; use app\admin\service\BaiduService; use think\Db; class H5 extends Base { public function index() { goto bFzDU; Myxh4: $last = get_url_content($url); goto IRNDz; L2N1N: return view(); goto wfPR7; EefpB: $this->assign("\x6c\151\156\153", $link); goto iaZJW; rOaaB: $ROOT = str_replace("\143\x6f\162\145\x2f", '', SITE_PATH); goto vSHRG; H7XOG: $now = file_get_contents($version_file); goto CJECl; JYNJI: $this->assign("\x6c\x61\x73\x74", $last); goto H7XOG; wE2yu: $link = $_W["\163\x69\x74\145\162\x6f\157\164"] . "\x61\x64\144\x6f\156\x73\57\x79\x62\137\163\x68\x6f\x70\x2f\x68\x35\57" . $this->bus_id . "\57"; goto EefpB; Ufo3V: $json = json_decode(file_get_contents($version_file), true); goto UZ8fF; H3fhs: $version_file = $BASE_PATH . "\171\142\137\x73\150\x6f\x70\x5f\x68\x35\x2e\152\x73\157\x6e"; goto GHd1j; MA1jd: if (!$packaged) { goto EJH9Y; } goto Ufo3V; bFzDU: global $_W; goto rOaaB; Zi46s: $this->assign("\x70\x61\x63\153\141\x67\145\x64", $packaged); goto MA1jd; UZ8fF: $url = IMG_URL . "\141\x70\151\x2f\122\145\x6d\157\x74\145\x6c\x79\x2f\150\65\x5f\143\150\145\143\x6b\77\x68\65\75\171\x62\x5f\163\x68\x6f\x70\137\150\x35"; goto Myxh4; iaZJW: EJH9Y: goto L2N1N; vSHRG: $BASE_PATH = $ROOT . "\150\65\57{$this->bus_id}\x2f"; goto H3fhs; CJECl: $now = json_decode($now, true); goto zAk7h; IRNDz: $last = json_decode($last, true); goto JYNJI; zAk7h: $this->assign("\156\x6f\167", $now); goto wE2yu; GHd1j: $packaged = file_exists($version_file); goto Zi46s; wfPR7: } public function install() { goto pJL25; oF5PF: $version_file = $USER_PATH . "\171\142\137\163\x68\x6f\160\x5f\150\x35\56\152\x73\x6f\156"; goto turDB; ZNDQ7: $zip_data = file_get_contents($url); goto bv14u; XVnhY: $js_arr[] = $USER_PATH . "\151\x6e\x64\145\x78\56\x68\x74\x6d\x6c"; goto enJ9i; hV0SA: $zip_file = $BASE_PATH . "\x79\x62\137\x73\150\x6f\160\137\150\x35\56\172\151\160"; goto RNbwk; turDB: $last = file_get_contents($json_file); goto Iu6I0; NJWRx: $res = $zip->open($zip_file); goto BfGs5; ZLs5m: mkdir($BASE_PATH, 0755, true); goto Dxzft; uz0C6: $last_v = json_decode($last, true)["\166\x65\162\x73\151\x6f\x6e"]; goto xD7ma; uiQcB: if (is_dir($BASE_PATH)) { goto ZLLKI; } goto ZLs5m; pJL25: if (!(request()->isPost() && request()->isAjax())) { goto w3tO1; } goto TnoCH; cFmAG: $ROOT = str_replace("\x63\157\x72\x65\57", '', SITE_PATH); goto v0E2C; dtkt8: $last = get_url_content($url); goto uz0C6; zZCcE: $js_arr = allfile($js_path); goto XVnhY; m1IAI: $last["\156\145\167\x5f\164\151\155\x65"] = time(); goto tqHeO; kKKQy: if (!(!file_exists($zip_file) || !file_exists($json_file) || $now_v < $last_v)) { goto xydyc; } goto wUwiy; Iu6I0: $last = json_decode($last, true); goto m1IAI; km7ke: $now = json_decode($now, true); goto Tvwb3; DCFGk: XCU4K: goto o0CFA; pDSZv: if (!file_exists($json_file)) { goto MS6cw; } goto MqgMk; UVufj: if (is_dir($USER_PATH)) { goto Q4Hcm; } goto u8bJH; jZQtC: JxbG1: goto b6x9H; u8bJH: mkdir($USER_PATH, 0755, true); goto ep2xZ; qesCN: $res1 = file_put_contents($json_file, $last); goto ApFQY; enJ9i: $title = $_W["\165\x6e\151\141\143\143\157\x75\156\x74"]["\x6e\141\155\x65"]; goto m0JGd; BfGs5: if ($res === TRUE) { goto wC0CD; } goto sntY8; b6x9H: xydyc: goto cFmAG; tqHeO: $last = json_encode($last, true); goto i2grD; TnoCH: global $_W; goto WiTVf; rA14q: $zip->extractTo($USER_PATH); goto F8JSm; umfIu: MS6cw: goto kKKQy; lgVQS: $zip = new \ZipArchive(); goto NJWRx; v0E2C: $USER_PATH = $ROOT . "\x68\65\x2f{$this->bus_id}\57"; goto UVufj; Akj0Z: $url = IMG_URL . "\141\160\x69\x2f\122\x65\x6d\x6f\x74\145\x6c\x79\x2f\150\x35\x5f\x63\x68\x65\x63\x6b\x3f\x68\65\x3d\171\142\x5f\x73\x68\157\160\137\150\65"; goto dtkt8; J0TUo: w3tO1: goto bDtgH; fbnRV: choCx: goto oF5PF; ApFQY: if (!($res === false || $res1 === false)) { goto JxbG1; } goto o5YC8; Dxzft: ZLLKI: goto hV0SA; MqgMk: $now = file_get_contents($json_file); goto km7ke; ep2xZ: Q4Hcm: goto lgVQS; Tvwb3: $now_v = $now["\166\x65\x72\163\x69\157\x6e"]; goto umfIu; wUwiy: $url = IMG_URL . "\160\165\x62\154\x69\143\57\150\x35\x2f\x79\142\x5f\x73\x68\157\x70\x5f\150\65\57\171\142\137\x73\150\157\x70\x5f\x68\65\56\172\151\x70"; goto ZNDQ7; o0CFA: $js_path = $USER_PATH . "\x73\x74\141\x74\x69\x63\57\152\163\57"; goto zZCcE; RNbwk: $json_file = $BASE_PATH . "\171\142\137\x73\x68\x6f\160\137\x68\x35\x2e\152\163\x6f\x6e"; goto Akj0Z; gBRvS: goto XCU4K; goto O8qma; xD7ma: $now_v = 0; goto pDSZv; uyvim: foreach ($js_arr as $item) { goto nxJV9; e0EQl: $str = str_replace($olds, $news, $str); goto sqoW9; hFe97: $olds = array("\133\x23\165\156\x69\x61\143\x69\x64\43\135", "\133\x23\x68\157\x73\164\x23\135", "\133\x23\x74\151\164\x6c\145\43\x5d"); goto X1yd5; dLWCe: H2MR7: goto CzJgR; nxJV9: $str = file_get_contents($item); goto hFe97; X1yd5: $news = array($this->bus_id, $host . "\141\x70\x70\x2f\151\156\x64\x65\x78\56\160\150\160", $title); goto e0EQl; sqoW9: file_put_contents($item, $str); goto dLWCe; CzJgR: } goto fbnRV; bv14u: $res = file_put_contents($zip_file, $zip_data); goto qesCN; WiTVf: $BASE_PATH = SITE_PATH . "\160\x75\142\x6c\151\x63\x2f\165\x70\x6c\x6f\x61\x64\57\x68\65\x2f"; goto uiQcB; m0JGd: $host = str_replace(["\150\164\164\160\x73\72", "\x68\164\x74\x70\72"], '', $_W["\163\x69\x74\x65\x72\x6f\x6f\164"]); goto uyvim; o5YC8: return AjaxReturnMsg(0, "\346\x96\x87\344\xbb\266\xe4\xb8\213\xe8\275\xbd\345\xa4\261\xe8\264\xa5"); goto jZQtC; i2grD: file_put_contents($version_file, $last); goto uK_jv; uK_jv: return AjaxReturnMsg(1, "\xe7\xab\231\347\202\xb9\xe7\224\x9f\346\x88\x90\346\x88\220\xe5\x8a\x9f\x21"); goto J0TUo; sntY8: return AjaxReturnMsg(0, "\346\x96\207\xe4\xbb\xb6\xe5\xae\211\350\243\205\xe5\xa4\261\xe8\xb4\245"); goto gBRvS; O8qma: wC0CD: goto rA14q; F8JSm: $zip->close(); goto DCFGk; bDtgH: } }
