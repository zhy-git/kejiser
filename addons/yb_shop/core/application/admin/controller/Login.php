<?php
 namespace app\admin\controller; use think\Controller; use think\Db; use think\Cookie; load()->model("\167\170\x61\x70\x70"); load()->model("\165\x73\145\162"); class Login extends Controller { public function __construct() { goto gRg_Q; bnYFN: $siteroot = $_W["\x73\151\x74\x65\162\157\x6f\x74"]; goto UFKo2; FgRXw: $site_name = Db::name("\171\x62\163\x63\x5f\x63\x6f\160\171\x72\151\x67\150\x74")->where("\151\144", 1)->find(); goto j2wGq; Lw3Hs: global $_W; goto FgRXw; gRg_Q: parent::__construct(); goto Lw3Hs; UFKo2: $this->assign("\x73\x69\x74\x65\162\157\x6f\x74", $siteroot); goto Zl__A; nL_8W: $this->assign("\163\x69\164\145\x5f\x6e\141\x6d\145", $site_name["\x73\x69\x74\145\x5f\156\141\155\x65"]); goto bnYFN; j2wGq: $GLOBALS["\x62\141\x63\153\x5f\x74\x79\160\x65"] = $site_name["\142\141\143\x6b\x5f\164\x79\160\x65"]; goto nL_8W; Zl__A: } public function index() { goto rRqAr; h1wAn: return view(); goto CCubd; wb8s9: exit; goto RiR3O; lI4Jt: $this->assign("\163\x69\x74\x65\137\162\157\157\x74", $_W["\x73\151\x74\145\162\157\x6f\164"]); goto h1wAn; YiObi: $list = Db::name("\171\142\x73\143\x5f\x63\x6f\x70\x79\x72\x69\147\150\164")->where("\151\144", 1)->find(); goto jKNr_; jKNr_: $this->assign("\151\156\x66\157", $list); goto lI4Jt; RiR3O: T0iY6: goto YiObi; v6YoK: header("\x4c\157\143\x61\164\151\x6f\156\72" . url("\141\144\x6d\x69\x6e\x2f\x6c\157\x67\x69\x6e\x2f\x77\x78\x61\x70\x70")); goto wb8s9; rRqAr: global $_W; goto L3ASI; L3ASI: if (empty($_W["\165\x73\145\162"])) { goto T0iY6; } goto v6YoK; CCubd: } public function liu() { goto qayHI; GRhJ6: return $res; goto hIG9g; qayHI: $rr = str_replace("\40", '', request()->param("\165\x73\145\162\156\141\x6d\145")); goto CAmwE; CAmwE: $res = Db::name("\x75\163\145\x72\163")->where("\165\163\145\x72\x6e\141\155\145", $rr)->count(); goto GRhJ6; hIG9g: } public function login() { goto ZYF10; iRdEl: hJ5mr: goto vdRM_; ZYjDE: pdo_delete("\165\x73\145\x72\163\x5f\x66\x61\151\x6c\x65\144\x5f\x6c\x6f\147\x69\156", array("\151\x64" => $failed["\x69\x64"])); goto nDGfv; IPwr6: $vcode = $_SESSION["\137\x5f\143\157\144\x65"]; goto TFVnD; i7H7o: IBd5I: goto M9MMZ; dQu82: isetcookie("\x5f\x5f\x73\145\163\x73\x69\157\156", $session, 7 * 86400, true); goto Oqw5v; vdRM_: pdo_insert("\x75\163\145\162\163\137\x66\x61\x69\154\x65\144\x5f\154\157\x67\x69\x6e", array("\x69\x70" => CLIENT_IP, "\165\163\x65\162\x6e\x61\155\x65" => trim($uname), "\143\x6f\x75\x6e\164" => "\61", "\x6c\141\x73\x74\165\160\x64\x61\164\x65" => TIMESTAMP)); goto c66HT; hEmZw: $member = ["\165\163\x65\x72\x6e\141\155\x65" => $uname, "\160\141\163\x73\x77\x6f\162\144" => $upass]; goto zf0Nx; hoI7r: user_update($status); goto tzTwg; jU6zr: if (empty($failed)) { goto hJ5mr; } goto M_7Z9; BHl0P: $params = array(); goto Yy2Pg; V_l0k: X7upz: goto FrCgy; w5YK0: $uname = $data["\x75\x73\x65\x72\x6e\x61\155\145"]; goto HwTme; nxtEc: oXoLn: goto gRvMb; ki1AU: return AjaxReturnMsg(0, "\xe6\x82\250\347\x9a\x84\xe8\xb4\246\xe5\x8f\267\346\255\243\xe5\x9c\xa8\345\xae\xa1\xe6\240\270\xe6\210\x96\xe6\230\xaf\xe5\267\262\xe7\273\x8f\xe8\242\253\347\xb3\xbb\xe7\273\x9f\xe7\246\x81\xe6\xad\xa2\357\274\214\xe8\257\xb7\xe8\x81\x94\347\xb3\273\347\275\x91\xe7\253\x99\xe7\256\xa1\347\x90\x86\345\x91\230\350\247\xa3\345\x86\xb3\x3f"); goto V_l0k; vLrMF: if (!($password != $record["\160\x61\163\x73\167\x6f\162\144"])) { goto IBd5I; } goto or2S6; IB9XQ: $cookie["\x6c\x61\163\164\x76\x69\163\151\x74"] = $record["\x6c\x61\x73\x74\x76\151\163\x69\x74"]; goto AOUzB; O9Qaw: $_W["\165\163\145\x72"] = $record; goto FjZwT; HwTme: $upass = $data["\x70\x61\x73\163\x77\x6f\x72\144"]; goto bNP82; c66HT: scOrb: goto kl9Is; YkAQ0: return AjaxReturnMsg(0, "\347\xab\x99\347\x82\271\345\xb7\262\345\205\263\xe9\227\xad\357\274\x8c\xe5\x85\xb3\351\227\255\xe5\x8e\237\345\233\240\x3a" . $_W["\x73\145\x74\164\151\x6e\147"]["\x63\x6f\160\171\x72\151\147\150\x74"]["\162\x65\141\163\157\x6e"]); goto oaxtM; qjlus: l2dpc: goto S9uPQ; oaxtM: YXUse: goto bt6pu; FjZwT: if (!(!empty($_W["\x73\x69\x74\145\x63\x6c\157\163\x65"]) && empty($_W["\151\x73\146\157\x75\x6e\x64\145\x72"]))) { goto YXUse; } goto YkAQ0; M9MMZ: dmksf: goto u7pHx; sNMaw: $session = authcode(json_encode($cookie), "\145\x6e\143\x6f\144\x65"); goto dQu82; gRvMb: if (!($record["\x73\164\141\164\165\x73"] == USER_STATUS_CHECK || $record["\163\164\x61\x74\165\163"] == USER_STATUS_BAN)) { goto X7upz; } goto ki1AU; Rjk9z: $where .= "\40\101\x4e\104\x20\x75\56\x60\x75\163\145\162\156\141\155\x65\140\75\x3a\x75\163\x65\x72\156\141\x6d\145"; goto h1Dkt; r4NNZ: DZAq9: goto sIVne; jcSKx: global $_W; goto VWCeV; bNP82: $code = $data["\x63\x61\x70\164\143\150\141"]; goto dgjOx; M_7Z9: pdo_update("\x75\163\x65\x72\163\137\146\x61\151\x6c\145\x64\137\154\157\x67\151\x6e", array("\x63\157\165\x6e\164" => $failed["\143\x6f\x75\x6e\164"] + 1, "\x6c\141\163\x74\165\160\x64\x61\164\145" => TIMESTAMP), array("\x69\x64" => $failed["\x69\144"])); goto z20mg; nDGfv: return AjaxReturnMsg(1, "\347\231\xbb\xe5\275\225\xe6\x88\220\xe5\x8a\237"); goto qjlus; kl9Is: return AjaxReturnMsg(0, "\347\x99\273\345\xbd\x95\345\xa4\xb1\xe8\264\245\357\274\x8c\xe8\257\xb7\346\243\200\346\x9f\xa5\xe6\202\xa8\xe8\xbe\x93\345\x85\xa5\347\232\x84\xe8\xb4\246\345\x8f\267\345\x92\x8c\345\257\x86\xe7\xa0\201"); goto IOzJg; pF6l5: bMwMt: goto Rz84K; nzZLE: $failed = pdo_get("\165\x73\145\x72\163\137\146\141\x69\x6c\145\144\137\154\157\147\x69\x6e", array("\x75\x73\145\162\156\141\155\x65" => trim($uname), "\x69\x70" => CLIENT_IP)); goto jU6zr; tzTwg: $failed = pdo_get("\165\163\145\x72\163\137\x66\x61\x69\154\x65\x64\137\154\x6f\x67\151\x6e", array("\x75\163\145\162\156\x61\155\x65" => trim($uname), "\151\160" => CLIENT_IP)); goto ZYjDE; S9uPQ: jHm2J: goto jmezZ; RN8Ym: isetcookie("\x5f\x5f\x63\x6f\144\145", ''); goto hEmZw; sIVne: if (empty($member["\x70\x61\x73\x73\x77\x6f\162\144"])) { goto dmksf; } goto xtkQV; SwS4Q: return AjaxReturnMsg(0, "\350\xb4\xa6\xe5\217\267\346\x88\226\xe5\xaf\206\xe7\240\201\xe9\224\x99\350\xaf\257"); goto r4NNZ; DoCzV: $cookie["\150\x61\163\150"] = md5($record["\160\x61\163\163\167\x6f\162\144"] . $record["\x73\x61\154\x74"]); goto sNMaw; z20mg: goto scOrb; goto iRdEl; AOUzB: $cookie["\154\x61\x73\164\x69\160"] = $record["\154\x61\x73\164\151\x70"]; goto DoCzV; ZYF10: if (!(request()->isAjax() && request()->post())) { goto jHm2J; } goto jcSKx; TFVnD: $_SESSION["\137\137\x63\157\144\x65"] = ''; goto RN8Ym; bt6pu: $cookie = array(); goto hpWCx; Wyuu5: $record = pdo_fetch($sql, $params); goto pqaYv; EDeEy: $status["\154\141\x73\164\x69\160"] = CLIENT_IP; goto hoI7r; zf0Nx: $where = "\x20\127\x48\105\122\105\x20\61\40"; goto BHl0P; h1Dkt: $params["\72\x75\163\x65\162\156\141\x6d\x65"] = $member["\165\163\x65\x72\156\x61\x6d\145"]; goto pF6l5; pqaYv: if (!empty($record)) { goto DZAq9; } goto SwS4Q; Rrb1P: $_W["\x69\x73\x66\x6f\165\156\x64\x65\x72"] = user_is_founder($record["\165\x69\144"]); goto O9Qaw; VWCeV: $data = request()->post(); goto w5YK0; Oqw5v: $status = array(); goto EG3Ux; Yy2Pg: if (empty($member["\x75\x73\145\162\x6e\141\155\x65"])) { goto bMwMt; } goto Rjk9z; u7pHx: if (!empty($record)) { goto oXoLn; } goto nzZLE; FrCgy: $_W["\165\151\x64"] = $record["\165\151\x64"]; goto Rrb1P; EG3Ux: $status["\165\x69\x64"] = $record["\x75\151\144"]; goto wV1ao; or2S6: return AjaxReturnMsg(0, "\350\264\246\345\x8f\xb7\346\x88\x96\xe5\xaf\x86\347\xa0\x81\351\x94\x99\350\xaf\257"); goto i7H7o; dgjOx: $codehash = md5(strtolower($code) . $_W["\143\157\156\146\x69\147"]["\x73\145\164\x74\151\156\147"]["\x61\x75\164\150\153\145\171"]); goto IPwr6; hpWCx: $cookie["\165\x69\x64"] = $record["\x75\151\144"]; goto IB9XQ; wV1ao: $status["\154\141\x73\x74\166\x69\163\151\164"] = TIMESTAMP; goto EDeEy; xtkQV: $password = user_hash($member["\x70\x61\x73\x73\167\157\162\x64"], $record["\163\x61\x6c\x74"]); goto vLrMF; Rz84K: $sql = "\123\105\114\105\103\x54\x20\x75\x2e\x2a\54\40\x70\x2e\141\166\x61\164\x61\162\40\x46\x52\x4f\x4d\40" . tablename("\x75\163\x65\162\x73") . "\40\x41\123\40\x75\x20\x4c\x45\106\124\x20\112\117\111\116\x20" . tablename("\x75\x73\x65\162\x73\137\x70\162\x6f\146\x69\154\145") . "\x20\x41\123\x20\160\40\117\x4e\40\x75\x2e\x75\151\x64\40\75\x20\160\56\165\151\144\40" . $where . "\x20\x4c\111\x4d\x49\124\x20\x31"; goto Wyuu5; IOzJg: goto l2dpc; goto nxtEc; jmezZ: } public function logout() { goto WBf5L; f1MDw: unset($_SESSION["\167\x65\x37\137\x75\x73\145\x72"]); goto yW6Td; yzQok: $site_url = $_W["\x73\x69\164\145\162\x6f\x6f\x74"]; goto XEP03; g2TuQ: header("\x4c\x6f\143\141\164\151\157\156\72" . $site_url); goto dW1_6; IWPrS: if ($back_type == 1) { goto MFMIj; } goto g2TuQ; QDO0O: unset($_SESSION["\167\145\x37\137\167"]); goto f1MDw; rpK_Y: ktNXp: goto IXhSM; IXhSM: exit; goto j1c1c; nFcjk: unset($_W); goto QDO0O; yW6Td: unset($_SESSION["\x77\x65\x37\x5f\141\143\x63\157\165\156\x74"]); goto NkkNm; idce6: Cookie::delete("\x73\165\x62\x5f\155\x69\x64"); goto hIzw5; koe85: isetcookie("\x5f\137\167\170\141\x70\160\x76\145\x72\163\x69\x6f\x6e\151\144\163", '', -10000); goto PbsTz; hmWE9: isetcookie("\x5f\x5f\x73\x77\151\x74\x63\150", '', -10000); goto BZiJN; dW1_6: goto ktNXp; goto b1T2d; b1T2d: MFMIj: goto w9lkX; PW1hq: $back_type = $site_name["\142\141\143\153\x5f\164\x79\160\145"]; goto IWPrS; PbsTz: $site_name = Db::name("\x79\x62\x73\x63\137\143\157\160\x79\162\x69\147\150\x74")->where("\151\x64", 1)->find(); goto PW1hq; XEP03: Cookie::delete("\x74\157\160\x5f\x6d\x69\x64"); goto idce6; xh9uc: isetcookie("\137\137\x75\151\x64", '', -10000); goto koe85; BZiJN: isetcookie("\x5f\x5f\165\156\x69\x61\x63\x69\x64", '', -10000); goto xh9uc; WBf5L: global $_W; goto yzQok; hIzw5: Cookie::delete("\164\150\162\145\x65\x5f\x6d\151\x64"); goto nFcjk; w9lkX: header("\114\x6f\143\x61\164\151\157\156\72" . url("\141\x64\x6d\151\156\x2f\154\x6f\x67\151\156\x2f\x69\156\144\x65\x78")); goto rpK_Y; NkkNm: isetcookie("\x5f\137\x73\x65\x73\x73\151\157\156", '', -10000); goto hmWE9; j1c1c: } public function wxapp() { goto kpq5R; zvt6Y: $table->join("\x75\x6e\x69\x5f\x61\x63\x63\157\165\156\x74\x5f\165\163\x65\x72\163\40\143", "\x61\56\x75\156\x69\x61\143\151\x64\x20\75\x20\x63\56\165\x6e\x69\141\x63\x69\x64", "\x6c\145\146\x74"); goto F38wa; zAIu4: foreach ($list as &$account) { goto YY1_K; W4Tz3: PSb8H: goto CHws1; CHws1: $brrs[] = $account; goto yb6Dz; YY1_K: $account = uni_fetch($account["\165\156\151\141\x63\x69\144"]); goto MeeHP; Yfk0L: dqRYm: goto W4Tz3; cs_he: goto PSb8H; goto fN0Hm; wnH6H: UzWzA: goto aFnBB; R7GXy: $errs[] = $account; goto YsYEa; i0bFl: if (!empty($account["\166\145\x72\163\x69\157\x6e\163"])) { goto rfwGA; } goto q58xF; JKW7X: goto UzWzA; goto cs_he; Lf7_F: goto sF5Te; goto uVHfn; fN0Hm: rfwGA: goto zEP1H; zEP1H: foreach ($account["\166\x65\162\163\x69\157\156\163"] as $version) { goto JnK1P; r2zUh: Ala1Q: goto So7Dm; Rx1Wa: goto Ala1Q; goto O8_9E; JnK1P: if (!empty($version["\x63\x75\162\x72\x65\x6e\164"])) { goto QPhab; } goto MIBbY; MIBbY: $errs[] = $account; goto Rx1Wa; yA27j: QPhab: goto R8A5c; O8_9E: goto TCeUT; goto yA27j; R8A5c: $account["\x63\165\x72\162\x65\156\x74\x5f\x76\x65\x72\x73\x69\157\156"] = $version; goto MlKOb; MlKOb: goto dqRYm; goto IRwAE; IRwAE: TCeUT: goto r2zUh; So7Dm: } goto Yfk0L; e7cj1: goto UzWzA; goto OOKp1; OnCB4: sF5Te: goto v9oPf; Gy_I_: $account["\x76\145\x72\163\x69\157\x6e\x73"] = Db::name("\167\x78\x61\x70\160\x5f\166\x65\162\163\x69\x6f\x6e\x73")->where("\165\x6e\x69\141\143\151\144", $account["\x75\156\151\x61\x63\151\144"])->order("\151\144\40\x64\145\x73\143")->limit(4)->field("\151\x64\54\165\156\x69\x61\x63\151\x64\54\x76\145\x72\163\x69\x6f\156\x2c\x64\145\x73\x63\162\x69\x70\164\151\157\x6e\x2c\155\x6f\x64\x75\x6c\145\163\54\x63\162\145\x61\164\x65\164\x69\155\145")->select(); goto pZCq8; egkp2: goto UzWzA; goto OnCB4; SoWV5: if (!(strpos($modul, "\171\142\x5f\x73\x68\157\x70") === false)) { goto DEBaV; } goto e7cj1; yb6Dz: if (empty($account["\143\165\162\x72\145\156\164\137\166\x65\162\x73\x69\x6f\156"]["\166\x65\x72\x73\x69\x6f\156"])) { goto JwMfT; } goto OYIZu; uVHfn: JwMfT: goto egkp2; pZCq8: $account["\166\145\162\163\151\x6f\156\163"][0]["\143\x75\x72\162\x65\x6e\x74"] = true; goto i0bFl; I1zhO: MYhIW: goto Gy_I_; MeeHP: if (!empty($account["\165\x6e\x69\141\x63\x69\x64"])) { goto MYhIW; } goto R7GXy; OYIZu: $modul = $account["\x63\165\162\x72\x65\156\164\137\166\145\x72\163\x69\157\156"]["\155\157\x64\x75\154\145\163"]; goto SoWV5; v9oPf: $arrs[] = $account; goto wnH6H; YsYEa: goto UzWzA; goto I1zhO; q58xF: $errs[] = $account; goto JKW7X; OOKp1: DEBaV: goto Lf7_F; aFnBB: } goto wFah8; e0LiL: $arrs = array(); goto ecjtQ; yjOzo: $list = $table->where($where)->order($order)->field("\141\x2e\x2a\54\x62\x2e\x61\x63\x69\x64\54\142\56\150\x61\x73\150\x2c\x62\x2e\x74\171\x70\145\54\142\x2e\145\156\144\x74\x69\x6d\x65")->select(); goto e0LiL; zXSLQ: $this->assign("\154\151\x73\164", $arrs); goto Frg1J; kMHWt: if (!($uniacid > 0)) { goto OikWH; } goto aYXBz; yt1S0: ls_21: goto yjOzo; LCR6J: $uniacid = empty($_W["\141\143\143\x6f\x75\156\x74"]["\x75\156\151\141\143\x69\x64"]) ? 0 : $_W["\141\143\x63\x6f\165\156\x74"]["\x75\156\151\141\143\x69\144"]; goto kMHWt; J70XW: $about = empty($about) ? array("\154\x6f\147\157" => '') : $about; goto uaXtK; l1Vfl: UpGif: goto zvt6Y; kpq5R: global $_W; goto jrPgn; F38wa: $where["\x61\x2e\x64\145\146\141\x75\154\164\137\141\143\x69\144"] = array("\156\145\161", "\60"); goto hZxtn; S7KRq: $where["\x61\x2e\x64\x65\x66\x61\165\x6c\x74\x5f\x61\143\x69\x64"] = array("\156\x65\x71", "\60"); goto hA_CG; f0PR7: $order = "\141\x2e\x72\141\156\153\x20\144\145\163\143\54\141\56\165\x6e\151\x61\143\151\x64\x20\144\x65\163\143"; goto uPVy6; ecjtQ: $errs = array(); goto zAIu4; lVDF6: $where["\142\56\x74\171\160\x65"] = array("\151\156", array(ACCOUNT_TYPE_APP_NORMAL, ACCOUNT_TYPE_APP_AUTH)); goto CRv_k; hA_CG: goto ls_21; goto l1Vfl; uaXtK: $this->assign("\141\x62\157\165\x74", $about); goto r3uLM; AO5kX: $this->assign("\170\x63\170\x5f\x6e\x61\155\145", $xcx_name); goto LCR6J; mu4b2: OikWH: goto J70XW; CRv_k: $where["\142\56\x69\163\144\x65\x6c\x65\164\145\144"] = array("\156\x65\x71", "\x31"); goto f0PR7; wFah8: eOsVW: goto zXSLQ; uPVy6: $table->alias("\141")->join("\x61\143\x63\157\x75\156\164\40\x62", "\x61\56\x75\x6e\151\x61\143\151\x64\x20\x3d\x20\142\56\x75\x6e\151\x61\x63\151\x64\x20\141\x6e\144\x20\x61\56\x64\x65\x66\x61\x75\154\164\137\141\x63\x69\144\40\75\x20\x62\56\141\x63\x69\x64", "\x6c\145\x66\164"); goto f5mBo; f5mBo: if (!user_is_founder($_W["\165\x69\144"]) || user_is_vice_founder()) { goto UpGif; } goto S7KRq; jrPgn: $xcx_name = $_W["\165\x73\145\x72\156\x61\x6d\x65"]; goto AO5kX; aYXBz: $about = Db::name("\171\x62\163\x63\137\x62\165\x73\x69\x6e\x65\x73\x73\x5f\x61\x62\x6f\165\x74")->where("\x6d\x63\x68\x5f\x69\x64", $uniacid)->find(); goto mu4b2; Frg1J: return view(); goto x_uWt; hZxtn: $where["\x63\x2e\165\x69\144"] = $_W["\165\x69\x64"]; goto yt1S0; r3uLM: $table = Db::name("\165\156\x69\137\x61\143\x63\157\x75\x6e\164"); goto lVDF6; x_uWt: } }
