<?php
 namespace app\admin\controller; use app\admin\service\Images; use app\common\model\ImagesGroup; load()->func("\x66\x69\x6c\x65"); global $_W; $_W = $_SESSION["\x77\145\67\137\167"]; use think\Controller; use think\config; use think\Db; use think\Image; use think\Session; define("\x55\x50\114\117\x41\104\137\126\111\x44\105\x4f", Config::get("\x76\x69\145\167\x5f\162\x65\160\x6c\141\x63\x65\x5f\163\164\x72\56\x55\120\114\117\101\x44\137\126\x49\104\x45\117")); class Upload extends Controller { private $return = array(); private $file_path = ''; private $file_name = ''; private $file_size = 0; private $file_type = ''; private $upload_type = 2; public function uploadFile() { goto hdce3; vVKx3: $remotestatus = file_remote_upload($pathname); goto wZ517; KkciS: $width = $image_size[0]; goto wwIVR; LqxiD: $this->return["\x63\157\144\145"] = $retval; goto N06dL; oU0JM: $pic_id = request()->post("\151\155\147\x5f\x69\x64", ''); goto zfevG; TS2to: $mch_id = $_SESSION["\142\x75\x73\137\x69\x64"]; goto P8RFF; s1vh7: $retval = $this->photoCreate($this->file_path, $_W["\x73\151\x74\145\162\157\157\x74"] . "\141\x64\x64\x6f\156\163\x2f\x79\142\x5f\x73\150\x6f\x70\57\x63\157\x72\145\57" . $ok["\160\x61\164\150"], "\56" . $file_name_explode[$suffix], $type, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $ok["\x64\157\155\x61\x69\156"], $ok["\142\x75\143\x6b\145\x74"]); goto CCJ1i; wwIVR: $height = $image_size[1]; goto ayDOD; hPzke: $this->return["\143\x6f\144\x65"] = 1; goto NW1Fd; HH9Fv: $this->return["\155\x65\x73\163\141\x67\x65"] = "\344\xb8\212\344\xbc\xa0\xe6\x88\x90\345\x8a\237"; goto ZN7Up; z23kS: $mimetype = exif_imagetype($ok["\x70\141\164\150"]); goto LLPIS; xQ7mZ: return $this->ajaxFileReturn(); goto ryCMe; So81L: $this->return["\143\x6f\x64\x65"] = 1; goto JedIN; k1zft: goto xePdc; goto iUMEt; B4y5h: @unlink($_FILES["\146\x69\x6c\145\137\x75\x70\154\x6f\x61\144"]); goto BM9EC; P1P6K: return $this->ajaxFileReturn(); goto Ez4gK; wZ517: if (is_error($remotestatus)) { goto RoLCI; } goto QUobE; PC3fu: $this->file_path = "\160\x75\142\154\151\x63\57\x75\x70\154\157\x61\144\x2f" . $mch_id . "\x2f" . $old_path; goto R0MhP; qi9GO: goto PVw90; goto k4SqQ; co_a6: if (strstr(UPLOAD_VIDEO, $this->file_path)) { goto l9jYU; } goto B4y5h; Y2eNv: oz4cz: goto LELK6; yK8e2: $group = new ImagesGroup(); goto mKvYi; l1Vfj: if ($old_path == "\147\157\x6f\x64\x73\x2f") { goto qOpAk; } goto ivd59; OPOCj: Jy9uY: goto LqxiD; FUyzq: $newfile = $guid . $ext; goto VEYQU; x31Qo: $this->return["\x6d\145\163\x73\141\147\x65"] = "\346\226\207\344\xbb\xb6\xe8\xb7\xaf\345\276\x84\xe4\xb8\215\xe8\203\275\344\xb8\272\347\251\272"; goto JU1jA; n8EE1: goto vg14I; goto o4NQz; R9MX1: goto VIbA4; goto OPOCj; iUMEt: PlQVV: goto KkciS; o30Za: return $this->ajaxFileReturn(); goto qpJE4; k4SqQ: RoLCI: goto SdYDk; u2aXd: PVw90: goto mWHEA; ZF2bN: $this->return["\x64\141\164\x61"] = $_W["\163\x69\x74\x65\162\x6f\157\164"] . "\141\x64\x64\x6f\x6e\x73\57\171\142\x5f\x73\x68\157\x70\57\143\x6f\162\x65\x2f" . $ok["\x70\141\x74\x68"]; goto XFCzc; vncf0: l9jYU: goto bST8g; ayDOD: $name = $file_name_explode[0]; goto yK8e2; yCWcP: qOpAk: goto m4aqo; T9yTL: if (!($this->file_size == 0)) { goto CJcPX; } goto OqlN1; hdce3: $mch_id = Session::get("\x62\x75\x73\137\x69\x64"); goto tnnGR; mmSgz: if (file_exists($this->file_path)) { goto iAgtC; } goto RRYji; gK9xr: $this->return["\x6d\x65\163\x73\141\x67\x65"] = "\350\xaf\267\346\xa3\200\346\237\245\346\202\250\347\x9a\x84\xe4\xb8\x8a\xe4\xbc\240\xe5\x8f\x82\346\x95\xb0\351\205\x8d\347\275\xae\346\x88\226\xe4\xb8\x8a\xe4\xbc\240\347\x9a\x84\xe6\226\207\xe4\xbb\xb6\xe6\230\257\345\x90\xa6\xe6\234\x89\xe8\257\xaf"; goto k1zft; yCZP8: $image_size = getimagesize($_W["\163\151\x74\145\162\157\157\x74"] . "\x61\144\144\157\156\x73\57\171\x62\137\163\150\x6f\x70\57\x63\x6f\162\145\57" . $ok["\160\141\164\x68"]); goto kAfl1; z97Wl: global $_W; goto OKs0y; wtteK: $suffix = count($file_name_explode) - 1; goto cwBkI; BMQHF: $this->file_size = $_FILES["\x66\x69\154\145\x5f\165\160\x6c\157\141\144"]["\x73\151\x7a\145"]; goto YyfVX; OqlN1: $this->return["\155\145\x73\x73\x61\147\145"] = "\346\x96\207\xe4\273\xb6\xe5\xa4\247\345\xb0\217\xe4\270\272\60\115\102"; goto KegMZ; JedIN: $this->return["\144\141\x74\x61"] = $remoteurl; goto HH9Fv; NW1Fd: $this->return["\x64\141\x74\x61"] = str_replace("\x68\164\164\x70\72\x2f", "\x68\164\x74\x70\x73\72\57", $_W["\x73\151\164\x65\162\x6f\x6f\x74"] . "\x61\144\x64\x6f\156\x73\57\171\x62\x5f\x73\150\x6f\x70\x2f\x63\157\x72\x65\x2f" . $ok["\160\141\x74\x68"]); goto tJUGc; m4aqo: $type = request()->post("\x74\x79\x70\145", ''); goto hDbx7; ryCMe: VDoXp: goto Wy75r; rnw2D: $pic_tag = request()->post("\151\x6d\147\137\164\x61\x67", $name); goto oU0JM; o4NQz: XPOi1: goto hPzke; JpRV2: vEIgi: goto OxLdD; S4hsu: $old_path = request()->post("\x66\x69\154\x65\137\x70\141\164\x68", ''); goto If_nJ; JU1jA: return $this->ajaxFileReturn(); goto pklHZ; JlmMp: CJcPX: goto Oc_sb; kAfl1: if ($image_size) { goto PlQVV; } goto gK9xr; r6Xba: mkdir($this->file_path, $mode, true); goto rMm5c; ivd59: $this->return["\143\157\144\145"] = 1; goto V_ZXP; zfevG: $upload_flag = request()->post("\x75\160\x6c\x6f\x61\x64\137\x66\154\x61\x67", ''); goto s1vh7; VEYQU: $ok = $this->moveUploadFile($_FILES["\x66\x69\154\145\137\165\160\154\157\x61\144"]["\x74\x6d\x70\137\156\x61\x6d\x65"], $this->file_path . $newfile); goto z97Wl; rMm5c: iAgtC: goto tDynA; R0MhP: if (!($this->file_path == '')) { goto TIivD; } goto x31Qo; RRYji: $mode = intval("\x30\x37\x37\67", 8); goto r6Xba; ZN7Up: return json_encode($this->return); goto qi9GO; YyfVX: $this->file_type = $_FILES["\x66\151\154\145\137\165\x70\154\x6f\141\144"]["\164\171\x70\x65"]; goto T9yTL; OKs0y: if (!($this->upload_type == 2)) { goto vEIgi; } goto z23kS; W3HSK: $album_id = $group_id["\147\162\x6f\165\160\x5f\151\144"]; goto rnw2D; If_nJ: $new_upload_type = request()->post("\165\x70\x6c\157\x61\x64\x5f\164\x79\160\x65", 2); goto Y1zpC; tJUGc: $this->return["\x6d\x65\163\x73\141\147\x65"] = "\344\xb8\x8a\344\xbc\xa0\346\210\220\345\212\x9f"; goto wvr0O; XibZn: $file_name_explode = explode("\56", $this->file_name); goto wtteK; lzXdx: $this->return["\x6d\145\163\x73\141\147\145"] = "\xe6\226\x87\344\273\266\xe6\xa0\xbc\345\274\x8f\351\224\x99\xe8\257\xaf"; goto o30Za; XFCzc: VIbA4: goto Y2eNv; ql9fG: $this->upload_type = $new_upload_type; goto xIO5F; Y1zpC: if (!($new_upload_type != $this->upload_type)) { goto mQ8Vp; } goto ql9fG; u2ret: vg14I: goto vncf0; mWHEA: k8PA6: goto JpRV2; tDynA: $this->file_name = $_FILES["\x66\151\x6c\145\137\165\x70\x6c\157\141\144"]["\x6e\x61\155\145"]; goto BMQHF; Oc_sb: if ($this->validationFile()) { goto VDoXp; } goto xQ7mZ; OxLdD: if ($ok["\x63\x6f\144\x65"]) { goto ck5fi; } goto GZC8o; P8RFF: dATha: goto S4hsu; cwBkI: $ext = "\56" . $file_name_explode[$suffix]; goto FUyzq; CCJ1i: if ($retval > 0) { goto Jy9uY; } goto nl8wt; iRtYi: goto SjGc7; goto d0KcS; E6o5j: $this->return["\155\x65\x73\163\x61\x67\145"] = "\xe4\270\212\xe4\274\xa0\xe6\x88\x90\xe5\x8a\237"; goto hqbql; Wy75r: $guid = md5(time()); goto XibZn; qpJE4: tukWP: goto Mjd0i; UH2iZ: $pathname = $ok["\x70\141\x74\x68"]; goto vVKx3; d0KcS: ck5fi: goto co_a6; KegMZ: return $this->ajaxFileReturn(); goto JlmMp; bST8g: SjGc7: goto P1P6K; hqbql: goto oz4cz; goto yCWcP; BM9EC: if ($old_path == "\x76\151\144\x65\x6f\x2f\166\151\144\145\x6f\57") { goto XPOi1; } goto yCZP8; SdYDk: return "\350\xbf\234\347\xa8\213\351\231\x84\xe4\273\266\xe4\xb8\x8a\344\274\xa0\345\xa4\261\xe8\264\245\357\xbc\x8c\xe8\257\xb7\xe6\xa3\200\xe6\x9f\245\xe9\205\x8d\xe7\275\256\345\xb9\266\xe9\207\215\346\226\xb0\xe4\xb8\212\344\274\240"; goto u2aXd; N06dL: $this->return["\155\145\163\163\x61\147\x65"] = "\xe4\xb8\212\344\xbc\240\xe6\210\x90\345\x8a\x9f"; goto ZF2bN; hDbx7: $pic_name = request()->post("\x69\155\147\137\x6e\x61\155\145", $guid); goto W3HSK; Mjd0i: $_W = $_SESSION["\x77\x65\x37\x5f\x77"]; goto oKfF9; tnnGR: if (!empty($mch_id)) { goto dATha; } goto TS2to; LLPIS: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto tukWP; } goto lzXdx; pklHZ: TIivD: goto mmSgz; wvr0O: return json_encode($this->return); goto u2ret; mKvYi: $group_id = $group->getInfo(["\x6d\x63\x68\137\151\x64" => $mch_id, "\x69\163\x5f\x64\x65\x66\141\165\154\x74" => "\x31"]); goto l1Vfj; GZC8o: $this->return["\x6d\145\x73\x73\x61\x67\145"] = "\xe8\257\267\346\243\200\xe6\x9f\245\xe6\202\250\xe7\232\x84\xe4\xb8\x8a\344\xbc\240\xe5\217\x82\xe6\225\xb0\351\x85\215\xe7\275\xae\xe6\x88\226\xe4\xb8\212\344\xbc\240\xe7\232\x84\xe6\x96\x87\xe4\xbb\xb6\xe6\230\257\345\220\246\xe6\234\211\xe8\xaf\xaf"; goto iRtYi; QUobE: $remoteurl = tomedia($ok["\160\141\x74\x68"]); goto So81L; oKfF9: if (empty($_W["\163\x65\x74\x74\151\x6e\x67"]["\x72\x65\x6d\157\164\x65"]["\x74\x79\160\145"])) { goto k8PA6; } goto UH2iZ; xIO5F: mQ8Vp: goto PC3fu; LELK6: xePdc: goto n8EE1; nl8wt: $this->return["\155\x65\x73\163\141\147\145"] = "\xe4\xb8\x8a\344\274\xa0\345\xa4\261\350\xb4\xa5"; goto R9MX1; V_ZXP: $this->return["\x64\141\x74\x61"] = $_W["\163\151\x74\145\x72\157\157\164"] . "\141\144\144\x6f\x6e\163\x2f\171\142\137\163\x68\x6f\x70\x2f\143\157\x72\145\57" . $ok["\x70\141\164\150"]; goto E6o5j; Ez4gK: } private function ajaxFileReturn() { goto VSDCK; Jowt5: $this->return["\144\x61\164\141"] = ''; goto EB1wV; C6Ikv: $this->return["\155\145\x73\163\x61\147\x65"] = ''; goto B2fG8; CzUQM: if (!(empty($this->return["\x64\141\x74\141"]) || null == $this->return["\144\141\164\x61"] || '' == $this->return["\144\141\x74\x61"])) { goto t15JU; } goto Jowt5; B2fG8: HCkjY: goto CzUQM; wYEEx: return json_encode($this->return); goto N0OTD; jxRIH: if (!(empty($this->return["\155\145\163\x73\141\x67\145"]) || null == $this->return["\x6d\x65\163\x73\141\x67\x65"] || '' == $this->return["\x6d\x65\163\163\141\x67\145"])) { goto HCkjY; } goto C6Ikv; EB1wV: t15JU: goto wYEEx; UrvY7: H2V_W: goto jxRIH; Z_b0w: $this->return["\143\157\x64\145"] = 0; goto UrvY7; VSDCK: if (!(empty($this->return["\143\157\144\145"]) || null == $this->return["\143\157\144\145"] || '' == $this->return["\x63\x6f\x64\x65"])) { goto H2V_W; } goto Z_b0w; N0OTD: } private function validationFile() { goto IdNBs; xf53a: $alltype = ["\151\x6d\141\147\145\57\152\x70\x67", "\151\x6d\141\147\x65\x2f\152\160\x65\147", "\151\x6d\x61\147\145\57\x70\x6e\147", "\x69\x6d\141\147\145\x2f\x67\x69\146", "\x76\151\x64\145\x6f\x2f\155\x70\x34", "\141\165\144\x69\157\57\155\x70\63"]; goto puVD9; Q5lID: $this->return["\155\x65\163\163\141\x67\145"] = "\346\226\207\xe4\273\266\344\270\212\344\xbc\240\345\244\261\xe8\xb4\xa5\54\xe8\257\xb7\xe6\xa3\200\xe6\237\xa5\xe6\202\250\344\xb8\212\xe4\xbc\240\xe7\232\204\346\226\207\xe4\xbb\266\347\xb1\xbb\345\x9e\213\x2c\346\x96\207\xe4\xbb\266\xe5\244\xa7\xe5\xb0\217\xe4\xb8\x8d\350\x83\275\350\266\x85\350\277\x87\61\60\x4d\x42"; goto xi31v; dgyfi: $flag = false; goto yJjEh; xi31v: $flag = false; goto FwUlF; FwUlF: RPQYw: goto xf53a; yJjEh: yl2qj: goto yNmHb; puVD9: if (in_array($this->file_type, $alltype)) { goto yl2qj; } goto o4kDi; yNmHb: return $flag; goto xjZJK; iEP4V: if (!($this->file_size > 10000000)) { goto RPQYw; } goto Q5lID; IdNBs: $flag = true; goto iEP4V; o4kDi: $this->return["\155\x65\x73\x73\141\x67\145"] = "\346\226\x87\344\xbb\xb6\347\xb1\xbb\345\x9e\213\xe9\224\x99\350\257\257"; goto dgyfi; xjZJK: } public function photoCreate($upFilePath, $photoPath, $ext, $type = 0, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $domain, $bucket) { goto M_lb6; PFuKj: aJ9K3: goto yeuu8; k14A8: $retval = $pic_id; goto u86sv; KOdAn: foreach ($photoArray as $v) { goto Dl8xB; Nb275: $image->thumb($v["\x77\151\x64\164\x68"], $v["\150\145\x69\147\x68\x74"], \think\Image::GbGIG)->save($v["\160\x61\x74\150"]); goto uqInE; uqInE: cMHNF: goto g5kpg; Dl8xB: if (!stristr($type, $v["\x74\x79\160\145"])) { goto cMHNF; } goto Nb275; g5kpg: Cpm7F: goto Vr5Nk; Vr5Nk: } goto Estuu; apdXL: return $retval; goto xoqkN; Estuu: HQ3k5: goto PFuKj; JkR_z: $_W = $_SESSION["\167\x65\x37\137\x77"]; goto BEQYl; KRT6U: $photoArray["\142\151\147\120\x61\x74\x68"]["\x70\141\164\150"] = $upFilePath . md5(time() . $pic_tag) . "\x31" . $ext; goto TkwWq; xcT98: k6wzW: goto Os5BJ; ef_a6: if ($pic_id == '') { goto k6wzW; } goto Y2Cqs; yeuu8: $album = new Images(); goto ef_a6; Y2Cqs: $retval = $album->ModifyAlbumPicture($pic_id, $_W["\x73\151\164\145\x72\x6f\157\164"] . "\141\x64\144\x6f\x6e\x73\x2f\171\x62\x5f\x73\150\x6f\160\57\x63\x6f\162\x65\57" . $photoPath, $width . "\x2c" . $height, $width . "\x2c" . $height, $photoArray["\142\151\147\x50\x61\x74\x68"]["\160\141\164\150"], $photoArray["\142\151\147\x50\x61\164\x68"]["\167\151\144\x74\x68"] . "\54" . $photoArray["\142\x69\147\x50\x61\164\x68"]["\x68\x65\151\147\x68\164"], $photoArray["\142\x69\147\x50\x61\x74\x68"]["\167\151\x64\x74\x68"] . "\x2c" . $photoArray["\142\x69\x67\120\x61\164\x68"]["\150\145\x69\x67\150\164"], $photoArray["\155\151\x64\144\x6c\x65\x50\141\164\x68"]["\x70\141\164\150"], $photoArray["\155\151\144\144\154\145\x50\141\x74\150"]["\167\x69\144\x74\150"] . "\54" . $photoArray["\x6d\x69\x64\144\154\145\x50\141\164\x68"]["\x68\x65\x69\147\x68\164"], $photoArray["\155\x69\144\x64\x6c\x65\120\141\x74\x68"]["\167\x69\x64\164\150"] . "\x2c" . $photoArray["\155\151\x64\x64\154\145\120\x61\164\150"]["\x68\145\x69\x67\150\x74"], $photoArray["\x73\155\141\x6c\x6c\x50\x61\x74\150"]["\x70\141\164\150"], $photoArray["\x73\155\x61\154\154\x50\141\x74\150"]["\167\151\x64\164\x68"] . "\54" . $photoArray["\x73\x6d\x61\x6c\154\x50\141\164\x68"]["\150\x65\151\147\150\164"], $photoArray["\x73\x6d\x61\x6c\x6c\x50\141\164\x68"]["\x77\x69\x64\x74\x68"] . "\x2c" . $photoArray["\x73\155\141\x6c\154\x50\141\164\x68"]["\x68\145\151\x67\x68\x74"], $photoArray["\x6c\151\x74\164\x6c\x65\x50\x61\x74\150"]["\160\141\164\x68"], $photoArray["\x6c\x69\x74\164\154\x65\x50\141\x74\x68"]["\167\151\x64\x74\x68"] . "\54" . $photoArray["\x6c\151\164\164\154\145\x50\141\164\x68"]["\x68\145\151\x67\150\x74"], $photoArray["\154\151\164\x74\x6c\x65\120\141\x74\150"]["\167\x69\x64\x74\x68"] . "\x2c" . $photoArray["\x6c\151\x74\164\x6c\x65\120\141\164\150"]["\150\x65\x69\x67\150\164"], $this->instance_id, $this->upload_type, $domain, $bucket); goto k14A8; e9eF7: $photoArray["\x73\x6d\x61\154\x6c\x50\x61\164\x68"]["\160\x61\164\150"] = $upFilePath . md5(time() . $pic_tag) . "\x33" . $ext; goto Dwx4E; b_tvZ: if (!($this->upload_type == 1)) { goto aJ9K3; } goto bC0QI; u86sv: goto efLPm; goto xcT98; BEQYl: $photoArray = array("\142\151\147\120\x61\x74\150" => array("\x70\141\164\150" => '', "\x77\151\144\164\x68" => 700, "\x68\x65\151\147\150\x74" => 700, "\x74\x79\160\x65" => "\x31"), "\x6d\151\x64\144\x6c\x65\120\141\x74\x68" => array("\x70\x61\x74\x68" => '', "\x77\151\144\x74\x68" => 360, "\x68\145\151\x67\x68\x74" => 360, "\x74\x79\160\145" => "\62"), "\163\155\141\154\154\120\x61\x74\x68" => array("\x70\x61\164\x68" => '', "\167\x69\144\x74\x68" => 240, "\150\145\x69\147\150\x74" => 240, "\164\x79\160\x65" => "\x33"), "\x6c\x69\x74\164\154\145\x50\141\x74\150" => array("\x70\x61\164\150" => '', "\167\x69\144\x74\150" => 60, "\150\145\x69\x67\x68\164" => 60, "\164\x79\160\145" => "\64")); goto b_tvZ; Dwx4E: $photoArray["\154\151\164\164\154\145\120\x61\x74\x68"]["\160\x61\164\150"] = $upFilePath . md5(time() . $pic_tag) . "\64" . $ext; goto KOdAn; Qcbhq: efLPm: goto apdXL; M_lb6: global $_W; goto JkR_z; TkwWq: $photoArray["\x6d\x69\x64\144\154\145\x50\x61\164\x68"]["\160\141\164\x68"] = $upFilePath . md5(time() . $pic_tag) . "\x32" . $ext; goto e9eF7; bC0QI: $image = \think\Image::open($photoPath); goto KRT6U; Os5BJ: $retval = $album->addPicture($album_id, $pic_name, $pic_tag, $_W["\163\x69\x74\x65\162\157\157\x74"] . "\141\x64\x64\157\156\x73\57\171\x62\x5f\163\150\x6f\x70\57\x63\157\162\x65\57" . $photoPath, $width . "\x2c" . $height, $width . "\x2c" . $height, $photoArray["\x62\151\x67\120\x61\x74\x68"]["\x70\141\164\150"], $photoArray["\142\x69\147\x50\141\x74\x68"]["\x77\x69\x64\164\150"] . "\54" . $photoArray["\142\151\x67\120\141\164\150"]["\x68\x65\151\x67\x68\164"], $photoArray["\142\x69\x67\x50\x61\164\150"]["\x77\151\x64\x74\150"] . "\x2c" . $photoArray["\x62\x69\x67\120\x61\x74\150"]["\x68\145\x69\x67\150\164"], $photoArray["\x6d\151\144\x64\154\x65\x50\141\x74\150"]["\x70\141\164\x68"], $photoArray["\155\151\144\x64\x6c\145\x50\141\x74\150"]["\167\x69\x64\164\150"] . "\54" . $photoArray["\x6d\151\144\x64\x6c\x65\120\141\x74\x68"]["\150\x65\x69\x67\150\164"], $photoArray["\155\151\x64\x64\154\145\x50\141\164\150"]["\x77\x69\144\164\150"] . "\54" . $photoArray["\x6d\151\144\x64\154\145\x50\x61\x74\x68"]["\150\x65\151\147\x68\164"], $photoArray["\163\x6d\x61\154\x6c\120\141\164\x68"]["\x70\141\x74\150"], $photoArray["\163\x6d\141\x6c\154\x50\x61\x74\x68"]["\x77\x69\144\x74\x68"] . "\54" . $photoArray["\163\155\141\x6c\x6c\x50\141\x74\150"]["\150\145\151\147\150\164"], $photoArray["\x73\x6d\141\154\154\120\141\x74\x68"]["\167\151\x64\164\150"] . "\x2c" . $photoArray["\x73\x6d\x61\154\154\x50\x61\x74\x68"]["\150\145\x69\x67\x68\x74"], $photoArray["\x6c\x69\x74\x74\154\x65\x50\x61\164\x68"]["\160\x61\164\x68"], $photoArray["\154\151\164\164\x6c\145\x50\141\164\x68"]["\x77\x69\144\164\150"] . "\54" . $photoArray["\154\151\164\x74\x6c\145\120\x61\x74\x68"]["\x68\x65\x69\147\150\x74"], $photoArray["\154\x69\164\x74\154\145\x50\141\164\x68"]["\167\151\x64\164\x68"] . "\54" . $photoArray["\x6c\x69\164\164\x6c\x65\x50\141\164\150"]["\x68\145\x69\147\150\x74"], $this->upload_type, $domain, $bucket); goto Qcbhq; xoqkN: } public function moveUploadFile($file_path, $key) { goto vSdf0; z2tg3: $ok = @move_uploaded_file($file_path, $key); goto d_UbT; vSdf0: if (!($this->upload_type == 2 || $this->upload_type == 3)) { goto mZvez; } goto z2tg3; d_UbT: $result = ["\x63\157\144\x65" => $ok, "\160\141\x74\x68" => $key, "\x64\157\x6d\141\151\156" => '', "\x62\165\143\x6b\145\x74" => '']; goto QlG3e; QlG3e: mZvez: goto ABPFn; ABPFn: return $result; goto tFvJj; tFvJj: } public function photoAlbumUpload() { goto ysF7x; xJ7Y8: return $this->ajaxFileReturn(); goto EHitr; AVOGS: $data["\x66\x69\154\x65\137\160\x61\164\150"] = $remoteurl; goto cflX1; l7lNf: kxITU: goto e3dYJ; cflX1: $res = Db::name("\x79\142\163\143\137\151\x6d\141\147\145\x73")->insertGetId(["\165\160\x6c\157\141\144\x5f\x74\151\155\x65" => time(), "\x67\162\x6f\165\160\137\151\x64" => $album_id, "\151\x6d\147\137\156\141\155\145" => $newfile, "\151\x6d\147\137\164\141\x67" => '', "\x69\x6d\147\137\x63\157\x76\x65\162" => $remoteurl]); goto v2iZS; lJLkD: if (!empty($album_id)) { goto sfEVT; } goto LLHtb; jHVbV: goto T1CVT; goto iV_l8; ff49M: return $data; goto LcXEt; Tamts: $album_id = request()->post("\x67\162\x6f\x75\160\137\x69\144", ''); goto lJLkD; ysF7x: $data = array(); goto ImTr3; PEQZ5: @unlink($_FILES["\146\151\154\145\137\165\x70\154\x6f\141\x64"]); goto g95EY; UkB0S: RNNie: goto q2On5; mY1DM: $newfile = md5($file_new_name . $guid) . $ext; goto i5vjT; mvihV: if (empty($_W["\163\x65\164\164\151\x6e\x67"]["\x72\x65\x6d\x6f\164\x65"]["\164\171\160\145"])) { goto RNNie; } goto tOjMU; wYEwq: return $this->ajaxFileReturn(); goto REQRR; RIXNR: return $this->ajaxFileReturn(); goto jHVbV; Z1Csn: $this->return["\155\145\163\x73\141\147\145"] = "\346\226\207\344\273\266\xe6\240\xbc\xe5\274\217\xe9\224\x99\350\xaf\xaf"; goto xJ7Y8; HQEOO: MJXij: goto o3VeJ; P7qdl: $remoteurl = tomedia($ok["\160\141\x74\150"]); goto jOssx; K3fzt: $upload_flag = request()->post("\x75\x70\154\x6f\141\x64\137\146\154\141\x67", ''); goto ysa0L; mkhxx: return $this->ajaxFileReturn(); goto l7lNf; cb4Bt: $pic_name = request()->post("\151\x6d\147\137\156\x61\x6d\145", $file_new_name . $guid); goto Tamts; g95EY: $image_size = @getimagesize($ok["\160\x61\164\x68"]); goto nKXl1; SEzle: $picture_info = $album->getAlubmPictureDetail(["\x69\x6d\147\x5f\x69\144" => $retval]); goto v4hpa; E5l7P: $this->file_path = "\160\165\x62\154\151\143\57\165\160\x6c\x6f\141\x64\57" . $mch_id . "\x2f" . $old_path; goto i_5af; RJbrb: return $this->ajaxFileReturn(); goto N6_j7; e3dYJ: if (file_exists($this->file_path)) { goto MKqLv; } goto BvCc_; mM_KK: MpEWt: goto IQo0H; Ee8M2: Srtj6: goto mM_KK; h4h7B: $data["\157\162\151\x67\x69\x6e\x5f\146\x69\x6c\145\x5f\156\x61\155\145"] = $this->file_name; goto Wuli4; i6HJY: $file_name_explode = explode("\x2e", $this->file_name); goto UFLsF; JFPhO: $this->file_type = $_FILES["\x66\151\x6c\x65\137\x75\x70\x6c\157\x61\144"]["\x74\x79\x70\145"]; goto F8XGo; q2On5: if ($ok["\143\157\144\145"]) { goto McvA2; } goto O6kfq; U62EM: return $this->ajaxFileReturn(); goto m31Nl; b0hOr: $mimetype = exif_imagetype($ok["\160\141\x74\x68"]); goto xv2_p; POT3w: $width = $image_size[0]; goto VEwgc; nN0Ez: goto MpEWt; goto CtJMQ; KFOnw: $file_new_name = implode("\56", $tmp_array); goto mY1DM; LcXEt: T1CVT: goto Ee8M2; VuOqK: return $data; goto lWpUr; m31Nl: c4kaq: goto GJmQ1; mOylA: $data["\x66\x69\x6c\145\x5f\156\x61\155\x65"] = ''; goto VuOqK; P329o: AFKx8: goto MMx4_; UFLsF: $suffix = count($file_name_explode) - 1; goto vlzJR; ipi1v: $data["\143\x6f\144\x65"] = 1; goto VP8gS; QTpLG: $_W = $_SESSION["\167\145\x37\137\x77"]; goto mvihV; LLHtb: $album_id = $group_id["\147\x72\157\165\x70\137\151\144"]; goto txQ8b; iI8PH: return "\xe8\xbf\x9c\xe7\250\213\351\x99\204\xe4\xbb\266\344\xb8\212\344\274\240\xe5\244\xb1\xe8\xb4\xa5\xef\274\214\xe8\257\267\xe6\243\200\346\x9f\xa5\351\205\215\xe7\xbd\256\xe5\271\266\xe9\x87\x8d\xe6\x96\xb0\344\xb8\x8a\xe4\xbc\240"; goto RnNfh; i5vjT: $ok = $this->moveUploadFile($_FILES["\146\151\x6c\145\x5f\x75\x70\154\157\141\x64"]["\x74\155\160\137\156\x61\155\145"], $this->file_path . $newfile); goto b0hOr; RWHVD: $pic_tag = request()->post("\151\155\x67\x5f\164\x61\147", $file_new_name); goto H5Tnu; MMx4_: if (!($this->file_size > 5000000)) { goto Y2Z8L; } goto Nt68R; o3VeJ: $group = new ImagesGroup(); goto We07s; tOjMU: $pathname = $ok["\x70\141\x74\x68"]; goto Qdu3c; KpLTV: $album = new Images(); goto SEzle; ysa0L: $retval = $this->photoCreate($this->file_path, $ok["\160\141\x74\150"], "\56" . $file_name_explode[$suffix], $type, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $ok["\x64\157\155\141\151\x6e"], $ok["\x62\x75\143\153\x65\x74"]); goto EU2oi; lWpUr: goto pf4z1; goto UR60q; EU2oi: if ($retval > 0) { goto e_RgY; } goto dBXGm; VEwgc: $height = $image_size[1]; goto LK5vw; WYzlU: $old_path = request()->post("\x66\151\154\145\x5f\x70\141\x74\x68", ''); goto E5l7P; osWVQ: return $this->ajaxFileReturn(); goto nN0Ez; Erpyk: $this->file_size = $_FILES["\x66\x69\154\x65\x5f\x75\160\x6c\x6f\141\144"]["\163\151\172\x65"]; goto JFPhO; ZA7ZW: mkdir($this->file_path, $mode, true); goto UHIX_; CtJMQ: McvA2: goto PEQZ5; txQ8b: sfEVT: goto RWHVD; v2iZS: $data["\163\164\141\164\145"] = 1; goto ipi1v; iV_l8: e_RgY: goto KpLTV; Qdu3c: $remotestatus = file_remote_upload($pathname); goto UCVGc; LK5vw: $name = $file_name_explode[0]; goto jurn5; aiHrU: $this->file_name = $_FILES["\146\x69\x6c\145\x5f\x75\x70\x6c\x6f\141\144"]["\x6e\x61\x6d\x65"]; goto Erpyk; i_5af: if (!($this->file_path == '')) { goto kxITU; } goto kvuqC; kvuqC: $this->return["\x6d\x65\x73\163\x61\147\x65"] = "\346\x96\207\344\273\xb6\xe8\267\257\xe5\xbe\x84\344\xb8\x8d\xe8\203\275\xe4\270\272\347\251\xba"; goto mkhxx; ImTr3: $mch_id = $_SESSION["\x77\145\x37\137\141\143\143\x6f\165\x6e\x74"]["\165\x6e\151\141\143\x69\x64"]; goto wgi5p; xv2_p: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto OZgvO; } goto Z1Csn; kzk3J: $this->return["\155\145\x73\163\x61\x67\x65"] = "\346\226\x87\xe4\273\xb6\xe5\xa4\xa7\345\260\217\xe4\270\272\x30\115\x42"; goto vMVSi; fMRGo: if ($this->validationFile()) { goto c4kaq; } goto U62EM; WhH41: $this->return["\155\x65\163\163\x61\147\x65"] = "\xe5\x9b\xbe\xe7\211\207\344\270\212\344\xbc\xa0\xe5\244\xb1\xe8\xb4\245"; goto RJbrb; jurn5: $type = request()->post("\164\171\x70\x65", ''); goto cb4Bt; UCVGc: if (is_error($remotestatus)) { goto QEa9v; } goto P7qdl; O6kfq: $this->return["\155\145\163\163\141\x67\x65"] = "\345\x9b\xbe\347\x89\207\xe4\270\x8a\xe4\274\240\345\xa4\261\xe8\xb4\245"; goto osWVQ; vlzJR: $ext = "\x2e" . $file_name_explode[$suffix]; goto lvnpu; vMVSi: return $this->ajaxFileReturn(); goto P329o; VP8gS: $data["\146\x69\154\145\137\151\144"] = $res; goto mOylA; N6_j7: goto Srtj6; goto HQEOO; c1mNN: $data["\146\151\154\145\x5f\x6e\141\x6d\145"] = $picture_info["\x69\155\x67\137\156\141\x6d\145"]; goto h4h7B; F8XGo: if (!($this->file_size == 0)) { goto AFKx8; } goto kzk3J; GpRpR: $data["\163\x74\141\164\145"] = "\x31"; goto Gd2z7; Yfp4q: unset($tmp_array[$suffix]); goto KFOnw; nKXl1: if ($image_size) { goto MJXij; } goto WhH41; H5Tnu: $pic_id = request()->post("\x69\x6d\147\137\151\144", ''); goto K3fzt; UR60q: QEa9v: goto iI8PH; GJmQ1: $guid = md5(time()); goto i6HJY; f4WcS: global $_W; goto QTpLG; Gd2z7: $data["\143\x6f\144\x65"] = 1; goto ff49M; jOssx: $data["\157\x72\151\147\x69\156\x5f\146\x69\154\145\137\x6e\x61\x6d\145"] = $this->file_name; goto AVOGS; v4hpa: $data["\x66\x69\154\145\137\x69\144"] = $retval; goto c1mNN; lvnpu: $tmp_array = $file_name_explode; goto Yfp4q; We07s: $group_id = $group->getInfo(["\155\143\x68\x5f\151\x64" => $mch_id, "\x69\x73\x5f\144\145\146\141\x75\x6c\x74" => "\x31"]); goto POT3w; Nt68R: $this->return["\155\x65\x73\163\x61\x67\145"] = "\xe6\226\207\xe4\273\266\xe5\244\247\xe5\260\217\344\270\x8d\350\x83\275\xe8\266\205\350\277\x87\x35\115\102"; goto wYEwq; dBXGm: $this->return["\x6d\145\163\163\x61\x67\145"] = "\xe5\x9b\276\xe7\211\x87\344\270\212\xe4\274\240\345\244\261\xe8\xb4\245"; goto RIXNR; RnNfh: pf4z1: goto UkB0S; wgi5p: $album_id = request()->post("\147\162\x6f\165\x70\x5f\151\x64", ''); goto WYzlU; UHIX_: MKqLv: goto aiHrU; REQRR: Y2Z8L: goto fMRGo; Wuli4: $data["\x66\151\x6c\x65\137\x70\x61\x74\150"] = $_W["\x73\151\164\145\162\157\157\164"] . "\x61\x64\144\157\156\x73\x2f\x79\x62\137\x73\x68\x6f\160\57\x63\157\x72\x65\57" . $this->file_path . $newfile; goto GpRpR; BvCc_: $mode = intval("\60\67\67\67", 8); goto ZA7ZW; EHitr: OZgvO: goto f4WcS; IQo0H: } }
