<?php
 namespace app\app\controller; use app\admin\service\Images; use app\common\model\ImagesGroup; session_start(); define("\111\101\137\x52\117\117\x54", ''); load()->func("\x66\151\x6c\145"); use think\Controller; use think\config; use think\Db; use think\Log; use think\Image; use think\Session; define("\125\120\114\117\101\104\137\x56\x49\x44\105\x4f", Config::get("\166\x69\x65\x77\137\162\145\160\x6c\x61\143\145\x5f\x73\x74\x72\56\x55\120\114\x4f\101\104\x5f\x56\x49\104\105\x4f")); class Umupload extends Controller { private $return = array(); private $file_path = ''; private $file_name = ''; private $file_size = 0; private $file_type = ''; private $upload_type = 2; public function uploadFile() { goto rhNNo; bwGPj: if (!($this->file_size == 0)) { goto Q3JVF; } goto akR_r; mTA8N: $this->return["\155\x65\x73\x73\x61\x67\145"] = "\350\xaf\267\xe6\xa3\200\346\x9f\xa5\346\x82\250\xe7\x9a\x84\xe4\270\x8a\344\xbc\xa0\345\217\x82\xe6\225\260\xe9\205\x8d\xe7\xbd\xae\xe6\210\x96\xe4\270\212\xe4\xbc\xa0\xe7\x9a\x84\xe6\226\x87\xe4\273\xb6\xe6\230\xaf\345\x90\xa6\xe6\234\211\xe8\xaf\257"; goto u7cY8; sE5AK: $this->return["\x73\164\141\x74\145"] = "\x53\125\x43\x43\105\x53\x53"; goto DLxqE; okJgh: return "\xe8\277\x9c\347\250\213\351\231\x84\344\xbb\266\xe4\270\212\xe4\xbc\240\xe5\244\261\350\264\xa5\xef\xbc\x8c\xe8\257\267\xe6\243\x80\346\x9f\245\351\205\x8d\xe7\xbd\256\xe5\xb9\266\351\x87\x8d\xe6\226\xb0\344\xb8\212\344\274\240"; goto IpMCW; XolhK: $this->return["\155\145\x73\163\141\x67\145"] = "\350\257\xb7\xe6\xa3\200\346\x9f\xa5\346\202\xa8\xe7\232\204\xe4\xb8\x8a\344\274\240\345\x8f\202\xe6\x95\260\xe9\x85\215\xe7\xbd\xae\xe6\x88\x96\344\xb8\212\344\274\240\xe7\x9a\x84\346\x96\x87\344\xbb\266\346\x98\257\345\x90\246\xe6\234\x89\xe8\xaf\xaf"; goto P6Z6o; e1XqI: SCoRr: goto NeS4N; IvsQX: if (is_error($remotestatus)) { goto twiB2; } goto mkU59; hYMTl: @unlink($_FILES["\x66\x69\154\x65\137\165\160\x6c\157\141\x64"]); goto gA64z; U8JgI: $old_path = request()->post("\x66\x69\154\145\137\160\141\x74\x68", ''); goto NeLMU; Tvkze: if ($ok["\143\157\x64\x65"]) { goto V_slR; } goto XolhK; retjH: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto iVpxe; } goto XNLcg; r3IlX: jj7JM: goto Tvkze; WOg9c: $this->return["\165\x72\154"] = $_W["\x73\151\164\x65\x72\157\157\164"] . "\x61\144\x64\157\156\x73\57\171\142\x5f\163\x68\x6f\x70\57\143\157\x72\x65\x2f" . $ok["\160\141\164\150"]; goto LGR7e; gMTaD: mkdir($this->file_path, $mode, true); goto YTDqc; vIzPB: return $this->ajaxFileReturn(); goto yf7rf; LGR7e: $this->return["\164\x69\x74\154\145"] = $newfile; goto ZgGzG; mkU59: $remoteurl = tomedia($ok["\160\141\x74\150"]); goto sE5AK; s3TlI: $suffix = count($file_name_explode) - 1; goto nEY7a; ULcl4: $pathname = $ok["\x70\x61\x74\x68"]; goto EcaR0; M6TT8: Vev3I: goto hYMTl; L92Vt: if (empty($_W["\x73\145\x74\x74\x69\156\147"]["\x72\x65\x6d\x6f\164\145"]["\x74\171\160\x65"])) { goto jj7JM; } goto ULcl4; opvvK: $mode = intval("\x30\67\x37\x37", 8); goto gMTaD; LOV06: if (!($this->file_path == '')) { goto ae4bF; } goto z10wd; IpMCW: P_IoD: goto r3IlX; gA64z: $this->return["\x73\x74\x61\x74\x65"] = "\x53\x55\103\103\105\x53\x53"; goto WOg9c; vGOAK: return $this->ajaxFileReturn(); goto gUl8M; DdLJe: $this->file_type = $_FILES["\x75\160\146\x69\154\145"]["\164\x79\160\x65"]; goto bwGPj; ZgGzG: B8oma: goto o4jnv; u7cY8: goto B8oma; goto M6TT8; PBMBz: if (!strstr(UPLOAD_VIDEO, $this->file_path)) { goto Vev3I; } goto mTA8N; EcaR0: $remotestatus = file_remote_upload($pathname); goto IvsQX; eof_6: V_slR: goto PBMBz; rhNNo: global $_W; goto dyunU; P6Z6o: goto yluCG; goto eof_6; HOsoq: goto P_IoD; goto weJUW; cMsVn: if (file_exists($this->file_path)) { goto yQnh4; } goto opvvK; chF3y: $ok = $this->moveUploadFile($_FILES["\x75\160\x66\x69\154\x65"]["\x74\155\160\137\156\x61\155\145"], $this->file_path . $newfile); goto XjLp2; DLxqE: $this->return["\x75\x72\x6c"] = $remoteurl; goto Khj7e; NeS4N: $guid = app_random(32); goto KmOVl; NeLMU: $this->file_path = "\x70\165\142\x6c\151\143\x2f\x75\x70\154\x6f\x61\x64\57" . $mch_id . "\57" . $old_path; goto LOV06; W3N_8: $this->file_name = $_FILES["\x75\x70\x66\x69\x6c\x65"]["\156\x61\x6d\x65"]; goto lHsa2; o4jnv: yluCG: goto vGOAK; VoUj_: Q3JVF: goto APXcW; nEY7a: $ext = "\x2e" . $file_name_explode[$suffix]; goto ZopMA; ikAWo: return $this->ajaxFileReturn(); goto e1XqI; XNLcg: $this->return["\155\145\163\163\x61\x67\x65"] = "\xe6\226\207\xe4\xbb\xb6\346\xa0\274\345\xbc\217\xe9\x94\231\350\xaf\257"; goto vIzPB; APXcW: if ($this->validationFile()) { goto SCoRr; } goto ikAWo; Khj7e: $this->return["\164\x69\164\x6c\145"] = $newfile; goto b8Doc; lHsa2: $this->file_size = $_FILES["\165\160\146\151\x6c\x65"]["\x73\151\172\x65"]; goto DdLJe; yf7rf: iVpxe: goto L92Vt; WuKGp: ae4bF: goto cMsVn; ZopMA: $newfile = $guid . $ext; goto chF3y; qOr3k: return $this->ajaxFileReturn(); goto WuKGp; KmOVl: $file_name_explode = explode("\x2e", $this->file_name); goto s3TlI; z10wd: $this->return["\x6d\145\163\163\x61\x67\x65"] = "\xe6\x96\207\344\xbb\xb6\xe8\267\257\xe5\276\x84\xe4\xb8\215\350\x83\xbd\xe4\xb8\272\xe7\xa9\xba"; goto qOr3k; b8Doc: return json_encode($this->return); goto HOsoq; dyunU: $mch_id = $_W["\x61\x63\151\144"]; goto U8JgI; iQlAW: return $this->ajaxFileReturn(); goto VoUj_; akR_r: $this->return["\x6d\145\x73\x73\141\147\145"] = "\xe6\x96\x87\xe4\xbb\xb6\xe5\244\247\345\xb0\x8f\344\270\xba\x30\x4d\x42"; goto iQlAW; weJUW: twiB2: goto okJgh; YTDqc: yQnh4: goto W3N_8; XjLp2: $mimetype = exif_imagetype($ok["\x70\x61\164\x68"]); goto retjH; gUl8M: } private function ajaxFileReturn() { goto b0Ff1; FWvJV: $this->return["\144\x61\164\141"] = ''; goto wAF_O; b0Ff1: if (!(empty($this->return["\x63\x6f\x64\145"]) || null == $this->return["\143\x6f\144\x65"] || '' == $this->return["\143\157\144\x65"])) { goto xBMLy; } goto NhUnV; wAF_O: uQs1n: goto kAwqi; kAwqi: return json_encode($this->return); goto Fx2UW; ANZeN: $this->return["\x6d\145\x73\163\x61\x67\x65"] = ''; goto sWwgQ; oDnI2: if (!(empty($this->return["\155\x65\x73\163\141\x67\145"]) || null == $this->return["\155\x65\x73\163\x61\147\x65"] || '' == $this->return["\155\145\x73\163\x61\147\x65"])) { goto rEbbY; } goto ANZeN; NQVDh: xBMLy: goto oDnI2; sWwgQ: rEbbY: goto QBFxU; QBFxU: if (!(empty($this->return["\x64\x61\164\141"]) || null == $this->return["\x64\141\164\141"] || '' == $this->return["\144\x61\x74\x61"])) { goto uQs1n; } goto FWvJV; NhUnV: $this->return["\143\157\x64\x65"] = 0; goto NQVDh; Fx2UW: } private function validationFile() { goto m1Z7P; TANX9: $this->return["\x6d\x65\x73\163\141\147\x65"] = "\xe6\x96\207\344\273\xb6\344\270\212\xe4\274\xa0\xe5\244\xb1\350\xb4\245\54\xe8\257\267\346\xa3\x80\xe6\237\xa5\346\x82\250\xe4\xb8\212\344\274\xa0\xe7\232\204\346\226\x87\xe4\xbb\266\347\xb1\273\xe5\236\213\x2c\346\226\x87\344\273\266\xe5\244\247\xe5\xb0\x8f\344\xb8\x8d\xe8\203\xbd\xe8\266\x85\350\277\207\61\60\x4d\102"; goto GUXDy; eRzCt: Cxdr9: goto vJ7NG; GUXDy: $flag = false; goto jOW5Y; tJJIj: $flag = false; goto eRzCt; yFW_U: if (in_array($this->file_type, $alltype)) { goto Cxdr9; } goto ynP3m; m1Z7P: $flag = true; goto WUeEA; WUeEA: if (!($this->file_size > 10000000)) { goto e55LN; } goto TANX9; CJLzg: $alltype = ["\151\x6d\x61\x67\x65\x2f\152\x70\x67", "\151\x6d\141\x67\145\x2f\152\x70\145\x67", "\151\x6d\141\x67\x65\57\160\x6e\147", "\x69\155\141\x67\x65\x2f\147\x69\x66"]; goto yFW_U; vJ7NG: return $flag; goto XfkxS; jOW5Y: e55LN: goto CJLzg; ynP3m: $this->return["\155\145\163\163\x61\x67\145"] = "\346\226\x87\xe4\xbb\266\xe7\261\273\345\236\x8b\351\224\x99\xe8\xaf\257"; goto tJJIj; XfkxS: } public function photoCreate($upFilePath, $photoPath, $ext, $type = 0, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $domain, $bucket) { goto GIc2G; QTopt: $photoArray["\x6c\151\x74\164\154\145\120\141\164\x68"]["\x70\x61\164\x68"] = $upFilePath . md5(time() . $pic_tag) . "\64" . $ext; goto UbRmR; GIc2G: global $_W; goto kuCDC; dX0l6: $retval = $album->addPicture($album_id, $pic_name, $pic_tag, $_W["\163\151\x74\145\x72\157\x6f\164"] . "\x61\x64\x64\x6f\156\163\57\x79\x62\137\x73\150\x6f\160\x2f\x63\157\162\145\x2f" . $photoPath, $width . "\x2c" . $height, $width . "\x2c" . $height, $photoArray["\x62\151\147\120\x61\164\150"]["\x70\x61\x74\x68"], $photoArray["\142\x69\x67\120\x61\164\x68"]["\x77\x69\144\x74\150"] . "\x2c" . $photoArray["\x62\x69\147\x50\x61\164\x68"]["\150\x65\151\x67\x68\164"], $photoArray["\142\151\x67\x50\x61\164\150"]["\167\x69\x64\164\150"] . "\x2c" . $photoArray["\142\151\147\120\141\x74\x68"]["\150\x65\151\147\x68\x74"], $photoArray["\x6d\151\x64\144\154\145\x50\141\x74\x68"]["\x70\141\x74\x68"], $photoArray["\155\151\144\x64\x6c\x65\x50\x61\x74\150"]["\x77\151\x64\x74\x68"] . "\x2c" . $photoArray["\x6d\151\144\x64\x6c\x65\120\141\x74\150"]["\x68\145\x69\147\150\164"], $photoArray["\x6d\151\x64\x64\154\x65\120\141\x74\150"]["\x77\151\144\x74\150"] . "\54" . $photoArray["\155\151\x64\x64\154\145\x50\141\x74\150"]["\150\145\151\x67\x68\164"], $photoArray["\163\155\x61\x6c\154\x50\141\164\150"]["\x70\x61\x74\x68"], $photoArray["\163\155\141\x6c\154\120\141\164\x68"]["\167\151\x64\x74\150"] . "\54" . $photoArray["\x73\x6d\141\x6c\154\x50\141\164\150"]["\150\x65\151\147\150\164"], $photoArray["\x73\155\x61\154\154\x50\141\x74\x68"]["\167\151\x64\x74\150"] . "\54" . $photoArray["\163\x6d\x61\x6c\x6c\120\141\x74\150"]["\150\x65\x69\147\150\x74"], $photoArray["\154\151\164\x74\x6c\145\120\x61\164\150"]["\x70\x61\164\150"], $photoArray["\154\x69\164\164\x6c\145\120\x61\164\x68"]["\x77\151\x64\164\150"] . "\x2c" . $photoArray["\x6c\x69\x74\x74\154\x65\x50\x61\x74\x68"]["\x68\x65\151\147\x68\164"], $photoArray["\154\x69\164\164\154\x65\120\x61\164\x68"]["\x77\x69\x64\164\x68"] . "\54" . $photoArray["\x6c\x69\164\x74\x6c\x65\x50\x61\x74\x68"]["\x68\145\x69\147\150\164"], $this->upload_type, $domain, $bucket); goto lOGZ4; fUo0e: goto e9syN; goto su2LF; yg6ND: $photoArray["\155\x69\x64\x64\154\145\x50\x61\x74\x68"]["\160\x61\x74\x68"] = $upFilePath . md5(time() . $pic_tag) . "\x32" . $ext; goto o2gvb; UbRmR: foreach ($photoArray as $v) { goto zZK6Z; zZK6Z: if (!stristr($type, $v["\x74\x79\x70\x65"])) { goto IDX8s; } goto M2sG7; sTRgq: fkHW6: goto u1eyH; pkkOb: IDX8s: goto sTRgq; M2sG7: $image->thumb($v["\x77\x69\x64\164\x68"], $v["\150\145\x69\x67\x68\164"], \think\Image::GbGIG)->save($v["\x70\141\164\150"]); goto pkkOb; u1eyH: } goto gFvnf; uV7CQ: b5g1l: goto qbU1n; lOGZ4: e9syN: goto as1T9; DW3iK: $retval = $pic_id; goto fUo0e; as1T9: return $retval; goto Kr6Eu; gFvnf: aHcfp: goto uV7CQ; PIg1Z: if (!($this->upload_type == 1)) { goto b5g1l; } goto sHy23; TSZBx: $retval = $album->ModifyAlbumPicture($pic_id, $_W["\x73\x69\164\x65\x72\157\157\164"] . "\x61\x64\x64\x6f\156\x73\57\171\x62\x5f\x73\150\x6f\x70\x2f\x63\x6f\162\x65\57" . $photoPath, $width . "\54" . $height, $width . "\x2c" . $height, $photoArray["\142\151\147\x50\x61\164\x68"]["\160\141\x74\150"], $photoArray["\142\x69\147\x50\141\x74\150"]["\167\x69\144\164\150"] . "\54" . $photoArray["\142\151\x67\120\x61\x74\150"]["\150\x65\x69\147\x68\164"], $photoArray["\142\151\x67\120\141\164\x68"]["\x77\x69\x64\x74\x68"] . "\x2c" . $photoArray["\x62\151\x67\x50\141\164\x68"]["\x68\x65\151\x67\x68\164"], $photoArray["\155\x69\x64\144\154\145\120\x61\164\150"]["\x70\x61\x74\x68"], $photoArray["\x6d\x69\x64\x64\154\145\120\x61\164\150"]["\x77\151\144\164\150"] . "\x2c" . $photoArray["\155\x69\x64\x64\x6c\145\x50\x61\x74\150"]["\150\x65\151\x67\150\x74"], $photoArray["\x6d\x69\144\144\x6c\145\120\x61\x74\x68"]["\x77\151\x64\164\x68"] . "\54" . $photoArray["\155\151\x64\x64\154\x65\x50\141\164\150"]["\150\x65\x69\147\150\x74"], $photoArray["\x73\155\x61\x6c\x6c\x50\141\164\150"]["\x70\141\x74\x68"], $photoArray["\163\x6d\x61\x6c\x6c\x50\141\164\x68"]["\167\151\x64\164\x68"] . "\x2c" . $photoArray["\x73\x6d\x61\154\x6c\x50\x61\x74\x68"]["\150\145\x69\147\150\x74"], $photoArray["\x73\155\141\x6c\x6c\x50\141\164\150"]["\x77\x69\x64\164\x68"] . "\54" . $photoArray["\163\155\141\x6c\x6c\x50\141\x74\x68"]["\x68\145\151\147\x68\x74"], $photoArray["\154\x69\x74\164\154\145\120\141\164\150"]["\x70\141\164\x68"], $photoArray["\154\151\164\164\154\x65\x50\x61\x74\150"]["\x77\151\144\164\150"] . "\x2c" . $photoArray["\x6c\x69\x74\164\x6c\145\x50\141\x74\150"]["\x68\x65\151\147\150\x74"], $photoArray["\x6c\x69\164\x74\154\145\120\x61\164\150"]["\167\x69\x64\164\x68"] . "\x2c" . $photoArray["\x6c\x69\164\x74\x6c\x65\x50\141\164\150"]["\150\145\x69\147\150\x74"], $this->instance_id, $this->upload_type, $domain, $bucket); goto DW3iK; GruU0: if ($pic_id == '') { goto KBDRH; } goto TSZBx; StqGb: $photoArray = array("\x62\x69\147\x50\x61\x74\150" => array("\x70\141\x74\x68" => '', "\x77\x69\x64\164\150" => 700, "\150\145\151\147\150\x74" => 700, "\x74\x79\160\x65" => "\61"), "\155\151\144\x64\154\145\120\x61\164\150" => array("\x70\141\164\x68" => '', "\x77\151\144\164\x68" => 360, "\x68\145\151\x67\150\164" => 360, "\164\x79\160\x65" => "\62"), "\x73\x6d\141\154\x6c\x50\141\164\x68" => array("\x70\x61\164\x68" => '', "\167\151\144\x74\150" => 240, "\150\145\x69\147\150\x74" => 240, "\x74\171\x70\x65" => "\x33"), "\x6c\x69\164\164\154\x65\x50\x61\x74\150" => array("\x70\x61\x74\150" => '', "\x77\151\144\x74\150" => 60, "\x68\x65\x69\x67\150\164" => 60, "\x74\x79\x70\x65" => "\x34")); goto PIg1Z; qbU1n: $album = new Images(); goto GruU0; kuCDC: $_W = $_SESSION["\x77\145\67\x5f\167"]; goto StqGb; o2gvb: $photoArray["\163\155\x61\154\154\x50\141\x74\x68"]["\x70\141\164\x68"] = $upFilePath . md5(time() . $pic_tag) . "\x33" . $ext; goto QTopt; sHy23: $image = \think\Image::open($photoPath); goto ORYj3; su2LF: KBDRH: goto dX0l6; ORYj3: $photoArray["\x62\151\147\x50\x61\x74\x68"]["\x70\x61\x74\150"] = $upFilePath . md5(time() . $pic_tag) . "\61" . $ext; goto yg6ND; Kr6Eu: } public function moveUploadFile($file_path, $key) { goto SfoPS; NJwV1: return $result; goto LWvjV; Ou_eu: uCDEK: goto NJwV1; qwxmN: $ok = @move_uploaded_file($file_path, $key); goto or78n; SfoPS: if (!($this->upload_type == 2)) { goto uCDEK; } goto qwxmN; or78n: $result = ["\x63\157\x64\145" => $ok, "\x70\141\164\150" => $key, "\144\x6f\155\x61\151\x6e" => '', "\x62\x75\143\153\145\164" => '']; goto Ou_eu; LWvjV: } public function photoAlbumUpload() { goto RYS0r; yIfQZ: return $this->ajaxFileReturn(); goto czOO0; O78ph: $ext = "\x2e" . $file_name_explode[$suffix]; goto UlpYg; gnWlV: $width = $image_size[0]; goto LkEDs; yK0gL: if ($ok["\x63\157\144\x65"]) { goto JNAF7; } goto el1iR; wAKMJ: bheiM: goto xQot7; hQwnL: $ok = $this->moveUploadFile($_FILES["\x75\160\x66\151\x6c\x65"]["\164\x6d\160\137\x6e\141\155\145"], $this->file_path . $newfile); goto BUdsz; rWSGC: $data["\157\x72\151\147\x69\x6e\x5f\146\x69\154\145\137\x6e\x61\x6d\x65"] = $this->file_name; goto vlR2s; pP83m: $data["\x6f\162\x69\147\151\156\137\146\x69\154\145\x5f\x6e\x61\x6d\145"] = $this->file_name; goto GuGF2; nTJJf: $name = $file_name_explode[0]; goto PhgTF; KscCV: Q81kz: goto v0RWJ; SqsxA: cgth1: goto WfqYn; KRdOm: $data["\x66\151\154\145\x5f\x69\144"] = $res; goto A0C2O; BUdsz: $mimetype = exif_imagetype($ok["\160\141\164\x68"]); goto DX_GR; QQekq: $group = new ImagesGroup(); goto N4JHa; Z8603: @unlink($_FILES["\146\151\154\145\x5f\x75\x70\x6c\157\141\144"]); goto xh1TV; KBTYN: VpwZM: goto czOLt; el1iR: $data["\163\x74\x61\164\145"] = "\60"; goto wjvIc; Y0Ib4: $data["\163\164\x61\x74\145"] = "\60"; goto erkmw; RYS0r: $data = array(); goto mdAJ_; VgKMT: $data["\x6f\162\151\147\151\x6e\x5f\x66\151\x6c\145\137\x6e\141\x6d\x65"] = $this->file_name; goto nj_0l; Nh428: return $data; goto e5X45; lCFFq: $this->file_size = $_FILES["\x75\160\x66\x69\x6c\145"]["\x73\151\x7a\145"]; goto MaeW_; MzcCA: bjJtH: goto Y3LiU; FYq9f: $guid = time(); goto CqGZm; C8Cvl: $remoteurl = tomedia($ok["\x70\141\x74\x68"]); goto GbPrA; AJADn: $old_path = $this->file_path = request()->post("\146\x69\154\x65\x5f\160\x61\x74\150", ''); goto rhzx3; uE1gp: $data["\x73\x74\x61\x74\145"] = "\60"; goto cTfKw; LkEDs: $height = $image_size[1]; goto nTJJf; UlpYg: $tmp_array = $file_name_explode; goto oiUnb; R3VI6: if (!($this->file_path == '')) { goto cgth1; } goto uE1gp; eTU_Z: $data["\x66\x69\x6c\x65\137\151\144"] = $retval; goto VNGSQ; kwNTx: $data["\146\x69\154\145\x5f\160\141\164\x68"] = $_W["\x73\x69\164\x65\x72\157\x6f\164"] . "\x61\x64\x64\157\x6e\x73\57\x79\142\137\163\150\x6f\x70\x2f\143\x6f\162\x65\x2f" . $this->file_path . $newfile; goto DhqM7; A0C2O: $data["\146\x69\x6c\145\x5f\x6e\x61\155\x65"] = ''; goto oC0SG; r3I1H: $data["\x66\x69\x6c\145\x5f\160\141\x74\150"] = $remoteurl; goto Xqu1I; xh1TV: $image_size = @getimagesize($ok["\x70\x61\x74\150"]); goto NgDbe; erkmw: $data["\x6d\145\163\x73\x61\147\x65"] = "\346\226\x87\344\xbb\xb6\345\244\247\xe5\xb0\x8f\344\xb8\x8d\350\x83\275\xe8\xb6\x85\xe8\277\207\65\115\102"; goto ROzkz; VMKAA: $data["\155\x65\163\x73\141\147\x65"] = "\345\x9b\xbe\xe7\x89\x87\xe4\270\x8a\xe4\xbc\xa0\345\244\xb1\350\264\xa5"; goto VgKMT; tfP1L: $suffix = count($file_name_explode) - 1; goto O78ph; CqGZm: $file_name_explode = explode("\x2e", $this->file_name); goto tfP1L; JjYEb: $data["\163\164\141\x74\145"] = "\x30"; goto Qenlg; ifnTv: $pic_tag = request()->post("\151\155\x67\x5f\x74\141\147", $file_new_name); goto uOQ3U; jRMYh: $pathname = $ok["\x70\x61\164\150"]; goto YfFbC; xQot7: CK1Al: goto yK0gL; v0RWJ: global $_W; goto maDzs; heuIa: $album_id = $group_id["\x67\x72\157\x75\160\x5f\x69\x64"]; goto NQ4bt; kfFnQ: $album_id = request()->post("\x67\x72\157\165\160\137\151\x64", ''); goto GowLx; RUvbP: if ($retval > 0) { goto VpwZM; } goto SC5ju; oiUnb: unset($tmp_array[$suffix]); goto Odsdz; Z_t61: $data["\x73\x74\141\x74\145"] = "\60"; goto ChfXW; N9pNi: if (!($this->file_size > 5000000)) { goto Ckx8t; } goto Y0Ib4; PhgTF: $type = request()->post("\164\171\x70\145", ''); goto VsxSI; nj_0l: return $data; goto ewOlA; sW_N4: $this->file_name = $_FILES["\x75\x70\x66\151\154\145"]["\156\141\155\x65"]; goto lCFFq; maDzs: $_W = $_SESSION["\x77\145\x37\137\167"]; goto ynYT5; axAKl: $album_id = request()->post("\147\x72\x6f\165\x70\137\x69\x64", ''); goto AJADn; Odsdz: $file_new_name = implode("\56", $tmp_array); goto iZbO0; wjvIc: $data["\155\x65\163\x73\x61\147\x65"] = "\xe5\x9b\xbe\347\x89\x87\344\xb8\212\344\xbc\xa0\xe5\xa4\xb1\xe8\264\xa5"; goto Xr1zi; Xqu1I: $res = Db::name("\171\142\x73\143\x5f\151\x6d\141\x67\x65\x73")->insertGetId(["\147\x72\157\165\160\x5f\x69\144" => $album_id, "\151\x6d\x67\137\x6e\141\155\145" => $newfile, "\151\155\147\137\164\x61\147" => '', "\151\x6d\147\137\x63\157\x76\x65\162" => $remoteurl]); goto Zvs5i; Qenlg: $data["\x6d\x65\x73\163\141\147\145"] = "\345\233\276\xe7\211\x87\xe4\xb8\212\xe4\274\xa0\345\244\xb1\350\xb4\245"; goto IyBsb; GbPrA: $data["\x6f\x72\151\x67\x69\x6e\x5f\x66\151\x6c\145\137\x6e\141\x6d\145"] = $this->file_name; goto r3I1H; QLQSI: lMonT: goto sW_N4; GuGF2: return $data; goto SqsxA; VsxSI: $pic_name = request()->post("\151\155\147\x5f\156\141\x6d\x65", $file_new_name . $guid); goto kfFnQ; DX_GR: if (!($mimetype != IMAGETYPE_GIF && $mimetype != IMAGETYPE_JPEG && $mimetype != IMAGETYPE_PNG && $mimetype != IMAGETYPE_BMP)) { goto Q81kz; } goto Z_t61; DhqM7: $data["\163\x74\x61\164\145"] = "\61"; goto SI2jO; czOO0: VkkzZ: goto FYq9f; ewOlA: goto bjJtH; goto KBTYN; nyFJH: if (!($this->file_size == 0)) { goto PS5aR; } goto phbIt; Zvs5i: $data["\x73\x74\x61\164\145"] = 1; goto KRdOm; e5X45: goto OYRI7; goto eueeI; vKnsz: $data["\x6f\x72\151\147\x69\156\137\x66\151\x6c\145\x5f\x6e\141\155\145"] = $this->file_name; goto kwNTx; N4JHa: $group_id = $group->getInfo(["\x6d\x63\x68\x5f\x69\x64" => $mch_id, "\151\163\137\144\145\x66\x61\165\x6c\164" => "\61"]); goto gnWlV; oC0SG: return $data; goto umwwk; ChfXW: $data["\x6d\x65\163\163\141\147\x65"] = "\346\226\207\xe4\xbb\xb6\xe6\240\274\xe5\xbc\217\xe9\224\231\xe8\257\257"; goto Zpj9x; rhzx3: $this->file_path = "\x70\165\x62\x6c\151\x63\57\165\160\x6c\157\141\x64\57" . $mch_id . "\57" . $old_path; goto R3VI6; KG5_I: H4uB5: goto qnFRT; ORii8: OYRI7: goto CDpEV; GowLx: if (!empty($album_id)) { goto Ilpjj; } goto heuIa; NgDbe: if ($image_size) { goto IBmY3; } goto JjYEb; pWDkq: return $data; goto skUVp; YfFbC: $remotestatus = file_remote_upload($pathname); goto JXDoW; mdAJ_: $mch_id = Session::get("\142\165\x73\x5f\x69\x64"); goto axAKl; Xr1zi: $data["\x6f\162\151\x67\x69\x6e\137\x66\x69\x6c\x65\137\x6e\141\155\145"] = $this->file_name; goto Nh428; qnFRT: return "\xe8\277\234\xe7\xa8\x8b\351\x99\204\xe4\273\266\344\270\212\344\274\240\345\xa4\261\350\xb4\xa5\xef\274\x8c\xe8\257\267\346\243\200\xe6\x9f\xa5\xe9\205\215\347\xbd\xae\xe5\xb9\266\xe9\x87\x8d\346\x96\xb0\344\xb8\x8a\xe4\274\xa0"; goto wAKMJ; LoghM: IBmY3: goto QQekq; Y3LiU: yrBaR: goto ORii8; OUC7t: Ckx8t: goto Tiidj; skUVp: goto yrBaR; goto LoghM; aUeFX: $retval = $this->photoCreate($this->file_path, $ok["\160\x61\x74\x68"], "\56" . $file_name_explode[$suffix], $type, $pic_name, $album_id, $width, $height, $pic_tag, $pic_id, $ok["\144\157\155\141\x69\x6e"], $ok["\x62\x75\143\x6b\x65\164"]); goto RUvbP; Zpj9x: $data["\x6f\162\x69\147\151\156\x5f\146\x69\x6c\x65\x5f\156\141\x6d\x65"] = $this->file_name; goto TRL06; iZbO0: $newfile = md5($file_new_name . $guid) . $ext; goto hQwnL; k14L8: return $data; goto OUC7t; ROzkz: $data["\x6f\x72\151\x67\x69\156\x5f\146\151\154\145\x5f\156\x61\x6d\x65"] = $this->file_name; goto k14L8; Tiidj: if ($this->validationFile()) { goto VkkzZ; } goto yIfQZ; ynYT5: if (empty($_W["\163\145\x74\x74\x69\x6e\147"]["\162\x65\155\x6f\164\x65"]["\x74\x79\160\145"])) { goto CK1Al; } goto jRMYh; MaeW_: $this->file_type = $_FILES["\165\x70\146\x69\x6c\x65"]["\164\x79\x70\145"]; goto nyFJH; Y_XP8: $upload_flag = request()->post("\165\x70\154\157\141\x64\x5f\146\154\141\x67", ''); goto aUeFX; eueeI: JNAF7: goto Z8603; xcIY0: $mode = intval("\x30\67\x37\67", 8); goto Nx39I; TRL06: return $data; goto KscCV; SI2jO: return $data; goto MzcCA; czOLt: $album = new Images(); goto VXCPc; IyBsb: $data["\x6f\162\151\147\151\156\x5f\146\151\154\x65\x5f\x6e\141\155\x65"] = $this->file_name; goto pWDkq; NQ4bt: Ilpjj: goto ifnTv; uOQ3U: $pic_id = request()->post("\x69\x6d\x67\x5f\151\144", ''); goto Y_XP8; WfqYn: if (file_exists($this->file_path)) { goto lMonT; } goto xcIY0; umwwk: goto bheiM; goto KG5_I; phbIt: $data["\163\164\x61\164\145"] = "\x30"; goto Fahik; VXCPc: $picture_info = $album->getAlubmPictureDetail(["\x69\x6d\x67\x5f\x69\x64" => $retval]); goto eTU_Z; cTfKw: $data["\155\x65\163\163\x61\x67\x65"] = "\346\x96\207\344\273\266\xe8\xb7\xaf\345\xbe\x84\xe4\xb8\215\xe8\203\xbd\344\xb8\272\xe7\251\272"; goto pP83m; Fahik: $data["\155\145\163\163\x61\x67\145"] = "\346\x96\x87\xe4\273\266\345\244\xa7\xe5\xb0\217\xe4\xb8\xba\60\x4d\x42"; goto rWSGC; vlR2s: return $data; goto Ak9Xu; JXDoW: if (is_error($remotestatus)) { goto H4uB5; } goto C8Cvl; Nx39I: mkdir($this->file_path, $mode, true); goto QLQSI; Ak9Xu: PS5aR: goto N9pNi; SC5ju: $data["\163\164\141\x74\145"] = "\x30"; goto VMKAA; VNGSQ: $data["\146\151\154\x65\137\156\x61\x6d\145"] = $picture_info["\160\x69\143\137\143\x6f\166\x65\x72\137\155\x69\144"]; goto vKnsz; CDpEV: } public function deleteimg() { goto FPthT; A0Xql: exit(json_encode($result, true)); goto f3r23; Ys1sm: AZO3Z: goto nkUUl; OkLv6: skVhe: goto Zr8ns; b3Hc9: load()->library("\x63\x6f\x73"); goto SY6FP; Jh0hk: w1mhY: goto gxNCj; xsmgn: $path = "\57" . $file; goto CxQRr; ac1fr: exit; goto Jh0hk; gx79k: goto AZO3Z; goto clHpo; clHpo: IPDjZ: goto u1BeU; enr2X: if (!empty($result["\143\x6f\x64\145"])) { goto nwL7c; } goto A0Xql; Iqa90: load()->library("\157\163\163"); goto wbVDL; lSNwV: foreach ($file as $item) { goto C7yie; zKXtw: M1G2H: goto KluEd; jRSL5: yaOy2: goto y99ZM; C7yie: if (!($i > 0)) { goto u963d; } goto Ru3zb; KluEd: u963d: goto SrPPL; Kwzgd: goto M1G2H; goto jRSL5; XJRPv: SI6W2: goto jfeQh; Ru3zb: if ($str == '') { goto yaOy2; } goto XGwuv; SrPPL: $i += 1; goto XJRPv; y99ZM: $str .= "\x70\165\142\154\x69\143\57\165\160\x6c\x6f\x61\144\57" . $item; goto zKXtw; XGwuv: $str .= "\57\x70\x75\x62\x6c\x69\x63\57\x75\x70\154\x6f\x61\x64\x2f" . $item; goto Kwzgd; jfeQh: } goto fW4N1; ZDRiw: exit(json_encode($error, true)); goto nCDX9; tDziO: r2ef0: goto WvNPz; wbVDL: $bucket = explode("\x40\x40", $_W["\x73\145\x74\x74\x69\156\147"]["\162\145\x6d\157\x74\x65"]["\x61\154\151\x6f\x73\163"]["\x62\165\143\153\145\164"]); goto Pc99m; m1GwW: $auth = new \Qiniu\Auth($_W["\163\145\x74\x74\151\x6e\x67"]["\162\x65\155\157\x74\145"]["\161\x69\156\x69\x75"]["\x61\x63\143\x65\163\x73\x6b\145\x79"], $_W["\163\145\x74\x74\x69\156\x67"]["\x72\145\x6d\x6f\x74\145"]["\x71\x69\x6e\151\165"]["\163\x65\x63\x72\x65\164\x6b\x65\x79"]); goto ZVQB3; g92gt: goto rokZE; goto aMb91; nCDX9: goto zbQ27; goto tDziO; t5cGB: load()->model("\141\164\164\141\143\150\155\145\156\164"); goto Iqa90; lVx7n: $ftp_config = array("\150\x6f\x73\x74\156\141\x6d\x65" => $_W["\163\x65\x74\164\x69\x6e\147"]["\162\x65\155\x6f\x74\145"]["\146\164\160"]["\x68\157\x73\x74"], "\165\x73\145\x72\x6e\x61\x6d\x65" => $_W["\163\145\164\164\151\156\x67"]["\x72\x65\x6d\x6f\164\x65"]["\146\164\x70"]["\165\x73\x65\x72\156\141\x6d\x65"], "\x70\141\163\x73\167\157\x72\144" => $_W["\163\x65\x74\164\x69\156\x67"]["\162\145\155\157\164\145"]["\x66\x74\160"]["\x70\141\163\163\167\x6f\x72\144"], "\160\157\x72\164" => $_W["\163\145\164\x74\151\x6e\x67"]["\162\145\x6d\x6f\164\145"]["\146\x74\160"]["\x70\x6f\162\164"], "\x73\163\x6c" => $_W["\163\145\164\x74\151\156\x67"]["\162\x65\x6d\x6f\x74\145"]["\146\x74\160"]["\x73\x73\154"], "\x70\x61\163\x73\x69\166\145" => $_W["\163\x65\x74\164\x69\156\147"]["\x72\x65\155\x6f\164\x65"]["\146\164\x70"]["\160\x61\163\166"], "\164\151\155\145\157\165\164" => empty($_W["\163\145\164\164\x69\156\x67"]["\x72\145\x6d\x6f\164\145"]["\146\164\x70"]["\x74\x69\155\145\x6f\x75\x74"]) ? 0 : $_W["\163\x65\x74\x74\151\x6e\x67"]["\162\x65\155\157\x74\x65"]["\146\x74\160"]["\x74\151\x6d\x65\157\165\164"], "\x72\157\x6f\164\144\151\x72" => $_W["\163\x65\164\x74\151\156\147"]["\162\145\155\157\x74\145"]["\146\x74\160"]["\x64\x69\162"]); goto yO0hs; n7OPi: gi30T: goto u1vsU; kxOf_: if (true === $ftp->connect()) { goto BwVSy; } goto MMZzX; uYE0T: $file = $file[0]; goto qKU23; qKU23: gI8I4: goto xMrtJ; jOcNe: zbQ27: goto gx79k; k_a31: $endpoint = "\x68\164\164\x70\x3a\x2f\57" . $buckets[$_W["\163\x65\x74\x74\x69\x6e\147"]["\x72\x65\x6d\x6f\x74\x65"]["\141\x6c\151\157\163\x73"]["\142\165\x63\x6b\x65\164"]]["\x6c\x6f\143\x61\164\151\x6f\156"] . "\56\x61\154\x69\x79\165\x6e\x63\163\56\143\157\x6d"; goto mBj9l; IDXUe: goto AZO3Z; goto OkLv6; QQ5fN: if ($type == 4) { goto IPDjZ; } goto IDXUe; bUsjX: exit(json_encode($error, true)); goto jOcNe; Pc99m: $_W["\x73\x65\164\164\x69\x6e\x67"]["\162\x65\x6d\x6f\x74\x65"]["\141\x6c\151\157\163\x73"]["\x62\165\x63\153\145\x74"] = $bucket[0]; goto NWVfe; vBeK8: if ($type == 2) { goto OSkeX; } goto pUTlX; LsJ3w: $result = \Qcloud_cos\Cosapi::delFile($bucketName, $path); goto g92gt; JF4vN: exit(json_encode($result, true)); goto h7bfx; yo9oM: PuAil: goto bUsjX; NWVfe: $buckets = attachment_alioss_buctkets($_W["\163\x65\164\x74\151\156\x67"]["\162\145\x6d\157\164\x65"]["\x61\x6c\x69\157\x73\163"]["\153\145\x79"], $_W["\163\145\x74\164\x69\156\147"]["\162\x65\x6d\157\164\145"]["\x61\154\x69\157\x73\x73"]["\163\145\x63\x72\x65\x74"]); goto k_a31; UZaAU: $type = request()->param("\164\171\x70\145", 0); goto Ax8fQ; z4e8X: if (count($file) == 1) { goto WeXA0; } goto Tr1za; nkUUl: return true; goto kQ6ZJ; y9jGR: $result = \qcloudcos\Cosapi::delFile($bucketName, $path); goto GLMF7; u1vsU: load()->library("\x71\151\x6e\x69\165"); goto m1GwW; SY6FP: \qcloudcos\Cosapi::setRegion($_W["\163\x65\164\x74\151\156\x67"]["\162\145\x6d\x6f\x74\x65"]["\x63\x6f\163"]["\x6c\x6f\x63\x61\x6c"]); goto y9jGR; JOWdM: OSkeX: goto t5cGB; FPthT: $file = request()->param("\x66\151\154\x65", ''); goto UZaAU; OvJnF: exit("\345\210\240\351\231\244\146\164\x70\351\231\x84\xe4\273\xb6\345\244\261\350\xb4\245\xef\xbc\214\350\257\267\xe6\243\200\346\237\245\xe9\x85\x8d\347\275\xae\xe5\271\xb6\xe9\207\x8d\xe6\226\xb0\345\210\xa0\xe9\231\244"); goto D20Yo; LPk6h: $file = explode("\57\160\x75\142\154\x69\x63\57\x75\160\154\x6f\x61\144\57", $file); goto z4e8X; ZVQB3: $bucketMgr = new \Qiniu\Storage\BucketManager($auth); goto SjBo1; pIUkt: if ($error instanceof Qiniu\Http\Error) { goto r2ef0; } goto ZDRiw; fW4N1: lnZfM: goto ZuBLY; D20Yo: goto w1mhY; goto m8Vc9; Ax8fQ: global $_W; goto ur9R3; ncjUX: load()->library("\x63\x6f\x73\166\63"); goto LsJ3w; a3txP: BwVSy: goto FMa1l; mBj9l: try { goto RxiiX; VA1l0: exit(json_encode($res, true)); goto cmB2V; RxiiX: $ossClient = new \OSS\OssClient($_W["\x73\145\164\164\151\156\x67"]["\162\x65\x6d\157\x74\x65"]["\141\x6c\151\x6f\x73\x73"]["\x6b\145\x79"], $_W["\x73\145\x74\x74\x69\x6e\147"]["\162\145\155\x6f\x74\x65"]["\141\154\151\157\x73\163"]["\163\145\143\x72\145\x74"], $endpoint); goto mLfXl; mLfXl: $res = $ossClient->deleteObject($_W["\x73\145\x74\164\x69\x6e\147"]["\x72\145\155\x6f\x74\145"]["\141\x6c\x69\x6f\163\x73"]["\x62\x75\143\153\145\164"], $file); goto VA1l0; cmB2V: } catch (\OSS\Core\OssException $e) { goto PMUCF; o1Hvy: $res["\x6d\163\x67"] = $e->getMessage(); goto gs0Jb; YG5fe: $res["\x65\162\162\x5f\x6d\x73\x67"] = $e->getErrorMessage(); goto o1Hvy; E2tth: exit(json_encode($res, true)); goto CNGDK; gs0Jb: $res["\143\157\x64\145"] = $e->getCode(); goto E2tth; PMUCF: $res["\145\162\162\137\143\157\144\145"] = $e->getErrorCode(); goto YG5fe; CNGDK: } goto YL70M; WpWmN: exit(json_encode($error, true)); goto yo9oM; u1BeU: $bucketName = $_W["\163\145\x74\164\151\156\x67"]["\162\145\x6d\157\x74\x65"]["\143\157\x73"]["\x62\165\x63\153\x65\x74"]; goto xsmgn; WvNPz: if (!($error->code() == 612)) { goto PuAil; } goto WpWmN; PD35d: goto hJE7d; goto a3txP; MMZzX: exit("\146\164\160\350\xbf\x9e\xe6\216\xa5\xe5\244\261\xe8\xb4\xa5\xef\xbc\214\350\257\xb7\346\243\200\346\237\xa5\351\x85\x8d\347\xbd\xae\xe5\271\xb6\351\x87\215\346\x96\xb0\xe5\x88\240\xe9\x99\xa4"); goto PD35d; FMa1l: if ($ftp->delete_file($file)) { goto lzMxi; } goto OvJnF; Eurz0: goto gI8I4; goto SqH_t; CxQRr: if (!empty($_W["\x73\145\164\164\151\x6e\x67"]["\x72\x65\x6d\157\x74\145"]["\143\x6f\x73"]["\154\x6f\143\x61\154"])) { goto zRdya; } goto ncjUX; f3r23: goto HB8t2; goto c1YUN; SjBo1: $error = $bucketMgr->delete($_W["\163\145\164\x74\x69\156\x67"]["\162\x65\155\157\164\145"]["\161\151\156\151\x75"]["\x62\165\143\x6b\145\x74"], $file); goto pIUkt; CEciS: $i = 0; goto lSNwV; ur9R3: if (!(empty($file) || empty($type))) { goto Ykoqy; } goto X3Dq0; h7bfx: HB8t2: goto Ys1sm; gxNCj: hJE7d: goto LB08Z; Tr1za: $str = ''; goto CEciS; LB08Z: goto AZO3Z; goto JOWdM; Zr8ns: load()->library("\146\164\160"); goto lVx7n; aMb91: zRdya: goto b3Hc9; GLMF7: rokZE: goto enr2X; pUTlX: if ($type == 3) { goto gi30T; } goto QQ5fN; xMrtJ: if ($type == 1) { goto skVhe; } goto vBeK8; MFfO4: Ykoqy: goto LPk6h; c1YUN: nwL7c: goto JF4vN; ZuBLY: $file = $str; goto Eurz0; yO0hs: $ftp = new \Ftp($ftp_config); goto kxOf_; X3Dq0: exit; goto MFfO4; SqH_t: WeXA0: goto uYE0T; m8Vc9: lzMxi: goto ac1fr; YL70M: goto AZO3Z; goto n7OPi; kQ6ZJ: } } function app_random($length = 16) { goto TpkB1; NoVBq: $i = 0; goto TFkh9; nGS1D: if (!($i < $length)) { goto DQjAk; } goto I1mtA; qFoh4: $password = ''; goto NoVBq; TpkB1: $chars = "\141\x62\143\x64\145\146\x67\x68\x69\152\153\154\x6d\x6e\157\x70\x71\x72\163\x74\x75\166\x77\x78\171\172\101\102\x43\x44\105\x46\107\110\x49\x4a\113\x4c\115\x4e\x4f\120\x51\122\123\x54\x55\x56\x57\130\x59\132\x30\61\x32\x33\x34\65\x36\67\70\x39"; goto qFoh4; TXVMU: DQjAk: goto Z7nAA; I1mtA: $password .= $chars[mt_rand(0, strlen($chars) - 1)]; goto TAViL; TAViL: ivJBa: goto p9XyN; p9XyN: $i++; goto ciIRH; TFkh9: PTpdG: goto nGS1D; Z7nAA: return $password; goto aIIE7; ciIRH: goto PTpdG; goto TXVMU; aIIE7: }
