<?php
 namespace app\api\controller; require_once BASE_ROOT . "\x63\157\x72\x65\x2f\x61\160\160\x6c\x69\143\141\164\151\157\x6e\x2f\141\160\x69\57\143\157\x6e\x74\x72\157\x6c\154\145\162\57\x42\141\x73\x65\x43\157\x6e\164\162\157\x6c\154\x65\162\x2e\x70\150\160"; use think\Request; use think\Db; use think\Session; use think\Cache; class Wxpush extends BaseController { protected $config = array("\165\162\154" => "\x68\164\x74\160\x73\x3a\x2f\x2f\x61\x70\151\56\167\145\151\170\x69\156\56\x71\x71\x2e\x63\x6f\155\x2f\x73\x6e\x73\x2f\x6a\163\x63\157\x64\x65\62\163\x65\x73\x73\151\x6f\156", "\141\x70\x70\x69\x64" => '', "\163\145\143\x72\x65\x74" => '', "\147\x72\x61\156\164\137\x74\171\x70\145" => "\141\x75\x74\x68\x6f\162\x69\172\x61\x74\x69\157\x6e\x5f\x63\157\x64\145"); protected $mch_id = ''; function __construct() { goto GMJ8a; KXTgI: bhQrJ: goto QQ_pz; F30Zv: goto bhQrJ; goto Bu7o3; hJq4Z: $this->config["\x61\160\x70\x69\144"] = $param["\101\120\x50\x5f\x49\x44"]; goto JmfdE; yt7Z2: $this->mch_id = $mch_id; goto KXTgI; JmfdE: $this->config["\x73\145\x63\x72\x65\x74"] = $param["\101\x50\120\137\123\105\103\x52\105\x54"]; goto yt7Z2; BdsDu: $param = Db::name("\171\x62\163\x63\137\x63\x6f\156\146\151\147")->where("\153\x65\171", "\x57\x58\120\x41\x59")->where("\155\143\x68\x5f\x69\x64", $mch_id)->value("\x76\x61\154\165\x65"); goto l7cxB; Bu7o3: UdF_o: goto BdsDu; vPtYp: die; goto F30Zv; g2tEi: $mch_id = $this->getMchId($app_id); goto Ygl8A; DzfUH: $app_id = Request::instance()->param("\x69"); goto g2tEi; Ygl8A: if ($mch_id) { goto UdF_o; } goto vPtYp; l7cxB: $param = json_decode($param, true); goto hJq4Z; GMJ8a: parent::__construct(); goto DzfUH; QQ_pz: } public function CreateOrderPush() { goto FBPSd; zUsjN: $temp = json_decode($temp, true); goto oxWtA; lfAPB: b1uvy: goto l23ou; l3xFq: return json_encode($rs); goto Gr2xF; B6iFy: return json_encode($rs); goto hTZdH; puD7B: foreach ($order_goods as $k => $v) { goto k6UX1; gtwUV: $good_name = $good_name . "\x2c" . $v["\147\157\x6f\x64\x73\137\x6e\141\155\145"]; goto eOn1w; e_41f: a11Ws: goto DQYPG; vjPz3: $good_name = $good_name . $v["\147\157\x6f\144\163\137\x6e\141\155\145"]; goto s3bFk; s3bFk: p6YjP: goto e_41f; eOn1w: goto p6YjP; goto gTP7B; k6UX1: if ($k == 0) { goto rnzfd; } goto gtwUV; gTP7B: rnzfd: goto vjPz3; DQYPG: } goto qK3yB; ql0rk: FC4sw: goto zUsjN; bLVTi: $new_data["\x74\145\x6d\160\x6c\x61\164\x65\x5f\x69\x64"] = $template_id; goto CgTx9; xAS0O: OjRdf: goto TuKZC; NCMi_: BPkK0: goto xAS0O; lwe2t: return $result; goto bfEhd; l23ou: $template_id = $temp["\101\124\60\62\61\60"]; goto NCMi_; JnGdP: if ($temp) { goto FC4sw; } goto aXS2T; MntIR: if (empty($result)) { goto JOmGt; } goto x1WyD; W_Knh: return json_encode($rs); goto Y4K_C; mZ1IA: $rs["\143\157\x64\x65"] = 1; goto niC_N; JlNMd: $new_data["\x6f\160\x65\156\151\144"] = $user["\167\x78\x5f\157\x70\x65\x6e\x69\x64"]; goto V1eM2; tB3wY: $result = $this->push($new_data, $data_arr); goto lwe2t; x08QU: BgiTW: goto RhEER; MTfQo: $mch_id = $this->getMchId($app_id); goto mzm8m; CNvZi: $data = ["\x6d\143\150\x5f\151\144" => $mch_id, "\146\157\x72\x6d\x69\144" => Request::instance()->param("\x66\x6f\162\155\x69\x64"), "\165\151\x64" => Request::instance()->param("\x75\x69\x64"), "\x6f\x72\x64\145\x72\x5f\151\144" => Request::instance()->param("\157\x72\x64\145\x72\x5f\151\x64")]; goto pQD5Q; x1WyD: $rs["\143\x6f\144\x65"] = 1; goto JCR01; Gr2xF: goto OjRdf; goto ql0rk; FBPSd: $app_id = Request::instance()->param("\x69"); goto MTfQo; bAU9y: $order_goods = Db::name("\171\x62\x73\143\137\157\x72\x64\145\x72\137\147\157\x6f\144\163")->where(["\157\x72\144\145\x72\137\x69\144" => $data["\157\x72\x64\x65\x72\x5f\151\x64"]])->select(); goto PTqIf; PTqIf: if (!(empty($order) || empty($user) || empty($order_goods))) { goto BgiTW; } goto XnqVs; ElNST: $rs["\155\x73\x67"] = "\x66\141\151\154\x5f\164\x65\x6d\x70\x6c\x61\x74\145\137\151\x64"; goto dVlcf; JCR01: $rs["\155\x73\147"] = $result; goto B6iFy; RgmDv: $order = Db::name("\171\x62\163\x63\x5f\157\x72\x64\145\162")->where(["\155\143\x68\137\151\144" => $data["\x6d\x63\x68\137\x69\x64"], "\x6f\x72\144\x65\x72\137\151\144" => $data["\x6f\162\x64\x65\x72\x5f\151\x64"]])->find(); goto u3mMt; TuKZC: $good_name = ''; goto puD7B; CgTx9: $new_data["\160\x61\147\145"] = "\171\142\x5f\x73\150\157\x70\x2f\160\141\x67\145\163\57\151\x6e\x64\145\170\57\151\x6e\x64\145\170"; goto JlNMd; Y4K_C: goto BPkK0; goto lfAPB; pQD5Q: $result = $this->checkParam($rule, $data); goto MntIR; dVlcf: return json_encode($rs); goto x08QU; aXS2T: $rs["\x63\x6f\144\x65"] = 1; goto kqJI_; RhEER: $temp = Db::name("\171\x62\x73\x63\137\164\155\x70\x6c\137\x64\157\160\x65")->where("\155\143\150\x5f\151\144", $data["\x6d\x63\150\x5f\x69\x64"])->value("\164\145\155\x70"); goto JnGdP; XnqVs: $rs["\143\157\144\145"] = 1; goto ElNST; oxWtA: if ($temp["\101\x54\60\x32\61\60"]) { goto b1uvy; } goto mZ1IA; mzm8m: $rule = [["\x66\x6f\162\x6d\x69\144", "\x72\145\161\165\151\x72\x65"], ["\155\143\150\x5f\151\x64", "\162\x65\x71\x75\151\x72\145", "\xe4\270\x8d\345\255\230\xe5\234\xa8\xe5\x95\x86\346\210\267"], ["\165\151\144", "\162\145\x71\x75\x69\162\145"], ["\x6f\162\144\145\162\137\151\144", "\162\145\161\165\151\x72\x65"]]; goto CNvZi; qK3yB: R7PO5: goto GKrl9; hTZdH: JOmGt: goto RgmDv; GKrl9: $data_arr = array("\x6b\x65\x79\x77\x6f\x72\144\x31" => array("\x76\141\154\165\x65" => $order["\157\x72\x64\x65\x72\137\x6e\x6f"], "\143\x6f\x6c\157\x72" => "\43\64\x33\x34\63\64\63"), "\153\145\171\x77\157\x72\144\62" => array("\166\141\154\165\145" => $order["\x70\x61\x79\137\x6d\157\x6e\145\x79"], "\x63\x6f\x6c\157\x72" => "\x23\x39\x34\x39\64\x39\x34"), "\153\145\x79\x77\157\x72\144\x33" => array("\166\141\x6c\165\x65" => $good_name, "\143\157\154\157\162" => "\43\71\64\x39\x34\x39\x34"), "\x6b\x65\x79\167\x6f\x72\x64\64" => array("\x76\141\x6c\x75\x65" => $order["\142\165\171\x65\x72\x5f\155\145\x73\x73\x61\x67\x65"] ? $order["\142\x75\171\145\x72\x5f\x6d\145\x73\x73\141\x67\x65"] : "\346\227\xa0", "\x63\157\x6c\x6f\x72" => "\x23\x39\x34\71\x34\71\x34")); goto bLVTi; V1eM2: $new_data["\146\157\x72\155\x69\144"] = $data["\146\157\x72\155\151\144"]; goto tB3wY; kqJI_: $rs["\155\x73\x67"] = "\x66\141\151\x6c\137\x74\145\x6d\160\x6c\x61\x74\x65\137\151\144"; goto l3xFq; u3mMt: $user = Db::name("\x79\142\x73\143\x5f\x75\163\145\162")->where("\x75\151\x64", $data["\x75\151\x64"])->find(); goto bAU9y; niC_N: $rs["\155\x73\147"] = "\146\x61\x69\154\137\164\x65\155\160\x6c\141\164\145\137\151\144"; goto W_Knh; bfEhd: } public function PayOrderPush() { goto bQgQp; fYKo1: $user = Db::name("\171\x62\x73\143\x5f\165\x73\145\162")->where("\x75\x69\x64", $order["\x62\165\171\x65\x72\x5f\x69\144"])->find(); goto spDam; bQgQp: $app_id = Request::instance()->param("\x69"); goto gwIrZ; RUugD: return $result; goto tc5H9; xDc2w: $result = $this->push($new_data, $data_arr); goto RUugD; mYEzj: $data = ["\x6d\143\x68\x5f\151\144" => $mch_id, "\146\x6f\162\x6d\151\x64" => Request::instance()->param("\x66\x6f\162\155\x69\144"), "\x75\151\144" => Request::instance()->param("\165\x69\x64"), "\157\x75\164\137\x74\x72\x61\144\145\x5f\156\x6f" => Request::instance()->param("\157\x75\164\x5f\x74\x72\141\x64\x65\x5f\156\x6f")]; goto kO38_; HFhuc: if ($temp["\x41\x54\x30\x30\x34\70"]) { goto Wv2MQ; } goto ajLPg; sCA56: $rs["\143\157\x64\145"] = 1; goto cZoVU; KBwiF: foreach ($order_goods as $k => $v) { goto O6VMk; Uy6Mu: OFBQG: goto zEKHV; koes3: goto xirHg; goto Uy6Mu; zEKHV: $good_name = $good_name . $v["\x67\157\157\x64\163\137\x6e\x61\155\x65"]; goto zCwyC; zCwyC: xirHg: goto Uo8PU; D3h26: $good_name = $good_name . "\54" . $v["\147\157\x6f\144\163\137\156\x61\155\145"]; goto koes3; Uo8PU: mdPMl: goto HM2mm; O6VMk: if ($k == 0) { goto OFBQG; } goto D3h26; HM2mm: } goto n3KX7; BXGYH: $new_data["\x66\157\162\155\x69\x64"] = $data["\146\157\162\155\x69\144"]; goto xDc2w; gxdYQ: Ht7qr: goto jW8Z6; MGpzS: $rs["\x63\157\x64\x65"] = 1; goto dzVck; WEAbw: $rs["\155\x73\x67"] = "\146\x61\x69\154\137\x65\x6d\x70\x74\x79"; goto yfRKP; WKUZq: $new_data["\160\141\147\145"] = "\x79\142\x5f\x73\x68\x6f\160\x2f\160\x61\x67\145\x73\57\x69\156\x64\145\x78\x2f\x69\156\x64\145\170"; goto we_g9; yfRKP: return json_encode($rs); goto JhRGy; spDam: $order_goods = Db::name("\171\x62\x73\143\137\x6f\162\x64\145\162\137\x67\x6f\157\x64\x73")->where(["\x6f\162\144\x65\162\x5f\151\144" => $order["\x6f\162\144\145\x72\137\x69\x64"]])->select(); goto fbUdO; JhRGy: k_Zpz: goto Rk12S; gwIrZ: $mch_id = $this->getMchId($app_id); goto xLAT8; we_g9: $new_data["\157\160\x65\156\151\144"] = $user["\167\x78\x5f\x6f\160\x65\156\151\x64"]; goto BXGYH; jW8Z6: QIfXZ: goto p5vEG; qP9we: goto Ht7qr; goto qDEEn; aPmZZ: $rs["\143\x6f\x64\x65"] = 1; goto WEAbw; UzCUm: $order = Db::name("\171\x62\163\143\x5f\157\162\144\x65\162")->where(["\x6d\x63\x68\137\151\x64" => $data["\x6d\x63\150\x5f\x69\144"], "\x6f\165\x74\x5f\164\x72\141\x64\x65\137\156\157" => $data["\157\165\x74\137\164\162\141\x64\x65\137\156\x6f"]])->find(); goto fYKo1; p5vEG: $good_name = ''; goto KBwiF; mqx7f: $temp = json_decode($temp, true); goto HFhuc; cZoVU: $rs["\155\x73\147"] = $result; goto V6R1n; WeN6D: $template_id = $temp["\101\x54\60\x30\64\x38"]; goto gxdYQ; xLAT8: $rule = [["\146\x6f\162\x6d\x69\x64", "\162\145\x71\x75\151\162\x65"], ["\155\143\150\x5f\x69\144", "\x72\x65\x71\x75\x69\x72\x65", "\344\270\x8d\xe5\xad\230\xe5\x9c\xa8\345\225\206\346\x88\xb7"], ["\165\x69\144", "\162\145\161\x75\x69\x72\145"], ["\x6f\x75\164\x5f\x74\x72\141\x64\x65\137\x6e\x6f", "\x72\145\x71\x75\151\x72\x65"]]; goto mYEzj; n3KX7: bGcoK: goto WzLge; dzVck: $rs["\155\163\x67"] = "\x66\x61\151\x6c\x5f\x74\x65\x6d\160\154\x61\x74\145\x5f\x69\x64"; goto RvH7f; v8IhA: $jifen_add = $integral["\x69\x6e\164\x65\147\x72\141\x6c"] ? $integral["\151\156\164\x65\x67\162\x61\x6c"] : 0; goto ajqry; p7Gni: $rs["\x6d\163\x67"] = "\x66\141\151\x6c\137\x74\145\x6d\160\154\x61\x74\x65\x5f\x69\x64"; goto trdre; V6R1n: return json_encode($rs); goto iLvhR; YB601: $new_data["\x74\x65\x6d\160\154\141\164\x65\x5f\x69\144"] = $template_id; goto WKUZq; kO38_: $result = $this->checkParam($rule, $data); goto j6tD0; Rk12S: $temp = Db::name("\x79\142\x73\143\137\164\155\160\154\137\144\157\x70\x65")->where("\155\x63\150\x5f\151\x64", $data["\x6d\143\x68\137\151\x64"])->value("\164\x65\x6d\160"); goto Y6CQR; ajLPg: $rs["\143\157\x64\145"] = 1; goto p7Gni; JrF5m: lUwGz: goto mqx7f; ajqry: if (!(empty($order) || empty($user) || empty($order_goods))) { goto k_Zpz; } goto aPmZZ; iLvhR: TndLC: goto UzCUm; WzLge: $data_arr = array("\153\145\171\x77\157\x72\x64\x31" => array("\x76\141\154\165\145" => $order["\157\162\x64\x65\x72\137\x6e\x6f"], "\x63\x6f\154\157\162" => "\43\64\63\x34\x33\64\63"), "\153\145\x79\x77\x6f\162\x64\62" => array("\166\141\x6c\x75\x65" => $user["\156\151\x63\x6b\137\156\141\x6d\x65"], "\143\x6f\x6c\x6f\162" => "\43\x39\64\71\64\x39\x34"), "\153\145\171\167\x6f\162\144\63" => array("\x76\141\154\165\x65" => $good_name, "\x63\x6f\154\x6f\x72" => "\43\71\64\71\x34\71\x34"), "\x6b\145\x79\167\x6f\162\x64\64" => array("\166\x61\x6c\165\145" => $order["\x70\141\x79\137\155\157\156\x65\x79"], "\143\x6f\x6c\x6f\x72" => "\x23\71\x34\71\64\71\64"), "\x6b\145\x79\167\x6f\162\144\65" => array("\x76\x61\154\165\145" => $order["\157\x72\x64\145\x72\x5f\x6d\157\x6e\145\171"], "\x63\157\154\x6f\162" => "\43\x39\64\x39\x34\x39\64"), "\153\145\x79\x77\157\x72\x64\66" => array("\x76\x61\154\165\145" => $jifen_add, "\x63\157\154\157\162" => "\43\71\x34\x39\64\71\64"), "\x6b\x65\x79\167\x6f\162\x64\67" => array("\x76\x61\x6c\165\x65" => $user["\x69\x6e\x74\x65\x67\x72\x61\x6c"], "\143\157\x6c\x6f\x72" => "\43\x39\64\71\64\71\64"), "\x6b\145\x79\x77\157\162\x64\70" => array("\x76\141\x6c\165\x65" => date("\131\x2d\155\x2d\x64\x20\x48\x3a\151\x3a\x73", $order["\160\x61\x79\137\x74\151\x6d\145"]), "\x63\157\x6c\157\x72" => "\43\71\64\x39\64\71\64"), "\x6b\x65\x79\x77\x6f\162\144\x39" => array("\x76\141\x6c\x75\145" => $order["\x62\165\171\x65\162\x5f\155\x65\163\163\x61\x67\145"] ? $order["\142\165\x79\145\162\x5f\x6d\x65\163\163\x61\x67\x65"] : "\xe6\x97\xa0", "\143\x6f\x6c\x6f\162" => "\43\71\x34\71\x34\71\64")); goto YB601; trdre: return json_encode($rs); goto qP9we; qDEEn: Wv2MQ: goto WeN6D; fbUdO: $integral = Db::name("\171\142\163\143\x5f\x69\156\164\x65\147\162\141\x6c\137\144\x65\164\141\x69\x6c")->where(["\155\x63\x68\137\151\144" => $data["\x6d\143\x68\x5f\x69\x64"], "\x6f\162\x64\145\x72\x5f\x69\x64" => $order["\x6f\162\144\145\162\x5f\x69\144"]])->find(); goto v8IhA; j6tD0: if (empty($result)) { goto TndLC; } goto sCA56; ANIgt: goto QIfXZ; goto JrF5m; RvH7f: return json_encode($rs); goto ANIgt; Y6CQR: if ($temp) { goto lUwGz; } goto MGpzS; tc5H9: } public function UniformPushMsg() { goto CnBK4; bS9Px: $order_type = Request::instance()->param("\157\x72\x64\x65\x72\137\x74\x79\160\x65", 1); goto vujJK; Xx7NS: if ($send_type == 2) { goto s_u2E; } goto sZgab; WT92p: if ($order_type == 6) { goto rj3TG; } goto oYWeZ; SfAH6: $order = Db::name("\171\x62\x73\143\137\x62\141\x72\x67\x61\x69\156\x5f\157\x72\x64\x65\162")->where("\x6f\x75\164\x5f\164\x72\141\144\145\x5f\156\x6f", $data["\x6f\x72\x64\145\x72\137\x6e\x6f"])->find(); goto UpMre; zV_gk: fG3g3: goto AYhHE; mIzEA: goto QhLvO; goto v63zR; ELWyW: Y5zfK: goto b3eBP; izbW0: goto QhLvO; goto T5cfU; cYVsB: $order = Db::name("\x79\142\x73\x63\x5f\157\x72\x64\x65\x72")->where(["\x6f\x75\164\x5f\x74\x72\x61\x64\x65\137\x6e\x6f" => $data["\x6f\x72\x64\x65\x72\x5f\x6e\157"]])->find(); goto fQwSP; PTIhY: ywKn_: goto JzK3e; iKI9p: goto WFYLf; goto ck0iT; WmpxU: haZ35: goto c3BaP; b3eBP: $push_data = array("\142\165\x79\145\x72\137\x69\x64" => $order["\142\165\x79\145\x72\x5f\x69\144"], "\157\162\144\145\x72\x5f\x74\171\160\145" => $order_type, "\163\x65\156\x64\x5f\x74\171\x70\145" => $send_type, "\x6f\162\x64\145\x72\x5f\x6e\x6f" => $order["\x6f\x72\144\145\162\x5f\156\x6f"], "\x6f\x72\144\x65\x72\x5f\147\157\157\144\x73" => $good_name, "\x6f\x72\x64\145\x72\137\x6d\157\x6e\x65\x79" => $order["\x6f\162\x64\145\x72\137\x6d\x6f\156\x65\x79"], "\157\162\144\145\162\x5f\163\x74\x61\x74\165\x73" => $order_status, "\143\162\x65\141\164\x65\x5f\164\151\x6d\x65" => date("\131\55\155\55\144\40\110\72\151\x3a\163", $order["\143\162\x65\x61\164\145\x5f\164\x69\x6d\x65"])); goto Y487t; c3BaP: $order_status = "\xe5\276\205\xe5\217\221\350\264\247"; goto iKI9p; sZgab: goto WFYLf; goto WmpxU; TrZDV: return $result; goto MWBYw; j1dss: $push_data = array("\142\165\171\145\162\x5f\x69\144" => $order["\165\x73\145\162\137\x69\x64"], "\157\162\144\145\162\x5f\164\x79\160\145" => $order_type, "\x73\x65\156\144\137\164\171\160\145" => $send_type, "\143\162\145\141\164\x65\x5f\x74\151\x6d\x65" => date("\x59\x2d\155\x2d\x64\x20\x48\72\x69\72\163", $order["\x63\162\145\141\x74\145\x5f\164\151\x6d\x65"])); goto jaHyu; XwrsC: goto J3668; goto HzGw8; wx1pD: $result = $this->UniformPush($push_data, $mch_id); goto U1WeZ; PoqxC: qqNRt: goto K4QQZ; x2yYv: $push_data = array("\142\165\171\145\162\137\x69\x64" => $order["\142\165\x79\x65\x72\137\x69\144"], "\157\162\144\145\x72\x5f\x74\x79\x70\x65" => $order_type, "\x73\145\x6e\x64\x5f\164\171\160\x65" => $send_type, "\x6f\x72\x64\145\162\x5f\x6e\x6f" => $order["\157\x72\144\145\162\137\x6e\x6f"], "\x6f\162\x64\x65\162\137\x67\x6f\157\x64\x73" => $order["\142\141\x72\x67\x61\x69\x6e\x5f\156\141\x6d\145"], "\x6f\x72\x64\x65\162\137\155\157\x6e\145\171" => $order["\157\162\x64\145\x72\137\155\157\x6e\x65\x79"], "\x6f\162\x64\x65\x72\x5f\x73\164\141\164\x75\x73" => $order_status, "\x63\x72\x65\x61\x74\145\x5f\x74\x69\x6d\145" => date("\131\x2d\x6d\x2d\144\x20\x48\x3a\x69\72\x73", $order["\143\162\145\x61\164\145\x5f\164\x69\155\x65"])); goto UcG2G; Y487t: $result = $this->UniformPush($push_data, $mch_id); goto KfUAv; pDPvf: return json_encode($rs); goto yCyIV; CUAHj: $result = $this->checkParam($rule, $data); goto DmobS; lfUMC: $order = Db::name("\171\x62\163\143\137\162\x65\163\x65\x72\x76\145\x5f\x70\157\x69\x6e\164")->where("\x75\x73\x65\x72\x5f\151\144", $data["\x75\x69\144"])->where("\151\144", $data["\x6f\x72\144\x65\162\137\x6e\157"])->find(); goto j1dss; ck0iT: s_u2E: goto LZN1E; v63zR: rj3TG: goto lfUMC; B0Z1V: $rule = [["\155\x63\150\137\x69\144", "\x72\x65\x71\165\151\x72\x65", "\xe4\270\215\xe5\255\x98\345\234\xa8\345\225\206\xe6\x88\xb7"], ["\x75\x69\x64", "\162\145\161\165\x69\x72\145"], ["\x6f\162\x64\x65\162\x5f\x6e\157", "\162\x65\x71\165\x69\x72\145"], ["\x6f\x72\x64\145\162\137\x74\x79\x70\145", "\x72\145\x71\x75\151\162\x65"], ["\163\x65\156\144\x5f\x74\x79\160\x65", "\x72\x65\161\x75\151\162\x65"]]; goto jcmmz; bpxC8: $order = Db::name("\x79\x62\x73\x63\137\141\x63\x74\151\x76\151\x74\171\x5f\157\x72\x64\x65\162")->where("\157\x72\144\x65\162\137\151\144", $data["\157\x72\144\x65\162\x5f\156\157"])->find(); goto RNXkp; DmobS: if (empty($result)) { goto q28pc; } goto v171F; AYhHE: $order = $info = Db::name("\171\x62\x73\x63\x5f\x70\x74\137\157\162\x64\x65\x72\163")->where(["\151\x64" => $data["\157\x72\144\x65\162\x5f\x6e\157"]])->find(); goto NcUHr; fMYxN: $order = Db::name("\171\x62\163\143\137\141\x63\x74\151\166\151\164\x79\x5f\x6f\x72\x64\145\x72")->where("\x6f\x75\x74\x5f\x74\162\x61\x64\x65\137\x6e\157", $data["\157\x72\x64\x65\x72\137\156\x6f"])->find(); goto wCW1H; iIaqB: if ($send_type == 2) { goto ywKn_; } goto PWEjy; ysjTF: return $result; goto bhXXH; CbTd8: if ($order_type == 4) { goto l_N6B; } goto jt6jL; CrKaT: if ($order_type == 3) { goto fG3g3; } goto CbTd8; nq29l: WFYLf: goto HmDmL; Cwysp: $good_name = ''; goto AoaNx; xpxkh: RXkXg: goto xaQkU; ig4SU: $mch_id = $this->getMchId($app_id); goto bS9Px; UpMre: $order["\x63\162\145\x61\164\145\x5f\x74\151\155\145"] = time(); goto JvKgT; SZQPo: zTTtT: goto cYVsB; szfjN: l_N6B: goto W0WcE; U1WeZ: return $result; goto xXyz3; HmDmL: $rs["\143\x6f\x64\145"] = 0; goto NJubD; v171F: $rs["\x63\x6f\x64\x65"] = 1; goto dUP3B; UcG2G: $result = $this->UniformPush($push_data, $mch_id); goto TrZDV; LZN1E: $order_status = "\345\xbe\x85\351\x80\x80\xe6\xac\xbe"; goto nq29l; bhXXH: QhLvO: goto o4zzE; NcUHr: $goods = Db::name("\x79\142\163\x63\137\160\164\137\x67\x6f\157\x64\x73")->where(["\x69\144" => $order["\147\151\144"]])->find(); goto q2jKk; m0ols: goto J3668; goto McUMT; rlHh0: return $result; goto mIzEA; oYWeZ: goto QhLvO; goto xpxkh; JvKgT: goto uWzWQ; goto PoqxC; yCyIV: q28pc: goto cffL0; lWy7J: goto QhLvO; goto szfjN; Eacdi: $order = Db::name("\171\142\x73\143\137\x75\x73\145\162\x5f\146\157\x72\155")->where("\x75\x73\x65\x72\137\151\x64", $data["\x75\x69\x64"])->where("\x62\165\163\137\x66\157\162\x6d\x5f\151\x64", $data["\157\x72\x64\x65\162\x5f\x6e\157"])->find(); goto BWFIc; CnBK4: $app_id = Request::instance()->param("\151"); goto ig4SU; PWEjy: goto bHjn_; goto SZQPo; MWBYw: goto QhLvO; goto hlAh3; PQrhe: $result = $this->UniformPush($push_data, $mch_id); goto GFVFF; McUMT: J7NVG: goto fMYxN; JzK3e: $order = Db::name("\171\x62\163\x63\137\157\162\x64\x65\x72")->where(["\157\162\144\145\x72\x5f\151\144" => $data["\157\162\x64\145\x72\x5f\156\x6f"]])->find(); goto aTyD5; KfUAv: return $result; goto izbW0; T5cfU: CQcS7: goto Daybt; fQwSP: $order["\x63\162\145\141\x74\145\x5f\x74\x69\x6d\x65"] = time(); goto Q54zL; jaHyu: $result = $this->UniformPush($push_data, $mch_id); goto ysjTF; xaQkU: if ($send_type == 1) { goto zTTtT; } goto iIaqB; K4QQZ: $order = Db::name("\171\142\163\x63\137\x62\x61\162\x67\141\151\x6e\137\157\162\x64\145\162")->where("\x6f\162\x64\145\x72\x5f\151\144", $data["\157\162\144\x65\x72\137\156\x6f"])->find(); goto bwgCy; WRIPp: $order_goods = Db::name("\171\142\x73\143\x5f\157\x72\x64\145\x72\137\147\x6f\157\x64\163")->where(["\x6f\162\144\x65\162\137\151\144" => $order["\x6f\162\x64\145\x72\x5f\x69\144"]])->select(); goto Cwysp; W0WcE: if ($send_type == 1) { goto tn1ET; } goto lfEdW; rQHEV: $result = $this->UniformPush($push_data, $mch_id); goto rlHh0; cffL0: if ($send_type == 1) { goto haZ35; } goto Xx7NS; T4c7K: if ($order_type == 2) { goto CQcS7; } goto CrKaT; GFVFF: return $result; goto lWy7J; Daybt: if ($send_type == 1) { goto J7NVG; } goto z6kZq; Q54zL: goto bHjn_; goto PTIhY; bwgCy: uWzWQ: goto x2yYv; BWFIc: $push_data = array("\142\x75\x79\x65\x72\137\151\x64" => $order["\x75\163\145\x72\x5f\151\144"], "\157\162\x64\x65\162\x5f\x74\171\x70\145" => $order_type, "\x73\145\156\144\x5f\x74\171\160\145" => $send_type, "\x63\x72\x65\141\164\x65\x5f\x74\x69\155\x65" => date("\x59\x2d\x6d\55\x64\x20\110\72\151\72\x73", $order["\143\x72\145\x61\x74\x65\137\x74\x69\155\145"])); goto rQHEV; dUP3B: $rs["\x6d\x73\x67"] = $result; goto pDPvf; aTyD5: bHjn_: goto WRIPp; lfEdW: if ($send_type == 2) { goto qqNRt; } goto HMBTQ; hlAh3: zkj0S: goto Eacdi; q2jKk: $push_data = array("\142\x75\x79\145\x72\137\x69\144" => $order["\x62\165\x79\145\x72\137\151\144"], "\157\x72\144\145\162\137\x74\171\160\145" => $order_type, "\x73\x65\x6e\x64\x5f\164\171\x70\x65" => $send_type, "\x6f\162\x64\145\x72\137\156\157" => $order["\157\x72\144\145\x72\116\165\x6d"], "\157\162\144\x65\162\x5f\147\157\x6f\144\x73" => $goods["\x6e\x61\155\x65"], "\157\x72\x64\145\162\x5f\x6d\x6f\156\145\x79" => $order["\x74\157\x74\141\x6c\x50\x72\x69\x63\145"], "\157\162\x64\145\162\137\x73\164\x61\x74\x75\163" => $order_status, "\x63\162\145\141\164\145\137\x74\x69\x6d\x65" => date("\131\55\155\x2d\x64\x20\110\x3a\x69\72\x73", time())); goto PQrhe; HMBTQ: goto uWzWQ; goto EWS36; z6kZq: if ($send_type == 2) { goto DlTuZ; } goto m0ols; RNXkp: J3668: goto qhgZe; qhgZe: $push_data = array("\142\165\171\x65\162\137\x69\144" => $order["\142\165\171\x65\162\137\x69\144"], "\157\x72\144\145\162\x5f\x74\x79\x70\145" => $order_type, "\163\145\x6e\144\137\x74\x79\160\x65" => $send_type, "\157\162\x64\x65\x72\x5f\x6e\x6f" => $order["\x6f\x72\x64\x65\x72\x5f\x6e\x6f"], "\157\x72\x64\145\162\x5f\x67\157\157\x64\x73" => $order["\142\141\162\x67\141\x69\156\137\x6e\141\x6d\x65"], "\x6f\x72\144\145\162\137\155\157\x6e\x65\171" => $order["\x6f\162\x64\x65\x72\137\x6d\157\156\145\x79"], "\157\162\x64\145\162\137\163\164\141\x74\165\163" => $order_status, "\143\x72\x65\141\x74\x65\137\x74\x69\x6d\145" => date("\131\55\x6d\55\x64\40\110\72\x69\x3a\x73", $order["\x63\x72\145\x61\x74\145\137\164\151\x6d\x65"])); goto wx1pD; xXyz3: goto QhLvO; goto zV_gk; HzGw8: DlTuZ: goto bpxC8; jcmmz: $data = ["\155\x63\x68\137\x69\x64" => $mch_id, "\x75\x69\x64" => Request::instance()->param("\x75\x69\144"), "\157\162\x64\x65\162\137\x6e\157" => Request::instance()->param("\x6f\x72\144\x65\x72\x5f\x6e\x6f"), "\157\162\x64\145\x72\137\164\x79\x70\x65" => $order_type, "\x73\x65\x6e\x64\137\164\x79\x70\x65" => $send_type]; goto CUAHj; AoaNx: foreach ($order_goods as $k => $v) { goto EW1sd; SxD28: pD_T_: goto OFt2c; haKgf: $good_name = $good_name . "\x2c" . $v["\147\157\157\x64\163\x5f\156\141\155\x65"]; goto tERIC; EW1sd: if ($k == 0) { goto TdXsQ; } goto haKgf; JOZdD: TdXsQ: goto Vowtg; Vowtg: $good_name = $good_name . $v["\x67\157\157\x64\x73\x5f\x6e\x61\x6d\145"]; goto SxD28; OFt2c: Kke7i: goto epc38; tERIC: goto pD_T_; goto JOZdD; epc38: } goto ELWyW; wCW1H: $order["\143\x72\145\141\164\x65\137\164\151\x6d\145"] = time(); goto XwrsC; EWS36: tn1ET: goto SfAH6; NJubD: if ($order_type == 1) { goto RXkXg; } goto T4c7K; vujJK: $send_type = Request::instance()->param("\163\145\x6e\144\x5f\x74\x79\x70\x65", 1); goto B0Z1V; jt6jL: if ($order_type == 5) { goto zkj0S; } goto WT92p; o4zzE: } public function DeliveryOrderPush() { goto GidcH; QacKT: $mch_name = $mch_name ? $mch_name : "\345\x95\x86\xe5\xae\xb6\345\220\x8d\347\247\260"; goto hz4v3; GidcH: $order_id = Request::instance()->param("\157\162\144\145\162\137\x69\x64"); goto GgUlG; ZCqCX: $temp = Db::name("\x79\142\x73\x63\x5f\164\x6d\160\154\x5f\x64\157\x70\145")->where("\x6d\143\150\137\x69\144", $this->mch_id)->value("\164\x65\x6d\x70"); goto Vewgh; gnzPD: $area_id = $order["\x72\145\143\145\151\x76\x65\162\x5f\141\x72\145\141"]; goto QqlcT; pE9TM: $new_data["\x66\157\162\155\x69\x64"] = $order["\x70\162\x65\160\141\171\x5f\x69\x64"]; goto zf5z3; S9qLE: $new_data["\x74\x65\155\x70\x6c\x61\164\145\137\x69\x64"] = $template_id; goto dzniY; LsKJ1: $temp = json_decode($temp, true); goto qRnea; nboWG: return $result; goto rU7_h; WtmcL: $rs["\155\x73\x67"] = "\146\141\151\154\x5f\x74\x65\x6d\160\154\141\x74\x65\x5f\x69\144"; goto v5z75; kToSx: goto u6om0; goto Eb9HB; ZWGMz: foreach ($order_goods as $k => $v) { goto Jjrdj; Jjrdj: if ($k == 0) { goto gTeeX; } goto XuePL; ooc1f: goto KHaBY; goto HnZX9; XuePL: $good_name = $good_name . "\x2c" . $v["\147\157\157\x64\163\137\x6e\141\155\145"]; goto ooc1f; FlfCF: w2g8_: goto Kn01Z; HnZX9: gTeeX: goto Ck3Vk; AgO1R: KHaBY: goto FlfCF; Ck3Vk: $good_name = $good_name . $v["\x67\157\x6f\144\163\137\156\x61\x6d\x65"]; goto AgO1R; Kn01Z: } goto leunX; IJixG: uin6c: goto OwijH; ouIwF: $user = Db::name("\171\142\163\143\x5f\165\x73\x65\162")->where("\x75\x69\144", $order["\142\x75\171\145\x72\137\x69\144"])->find(); goto ZCqCX; Eb9HB: weG5a: goto GIqYS; GK4KV: $mch_name = Db::name("\x79\142\x73\x63\x5f\142\165\x73\x69\x6e\145\163\x73\x5f\141\x62\157\x75\164")->where("\x6d\x63\150\x5f\151\x64", $this->mch_id)->value("\156\x61\155\x65"); goto QacKT; Pbo24: $addr = ''; goto gnzPD; v5z75: return json_encode($rs); goto zmGtU; GgUlG: $order = Db::name("\x79\142\163\x63\137\x6f\x72\144\x65\x72")->where(["\155\143\150\x5f\151\144" => $this->mch_id, "\x6f\x72\144\145\162\137\x69\144" => $order_id])->find(); goto ouIwF; S1Uj2: goto XtjmL; goto IJixG; uFUrK: $addr = $area["\x6e\x61\155\145"] . $addr; goto JNd4Z; qRnea: if ($temp["\x41\124\60\60\x30\67"]) { goto weG5a; } goto bSrhq; Hp3uf: $area = Db::name("\x79\x62\x73\x63\137\141\162\145\141")->where("\x69\x64", $area_id)->find(); goto uFUrK; Gq5Ez: return json_encode($rs); goto kToSx; KWfZ5: if (!($area_id != 0)) { goto uin6c; } goto Hp3uf; leunX: egdRb: goto Pbo24; CasMB: $rs["\x63\157\144\x65"] = 1; goto WtmcL; OwijH: $data_arr = array("\x6b\x65\171\167\157\162\144\x31" => array("\x76\141\x6c\x75\x65" => $order["\x6f\162\144\x65\x72\x5f\156\x6f"], "\143\x6f\154\x6f\x72" => "\x23\64\63\64\63\x34\x33"), "\x6b\x65\171\167\x6f\x72\x64\x32" => array("\166\141\154\165\x65" => $mch_name, "\x63\157\154\157\x72" => "\x23\71\x34\x39\x34\x39\64"), "\x6b\x65\x79\167\x6f\x72\144\63" => array("\166\141\154\165\145" => $good_name, "\143\x6f\x6c\x6f\162" => "\x23\x39\x34\71\x34\71\64"), "\153\145\x79\x77\x6f\162\x64\x34" => array("\166\x61\x6c\165\x65" => $order["\157\x72\x64\x65\x72\137\155\x6f\156\145\x79"], "\143\157\x6c\x6f\162" => "\43\71\64\71\64\x39\x34"), "\153\x65\x79\167\157\162\144\65" => array("\166\x61\x6c\x75\x65" => $order["\x72\x65\x63\x65\x69\x76\x65\162\137\x6e\x61\155\x65"], "\x63\x6f\x6c\157\162" => "\x23\71\64\x39\64\x39\x34"), "\x6b\145\x79\x77\x6f\x72\x64\66" => array("\x76\141\x6c\x75\145" => $order["\162\145\x63\145\151\x76\x65\162\137\x6d\x6f\142\151\154\x65"], "\143\x6f\x6c\x6f\162" => "\43\x39\64\71\x34\71\64"), "\153\x65\171\x77\x6f\162\x64\67" => array("\x76\141\x6c\165\x65" => $addr . $order["\x72\x65\x63\x65\151\x76\x65\x72\x5f\141\144\x64\x72\x65\163\163"], "\x63\x6f\x6c\157\x72" => "\x23\71\64\71\x34\71\64")); goto S9qLE; JNd4Z: $area_id = $area["\160\x69\x64"]; goto S1Uj2; D2j1D: $rs["\155\163\x67"] = "\x66\141\x69\x6c\137\x74\145\x6d\x70\x6c\x61\164\145\137\x69\x64"; goto Gq5Ez; QqlcT: XtjmL: goto KWfZ5; B2Jau: $good_name = ''; goto ZWGMz; hOOYn: oAU3D: goto LsKJ1; KRldR: YIBS4: goto GK4KV; zf5z3: $result = $this->push($new_data, $data_arr); goto nboWG; bSrhq: $rs["\143\x6f\x64\x65"] = 1; goto D2j1D; a84N8: u6om0: goto KRldR; a2ASE: $new_data["\157\x70\145\156\x69\x64"] = $user["\167\170\x5f\157\x70\145\x6e\x69\144"]; goto pE9TM; hz4v3: $order_goods = Db::name("\171\142\163\143\x5f\x6f\x72\x64\x65\162\137\147\x6f\157\144\163")->where(["\157\x72\144\145\162\137\x69\144\x20" => $order["\x6f\x72\x64\145\162\137\x69\144"]])->select(); goto B2Jau; Vewgh: if ($temp) { goto oAU3D; } goto CasMB; zmGtU: goto YIBS4; goto hOOYn; dzniY: $new_data["\160\141\x67\145"] = "\171\x62\137\163\150\x6f\160\x2f\160\x61\147\x65\x73\57\151\156\x64\x65\x78\57\151\x6e\x64\145\x78"; goto a2ASE; GIqYS: $template_id = $temp["\x41\124\60\60\x30\67"]; goto a84N8; rU7_h: } public function PtSuccessPush() { goto y2ULo; BZ34j: $good = Db::name("\x79\142\163\x63\137\160\x74\137\147\x6f\157\144\x73")->where(["\151\144" => $order_p["\147\x69\x64"]])->find(); goto rhPf1; wC35P: return json_encode($rs); goto mQ1Ll; x2xce: yzn24: goto PS8vB; LYp_K: return $res; goto tl7U4; mQ1Ll: goto yzn24; goto Cj4zx; rhPf1: $data_arr = array("\x6b\145\x79\x77\x6f\162\144\61" => array("\x76\x61\x6c\165\x65" => $good["\x67\162\157\165\160\x4e\165\155"], "\143\x6f\x6c\x6f\x72" => "\43\64\x33\x34\63\x34\x33"), "\x6b\145\171\x77\157\x72\144\62" => array("\166\141\154\x75\x65" => $order_p["\164\157\164\x61\x6c\120\x72\x69\x63\145"], "\143\x6f\x6c\x6f\162" => "\x23\71\64\x39\x34\71\x34"), "\153\145\171\167\157\162\x64\x33" => array("\166\141\154\x75\x65" => $good["\x6e\x61\x6d\145"], "\x63\157\154\157\x72" => "\43\71\64\71\x34\x39\x34"), "\x6b\145\x79\167\157\x72\x64\x34" => array("\x76\141\x6c\165\145" => date("\131\55\x6d\55\x64\x20\110\72\151\72\163", $order_p["\160\x61\x79\x54\151\155\145"]), "\143\157\154\x6f\x72" => "\43\71\x34\x39\64\x39\x34"), "\x6b\145\x79\167\x6f\162\144\x35" => array("\166\x61\154\165\x65" => date("\x59\55\x6d\x2d\x64\x20\110\72\151\x3a\x73", $order_p["\x67\x72\157\x75\160\124\151\155\x65"]), "\x63\x6f\154\x6f\x72" => "\x23\71\x34\71\64\x39\x34"), "\153\x65\x79\x77\x6f\x72\x64\66" => array("\166\x61\154\165\x65" => "\346\213\xbc\345\x9b\242\xe5\xb7\xb2\xe6\x88\x90\xe5\212\x9f\357\274\214\345\x95\x86\xe5\223\201\345\x8d\xb3\xe5\xb0\206\345\x8f\x91\350\xb4\xa7\357\xbc\201", "\143\157\x6c\157\162" => "\43\71\x34\71\64\x39\x34")); goto y0rtN; Cj4zx: k_x0V: goto ew0Ag; oePAK: foreach ($order as $k => $v) { goto Qngpo; KypMg: gbizW: goto tWydZ; XuL_j: $re = $this->push($new_data, $data_arr); goto UK0g5; UK0g5: $res = $res . $re; goto KypMg; rkQUh: $new_data["\x66\x6f\x72\x6d\151\x64"] = $v["\160\x72\145\x70\141\x79\111\x64"]; goto XuL_j; Qngpo: $new_data["\x6f\160\145\x6e\x69\x64"] = Db::name("\x79\x62\x73\x63\x5f\165\163\x65\x72")->where("\165\151\144", $v["\x75\x69\144"])->value("\167\x78\137\157\160\x65\156\x69\144"); goto rkQUh; tWydZ: } goto mHaMA; Pz50x: R6io7: goto x2xce; mtf8l: $order = Db::name("\x79\142\x73\x63\x5f\x70\x74\137\157\162\x64\x65\162\163")->where(["\155\143\150\137\x69\144" => $this->mch_id, "\x69\x64\174\160\x69\x64" => $pid])->select(); goto KI_dT; PS8vB: $order_p = Db::name("\x79\142\x73\x63\x5f\x70\x74\x5f\157\162\144\145\x72\x73")->where(["\155\x63\x68\137\151\144" => $this->mch_id, "\151\144" => $pid])->find(); goto BZ34j; RUaAG: $rs["\155\163\x67"] = "\x66\141\x69\x6c\x5f\164\145\x6d\160\x6c\x61\164\145\x5f\x69\x64"; goto wC35P; aRim5: $template_id = $temp["\x41\124\x30\x30\65\x31"]; goto Pz50x; ZXai3: $new_data["\160\x61\147\x65"] = "\x79\142\137\163\x68\157\x70\x2f\160\141\147\145\163\x2f\x69\x6e\144\145\x78\57\x69\156\x64\x65\x78"; goto nC7nX; KI_dT: $temp = Db::name("\171\x62\163\143\x5f\x74\155\160\x6c\x5f\144\157\x70\145")->where("\x6d\143\150\137\x69\144", $this->mch_id)->value("\x74\x65\x6d\160"); goto XrocN; y2ULo: $pid = Request::instance()->param("\160\x69\144"); goto mtf8l; TAjY9: $rs["\x6d\x73\x67"] = "\x66\x61\151\x6c\137\164\145\x6d\160\x6c\141\164\x65\137\x69\144"; goto wHO3Z; YDNNj: $rs["\x63\x6f\144\x65"] = 1; goto RUaAG; mHaMA: h3j9X: goto LYp_K; wHO3Z: return json_encode($rs); goto uZsrr; nC7nX: $res = ''; goto oePAK; XrocN: if ($temp && !empty($order)) { goto k_x0V; } goto YDNNj; R1mTT: $rs["\143\157\144\145"] = 1; goto TAjY9; SHFxY: if ($temp["\x41\124\60\x30\x35\x31"]) { goto DSS9F; } goto R1mTT; uZsrr: goto R6io7; goto JLHr_; ew0Ag: $temp = json_decode($temp, true); goto SHFxY; JLHr_: DSS9F: goto aRim5; y0rtN: $new_data["\x74\145\155\160\154\x61\x74\x65\137\151\144"] = $template_id; goto ZXai3; tl7U4: } public function KgSuccessPush() { goto t4XMa; ZTXFB: return json_encode($rs); goto G6bJW; DuUZA: if ($temp["\101\x54\x31\x31\67\x33"]) { goto uMl7A; } goto IjyYa; azbnF: $new_data["\160\141\147\x65"] = "\x79\x62\x5f\x73\150\x6f\x70\57\160\x61\x67\145\x73\x2f\151\x6e\144\x65\170\57\151\156\144\145\x78"; goto cFvQy; l15h0: $new_data["\164\145\x6d\x70\154\141\164\x65\x5f\151\144"] = $template_id; goto azbnF; IUmbk: $rs["\x63\x6f\144\145"] = 1; goto ogQIu; tU_m2: $result = $this->push($new_data, $data_arr); goto KpkOF; N2iJj: if (!(empty($gprice) || empty($gname) || empty($openid) || empty($form_id))) { goto pjsYz; } goto IUmbk; fbvmA: return json_encode($rs); goto JDHjb; G6bJW: goto TdozY; goto CCp6i; xa7eS: $temp = json_decode($temp, true); goto DuUZA; KpkOF: return $result; goto ppQMN; pTccl: goto eWk63; goto M3W_h; NrdNH: if ($temp) { goto B5xPQ; } goto Bf1od; joeoD: $temp = Db::name("\x79\142\x73\143\137\164\x6d\x70\154\137\x64\157\x70\145")->where("\x6d\143\150\x5f\151\144", $this->mch_id)->value("\164\x65\155\x70"); goto NrdNH; M3W_h: uMl7A: goto pz2Xx; FZJcb: return json_encode($rs); goto pTccl; VgdQd: $rs["\155\x73\x67"] = "\x66\x61\x69\154\x5f\x74\x65\x6d\x70\154\x61\164\145\x5f\151\144"; goto ZTXFB; ogQIu: $rs["\155\x73\x67"] = "\xe5\217\x82\346\x95\xb0\xe4\xb8\215\350\203\275\xe4\xb8\272\xe7\251\272"; goto fbvmA; FXH4Q: eWk63: goto svKOa; pz2Xx: $template_id = $temp["\101\x54\x31\61\67\63"]; goto FXH4Q; h_JC8: $rs["\155\163\147"] = "\146\141\151\x6c\137\164\145\155\x70\154\141\x74\145\137\x69\144"; goto FZJcb; Bf1od: $rs["\143\157\x64\x65"] = 1; goto VgdQd; lDOW1: $new_data["\x66\157\162\155\x69\x64"] = $form_id; goto tU_m2; svKOa: TdozY: goto LUMMw; JDHjb: pjsYz: goto joeoD; NvKXP: $gname = Request::instance()->param("\x67\x6e\x61\x6d\145"); goto EGhSf; xyAt9: $data_arr = array("\x6b\145\x79\167\157\162\x64\61" => array("\166\x61\x6c\165\145" => $gname, "\143\157\154\157\x72" => "\x23\64\x33\64\63\64\63"), "\x6b\145\171\x77\157\162\144\62" => array("\x76\141\x6c\x75\145" => $gprice . "\40\345\205\203", "\143\x6f\x6c\157\x72" => "\43\x39\x34\71\x34\x39\64"), "\153\x65\x79\x77\157\162\x64\x33" => array("\x76\x61\154\x75\145" => date("\x59\x2d\x6d\x2d\144\x20\110\x3a\x69", $time), "\x63\x6f\x6c\x6f\162" => "\43\71\x34\71\64\x39\64"), "\153\145\x79\167\x6f\162\x64\64" => array("\x76\x61\x6c\165\x65" => "\346\x82\xa8\xe5\217\xaf\xe4\273\xa5\xe5\x91\212\xe7\x9f\245\xe4\xbd\240\347\x9a\204\345\xa5\275\xe5\x8f\x8b\xe7\xa0\x8d\344\xbb\xb7\346\210\x90\xe5\x8a\237\345\x93\246\xef\xbc\x81", "\x63\157\x6c\x6f\162" => "\43\71\x34\x39\x34\x39\64")); goto l15h0; CCp6i: B5xPQ: goto xa7eS; cFvQy: $new_data["\157\160\x65\x6e\x69\x64"] = $openid; goto lDOW1; UjHoC: $form_id = Request::instance()->param("\x66\157\162\x6d\x5f\151\144"); goto N2iJj; LUMMw: $time = time(); goto xyAt9; IjyYa: $rs["\143\157\x64\145"] = 1; goto h_JC8; EGhSf: $openid = Request::instance()->param("\157\x70\145\x6e\x69\x64"); goto UjHoC; t4XMa: $gprice = Request::instance()->param("\x67\160\162\x69\143\x65"); goto NvKXP; ppQMN: } public function FromSuccessPush() { goto phJTp; EBxPy: if ($temp[$te]) { goto qFy8z; } goto Ny7CH; AyED9: if ($typea == "\x62\x6f\x6f\153") { goto qz3tB; } goto cmIJA; SgAq0: $data_arr = array("\153\145\171\167\157\162\144\x31" => array("\x76\141\154\x75\145" => $user["\x6e\x69\x63\x6b\137\x6e\141\155\145"], "\x63\157\x6c\x6f\162" => "\x23\x34\63\64\x33\64\63"), "\153\145\171\x77\157\x72\x64\62" => array("\x76\141\154\165\x65" => $form["\x74\151\164\154\x65"], "\143\157\154\x6f\162" => "\x23\x39\x34\x39\64\x39\64"), "\153\145\171\x77\x6f\x72\144\63" => array("\166\141\x6c\x75\x65" => "\xe6\202\250\347\232\204\344\xbf\xa1\xe6\201\xaf\xe5\xb7\xb2\xe7\273\217\xe6\217\x90\xe4\xba\xa4\346\210\220\345\x8a\237\357\274\201", "\143\157\154\x6f\x72" => "\x23\71\64\x39\64\x39\64"), "\153\145\171\167\157\x72\144\x34" => array("\166\x61\154\165\x65" => date("\x59\55\x6d\55\x64\x20\110\72\x69", $time), "\x63\x6f\x6c\157\x72" => "\x23\71\x34\71\x34\x39\64")); goto SeE5d; L8wkc: goto kzxqQ; goto Qfc0h; phJTp: $id = Request::instance()->param("\151\144"); goto FuNBv; VbsnY: return json_encode($rs); goto L8wkc; dkiQH: $new_data["\x6f\x70\x65\156\151\144"] = $user["\x77\170\137\157\x70\145\x6e\x69\x64"]; goto e5E9l; kGm3S: $user = Db::name("\x79\142\163\143\137\x75\x73\x65\x72")->where("\165\x69\144", $uid)->find(); goto V8Ym3; SeE5d: $new_data["\x74\x65\155\x70\154\x61\x74\145\137\x69\x64"] = $template_id; goto br1sg; f2KiS: $te = "\x41\x54\x30\62\67\x36"; goto ESXVZ; ToQRK: $temp = json_decode($temp, true); goto EBxPy; br1sg: $new_data["\x70\x61\147\x65"] = "\x79\142\137\163\150\x6f\x70\57\x70\141\x67\x65\x73\x2f\x69\156\x64\x65\x78\57\151\x6e\x64\x65\170"; goto dkiQH; e5E9l: $new_data["\146\157\162\x6d\x69\x64"] = $form_id; goto FiaKQ; qvjp8: kzxqQ: goto NI3SZ; ZmDC1: WwU8T: goto dr4VK; o71WD: $rs["\x63\x6f\144\x65"] = 1; goto pMUb1; Ny7CH: $rs["\x63\x6f\x64\x65"] = 1; goto vPp1m; cmIJA: $form = Db::name("\171\142\163\x63\137\142\x75\x73\137\x66\x6f\162\x6d")->where(["\155\x63\150\137\x69\x64" => $this->mch_id, "\151\144" => $id])->find(); goto f2KiS; ESXVZ: goto f4pwh; goto wo0D7; pMUb1: $rs["\x6d\x73\x67"] = "\146\x61\x69\x6c\137\164\x65\155\x70\154\141\x74\145\x5f\151\x64\62"; goto YHS6G; Nzbo6: $form["\164\151\x74\x6c\145"] = $form["\156\x61\155\145"]; goto ZmDC1; Qfc0h: qFy8z: goto j6Ar4; dr4VK: $te = "\x41\x54\60\x31\x30\x34"; goto Ov_kb; siYSk: $time = time(); goto SgAq0; NI3SZ: tpqGp: goto siYSk; vPp1m: $rs["\155\163\147"] = "\146\x61\x69\154\137\164\145\x6d\x70\x6c\141\164\x65\x5f\x69\x64"; goto VbsnY; hazL0: goto tpqGp; goto ExRQl; FiaKQ: $result = $this->push($new_data, $data_arr); goto zUYMo; Pn6YH: if ($temp && $form && $user) { goto iuz_u; } goto o71WD; FuNBv: $uid = Request::instance()->param("\165\x69\x64"); goto JjKAO; wo0D7: qz3tB: goto eur5e; zUYMo: return $result; goto luVXt; MhiUe: if (!$form["\x6e\141\155\x65"]) { goto WwU8T; } goto Nzbo6; j6Ar4: $template_id = $temp[$te]; goto qvjp8; YHS6G: return json_encode($rs); goto hazL0; eur5e: $form = Db::name("\171\x62\x73\x63\137\x72\145\163\x65\x72\166\x65\x5f\x74\x68\151\156\147")->where(["\155\x63\x68\137\151\144" => $this->mch_id, "\151\x64" => $id])->find(); goto MhiUe; Dp2qj: $typea = Request::instance()->param("\x74\x79\160\x65\x61"); goto AyED9; Ov_kb: f4pwh: goto kGm3S; V8Ym3: $temp = Db::name("\171\142\x73\143\x5f\164\x6d\x70\x6c\x5f\144\x6f\x70\145")->where("\x6d\143\x68\137\151\144", $this->mch_id)->value("\x74\145\x6d\x70"); goto Pn6YH; ExRQl: iuz_u: goto ToQRK; JjKAO: $form_id = Request::instance()->param("\146\157\162\x6d\137\151\x64"); goto Dp2qj; luVXt: } protected function Push($data, $data_arr) { goto wLWuv; BVD5x: $push_url = "\150\164\x74\160\163\x3a\57\57\141\160\151\56\167\x65\x69\x78\151\156\56\x71\161\56\143\x6f\x6d\x2f\143\x67\x69\55\x62\x69\156\x2f\155\x65\x73\163\141\147\x65\57\167\170\x6f\160\145\x6e\x2f\x74\x65\155\x70\154\141\x74\x65\x2f\x73\x65\156\144\x3f\x61\143\143\x65\163\x73\x5f\164\x6f\153\145\156\x3d" . $access_token["\x61\x63\x63\x65\163\163\x5f\164\157\x6b\145\x6e"]; goto bNeGB; c862g: $appsecret = $this->config["\x73\145\x63\x72\x65\164"]; goto lnKYo; wLWuv: $params = array("\x74\x6f\165\163\145\x72" => $data["\157\x70\x65\x6e\151\144"], "\x74\x65\x6d\x70\154\x61\x74\145\137\x69\144" => $data["\x74\x65\x6d\x70\154\x61\x74\x65\137\x69\x64"], "\x70\x61\147\145" => $data["\x70\x61\147\145"], "\146\x6f\x72\x6d\137\151\x64" => $data["\146\157\162\x6d\151\x64"], "\144\x61\164\141" => $data_arr); goto CosCv; dusJB: return $result; goto g6E7_; CosCv: $appid = $this->config["\141\160\160\x69\144"]; goto c862g; IYvlR: $result = $this->send_post($push_url, $data); goto dusJB; lnKYo: $access_token = $this->getWxAccessToken($appid, $appsecret); goto BVD5x; bNeGB: $data = json_encode($params, true); goto IYvlR; g6E7_: } protected function send_post($url, $post_data) { goto M3tTQ; k3YBe: $result = file_get_contents($url, false, $context); goto chub2; chub2: return $result; goto WJmo7; rP83m: $context = stream_context_create($options); goto k3YBe; M3tTQ: $options = array("\x68\164\164\160" => array("\x6d\x65\x74\x68\x6f\144" => "\x50\117\123\x54", "\x68\x65\x61\144\145\162" => "\x43\x6f\156\x74\x65\156\x74\55\164\x79\x70\x65\x3a\141\x70\160\154\151\143\141\x74\x69\x6f\156\57\152\163\157\x6e", "\x63\x6f\x6e\x74\x65\x6e\x74" => $post_data, "\x74\151\x6d\145\x6f\x75\164" => 60)); goto rP83m; WJmo7: } function makeRequest($url, $params = array(), $expire = 0, $extend = array(), $hostIp = '') { goto lwxjQ; QE3L6: $_header = array("\101\x63\143\145\x70\x74\55\114\x61\156\147\x75\141\x67\x65\72\40\172\x68\x2d\103\116", "\x43\157\x6e\156\145\143\x74\x69\x6f\x6e\72\x20\x4b\x65\145\160\x2d\101\x6c\x69\166\x65", "\103\x61\143\150\145\x2d\x43\x6f\156\x74\x72\x6f\x6c\x3a\x20\x6e\157\x2d\x63\141\143\150\145"); goto zpd0x; oPoYU: $result["\143\x6f\x64\x65"] = curl_getinfo($_curl, CURLINFO_HTTP_CODE); goto U0ALU; j9w0m: return array("\143\x6f\144\x65" => "\x31\x30\60"); goto Cu3x9; aBgKp: fcxHI: goto NI_pk; T9O51: X6tRn: goto wztqa; HKu2H: curl_setopt($_curl, CURLOPT_HTTPHEADER, $_header); goto cktx8; U0ALU: $result["\x69\x6e\146\157"] = curl_getinfo($_curl); goto qlDit; gzXEe: if (empty($urlInfo["\150\x6f\163\164"])) { goto kftya; } goto dqN1j; dqN1j: $url = str_replace($urlInfo["\150\x6f\163\x74"], $hostIp, $url); goto tPECq; wztqa: if (empty($params)) { goto D3wKf; } goto ZSdq2; tPECq: goto MmFH1; goto FABDB; qKJgv: $_header[] = "\110\157\x73\x74\72\x20{$urlInfo["\x68\x6f\x73\164"]}"; goto T9O51; xWJVq: curl_setopt($_curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto G5grg; ZSdq2: curl_setopt($_curl, CURLOPT_POSTFIELDS, http_build_query($params)); goto xV0Kb; b23Of: curl_setopt($_curl, CURLOPT_USERAGENT, "\x41\120\111\40\120\x48\120\40\x43\125\122\x4c"); goto HKu2H; b94xo: $result["\x72\145\x73\x75\x6c\x74"] = curl_error($_curl); goto dpGD9; G5grg: curl_setopt($_curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto rqEXY; rvPux: $url = "\150\164\x74\160\x3a\57\x2f{$hostIp}{$url}"; goto zpmdE; w0Hw2: $urlInfo = parse_url($url); goto gzXEe; WNYLv: curl_setopt($_curl, CURLOPT_CONNECTTIMEOUT, $expire); goto GoixC; JtiUe: curl_setopt($_curl, CURLOPT_TIMEOUT, $expire); goto WNYLv; tKXhK: curl_setopt($_curl, CURLOPT_URL, $url); goto C8mUL; H1uPJ: curl_setopt_array($_curl, $extend); goto aBgKp; rqEXY: h71hy: goto tKXhK; dpGD9: $result["\143\x6f\144\145"] = -curl_errno($_curl); goto jTXEV; M1PoQ: $urlInfo["\150\x6f\x73\164"] = substr(DOMAIN, 7, -1); goto rvPux; xV0Kb: curl_setopt($_curl, CURLOPT_POST, true); goto qL3cz; lwxjQ: if (!empty($url)) { goto o94Rr; } goto j9w0m; qL3cz: D3wKf: goto a2ura; zpmdE: MmFH1: goto qKJgv; a2ura: if (!(substr($url, 0, 8) == "\x68\164\164\x70\x73\x3a\57\57")) { goto h71hy; } goto xWJVq; Tk1m0: return $result; goto wH8X0; SYXmU: if (empty($extend)) { goto fcxHI; } goto H1uPJ; C8mUL: curl_setopt($_curl, CURLOPT_RETURNTRANSFER, true); goto b23Of; FABDB: kftya: goto M1PoQ; ecWYl: curl_close($_curl); goto Tk1m0; jTXEV: z_vqT: goto ecWYl; cktx8: if (!($expire > 0)) { goto lkyQL; } goto JtiUe; zpd0x: if (empty($hostIp)) { goto X6tRn; } goto w0Hw2; qlDit: if (!($result["\x72\145\x73\165\154\x74"] === false)) { goto z_vqT; } goto b94xo; cLh2Y: $_curl = curl_init(); goto QE3L6; GoixC: lkyQL: goto SYXmU; NI_pk: $result["\162\x65\163\165\x6c\x74"] = curl_exec($_curl); goto oPoYU; Cu3x9: o94Rr: goto cLh2Y; wH8X0: } }
