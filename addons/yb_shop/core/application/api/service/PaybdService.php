<?php
 namespace app\api\service; use think\Db; require_once BASE_ROOT . "\143\157\162\x65\57\x65\x78\164\x65\156\144\57\102\x64\160\141\171\57\x41\x75\164\x6f\x6c\157\x61\x64\145\162\56\x70\150\x70"; class PaybdService { private $o = "\x79\142\163\143\137\x6f\162\144\x65\x72"; private $og = "\171\142\x73\x63\x5f\157\162\144\145\x72\x5f\147\x6f\x6f\144\163"; private $uc = "\171\x62\x73\143\x5f\x75\x73\145\x72\x5f\x63\157\x75\160\157\156"; private $s = "\x79\x62\163\x63\x5f\x67\157\x6f\144\163\137\x73\x6b\165"; private $g = "\171\x62\x73\x63\137\147\157\157\144\x73"; private $op = "\x79\x62\x73\143\x5f\x6f\162\x64\x65\x72\137\160\141\171\x6d\x65\156\x74"; private $i = "\x79\x62\x73\x63\x5f\151\155\x61\x67\x65\x73"; private $dq = "\x79\142\163\143\x5f\x61\162\x65\x61"; private $cf = "\171\x62\x73\x63\x5f\x63\157\156\146\x69\147"; public function orderPaybd($data) { goto nW4Jt; PQAC0: if (!(empty($orderinfo["\144\145\141\154\x49\144"]) || empty($orderinfo["\x61\x70\160\113\x65\x79"]) || empty($rsaPublicKeyStr) || empty($rsaPriKeyStr))) { goto cPBfx; } goto QazGJ; fKWgl: $param = json_decode($param, true); goto BG5WT; nCVnB: return json_encode($rs); goto wtnMy; XAqK8: cpWHw: goto fKWgl; xtE6m: return json_encode($rs); goto KlYnw; LNWlI: $rs["\x63\x6f\x64\x65"] = 1; goto NVrAj; QazGJ: $rs["\143\x6f\x64\x65"] = 1; goto Aj2Ss; jKPi4: $data["\160\162\151\x6b\x65\x79"] = $rsaPriKeyStr; goto Uf3un; wp74f: $orderinfo["\141\x70\x70\x4b\x65\171"] = $param["\141\160\160\x4b\145\171"] ? $param["\141\160\160\x4b\145\171"] : ''; goto FBAFV; FWIiB: if (!empty($info)) { goto iAC2Y; } goto P1ejF; zGW5s: $rs["\143\x6f\x64\145"] = 1; goto D00Er; frf6j: $rsaPublicKeyStr = $param["\x61\x70\160\137\x70\x75\x62"] ? $param["\141\x70\160\137\160\165\x62"] : ''; goto wp74f; dmHhO: if ($checkSignRes) { goto BMvb9; } goto LNWlI; Pph7C: $requestParamsArr = array("\141\160\x70\113\x65\171" => $orderinfo["\x61\160\x70\x4b\x65\x79"], "\x64\x65\x61\154\111\144" => $orderinfo["\x64\145\141\154\x49\144"], "\164\x70\117\x72\144\x65\162\111\144" => $data["\157\x75\x74\x5f\x74\162\141\x64\145\x5f\x6e\157"], "\x74\157\x74\141\154\101\x6d\x6f\165\x6e\x74" => $info["\160\x61\x79\137\x6d\x6f\x6e\145\171"] * 100); goto luGZJ; p_d9p: KCVLz: goto tCoBI; Uf3un: $data["\x70\x75\142\x6b\x65\171"] = $rsaPublicKeyStr; goto r97jg; NVrAj: $rs["\155\163\147"] = "\xe7\255\xbe\345\220\x8d\xe9\x94\231\350\xaf\xaf\54\350\xaf\xb7\xe7\xa1\xae\350\xae\xa4\xe5\x8f\x82\xe6\225\xb0\xe6\230\257\xe5\220\xa6\345\xa1\253\xe5\x86\x99\346\xad\243\xe7\241\256"; goto cQfkC; SqfBc: return json_encode($rs); goto sTc8w; r97jg: $checkSignRes = \NuomiRsaSign::checkSignWithRsa($requestParamsArr, $rsaPublicKeyStr); goto dmHhO; cQfkC: return json_encode($rs); goto aJp5A; tCoBI: $param = Db::name("\x79\x62\x73\x63\x5f\143\157\x6e\x66\x69\x67")->where("\153\145\171", "\102\104\101\x50\120")->where("\155\143\x68\x5f\x69\144", $data["\155\x63\x68\137\151\144"])->value("\166\141\x6c\165\x65"); goto eIGAt; wtnMy: iAC2Y: goto EwdPS; KlYnw: cPBfx: goto Pph7C; VYHDl: $orderinfo = []; goto FWIiB; nW4Jt: $rs = array("\x63\x6f\144\145" => 0, "\x69\x6e\x66\x6f" => array()); goto oqfhL; eIGAt: if (!empty($param)) { goto cpWHw; } goto zGW5s; EwdPS: if (!($info->pay_status != 0)) { goto KCVLz; } goto SWUhV; BG5WT: $orderinfo["\144\145\x61\154\x49\144"] = $param["\144\x65\141\154\111\x64"] ? $param["\144\x65\141\x6c\111\x64"] : ''; goto frf6j; luGZJ: $rsaSign = \NuomiRsaSign::genSignWithRsa($requestParamsArr, $rsaPriKeyStr); goto BkAtj; P1ejF: $rs["\x63\x6f\144\x65"] = 1; goto wCWNI; cQmOc: return json_encode($rs); goto p_d9p; Aj2Ss: $rs["\x6d\163\x67"] = "\xe5\225\206\xe6\x88\267\344\xbf\xa1\346\201\xaf\344\xb8\x8d\345\xae\x8c\xe6\x95\264"; goto xtE6m; BkAtj: $requestParamsArr["\163\151\147\156"] = $rsaSign; goto tluK5; aJp5A: BMvb9: goto YtFOH; D00Er: $rs["\x6d\x73\147"] = "\xe8\257\xb7\xe9\x85\215\xe7\275\256\xe5\225\206\346\210\267\xe4\277\241\346\x81\xaf"; goto SQDYz; CnlBI: $rs["\x69\x6e\x66\x6f"] = $orderinfo; goto VE3hG; YtFOH: $orderinfo["\x72\x73\x61\x53\x69\147\156"] = $rsaSign; goto CnlBI; VE3hG: $rs["\144\x61\164\x61"] = $data; goto SqfBc; cSFeS: $rs["\155\x73\147"] = "\xe8\xae\xa2\xe5\x8d\225\347\212\xb6\xe6\x80\201\xe5\267\262\346\x94\xb9\xe5\217\x98"; goto cQmOc; SWUhV: $rs["\x63\157\x64\x65"] = 1; goto cSFeS; tluK5: $data["\160\141\x72\141\155\x73"] = $requestParamsArr; goto jKPi4; SQDYz: return json_encode($rs); goto XAqK8; wCWNI: $rs["\155\163\x67"] = "\xe8\xae\242\345\215\x95\344\xb8\215\345\xad\230\345\x9c\250"; goto nCVnB; oqfhL: $info = Db::name($this->op)->where("\157\165\164\x5f\x74\x72\x61\144\x65\x5f\156\x6f", $data["\157\165\164\137\x74\162\141\144\x65\137\x6e\157"])->find(); goto VYHDl; FBAFV: $rsaPriKeyStr = $param["\160\141\x79\137\x73\x65\143\x72\145\x74"] ? $param["\160\141\171\137\x73\145\143\162\145\x74"] : ''; goto PQAC0; sTc8w: } private function createNoncestr($length = 32) { goto MoZm4; qbwIn: FSRb3: goto Sdbzu; gQSOY: if (!($i < $length)) { goto naj4Q; } goto scIzP; jb8J7: naj4Q: goto Q2TOD; MoZm4: $chars = "\141\142\143\144\145\x66\x67\x68\151\x6a\153\154\x6d\156\x6f\160\x71\x72\x73\x74\x75\166\x77\x78\171\x7a\60\x31\x32\63\x34\x35\66\x37\x38\71"; goto YPNGB; scIzP: $str .= substr($chars, mt_rand(0, strlen($chars) - 1), 1); goto qbwIn; Sdbzu: $i++; goto uAM93; C95XA: fQDzi: goto gQSOY; YPNGB: $str = ''; goto UR_ra; uAM93: goto fQDzi; goto jb8J7; Q2TOD: return $str; goto gdObO; UR_ra: $i = 0; goto C95XA; gdObO: } }
