<?php
 namespace app\api\service; use app\common\model\ResOrderPayment; use app\common\model\ResOrder; use app\common\model\Goods; use app\common\model\Images; use app\common\model\ResBooked; use app\common\model\ResService; use app\common\model\ResComment; use app\common\model\User; use app\common\model\UserCoupon; use app\common\model\ResOrderGoods; use app\common\model\Resdesk; use app\common\model\Business; use think\Db; use Exception; class CateringService { function __construct() { $this->UserOrder = new \app\common\model\ResOrder(); $this->OrderGoods = new \app\common\model\ResOrderGoods(); } public function VoiceCall($data) { goto TUH3u; eSp14: return "\xe5\267\xb2\351\200\x9a\xe7\237\245\346\234\x8d\xe5\x8a\xa1\345\221\230\54\xe8\xaf\xb7\xe7\xa8\215\345\x90\x8e"; goto BFaLe; NTWz0: $a = $desk->where($where)->find(); goto PU0BI; obaDz: $where = ["\x69\x64" => $data["\144\145\x73\153\137\x69\144"], "\x6d\x63\150\x5f\151\x64" => $data["\155\x63\150\x5f\151\x64"]]; goto NTWz0; VTABS: return ["\145\x72\162\137\x63\157\x64\145" => 1, "\x6d\163\147" => "\346\x89\xab\xe7\xa0\x81\xe5\274\202\345\xb8\270\357\xbc\214\350\xaf\267\xe9\207\x8d\xe8\257\225"]; goto dSfFW; PU0BI: if (!empty($a)) { goto KSkan; } goto VTABS; hYe3Z: $url = "\150\x74\x74\x70\163\x3a\x2f\x2f\x76\151\160\x2e\x6c\x79\x31\x30\x30\x2e\167\x61\156\147\x2f\141\160\x69\57\x61\x70\x70\x2f\101\154\151\x79\165\156\57\x70\165\x73\x68\77\x6d\x63\150\137\x69\144\x3d" . $data["\155\x63\x68\137\x69\144"] . "\x26\x74\151\x74\x6c\145\x3d" . $title . "\46\x63\x6f\156\164\x65\156\x74\75" . $content; goto FGd1V; FGd1V: file_get_contents($url); goto eSp14; TUH3u: $desk = new Resdesk(); goto obaDz; N5ODd: o7Jre: goto hYe3Z; LARBO: switch ($data["\x63\x61\154\x6c\137\x74\171\160\x65"]) { case 1: goto C0uLh; wvTwE: goto o7Jre; goto cBtVj; Jo8NJ: $content = $a["\156\x61\155\x65"] . "\xe5\217\267\xe6\xa1\x8c\345\x82\254\344\xbf\x83\344\270\212\xe8\217\234"; goto wvTwE; C0uLh: $title = "\345\202\254\xe4\xbf\x83\344\xb8\212\xe8\217\x9c"; goto Jo8NJ; cBtVj: case 2: goto JQmqR; JQmqR: $title = "\xe5\x91\274\345\x8f\xab\346\x9c\215\xe5\212\xa1\xe5\x91\x98"; goto DavkT; TFxKs: goto o7Jre; goto GAqke; DavkT: $content = $a["\x6e\x61\x6d\145"] . "\345\x8f\267\xe6\241\214\345\x91\274\xe5\217\253\346\x9c\x8d\xe5\x8a\xa1\345\221\230"; goto TFxKs; GAqke: case 3: goto GBDnt; TyTdO: $content = $a["\x6e\x61\x6d\145"] . "\xe5\x8f\267\xe6\241\214\xe9\x9c\200\xe8\246\201\345\x8a\240\xe7\xb1\263\351\xa5\xad"; goto E2L_9; E2L_9: goto o7Jre; goto OPX82; GBDnt: $title = "\xe5\x8a\xa0\xe7\xb1\263\351\245\255"; goto TyTdO; OPX82: case 4: goto RJeg1; RJeg1: $title = "\xe5\212\xa0\xe6\xb0\xb4"; goto pjpbU; uTvdg: goto o7Jre; goto rd9SZ; pjpbU: $content = $a["\x6e\x61\x6d\x65"] . "\345\217\267\xe6\xa1\x8c\351\234\200\xe8\xa6\201\345\212\xa0\xe6\xb0\xb4"; goto uTvdg; rd9SZ: default: return ["\x65\x72\162\137\x63\x6f\x64\145" => 1, "\155\163\x67" => "\xe5\217\202\xe6\x95\xb0\xe5\274\202\345\270\270\xef\xbc\214\350\257\xb7\346\xb1\202\xe5\244\xb1\xe8\xb4\xa5"]; } goto ka_1C; dSfFW: KSkan: goto LARBO; ka_1C: awr0C: goto N5ODd; BFaLe: } public function createOrder($data) { goto sqk2j; sqk2j: Db::startTrans(); goto EVDNZ; EVDNZ: try { goto MKb6B; QcNFR: $order_good = new Goods(); goto Vahtc; pHOig: w6eXh: goto QcNFR; esK30: $UserCoupon = new UserCoupon(); goto ShYSI; bgw06: foreach ($dish as $k => $v) { goto ula_D; duber: $info = $order_good->where("\147\157\157\x64\163\137\151\x64", $k)->find(); goto kvfQc; suD2P: $d = $good->insert($new_data); goto Zrg_S; ula_D: $order_good->where("\147\157\x6f\144\163\137\x69\x64", $k)->setInc("\162\145\x61\154\x5f\x73\141\x6c\x65\x73", $v); goto duber; lE5ml: PFYNS: goto aS8mW; uVlf7: $new_data = ["\157\x72\x64\x65\x72\x5f\x69\144" => $order->order_id, "\147\x6f\157\144\x73\x5f\156\x61\155\145" => $info["\147\x6f\157\x64\163\x5f\x6e\141\x6d\x65"], "\160\x72\151\x63\145" => $info["\x70\x72\x69\143\x65"], "\x6d\143\150\x5f\151\144" => $info["\155\143\x68\137\x69\144"], "\x75\163\x65\x72\137\x69\144" => $data["\165\x73\145\x72\x5f\x69\144"], "\151\x6d\x67" => $info["\151\155\141\x67\x65\x73"], "\147\x6f\x6f\144\x73\137\151\x64" => $k, "\156\x75\155\x62\145\x72" => $v, "\x74\171\160\x65" => 0, "\143\x72\145\x61\x74\x65\137\164\151\x6d\145" => $time]; goto suD2P; kvfQc: if (!$info) { goto vwI3y; } goto uVlf7; Zrg_S: if (!empty($d)) { goto PFYNS; } goto a2Mbp; fi9NM: s01Ho: goto wmleW; aS8mW: vwI3y: goto fi9NM; a2Mbp: throw new \think\Exception("\163\x68\151\x62\x61\x69"); goto lE5ml; wmleW: } goto e7WJI; NffJw: mrQS4: goto W1piF; RZNIp: throw new \think\Exception("\163\x68\151\142\141\151"); goto WiJ7U; oWcq5: $b = $pay->save($pay_data); goto n1NfW; e7WJI: G07Cj: goto lFFwJ; bxpa6: throw new \think\Exception("\163\150\151\x62\x61\151"); goto ss6jR; MKb6B: $order = new ResOrder(); goto x8CJy; xrh0D: $c = $UserCoupon->save($coupon_data, "\151\144\75" . $data["\143\157\165\x70\157\x6e\x5f\x69\144"]); goto G3vRC; x8CJy: $a = $order->data($data)->allowField(true)->save(); goto shJVZ; H5KM1: throw new Exception("\x73\150\151\142\x61\x69"); goto NffJw; n1NfW: if (!empty($b)) { goto mrQS4; } goto H5KM1; Th5da: $pay = new ResOrderPayment(); goto gORHw; ULrBU: $dish = json_decode($data["\x6f\162\144\145\162\137\x64\x69\163\150\x5f\x6a\x73\x6f\156"], true); goto akrfg; shJVZ: if (!empty($a)) { goto jgzEC; } goto RZNIp; akrfg: if (!empty($dish)) { goto w6eXh; } goto tpHws; ShYSI: $coupon_data = array("\163\x74\x61\x74\165\x73" => 1, "\x75\163\145\137\164\151\x6d\x65" => time()); goto xrh0D; ss6jR: ZJvre: goto B3pa4; dIUQJ: if (!($data["\160\141\171\137\x74\171\160\145"] == 1)) { goto eFYhk; } goto Th5da; WiJ7U: jgzEC: goto dIUQJ; Vahtc: $good = new ResOrderGoods(); goto sHXJw; WPC0B: if (!($data["\143\157\165\x70\x6f\x6e\x5f\x69\x64"] != 0)) { goto ZxbF6; } goto esK30; tpHws: throw new \think\Exception("\x73\x68\x69\142\x61\151"); goto pHOig; gORHw: $pay_data = array("\157\x75\164\137\164\x72\141\x64\x65\x5f\x6e\x6f" => $data["\157\x75\x74\137\x74\x72\141\x64\x65\x5f\156\157"], "\x74\171\x70\x65\x5f\141\154\x69\x73\x5f\x69\144" => $order->order_id, "\160\x61\x79\137\142\157\x64\171" => "\347\224\250\xe6\x88\xb7\346\x94\xaf\xe4\xbb\230", "\160\x61\x79\137\144\145\164\x61\x69\x6c" => "\xe7\x94\250\xe6\x88\267\xe8\264\xad\xe4\xb9\xb0\xe5\225\x86\345\223\201", "\160\x61\x79\137\155\x6f\x6e\145\x79" => $data["\x70\x61\171\x5f\x6d\x6f\x6e\x65\171"], "\143\162\145\x61\x74\x65\x5f\164\151\155\x65" => time()); goto oWcq5; B3pa4: ZxbF6: goto ULrBU; sHXJw: $time = time(); goto bgw06; W1piF: eFYhk: goto WPC0B; G3vRC: if (!empty($c)) { goto ZJvre; } goto bxpa6; lFFwJ: Db::commit(); goto SB3QQ; SB3QQ: } catch (\Exception $e) { Db::rollback(); return null; } goto d353h; d353h: return $order->order_id; goto vD98M; vD98M: } public function orderList($data, $page = 1) { goto IqOPT; zZLaF: $order_list = $order->where($data)->where("\x69\163\137\x64\x65\154\x65\x74\x65\144", 0)->page($page, PAGE_NUM)->order("\x63\x72\145\x61\164\145\137\x74\x69\155\145", "\144\x65\x73\143")->select(); goto JozuT; x24en: $order_list = null; goto zZLaF; JozuT: $info["\x69\x6e\146\x6f"] = $order_list; goto abIIG; Xw_UX: OZaQe: goto GNbas; IqOPT: $bus = new Business(); goto JRxIe; kj4RR: return $info; goto Xw_UX; pEEp9: HkBI1: goto ImxF_; JRxIe: $a = $bus->field("\151\144\54\160\x61\x79\155\145\156\x74\137\x6d\145\x74\x68\157\144")->where("\x69\144", $data["\155\x63\x68\x5f\x69\144"])->find(); goto MP1rs; abIIG: if (!empty($order_list)) { goto OZaQe; } goto kj4RR; ImxF_: return $info; goto LVf1l; GNbas: foreach ($order_list as $key => $value) { goto yiO0C; m1GhU: $desk = $Resdesk->where("\151\144", $value->desk_id)->find(); goto AfzyW; MXnDW: $value->desk_name = $desk["\x6e\141\155\145"]; goto LB9S8; PhMCh: foreach ($a as $k => $v) { goto qs9dQ; S8_1r: $v["\160\151\143"] = $pic; goto dYOIY; dYOIY: BNKRd: goto YuT0E; YuT0E: TA4Jt: goto Ht_KI; qs9dQ: $imgas = new Images(); goto mGUxk; ABTIl: if (!$pic) { goto BNKRd; } goto LvJmu; mGUxk: $pic = $imgas->where("\151\155\x67\137\151\144", $v->img)->field("\151\x6d\x67\x5f\143\157\x76\x65\162\137\x62\x69\x67\54\x69\155\x67\x5f\143\157\x76\145\162\137\x6d\x69\144\x2c\151\155\x67\x5f\x63\x6f\166\x65\x72\137\163\155\141\x6c\154")->find(); goto ABTIl; LvJmu: foreach ($pic->toArray() as $p_k => $p_v) { $pic[$p_k] = __IMG($p_v); I3cHo: } goto ulI3b; ulI3b: YMJHC: goto S8_1r; Ht_KI: } goto T0ZEe; VsgC4: $value->finish_time = __TIME($value->finish_time); goto U7Ft6; U7Ft6: $good = new ResOrderGoods(); goto SMMxP; MaqH0: Xhh33: goto AGY9E; D8XGq: $value->create_time = __TIME($value->create_time); goto LJXU1; AfzyW: if (!$desk) { goto dMQPc; } goto MXnDW; LJXU1: $value->pay_time = __TIME($value->pay_time); goto VsgC4; yiO0C: $Resdesk = new Resdesk(); goto m1GhU; LB9S8: dMQPc: goto D8XGq; SMMxP: $a = $good->where("\x6f\162\144\x65\x72\137\151\144", $value->order_id)->select(); goto PhMCh; T0ZEe: jzUvZ: goto HGBFd; HGBFd: $value->goods = $a; goto MaqH0; AGY9E: } goto pEEp9; MP1rs: $info["\160\x61\171\x5f\164\x79\x70\x65"] = $a["\x70\141\171\155\x65\x6e\x74\137\155\145\164\x68\x6f\x64"]; goto P2mF6; P2mF6: $order = new ResOrder(); goto x24en; LVf1l: } public function getOrder($data) { goto Uszrc; MZXOz: $a = $good->where("\157\x72\144\145\162\x5f\151\144", $order_info["\x6f\x72\144\x65\x72\x5f\x69\144"])->select(); goto TZREV; rUctb: uIY0l: goto vsm9j; hdS0g: $order_info["\x64\x65\163\153\137\156\x61\x6d\145"] = $desk["\156\x61\x6d\x65"]; goto iG9H1; Cm2it: $order_info["\x72\145\x66\165\156\144\x5f\x74\x69\155\x65"] = __TIME($order_info["\x72\x65\x66\165\156\144\x5f\x74\x69\155\x65"]); goto ScyDA; ScyDA: $order_info["\162\x65\146\x75\x6e\x64\137\157\x6b\x5f\164\151\x6d\145"] = __TIME($order_info["\x72\145\146\x75\156\144\x5f\x6f\x6b\137\164\151\x6d\145"]); goto F8k_r; OqeDh: return $order_info; goto kKQJS; vsm9j: $order_info["\x67\157\x6f\144\163"] = $a; goto OqeDh; gPYHZ: $desk = $Resdesk->where("\x69\x64", $order_info["\x64\145\163\x6b\137\151\144"])->find(); goto eD3mc; eD3mc: if (!$desk) { goto Tfkw3; } goto hdS0g; bFGWe: $order_info["\146\x69\x6e\x69\163\150\x5f\164\151\x6d\x65"] = __TIME($order_info["\x66\151\x6e\151\x73\150\137\x74\x69\155\145"]); goto JbfG7; dgpii: $Resdesk = new Resdesk(); goto gPYHZ; Uszrc: $order = new ResOrder(); goto QpFd_; QzdpF: if (!empty($order_info)) { goto BPLd2; } goto SMhFG; SMhFG: return $order_info; goto VEgr_; F8k_r: $good = new ResOrderGoods(); goto MZXOz; VEgr_: BPLd2: goto dgpii; bISCJ: $order_info = $order->where($data)->where("\151\x73\x5f\144\145\x6c\145\164\x65\x64", 0)->find(); goto QzdpF; iG9H1: Tfkw3: goto jrZRU; jrZRU: $order_info["\x70\x61\x79\x5f\x74\151\x6d\145"] = __TIME($order_info["\x70\x61\171\137\x74\151\155\145"]); goto bFGWe; JbfG7: $order_info["\x63\162\145\141\164\x65\137\164\x69\155\x65"] = __TIME($order_info["\143\162\145\141\x74\x65\137\164\151\x6d\145"]); goto Cm2it; TZREV: foreach ($a as $k => $v) { goto FQWW2; maxiH: wLxc7: goto SzB8x; b_nu8: foreach ($pic->toArray() as $p_k => $p_v) { $pic[$p_k] = __IMG($p_v); IauOc: } goto dAQUK; SzB8x: aXCTc: goto LL7ej; EjBbH: $pic = $imgas->where("\x69\155\x67\x5f\x69\144", $v->img)->field("\151\x6d\147\137\x63\x6f\x76\145\x72\137\142\151\x67\x2c\x69\155\147\137\x63\x6f\166\x65\x72\x5f\155\x69\x64\54\151\155\147\x5f\x63\157\166\x65\x72\x5f\x73\x6d\x61\154\154")->find(); goto LnLaz; u1Sej: $v["\160\151\x63"] = $pic; goto maxiH; LnLaz: if (!$pic) { goto wLxc7; } goto b_nu8; dAQUK: ihZXK: goto u1Sej; FQWW2: $imgas = new Images(); goto EjBbH; LL7ej: } goto rUctb; QpFd_: $order_info = null; goto bISCJ; kKQJS: } public function signOrder($data) { goto Q31_0; sJuPr: $info = $order->where($data)->find(); goto i_sOw; FQCtx: $res = $order->save($new_data, ["\x6f\x72\144\145\162\x5f\x69\x64" => $data["\157\x72\144\145\x72\137\x69\144"]]); goto OMkBb; vcNWu: FreBM: goto q4YAs; OMkBb: return $res; goto W0ery; q4YAs: $new_data = array("\157\x72\x64\x65\x72\137\163\164\x61\x74\x75\163" => 3, "\x66\x69\x6e\151\163\150\137\x74\x69\155\x65" => time()); goto FQCtx; Q31_0: $order = new ResOrder(); goto sJuPr; xUVTL: return null; goto vcNWu; i_sOw: if (!empty($info)) { goto FreBM; } goto xUVTL; W0ery: } public function cancelOrder($data) { goto qX98c; fUiDM: $res = $order->save($new_data, ["\x6f\x72\x64\x65\162\x5f\151\144" => $data["\x6f\x72\x64\145\162\137\151\x64"]]); goto UxhDm; UxhDm: return $res; goto e7tmi; Kuqrj: $new_data = array("\x6f\x72\x64\145\162\137\x73\x74\x61\164\165\x73" => -1); goto fUiDM; xb7ge: if (!empty($info)) { goto EbKVF; } goto cLN1o; qX98c: $order = new ResOrder(); goto UndF8; bVYeW: EbKVF: goto Kuqrj; UndF8: $info = $order->where($data)->find(); goto xb7ge; cLN1o: return null; goto bVYeW; e7tmi: } public function delOrder($data) { goto A1viE; Lx0ai: $new_data = array("\151\163\137\x64\x65\x6c\x65\164\x65\x64" => 1); goto c1pkG; CxI5I: return null; goto yJr9Y; c1pkG: $res = $order->save($new_data, ["\157\162\x64\x65\x72\137\x69\144" => $data["\x6f\x72\144\x65\162\x5f\x69\x64"]]); goto m3ETm; ihkn4: if (!empty($info)) { goto X_g4W; } goto CxI5I; m3ETm: return $res; goto gvJy1; A1viE: $order = new ResOrder(); goto Ij1eG; Ij1eG: $info = $order->where($data)->find(); goto ihkn4; yJr9Y: X_g4W: goto Lx0ai; gvJy1: } public function refundOrder($data) { goto qn47R; NEcFH: if (!empty($info)) { goto exmTy; } goto E3f8m; P5ZiH: $new_data = array("\x6f\162\144\x65\x72\x5f\x73\x74\141\164\165\163" => 4, "\x72\x65\x66\165\x6e\144\137\164\151\x6d\x65" => time()); goto cGJbB; UHQen: exmTy: goto P5ZiH; DfqUs: $info = $order->where($data)->find(); goto NEcFH; qn47R: $order = new ResOrder(); goto DfqUs; E3f8m: return null; goto UHQen; cGJbB: $res = $order->save($new_data, ["\157\162\x64\x65\x72\x5f\x69\144" => $data["\x6f\x72\x64\x65\162\x5f\x69\144"]]); goto eitbD; eitbD: return $res; goto tNJLb; tNJLb: } public function Book($data) { goto Me3Aq; Me3Aq: $book = new ResBooked(); goto W53SI; W53SI: $info = $book->save($data); goto n8IFc; n8IFc: return $info; goto Tfgj5; Tfgj5: } public function Booklist($data, $page) { goto hsIEJ; xcgnp: return $info; goto EiySP; DFv9Z: $info = $book->where($data)->where("\163\164\x61\x74\x75\163", ["\x69\156", [1, 2]])->page($page, PAGE_NUM)->order("\143\162\145\x61\164\145\137\164\x69\x6d\145", "\x64\145\163\x63")->select(); goto xkRPW; EiySP: i8MVT: goto Ou3QC; hsIEJ: $book = new ResBooked(); goto DFv9Z; HEcw8: $rs = $info; goto EfIsW; EfIsW: return $rs; goto PHUNv; yZ6Z2: tFtym: goto HEcw8; xkRPW: if (!empty($info)) { goto i8MVT; } goto xcgnp; Ou3QC: foreach ($info as $key => $value) { $value->create_time = __TIME($value->create_time); WBc32: } goto yZ6Z2; PHUNv: } public function cancelBook($data) { goto IV8Zf; EIiO3: return $info; goto DpNQh; dblt3: $info = $book->save($data, ["\151\x64" => $data["\151\144"]]); goto EIiO3; IV8Zf: $book = new ResBooked(); goto dblt3; DpNQh: } public function ShopService($data) { goto J9RG2; J9RG2: $book = new ResService(); goto ML_ue; ML_ue: $info = $book->where($data)->find(); goto FUnku; O9tER: return array(); goto mFHTP; oxqTZ: return $info["\x61\x72\162\141\171\x5f\x76\x61\154\x75\x65\163"]; goto ZBSE8; ZBSE8: ySw3J: goto O9tER; FUnku: if (!(isset($info["\x61\162\162\141\171\x5f\166\x61\x6c\165\x65\x73"]) && $info["\x61\x72\162\141\x79\137\x76\x61\154\x75\x65\x73"] != null)) { goto ySw3J; } goto oxqTZ; mFHTP: } public function WriteComment($data) { goto DatSa; iMEvd: return $info; goto n9JKn; DatSa: $comment = new ResComment(); goto q7_kj; q7_kj: $info = $comment->save($data); goto iMEvd; n9JKn: } public function CommentList($data, $page) { goto v9Wp1; LOOh7: return json_encode($rs); goto dphjh; qwobr: if (!empty($info)) { goto dOvwk; } goto ubPKq; jWjac: foreach ($info as $key => $value) { goto qDi3L; HG4Xu: if (!($i < count($pic))) { goto WjnHc; } goto n2KKn; Yu7YJ: $i++; goto jrUGN; z0uAq: $i = 0; goto X1NEn; vaRjn: WjnHc: goto fJFc0; HNUjS: TINGs: goto Ybc6S; eJ1F2: $value->user_headimg = $username["\165\x73\x65\162\x5f\x68\145\141\144\x69\155\147"]; goto OjqPJ; OjqPJ: uTXJA: goto rm5sM; fJFc0: $value->pic = $pic; goto HNUjS; X1NEn: HXgRr: goto HG4Xu; JEjCB: $value->username = $username["\x6e\x69\x63\153\137\x6e\x61\x6d\145"]; goto eJ1F2; qDi3L: if (!($value->array_pic != '')) { goto TINGs; } goto wcdnj; lT2Kk: $username = $this->getUserInfo($value->user_id); goto JEjCB; n2KKn: $pic[$i] = "\x68\x74\164\x70\163\x3a\x2f\57" . $_SERVER["\x48\x54\124\120\x5f\110\117\123\124"] . "\57\x61\x70\x69\x2f" . $pic[$i]; goto t5YQU; Ybc6S: $value->create_time = date("\x59\x2d\155\55\x64", $value->create_time); goto lT2Kk; t5YQU: lSPAV: goto Yu7YJ; wcdnj: $pic = explode("\x2c", rtrim($value->array_pic, "\54")); goto z0uAq; jrUGN: goto HXgRr; goto vaRjn; rm5sM: } goto szX0m; q7LtB: dOvwk: goto jWjac; Fp5bo: $num = $book->where($data)->avg("\146\162\x61\143\164\151\x6f\156") * 2; goto XkgV9; gZgxD: g5gGQ: goto Yq29H; Yq29H: $rs["\143\x6f\165\x6e\x74"] = $book->where($data)->count(); goto Fp5bo; bQ1Tx: $rs["\151\156\x66\x6f"] = $info; goto gZgxD; szX0m: s87sz: goto bQ1Tx; XkgV9: $rs["\163\x72\x6f\143\x65"] = round($num, 2); goto LOOh7; v9Wp1: $book = new ResComment(); goto rNYEf; ErwXa: goto g5gGQ; goto q7LtB; rNYEf: $info = $book->where($data)->page($page, PAGE_NUM)->order("\x63\162\x65\x61\x74\x65\137\164\151\155\x65", "\144\145\x73\143")->select(); goto qwobr; ubPKq: $rs["\x69\x6e\146\157"] = array(); goto ErwXa; dphjh: } public function getUserInfo($uid) { goto VvHCi; DhM1u: $info = $User->where("\x75\151\144", $uid)->find(); goto sdt5P; VvHCi: $User = new User(); goto DhM1u; sdt5P: return $info; goto F3dx8; F3dx8: } public function addOrder($data, $json) { goto PJ9XP; NobMu: $where["\x6f\162\x64\145\162\x5f\151\x64"] = $data["\157\x72\144\145\x72\x5f\x69\144"]; goto Q4BMZ; Q4BMZ: $where["\x75\163\x65\x72\137\151\144"] = $data["\165\x73\145\162\x5f\151\x64"]; goto eysNE; Ka7hg: $this->UserOrder->startTrans(); goto AAV6z; bQEtQ: if (!empty($info)) { goto H3EGy; } goto AJu3v; AAV6z: try { goto fQY8C; d2z6s: zkJXK: goto nIIr_; q3Dc1: $dish = json_decode($json, true); goto kPvdi; PPATq: if (!empty($a)) { goto uuEaW; } goto Dt94W; A7dKD: WstvR: goto q3Dc1; hnv7s: $b = $this->UserOrder->where("\157\162\x64\145\162\x5f\151\144", $data["\x6f\162\x64\x65\x72\x5f\151\144"])->setInc("\141\x64\x64\137\160\x72\x69\x63\145", $data["\141\144\144\x5f\160\x72\151\143\x65"]); goto P7gTi; W_sWd: JQzNQ: goto DnmF2; mTcBY: if (!empty($c)) { goto WstvR; } goto tM4YI; kPvdi: if (!empty($dish)) { goto WF7PV; } goto BQFQv; aaMaJ: $time = time(); goto z6jQa; nIIr_: $c = $this->UserOrder->where("\157\x72\x64\x65\x72\137\151\144", $data["\157\162\144\x65\x72\x5f\x69\144"])->setInc("\160\141\171\137\155\x6f\x6e\145\x79", $data["\141\144\x64\x5f\x70\x72\151\143\145"]); goto mTcBY; tM4YI: throw new Exception("\350\xae\242\xe5\x8d\x95\xe5\210\x9b\345\273\xba\xe5\244\261\xe8\xb4\xa5\x30\60\63"); goto A7dKD; P7gTi: if (!empty($b)) { goto zkJXK; } goto jxDQM; Dt94W: throw new Exception("\350\xae\242\345\x8d\225\345\x88\x9b\xe5\273\xba\345\244\xb1\xe8\264\245\x30\x30\x31"); goto taOMn; OdtnG: foreach ($dish as $k => $v) { goto roRWw; m4eYB: G1dnV: goto oltiD; z3HZE: $new_data = ["\x6f\x72\x64\x65\x72\x5f\151\x64" => $data["\157\162\144\145\162\137\151\144"], "\x67\157\x6f\x64\x73\137\156\x61\x6d\145" => $info["\147\157\157\144\163\x5f\156\141\x6d\145"], "\160\162\x69\143\145" => $info["\x70\x72\x69\143\x65"], "\x6d\x63\x68\137\x69\144" => $info["\x6d\143\150\x5f\x69\144"], "\165\x73\145\162\137\151\x64" => $data["\x75\163\x65\x72\x5f\151\144"], "\x69\155\x67" => $info["\x69\x6d\141\147\145\163"], "\147\157\157\144\x73\137\151\144" => $k, "\156\x75\x6d\x62\x65\x72" => $v, "\x74\171\160\x65" => 1, "\143\x72\x65\141\164\x65\137\164\151\155\145" => $time]; goto LpJkF; Jcaug: WdxDv: goto m4eYB; roRWw: $info = $order_good->where("\147\x6f\157\144\163\137\x69\144", $k)->find(); goto TmT1s; LpJkF: $d = $this->OrderGoods->insert($new_data); goto lJbsj; oltiD: iufCq: goto Jfcqj; F4uI2: throw new Exception("\xe8\x8f\x9c\xe5\215\x95\xe5\x86\x99\xe5\205\245\xe5\xa4\261\350\xb4\xa5"); goto Jcaug; lJbsj: if (!empty($d)) { goto WdxDv; } goto F4uI2; TmT1s: if (!$info) { goto G1dnV; } goto z3HZE; Jfcqj: } goto W_sWd; DnmF2: $this->UserOrder->commit(); goto lXmWL; pUQHB: WF7PV: goto aaMaJ; BQFQv: throw new Exception("\xe8\217\x9c\345\215\225\344\xb8\x8d\xe8\x83\275\344\xb8\xba\347\xa9\xba"); goto pUQHB; jxDQM: throw new Exception("\xe8\256\242\xe5\x8d\x95\xe5\x88\233\xe5\273\xba\345\xa4\xb1\xe8\xb4\245\60\x30\62"); goto d2z6s; fQY8C: $a = $this->UserOrder->where("\x6f\162\x64\145\x72\x5f\x69\144", $data["\157\162\x64\145\162\x5f\x69\144"])->setInc("\x74\x6f\164\x61\154", $data["\164\157\x74\141\x6c"]); goto PPATq; z6jQa: $order_good = new Goods(); goto OdtnG; taOMn: uuEaW: goto hnv7s; lXmWL: } catch (Exception $e) { $this->UserOrder->rollback(); return ["\145\x72\x72\137\143\x6f\144\x65" => 1, "\x6d\x73\x67" => $e->getMessage()]; } goto vHsIg; AJu3v: return ["\145\x72\162\137\143\157\x64\x65" => 1, "\x6d\x73\147" => "\350\xaf\245\xe8\xae\xa2\xe5\215\x95\xe4\270\x8d\345\255\230\xe5\234\250"]; goto h1kYM; vHsIg: return "\345\212\240\xe8\x8f\234\xe6\x88\x90\345\x8a\x9f"; goto j2dwB; PJ9XP: $where["\x6f\162\x64\x65\x72\x5f\163\x74\x61\164\165\163"] = 1; goto NobMu; eysNE: $info = $this->UserOrder->where($where)->find(); goto bQEtQ; h1kYM: H3EGy: goto Ka7hg; j2dwB: } public function tuiOrder($data, $json) { goto gwX_g; Ft03p: return "\351\x80\200\xe8\217\x9c\346\x88\x90\345\212\237"; goto vlIrn; Nq4yK: try { goto iXqsZ; qz4gF: $c = $this->UserOrder->where("\157\162\144\x65\x72\x5f\151\x64", $data["\x6f\x72\x64\145\162\137\151\144"])->setDec("\x70\x61\x79\x5f\155\157\x6e\145\x79", $data["\x72\145\x64\x75\x63\x65\x5f\x70\x72\x69\x63\x65"]); goto b3I7V; rcWTR: throw new Exception("\xe8\xae\xa2\xe5\x8d\225\xe5\x88\x9b\xe5\273\xba\xe5\xa4\xb1\xe8\xb4\245\x30\x30\x31"); goto YHl20; ZyOab: foreach ($dish as $k => $v) { goto m4852; UU4Ch: $new_data = ["\x6f\x72\x64\145\162\137\151\x64" => $data["\157\x72\144\x65\162\x5f\151\x64"], "\147\157\x6f\144\163\x5f\156\x61\155\145" => $info["\x67\157\x6f\x64\163\137\x6e\x61\155\145"], "\160\162\151\x63\145" => $info["\160\x72\x69\x63\145"], "\155\143\x68\x5f\x69\144" => $info["\x6d\143\150\137\151\144"], "\165\163\x65\x72\137\151\x64" => $data["\165\163\145\162\137\x69\144"], "\151\155\147" => $info["\151\155\x61\147\145\163"], "\x67\157\157\144\163\x5f\151\x64" => $k, "\156\x75\x6d\x62\145\162" => $v, "\x74\171\x70\145" => 2, "\x63\162\x65\141\x74\x65\x5f\164\x69\155\145" => $time]; goto pKE9P; pnfli: if (!empty($d)) { goto yUNDs; } goto TSa53; n7Zpr: if (!$info) { goto gTym0; } goto UU4Ch; MoPmm: fvqwB: goto TJL2J; TSa53: throw new Exception("\xe8\217\x9c\xe5\215\225\345\206\x99\345\205\245\345\244\261\350\264\xa5"); goto CZkxG; m4852: $info = $order_good->where("\147\157\x6f\144\x73\x5f\x69\144", $k)->find(); goto n7Zpr; pKE9P: $d = $this->OrderGoods->insert($new_data); goto pnfli; lElVU: gTym0: goto MoPmm; CZkxG: yUNDs: goto lElVU; TJL2J: } goto QYvPm; FwVmH: $dish = json_decode($json, true); goto hf5yL; iXqsZ: $a = $this->UserOrder->where("\157\162\x64\145\x72\x5f\151\x64", $data["\x6f\x72\x64\145\x72\x5f\151\x64"])->setDec("\164\157\x74\x61\x6c", $data["\164\157\x74\x61\154"]); goto ozOqg; ljMV3: $time = time(); goto dNOvq; dNOvq: $order_good = new Goods(); goto ZyOab; hf5yL: if (!empty($dish)) { goto WO2to; } goto HHBgl; YSTGM: gcJku: goto qz4gF; W09H7: $b = $this->UserOrder->where("\157\x72\144\x65\162\x5f\x69\144", $data["\157\x72\144\145\x72\x5f\x69\144"])->setInc("\x72\x65\x64\165\x63\145\137\x70\x72\151\x63\145", $data["\x72\x65\144\165\143\145\137\x70\162\x69\x63\145"]); goto N84wn; YHl20: EDyEk: goto W09H7; NxZZP: $this->UserOrder->commit(); goto BnGwY; GB3ZV: uBkj7: goto FwVmH; oGSJ_: WO2to: goto ljMV3; eOkfk: throw new Exception("\350\xae\242\345\215\x95\345\210\x9b\xe5\273\xba\xe5\xa4\261\xe8\264\245\60\x30\61"); goto GB3ZV; HHBgl: throw new Exception("\350\x8f\x9c\345\215\x95\xe4\xb8\215\350\x83\xbd\344\270\xba\347\xa9\272"); goto oGSJ_; b3I7V: if (!empty($c)) { goto uBkj7; } goto eOkfk; i9ozM: throw new Exception("\xe8\256\xa2\xe5\x8d\x95\345\x88\233\xe5\273\272\345\xa4\261\xe8\xb4\245\60\x30\62"); goto YSTGM; QYvPm: e3P1d: goto NxZZP; ozOqg: if (!empty($a)) { goto EDyEk; } goto rcWTR; N84wn: if (!empty($b)) { goto gcJku; } goto i9ozM; BnGwY: } catch (Exception $e) { $this->UserOrder->rollback(); return ["\145\x72\162\x5f\143\x6f\144\145" => 1, "\155\x73\x67" => $e->getMessage()]; } goto Ft03p; lEwzO: $where["\x6f\x72\x64\145\x72\x5f\151\x64"] = $data["\157\162\144\x65\x72\137\x69\144"]; goto DubGS; Fwvmm: if (!empty($info)) { goto IG82b; } goto AYaWq; DubGS: $where["\x75\x73\145\162\137\x69\144"] = $data["\165\163\145\162\x5f\x69\144"]; goto fn1dO; AYaWq: return ["\x65\x72\x72\x5f\143\x6f\x64\x65" => 1, "\x6d\x73\x67" => "\xe8\xaf\xa5\350\xae\242\xe5\x8d\x95\xe4\xb8\x8d\345\255\230\xe5\234\xa8"]; goto hh7Km; fn1dO: $info = $this->UserOrder->where($where)->find(); goto Fwvmm; gwX_g: $where["\157\x72\x64\145\162\137\x73\x74\141\x74\x75\163"] = 1; goto lEwzO; hh7Km: IG82b: goto kQIoA; kQIoA: $this->UserOrder->startTrans(); goto Nq4yK; vlIrn: } public function tuigoodslist($data) { goto t2LC4; cHp3p: d54ia: goto Y3Pql; Y3Pql: return $list; goto THDay; ycB1p: foreach ($list as $k => $v) { goto zKayh; x7zGy: UyOD2: goto qOygk; mh1NZ: DTIwI: goto G6fxJ; YNDoY: $a = $this->OrderGoods->where($data)->where($where)->field("\147\157\157\144\x73\x5f\151\144\x2c\x73\165\x6d\50\156\165\x6d\x62\145\162\51\x20\x61\x73\x20\141\154\154\137\156\x75\x6d")->group("\147\x6f\x6f\x64\x73\137\x69\144")->find(); goto sFBAd; vzp3t: foreach ($pic->toArray() as $p_k => $p_v) { $pic[$p_k] = __IMG($p_v); XuZ_k: } goto mh1NZ; UwyLx: DP7TE: goto uKNC7; xrDpM: GCJbu: goto diXuV; sFBAd: if ($a) { goto UyOD2; } goto KdAfA; x3HTi: $pic = $imgas->where("\151\155\x67\137\151\x64", $v->img)->field("\151\x6d\x67\137\x63\x6f\166\x65\162\137\x62\151\x67\x2c\x69\x6d\147\x5f\x63\157\166\145\162\137\155\x69\x64\54\x69\155\x67\137\143\157\x76\x65\x72\x5f\x73\155\141\154\x6c")->find(); goto YU8dq; YU8dq: if (!$pic) { goto ddNvV; } goto vzp3t; qOygk: $v->total = $v->all_num - $a["\x61\154\x6c\x5f\156\x75\155"]; goto UwyLx; e8vb4: $imgas = new Images(); goto x3HTi; M_wJp: ddNvV: goto YNDoY; zKayh: $where = ["\164\171\x70\x65" => 2, "\x67\x6f\x6f\144\163\137\x69\144" => $v->goods_id]; goto e8vb4; qh8Mu: goto DP7TE; goto x7zGy; G6fxJ: $v["\x70\151\x63"] = $pic["\x69\x6d\x67\137\143\x6f\x76\x65\x72\x5f\155\151\144"]; goto M_wJp; KdAfA: $v->total = $v->all_num; goto qh8Mu; uKNC7: $v->wri_total = $v->total; goto xrDpM; diXuV: } goto cHp3p; t2LC4: $list = $this->OrderGoods->where($data)->where("\x74\171\160\x65", "\x69\x6e", "\60\54\61")->field("\147\157\x6f\x64\163\x5f\x69\144\54\x67\x6f\x6f\144\x73\137\x6e\x61\x6d\x65\54\151\x6d\147\x2c\160\162\151\143\145\54\x73\x75\x6d\x28\x6e\165\155\x62\145\x72\51\40\141\x73\40\x61\154\154\x5f\x6e\x75\155")->group("\x67\157\157\144\163\x5f\151\x64")->select(); goto ycB1p; THDay: } }
