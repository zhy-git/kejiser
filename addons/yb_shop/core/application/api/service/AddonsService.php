<?php
 namespace app\api\service; use app\common\model\Addons; class AddonsService { public function getAddonsList($page_index = 1, $page_size = 0, $condition = '', $order = '', $field = "\52") { goto PQyAV; rV0iT: iw15W: goto sS1Kf; nqCbO: $new_array["\144\141\164\141"] = $data; goto DOQTm; JGOC1: return "\x65\x72\x72\x6f\162"; goto qeIHz; mBy9Z: $dirs = array_map("\142\141\163\145\x6e\141\155\x65", glob($addon_dir . "\52", GLOB_ONLYDIR)); goto Huy1U; emXeD: $addon_dir = ADDON_PATH; goto mBy9Z; ssm6o: if (!($page_size == 0)) { goto ZCKF3; } goto BDJfK; Huy1U: if (!($dirs === FALSE || !file_exists($addon_dir))) { goto TWJqj; } goto JGOC1; NsiKT: $data[$i] = $addons[$i]; goto rV0iT; ChoyJ: $list = $yb_addons->getQuerys($where, "\52", "\x63\162\x65\141\x74\x65\137\x74\x69\155\x65\40\144\145\x73\143"); goto bXvvA; I9Q72: $addons = $this->list_sort_by($addons, "\x75\x6e\x69\x6e\163\x74\x61\x6c\154", "\144\x65\x73\x63"); goto E7i4J; ElOtR: $i++; goto yDg2E; E7i4J: $new_array = []; goto USqY2; qeIHz: TWJqj: goto nLzs_; ja1Iy: return $new_array; goto iMnTw; bXvvA: foreach ($list as $key => $value) { $list[$key] = $value->toArray(); VXma9: } goto BZn2p; DOQTm: $new_array["\164\x6f\164\x61\154\137\143\x6f\165\x6e\164"] = $total_count; goto YkUgE; BZn2p: vLoTG: goto kWAhx; BDJfK: $page_size = PAGE_NUM; goto UN3Fv; YkUgE: $new_array["\160\x61\x67\x65\137\143\157\x75\156\x74"] = $page_count; goto ja1Iy; PQyAV: $yb_addons = new Addons(); goto ssm6o; oq6Xc: foreach ($dirs as $value) { goto VxPCr; tKAK5: \think\Log::record("\346\x8f\222\xe4\273\xb6" . $value . "\xe7\232\x84\xe5\x85\245\345\x8f\xa3\346\226\x87\344\xbb\xb6\344\xb8\215\xe5\xad\230\345\234\250\357\274\201"); goto zYkon; yreST: A4DqB: goto rdgN2; Q2EUS: if (!$addons[$value]) { goto s5EeG; } goto OiuEs; igEqi: $addons[$value] = $obj->info; goto Q2EUS; VxPCr: if (isset($addons[$value])) { goto A4DqB; } goto jMTEB; OiuEs: $addons[$value]["\165\x6e\151\156\163\164\141\x6c\x6c"] = 1; goto KO9d1; q5zLt: gmXq1: goto LqFjG; KO9d1: unset($addons[$value]["\x73\x74\x61\164\x75\x73"]); goto JUQfW; ZIkWL: trace($class); goto tKAK5; LqFjG: $obj = new $class(); goto igEqi; JUQfW: s5EeG: goto yreST; zYkon: goto Qtaiy; goto q5zLt; bQfpj: if (class_exists($class)) { goto gmXq1; } goto ZIkWL; jMTEB: $class = get_addon_class($value); goto bQfpj; rdgN2: Qtaiy: goto mDHu0; mDHu0: } goto qp0bb; yDg2E: goto XjBN7; goto aeVWG; nLzs_: $addons = array(); goto gO1UD; ftN3K: $key_end = $page_index * $page_size - 1; goto UZVLl; O1f0t: XjBN7: goto cTmpZ; UN3Fv: ZCKF3: goto emXeD; sS1Kf: QqvCV: goto ElOtR; qp0bb: r9qFs: goto I9Q72; cTmpZ: if (!($i <= $key_end)) { goto G3G7_; } goto hwSWV; aeVWG: G3G7_: goto nqCbO; USqY2: $total_count = count($addons); goto TPfJj; kWAhx: foreach ($list as $addon) { goto mmPQk; HYq4t: $addons[$addon["\x6e\x61\x6d\x65"]] = $addon; goto ytsMN; mmPQk: $addon["\x75\156\151\156\163\x74\x61\154\x6c"] = 0; goto HYq4t; ytsMN: SjUCi: goto USETI; USETI: } goto QKh5D; gO1UD: $where["\156\x61\x6d\x65"] = array("\x69\156", $dirs); goto ChoyJ; hwSWV: if (empty($addons[$i])) { goto iw15W; } goto NsiKT; QKh5D: U1Eh3: goto oq6Xc; Tm1fg: $key_start = ($page_index - 1) * $page_size; goto ftN3K; TPfJj: $page_count = ceil($total_count / $page_size); goto Tm1fg; UZVLl: $i = $key_start; goto O1f0t; iMnTw: } protected function list_sort_by($list, $field, $sortby = "\x61\x73\x63") { goto LMuQk; DScld: BN2BL: goto reCoZ; LMuQk: if (!is_array($list)) { goto BN2BL; } goto Y1CFQ; IZNpv: foreach ($list as $i => $data) { $refer[$i] =& $data[$field]; ywfwx: } goto l2Ai8; c7AEj: qNmb6: goto vktNt; reCoZ: return false; goto IFC7M; GDUH2: foreach ($refer as $key => $val) { $resultSet[] =& $list[$key]; IondS: } goto WiiG8; Otsfx: return $resultSet; goto DScld; oPrq4: switch ($sortby) { case "\141\163\x63": asort($refer); goto kJPpY; case "\x64\145\163\x63": arsort($refer); goto kJPpY; case "\x6e\x61\x74": natcasesort($refer); goto kJPpY; } goto c7AEj; WiiG8: CAe50: goto Otsfx; Y1CFQ: $refer = $resultSet = array(); goto IZNpv; l2Ai8: Kpigu: goto oPrq4; vktNt: kJPpY: goto GDUH2; IFC7M: } }
