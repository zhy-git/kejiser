<?php
 namespace app\api\service; use think\Db; use think\log; require_once BASE_ROOT . "\x63\157\x72\x65\x2f\141\160\160\x6c\x69\143\141\x74\151\x6f\156\x2f\x63\x6f\x6d\x6d\x6f\156\56\160\x68\x70"; require_once BASE_ROOT . "\x63\x6f\162\145\x2f\145\170\164\x65\156\144\x2f\127\x78\160\x61\x79\57\x57\x78\x50\x61\171\56\x41\x70\x69\56\160\x68\160"; require_once BASE_ROOT . "\143\x6f\162\x65\57\141\x70\x70\x6c\x69\143\x61\164\151\157\x6e\57\141\144\x6d\151\x6e\x2f\x73\145\162\166\151\143\145\57\120\x72\151\x6e\164\145\162\x53\x65\162\166\x69\x63\x65\56\160\x68\x70"; require_once BASE_ROOT . "\x63\157\162\x65\57\141\x70\160\x6c\151\x63\141\164\x69\x6f\156\57\141\x70\x69\57\163\145\162\166\x69\x63\x65\57\x52\x65\x66\x75\x6e\x64\x53\145\x72\166\151\143\x65\x2e\160\150\x70"; use app\api\service\RefundService; use app\admin\service\PrinterService; class BargainService { public function barIndex($data) { goto yXXqg; yXXqg: $rs = array(); goto Mk5VI; EH1gM: return $rs; goto Fk0SC; Mk5VI: $rs["\x63\x61\x72\x6f\x75\163\x65\154"] = Db::name("\x79\142\163\x63\137\141\x70\160\154\x69\x63\x61\164\x69\157\156\137\x63\x61\162\x6f\165\x73\145\154")->where("\151\163\137\x75\x73\145", 0)->where($data)->order("\163\x6f\x72\x74", "\144\x65\x73\143")->order("\143\x72\145\141\x74\x65\137\x74\x69\x6d\145", "\144\145\x73\x63")->select(); goto vh8Y7; vh8Y7: $cate_info = Db::name("\171\x62\163\143\137\141\160\x70\x6c\151\143\141\x74\x69\157\x6e\137\x61\143\x74\x69\x76\151\164\x79\x5f\x63\154\x61\x73\x73")->where("\151\x73\x5f\x75\x73\145", 0)->where($data)->order("\x73\x6f\162\x74", "\144\x65\163\x63")->order("\143\x72\145\x61\x74\145\137\x74\x69\x6d\x65", "\x64\145\163\143")->select(); goto PvSFs; PvSFs: $rs["\143\x61\164\145\x5f\151\x6e\146\x6f"] = $cate_info; goto EH1gM; Fk0SC: } public function getBargainList($data, $page) { goto mMvzo; l6ST0: $new_data = []; goto A1156; TB9Ix: $bargain_list = Db::name("\171\x62\x73\x63\x5f\x62\141\162\x67\141\151\156")->where($new_data)->where("\x62\x61\x72\x67\141\x69\x6e\137\x74\x79\160\x65", "\x31")->whereTime("\x65\x6e\x64\137\164\151\x6d\145", "\x3e", time())->order("\x73\x6f\162\164", "\x64\x65\x73\143")->order("\x63\x72\145\x61\164\x65\x5f\164\151\155\x65", "\144\x65\163\x63")->page($page, PAGE_NUM)->select(); goto AEf8P; QqJGJ: fyICK: goto SjwGf; KRcZo: return $bargain_list; goto DK4Ut; e7GzY: if ($data["\x74\x79\x70\145"] == 2) { goto p4Bpm; } goto TB9Ix; h4noa: $bargain_list = Db::name("\x79\142\163\x63\137\x62\x61\x72\x67\x61\x69\x6e")->where($new_data)->where("\142\141\x72\147\141\x69\156\137\164\171\160\x65", "\61")->whereTime("\x73\164\141\x72\x5f\164\151\155\x65", "\74", time())->whereTime("\145\x6e\x64\x5f\x74\151\x6d\x65", "\x3e", time())->order("\x73\157\x72\x74", "\144\x65\163\143")->order("\x63\162\145\141\164\145\137\164\151\155\x65", "\144\145\163\x63")->page($page, PAGE_NUM)->select(); goto QqJGJ; DK4Ut: lWq3Z: goto MZcdL; pyQZ4: $new_data["\144\145\154"] = 0; goto SByd3; AEf8P: goto Y1d6Q; goto SOoNt; mMvzo: if (!empty($data["\x63\154\x61\163\x73\137\151\x64"])) { goto uCiGF; } goto l6ST0; HXMy5: uCiGF: goto h1ghj; MZcdL: foreach ($bargain_list as $key => $value) { goto EhgMu; EhgMu: $bargain_user_list = Db::name("\171\x62\163\143\137\x62\x61\x72\x67\x61\151\156\x5f\x75\x73\x65\x72")->where("\142\x61\162\147\x61\x69\x6e\137\x69\x64", $value["\151\x64"])->select(); goto ScibH; DyFcK: wpTHW: goto SwfKZ; sXgQa: $bargain_list[$key]["\x70\151\143"] = $pic; goto DyFcK; BTSmP: if (!$pic) { goto wpTHW; } goto sXgQa; mVCnE: h0p7D: goto JoWrq; JoWrq: $bargain_list[$key]["\x75\163\x65\162"] = $user_list; goto VDgDn; VDgDn: T0hND: goto w39mX; ScibH: $pic = Db::name("\171\142\163\143\x5f\151\x6d\x61\147\x65\x73")->where("\151\x6d\147\137\151\144", $value["\142\141\x72\x67\141\151\156\137\x70\x69\143\164\x75\162\145"])->field("\x69\155\x67\137\143\x6f\x76\145\x72\x2c\x69\x6d\x67\x5f\x63\157\x76\145\162\137\142\151\x67\54\x69\155\147\137\x63\x6f\166\x65\162\x5f\x6d\151\144\x2c\151\155\147\137\143\157\166\145\x72\x5f\x73\155\x61\154\x6c")->find(); goto BTSmP; SwfKZ: $user_list = array(); goto paZZn; paZZn: foreach ($bargain_user_list as $user_key => $user_value) { goto V6iME; pm6aX: $user_list[$user_key] = $user_info; goto IwETq; V6iME: $user_info = Db::name("\x79\x62\163\x63\x5f\x75\163\145\162")->field("\165\163\x65\x72\137\150\145\141\144\151\155\x67\54\156\151\143\x6b\137\156\141\155\145")->where("\x75\151\x64", $user_value["\165\163\145\x72\x5f\x69\144"])->find(); goto pm6aX; IwETq: FZ50H: goto CAMrv; CAMrv: } goto mVCnE; w39mX: } goto KwQQ3; SByd3: if ($data["\164\171\160\x65"] == 1) { goto BR538; } goto e7GzY; A1156: goto xbqNs; goto HXMy5; KwQQ3: lQA1S: goto NvJwE; SjwGf: if (!empty($bargain_list)) { goto lWq3Z; } goto KRcZo; oFUVz: Y1d6Q: goto M8_p5; Na7VH: BR538: goto h4noa; h1ghj: $new_data = ["\x63\x6c\141\163\x73\137\x69\144" => $data["\x63\154\x61\163\163\x5f\151\x64"]]; goto tEX7p; SOoNt: p4Bpm: goto x4s95; NvJwE: return $bargain_list; goto HM74Z; tEX7p: xbqNs: goto qNY2S; M8_p5: goto fyICK; goto Na7VH; x4s95: $bargain_list = Db::name("\x79\x62\x73\143\x5f\142\x61\162\x67\x61\151\156")->where($new_data)->where("\x62\141\162\x67\141\x69\x6e\137\x74\x79\x70\x65", "\61")->whereTime("\x73\x74\x61\162\x5f\x74\151\x6d\x65", "\x3e", time())->order("\x73\x6f\x72\164", "\144\145\x73\x63")->order("\x63\x72\145\141\x74\145\x5f\164\151\x6d\x65", "\144\145\163\x63")->page($page, PAGE_NUM)->select(); goto oFUVz; qNY2S: $new_data["\x6d\143\x68\x5f\151\144"] = $data["\x6d\143\x68\x5f\x69\x64"]; goto pyQZ4; HM74Z: } public function get_kjGoodsmodel($data) { goto z6zBZ; eAsK8: return $bargain_list; goto qd2wx; ZmJwV: if (!empty($bargain_list)) { goto rKKYF; } goto ATGY_; dEafW: rKKYF: goto L6WD3; ATGY_: return $bargain_list; goto dEafW; jftIj: $bargain_list = Db::name("\171\142\163\143\137\x62\x61\162\147\141\x69\156")->where($data)->select(); goto ZmJwV; z6zBZ: $data["\144\x65\154"] = 0; goto jftIj; LIhYU: D4BAQ: goto eAsK8; L6WD3: foreach ($bargain_list as $key => $value) { goto R6xMC; NW_qY: XoQxW: goto VW76V; Hvspy: $user_list = array(); goto dSqJL; VW76V: $bargain_list[$key]["\165\163\145\x72"] = $user_list; goto oF8l5; Tn5lk: $pic = Db::name("\x79\x62\x73\x63\137\x69\x6d\141\x67\x65\x73")->where("\x69\155\x67\137\x69\x64", $value["\x62\141\x72\x67\141\151\x6e\137\160\x69\x63\x74\x75\162\x65"])->field("\151\155\x67\x5f\x63\x6f\x76\145\x72\x2c\151\x6d\147\137\x63\157\x76\x65\162\137\x62\x69\147\54\x69\155\147\x5f\143\157\x76\x65\x72\x5f\x6d\x69\144\54\151\155\x67\137\x63\x6f\x76\145\162\x5f\x73\x6d\141\154\x6c")->find(); goto uscM3; wc0nn: OUd8X: goto Hvspy; oF8l5: $bargain_list[$key]["\x75\x73\x65\x72\137\x6e\165\155"] = count($user_list); goto rqWLd; rqWLd: oyP1e: goto c7cb8; R6xMC: $bargain_user_list = Db::name("\x79\x62\163\143\137\x62\141\162\x67\141\151\156\x5f\x75\x73\145\x72")->where("\x62\141\162\147\x61\151\x6e\137\x69\144", $value["\x69\144"])->select(); goto Tn5lk; dSqJL: foreach ($bargain_user_list as $user_key => $user_value) { goto smC54; smC54: $user_info = Db::name("\x79\142\x73\x63\x5f\x75\163\x65\x72")->field("\165\163\145\x72\137\150\x65\141\x64\x69\155\x67\x2c\156\151\x63\153\137\x6e\141\155\x65")->where("\165\151\144", $user_value["\x75\x73\x65\x72\137\x69\x64"])->find(); goto R_RKR; s_WAW: DIQKr: goto U8LkR; R_RKR: $user_list[$user_key] = $user_info; goto s_WAW; U8LkR: } goto NW_qY; uscM3: if (!$pic) { goto OUd8X; } goto l5XHI; l5XHI: $bargain_list[$key]["\x70\x69\x63"] = $pic; goto wc0nn; c7cb8: } goto LIhYU; qd2wx: } public function getGoodsInfo($data) { goto oZtXc; QKSK_: $rs["\x61\x62\x6f\165\x74\x5f\x69\156\x66\157"] = $about_info; goto tsVVH; oZtXc: $rs = array(); goto x1I9a; pCIWt: XeXyf: goto zTgAs; Duq0Q: $bargain_info["\x70\151\143\137\x61\x72\162"] = $pic_arr; goto L2dXh; vwqzw: ArHyF: goto mxe2_; zTgAs: $i++; goto qWrS5; LANgf: VxobI: goto POzbn; q1leE: if (!$pic) { goto c1NUT; } goto lw9bd; L2dXh: $rs["\x62\141\x72\x67\141\x69\156\137\x69\156\x66\157"] = $bargain_info; goto rk8OP; POzbn: SOU7D: goto Duq0Q; mxe2_: if (!($i < count($pic_array))) { goto VxobI; } goto Hr_J5; qWrS5: goto ArHyF; goto LANgf; Hr_J5: $pic_arr[$i] = Db::name("\171\x62\163\143\137\151\155\141\x67\x65\163")->where("\151\155\x67\137\151\x64", $pic_array[$i])->value("\x69\155\147\x5f\143\x6f\x76\x65\162"); goto pCIWt; rk8OP: $about_info = Db::name("\x79\x62\163\143\x5f\x62\165\x73\x69\156\x65\163\163\x5f\x61\x62\157\x75\164")->where("\155\x63\x68\x5f\151\144", $data["\155\143\150\x5f\151\x64"])->find(); goto QKSK_; Heste: $i = 0; goto vwqzw; lw9bd: $bargain_info["\160\151\143"] = $pic; goto LGXI6; tsVVH: return $rs; goto JKi8W; fzunZ: if (!$bargain_info["\x69\x6d\147\x5f\x69\x64\x5f\141\x72\162\141\x79"]) { goto SOU7D; } goto bsFuh; x1I9a: $bargain_info = Db::name("\171\x62\x73\143\137\x62\x61\162\x67\x61\x69\156")->where($data)->where("\x62\x61\x72\x67\x61\x69\x6e\137\x74\x79\x70\x65", "\x31")->find(); goto lhzbG; LGXI6: c1NUT: goto wKzAq; lhzbG: Db::name("\171\x62\x73\x63\137\x62\141\162\x67\x61\151\x6e")->where($data)->setInc("\x63\x68\x65\143\153\x5f\156\x75\x6d\x62\x65\x72"); goto S8FQF; bsFuh: $pic_array = explode("\54", $bargain_info["\151\155\147\x5f\151\144\x5f\x61\x72\162\141\x79"]); goto Heste; S8FQF: $pic = Db::name("\171\x62\163\143\x5f\x69\155\x61\x67\145\x73")->where("\151\x6d\147\137\151\x64", $bargain_info["\x62\x61\162\x67\141\x69\156\x5f\160\151\143\x74\165\x72\x65"])->value("\x69\155\147\137\x63\x6f\x76\x65\x72"); goto q1leE; wKzAq: $pic_arr = array(); goto fzunZ; JKi8W: } public function getBargainInfo($data) { goto zyJ4z; k9FkB: $pic = Db::name("\171\x62\163\x63\x5f\x69\x6d\x61\x67\145\x73")->where("\x69\155\x67\x5f\151\144", $bargain_info["\142\x61\162\147\141\151\x6e\137\x70\x69\143\164\165\162\x65"])->value("\x69\x6d\x67\137\x63\157\x76\x65\162"); goto F732P; X_u5q: $pic_arr[$i] = Db::name("\171\142\163\x63\137\x69\x6d\141\x67\x65\163")->where("\151\155\x67\x5f\x69\x64", $pic_array[$i])->value("\x69\155\x67\137\143\x6f\166\145\x72"); goto bAyPl; KvzUk: $pic_array = explode("\54", $bargain_info["\x69\x6d\x67\137\x69\x64\x5f\141\162\162\141\x79"]); goto lu9cV; mO874: $bargain_info["\x70\151\x63"] = $pic; goto xorZx; t7ZF1: $user_info = Db::name("\171\142\163\143\137\x62\141\162\147\x61\151\x6e\137\165\x73\x65\x72")->where("\142\x61\162\147\141\x69\156\137\x69\144", $data["\x69\x64"])->where("\165\163\x65\162\x5f\151\x64", $data["\165\163\145\162\137\x69\144"])->find(); goto Cc2gn; gatel: $bargain_info["\x70\x69\x63\137\141\x72\x72"] = $pic_arr; goto h3uBA; bAyPl: HHYhn: goto NDgKv; kD7Ze: goto tdokF; goto jN9vY; xorZx: KpitY: goto lLjcE; lLjcE: $pic_arr = array(); goto go0V1; jN9vY: iwV8d: goto e_9u3; NDgKv: $i++; goto kD7Ze; xURMY: $bargain_info = Db::name("\171\x62\163\143\137\x62\141\162\x67\x61\151\156")->where("\x6d\143\x68\x5f\x69\144", $data["\x6d\x63\x68\x5f\151\x64"])->where("\x69\144", $data["\151\144"])->where("\x62\141\162\147\141\x69\x6e\137\164\171\x70\145", "\x31")->find(); goto k9FkB; WKwit: $user_info["\x75\x73\145\162\x5f\150\145\141\144\151\x6d\147"] = $user_data["\165\x73\x65\x72\x5f\x68\145\141\144\x69\x6d\x67"]; goto BZlLv; JIzzQ: if (!($i < count($pic_array))) { goto iwV8d; } goto X_u5q; t8Y_f: return $rs; goto NWOZG; lu9cV: $i = 0; goto BVGue; Cc2gn: $user_data = Db::name("\x79\x62\163\x63\x5f\165\163\x65\x72")->field("\165\x73\x65\x72\x5f\x68\x65\x61\x64\151\x6d\147\x2c\x6e\x69\143\x6b\137\x6e\x61\155\x65")->where("\165\x69\x64", $user_info["\165\x73\145\x72\x5f\x69\144"])->find(); goto WKwit; BVGue: tdokF: goto JIzzQ; s9uB6: $rs["\x75\163\x65\x72\x5f\x69\x6e\x66\157"] = $user_info; goto t8Y_f; e_9u3: pNeuS: goto gatel; h3uBA: $rs["\x62\141\162\x67\141\151\x6e\137\151\156\x66\x6f"] = $bargain_info; goto t7ZF1; go0V1: if (!$bargain_info["\x69\155\147\x5f\151\144\137\x61\162\x72\141\x79"]) { goto pNeuS; } goto KvzUk; zyJ4z: $rs = array(); goto xURMY; F732P: if (!$pic) { goto KpitY; } goto mO874; BZlLv: $user_info["\156\x69\x63\x6b\137\x6e\141\155\145"] = $user_data["\x6e\151\x63\153\x5f\x6e\141\155\145"]; goto s9uB6; NWOZG: } public function BargainCreate($data) { goto IPy3b; kHE3r: $data["\143\x75\162\162\145\156\164\x5f\160\x72\x69\143\x65"] = $bargain_info["\x6f\162\x69\147\151\156\141\x6c\x5f\160\x72\x69\143\145"] - $bargain_price; goto J0DgY; EAN0D: $bargain_price = ($bargain_info["\157\x72\151\147\151\x6e\141\154\x5f\160\x72\x69\143\145"] - $bargain_info["\x6c\157\167\145\x73\x74\137\160\162\x69\143\145"]) / $bargain_info["\x63\157\155\x70\x6c\145\164\x65\x64\x5f\156\165\155\x62\145\162"]; goto kHE3r; OmReu: if (empty($bargain_info)) { goto xIjGp; } goto uov_n; EL60a: $data["\154\157\x77\145\163\x74\137\160\x72\151\143\145"] = $bargain_info["\x6c\x6f\167\x65\163\x74\137\x70\x72\151\143\x65"]; goto EAN0D; gH_1B: return $info["\142\141\162\147\x61\x69\156\137\160\162\x69\x63\145"]; goto mujWs; J0DgY: $data["\151\x6e\151\x74\151\141\x74\145\144\x5f\x74\x69\155\145"] = time(); goto bBEqE; hpdS_: try { goto Dai5O; Dai5O: $in_id = Db::name("\x79\142\x73\143\x5f\142\x61\x72\x67\x61\x69\156\x5f\x75\x73\145\162")->strict(true)->insertGetId($data); goto yzS64; yzS64: $help_data = array("\x75\163\145\x72\137\151\144" => $data["\165\x73\145\x72\137\151\144"], "\151\x49\156\151\x74\x69\x61\164\145\144\137\151\x64" => $in_id, "\x62\x61\162\147\x61\x69\x6e\137\160\162\151\143\x65" => $bargain_price, "\x63\x72\x65\141\x74\145\137\164\151\x6d\145" => time(), "\142\x61\154\141\x6e\x63\x65\x5f\160\162\x69\143\x65" => $data["\x63\165\x72\x72\145\x6e\x74\137\160\x72\x69\143\x65"]); goto IVukL; IVukL: $help_id = Db::name("\x79\142\x73\x63\x5f\142\141\x72\147\141\x69\156\137\150\x65\x6c\160")->strict(true)->insertGetId($help_data); goto UuWZs; UuWZs: Db::name("\171\x62\163\143\137\x62\x61\162\x67\x61\x69\x6e")->where("\151\144", $data["\142\x61\162\x67\141\151\x6e\137\151\144"])->setInc("\x70\x61\x72\x74\151\143\151\x70\x61\156\164\x73\137\x6e\165\x6d\142\145\162"); goto oPm4O; XXKfu: Db::commit(); goto nYsQ5; oPm4O: Db::name("\171\x62\x73\143\x5f\x62\141\x72\147\x61\x69\x6e")->where("\151\144", $data["\142\x61\162\147\x61\x69\x6e\137\151\x64"])->setInc("\x68\x65\x6c\160\x5f\x6e\x75\155\x62\145\162"); goto XXKfu; nYsQ5: } catch (\Exception $e) { Db::rollback(); return null; } goto yTkfK; bBEqE: Db::startTrans(); goto hpdS_; tqZev: $data["\x67\157\157\144\163\137\x69\144"] = $bargain_info["\x67\x6f\x6f\x64\x73\x5f\151\144"]; goto gRydl; J1DDI: return "\154\157\163\x65"; goto swxnD; uov_n: return "\x65\x78\x69\x73\164"; goto N_C7g; swxnD: g5Pc2: goto tqZev; yTkfK: $info = Db::name("\x79\142\x73\x63\137\x62\141\162\147\141\x69\x6e\x5f\x68\145\154\x70")->where("\151\x64", $help_id)->find(); goto gH_1B; gRydl: $data["\x6f\162\151\x67\x69\x6e\141\x6c\137\160\x72\151\143\145"] = $bargain_info["\x6f\x72\151\147\x69\x6e\x61\x6c\137\160\x72\151\143\x65"]; goto EL60a; cyYbj: $bargain_info = Db::name("\x79\x62\x73\x63\137\142\141\x72\x67\x61\151\x6e")->where("\151\144", $data["\142\x61\162\147\x61\151\156\137\x69\144"])->where("\x62\141\162\147\x61\x69\x6e\x5f\x74\171\160\145", "\61")->where("\142\x61\x72\147\141\x69\x6e\137\151\156\166\145\x6e\164\x6f\x72\x79", "\x3c\x3e", 0)->whereTime("\x73\x74\141\162\x5f\164\151\155\x65", "\74", time())->whereTime("\145\x6e\144\137\x74\x69\155\x65", "\76", time())->find(); goto mwAQb; N_C7g: xIjGp: goto cyYbj; IPy3b: $bargain_info = Db::name("\x79\142\x73\143\137\x62\x61\x72\147\141\151\156\137\165\x73\x65\162")->where("\165\163\145\162\137\151\x64", $data["\x75\x73\x65\162\x5f\151\144"])->where("\142\x61\x72\x67\141\151\156\137\151\144", $data["\x62\141\162\x67\141\151\x6e\x5f\x69\x64"])->find(); goto OmReu; mwAQb: if (!empty($bargain_info)) { goto g5Pc2; } goto J1DDI; mujWs: } public function randomFloat($min = 0, $max = 1) { $num = $min + mt_rand() / mt_getrandmax() * ($max - $min); return sprintf("\x25\56\x32\x66", $num); } public function BargainHelp($data) { goto PsiDQ; QfpnG: if (!empty($user_info)) { goto xWG1Z; } goto KBSSg; GfYqe: $data["\154\157\167\145\163\x74\137\x70\x72\x69\143\x65"] = $bargain_info["\154\157\167\145\163\x74\137\x70\x72\x69\x63\x65"]; goto Qdc1Q; LpVyp: $user_info = Db::name("\x79\142\163\143\x5f\x62\x61\x72\147\x61\151\156\x5f\165\x73\145\162")->where("\x69\x64", $data["\x69\111\x6e\151\164\x69\141\x74\x65\x64\137\x69\144"])->find(); goto QfpnG; t7cD0: if (!empty($bargain_info)) { goto F2q7t; } goto c_I18; IIifD: try { goto jnfzS; ofh9K: Db::name("\x79\x62\163\143\x5f\142\141\x72\147\x61\151\x6e\137\x75\x73\x65\162")->where("\x69\x64", $data["\151\111\156\151\x74\x69\141\164\x65\x64\137\x69\x64"])->setDec("\143\x75\162\x72\x65\x6e\x74\137\x70\x72\151\143\145", $bargain_price); goto m1yEp; bVxit: $help_id = Db::name("\171\142\163\143\x5f\142\141\162\x67\141\151\x6e\x5f\x68\145\154\160")->strict(true)->insertGetId($help_data); goto ofh9K; jnfzS: $help_data = array("\165\x73\x65\x72\x5f\x69\x64" => $data["\165\x73\x65\162\137\151\144"], "\151\x49\x6e\151\164\151\x61\x74\x65\144\x5f\x69\x64" => $data["\x69\111\x6e\x69\x74\x69\x61\x74\x65\144\x5f\151\144"], "\142\141\162\147\141\x69\x6e\137\160\162\x69\143\x65" => $bargain_price, "\x63\x72\x65\x61\164\x65\137\164\x69\x6d\x65" => time(), "\x62\x61\x6c\141\156\x63\145\137\x70\162\x69\143\x65" => $data["\x62\141\x6c\x61\156\143\x65\137\x70\162\151\143\145"]); goto bVxit; m1yEp: Db::name("\171\x62\163\x63\137\142\x61\x72\x67\x61\x69\156")->where("\151\144", $user_info["\x62\141\x72\x67\x61\x69\x6e\x5f\x69\x64"])->setInc("\150\145\x6c\x70\x5f\156\x75\155\x62\145\162"); goto S93vP; S93vP: Db::commit(); goto UD_31; UD_31: } catch (\Exception $e) { Db::rollback(); return null; } goto NpJiM; GOXXn: return "\x6d\x61\x78"; goto KuKr1; Qdc1Q: if ($bargain_info["\143\157\155\160\154\x65\164\145\x64\x5f\156\165\155\x62\x65\x72"] - $help_count == 1) { goto aHsk7; } goto xVoNT; PsiDQ: $help_info = Db::name("\x79\x62\163\x63\x5f\142\x61\x72\147\141\151\x6e\137\150\x65\154\x70")->where($data)->find(); goto qbXDX; KBSSg: return "\142\141\x72\147\141\x69\156\x5f\x6c\157\163\145"; goto vQAqF; TKhPY: lPOdL: goto GOXXn; NpJiM: goto rL0Xd; goto TKhPY; tTMvR: NLi4G: goto EGZCP; v4OTy: if ($help_count == $bargain_info["\x63\x6f\155\x70\x6c\145\x74\145\144\x5f\156\165\x6d\142\x65\x72"]) { goto lPOdL; } goto ts7Y0; msrIS: $help_count = Db::name("\171\142\163\x63\x5f\x62\x61\162\x67\141\151\x6e\137\x68\145\154\x70")->where("\x69\111\x6e\151\x74\151\141\x74\145\x64\137\151\144", $data["\x69\111\156\151\164\x69\x61\x74\145\144\137\151\144"])->count(); goto v4OTy; EGZCP: $data["\142\x61\x6c\x61\x6e\143\x65\137\160\x72\x69\x63\x65"] = $user_info["\x63\165\162\162\x65\x6e\164\x5f\x70\162\151\x63\145"] - $bargain_price; goto b5Hr2; H7ZcO: aHsk7: goto bhTq6; FryiU: return "\145\x78\x69\163\x74"; goto svfn0; hdL9M: $info = Db::name("\x79\142\x73\x63\137\142\x61\x72\x67\x61\x69\x6e\137\150\145\154\160")->where("\x69\x64", $help_id)->find(); goto pmtBs; c_I18: return "\154\157\163\x65"; goto U09hF; ts7Y0: $help_price = Db::name("\x79\142\163\x63\137\142\141\162\147\141\x69\156\x5f\x68\145\x6c\160")->where("\x69\111\x6e\x69\x74\151\141\164\x65\144\x5f\151\x64", $data["\x69\x49\156\151\x74\151\141\164\145\x64\x5f\151\x64"])->sum("\x62\x61\x72\x67\141\151\x6e\137\160\162\x69\x63\x65"); goto XS9Uy; KSWsI: $bargain_price = $this->randomFloat($bargain_price * 0.5, $bargain_price * 1.5); goto U3N_k; XS9Uy: $data["\x6f\162\151\x67\x69\x6e\x61\154\137\x70\x72\151\x63\x65"] = $bargain_info["\157\162\151\147\151\x6e\141\x6c\x5f\160\x72\x69\x63\145"]; goto GfYqe; YuYHY: $bargain_info = Db::name("\x79\x62\163\143\137\142\x61\162\x67\141\x69\x6e")->where("\151\x64", $user_info["\x62\141\162\x67\x61\151\156\137\x69\x64"])->where("\142\x61\x72\147\141\x69\156\137\x74\171\160\x65", "\61")->whereTime("\163\164\x61\x72\137\x74\151\x6d\145", "\74", time())->whereTime("\145\x6e\x64\137\164\x69\x6d\145", "\76", time())->find(); goto t7cD0; svfn0: P7mJI: goto LpVyp; U3N_k: goto NLi4G; goto H7ZcO; U09hF: F2q7t: goto msrIS; vQAqF: xWG1Z: goto YuYHY; bhTq6: $bargain_price = $user_info["\143\165\x72\162\x65\156\x74\137\x70\162\x69\x63\x65"] - $bargain_info["\154\x6f\167\x65\x73\164\x5f\x70\162\151\143\x65"]; goto tTMvR; pmtBs: return $info["\x62\141\162\x67\x61\x69\156\x5f\160\162\151\143\145"]; goto OsqmF; b5Hr2: Db::startTrans(); goto IIifD; xVoNT: $bargain_price = ($user_info["\143\165\162\x72\145\156\x74\x5f\x70\162\x69\x63\x65"] - $bargain_info["\x6c\x6f\167\145\x73\x74\137\160\162\151\143\x65"]) / ($bargain_info["\x63\157\x6d\x70\154\x65\164\x65\144\x5f\x6e\165\155\142\x65\x72"] - $help_count); goto KSWsI; qbXDX: if (empty($help_info)) { goto P7mJI; } goto FryiU; KuKr1: rL0Xd: goto hdL9M; OsqmF: } public function getBargainRecord($data) { goto FEIWM; Y8C84: return $help_list; goto P5U97; gpF9m: o3tP1: goto Y8C84; Rn03y: foreach ($help_list as $key => $value) { goto a1_vl; YxaMR: MWRNd: goto Efg5c; IQ6n6: $help_list[$key]["\165\163\145\162\x5f\x68\x65\141\x64\x69\155\x67"] = $user_data["\165\163\145\162\137\x68\x65\x61\144\x69\x6d\147"]; goto jIERr; a1_vl: $user_data = Db::name("\x79\x62\x73\x63\137\165\x73\145\162")->field("\x75\163\x65\x72\137\150\145\141\x64\151\155\147\x2c\x6e\151\x63\x6b\x5f\156\141\155\x65")->where("\165\151\x64", $value["\x75\163\145\x72\x5f\x69\x64"])->find(); goto IQ6n6; jIERr: $help_list[$key]["\x6e\x69\143\153\x5f\x6e\x61\155\x65"] = $user_data["\x6e\x69\143\153\137\x6e\141\x6d\145"]; goto YxaMR; Efg5c: } goto gpF9m; FEIWM: $help_list = null; goto Zn11A; Zn11A: $help_list = Db::name("\171\x62\x73\x63\x5f\142\141\x72\x67\x61\x69\x6e\137\x68\145\x6c\160")->where("\151\111\x6e\x69\x74\151\x61\x74\x65\x64\137\151\x64", $data["\x69\111\x6e\x69\164\x69\x61\x74\145\144\x5f\x69\144"])->select(); goto Rn03y; P5U97: } public function getMyBargain($data, $page) { goto psGgF; nBaGo: return $user_list; goto SYNty; psGgF: $user_list = Db::name("\x79\x62\163\x63\137\x62\x61\x72\147\141\x69\x6e\x5f\x75\x73\x65\x72")->where("\x75\x73\x65\x72\137\x69\144", $data["\165\163\x65\162\x5f\151\144"])->order("\x69\156\151\x74\x69\x61\x74\145\144\137\x74\x69\155\145", "\144\145\163\x63")->page($page, PAGE_NUM)->select(); goto db2fx; db2fx: foreach ($user_list as $key => $value) { goto SGBwB; tp1Cq: WE99B: goto lKBv0; sMCWG: v2_u6: goto BtlB3; E8_aN: $user_list[$key]["\157\x72\x64\x65\162\x5f\x73\164\141\x74\x75\x73"] = $order_info["\157\162\x64\145\162\x5f\163\x74\141\x74\165\x73"]; goto qvDkb; C1p2y: $help_num = Db::name("\171\x62\x73\x63\x5f\142\141\162\147\141\151\x6e\137\x68\145\154\160")->where("\x69\x49\x6e\x69\164\151\x61\164\x65\144\137\x69\144", $value["\151\144"])->count(); goto YPCwU; SHrsQ: $user_list[$key]["\142\x61\162\147\141\151\156\x5f\x6e\141\155\x65"] = $bargain_info["\142\x61\x72\x67\x61\151\x6e\137\x6e\x61\x6d\x65"]; goto WZ_s2; NsdCb: if (!$pic) { goto EQFhI; } goto Jae7Z; lKBv0: $pic = Db::name("\x79\142\163\143\x5f\151\x6d\x61\147\145\163")->where("\x69\x6d\x67\x5f\151\x64", $bargain_info["\142\141\x72\x67\x61\151\156\137\160\x69\x63\x74\165\x72\x65"])->field("\151\x6d\147\x5f\143\157\x76\x65\162\x2c\x69\155\147\137\x63\x6f\166\145\162\x5f\142\151\147\x2c\151\x6d\x67\x5f\143\157\x76\145\x72\x5f\155\x69\x64\54\151\x6d\147\137\x63\157\x76\145\162\x5f\x73\155\141\x6c\154")->find(); goto NsdCb; Jae7Z: $user_list[$key]["\x70\x69\x63"] = $pic; goto YDpPp; YDpPp: EQFhI: goto C1p2y; WZ_s2: $user_list[$key]["\x73\164\141\x72\137\164\151\155\145"] = $bargain_info["\x73\164\141\x72\137\x74\x69\x6d\x65"]; goto Dyo6k; Dyo6k: $user_list[$key]["\145\156\x64\137\164\151\x6d\x65"] = $bargain_info["\145\156\144\137\x74\x69\x6d\145"]; goto GJGJN; SGBwB: $bargain_info = Db::name("\x79\142\163\143\x5f\x62\x61\162\147\x61\x69\x6e")->where("\x69\x64", $value["\x62\x61\x72\147\x61\151\x6e\137\x69\144"])->find(); goto SHrsQ; qvDkb: if (!($order_info["\x6f\162\x64\145\162\137\x73\x74\141\x74\x75\163"] === null)) { goto WE99B; } goto e3SMQ; YPCwU: $user_list[$key]["\x68\x65\x6c\160"] = $help_num; goto sMCWG; e3SMQ: $user_list[$key]["\x6f\x72\x64\145\162\x5f\163\164\x61\164\165\163"] = -2; goto tp1Cq; GJGJN: $user_list[$key]["\x63\x6f\x6e\163\165\x6d\160\x74\151\x6f\156\x5f\164\x69\x6d\145"] = $bargain_info["\x63\x6f\156\163\165\155\160\164\x69\157\156\x5f\x74\151\x6d\145"]; goto hH9AA; M7UXH: $order_info = Db::name("\x79\x62\x73\x63\137\x62\x61\162\x67\x61\x69\156\137\x6f\162\x64\145\162")->field("\157\x72\144\x65\x72\x5f\x73\x74\x61\x74\x75\x73")->where("\x62\165\171\145\x72\x5f\x69\x64", $data["\x75\x73\x65\x72\x5f\x69\x64"])->where("\x62\141\x72\x67\x61\151\x6e\x5f\x69\x64", $value["\142\x61\x72\x67\141\x69\x6e\137\x69\144"])->where("\141\143\x74\x69\166\151\x74\171\x5f\157\162\x64\145\162\137\x74\x79\x70\x65", 1)->find(); goto E8_aN; hH9AA: $user_list[$key]["\x63\157\x6e\x73\x75\x6d\x70\164\x69\157\x6e\164\x69\x6d\x65"] = date("\131\55\155\55\x64\x20\x48\x3a\x69", $bargain_info["\x63\157\156\163\x75\x6d\x70\x74\151\157\x6e\x5f\164\151\x6d\x65"]); goto M7UXH; BtlB3: } goto hU_Yu; hU_Yu: mDJ6_: goto nBaGo; SYNty: } public function createOrder($data) { goto Hsox2; q1MuK: $data["\157\162\x69\147\151\156\x61\154\x5f\160\x72\x69\x63\x65"] = $info["\157\162\x69\147\151\156\141\x6c\x5f\160\162\151\143\x65"]; goto df_wT; bVPUJ: VqYKw: goto i9KQI; sMS7D: $data["\x62\141\x72\147\x61\x69\156\x5f\156\141\x6d\145"] = $info["\x62\x61\162\x67\x61\151\156\137\156\x61\155\x65"]; goto QR_7d; PobJR: try { goto BRER0; nQT5k: if (!$id) { goto NDJec; } goto t6fQ2; EVzRW: C_4v_: goto ExI4u; t6fQ2: $pp = new PrinterService($data["\x6d\x63\x68\x5f\x69\x64"], $id, "\x6f\162\144\x65\x72", 1); goto nfWBG; tllPY: if (!(isset($data["\x62\x61\x72\x67\141\151\156\137\151\144"]) && $data["\141\x63\164\151\x76\151\x74\171\x5f\x6f\x72\144\145\x72\x5f\x74\x79\x70\145"] == 1)) { goto C_4v_; } goto myu_g; myu_g: Db::name("\171\142\x73\143\137\142\x61\162\147\141\x69\156")->where("\x69\144", $data["\x62\141\x72\x67\x61\151\156\137\x69\x64"])->setDec("\142\x61\162\147\x61\151\156\137\151\156\x76\x65\x6e\x74\x6f\162\x79"); goto EVzRW; ExI4u: Db::commit(); goto HV00C; BRER0: $id = Db::name("\x79\142\x73\x63\x5f\142\x61\162\x67\x61\x69\156\137\x6f\162\x64\145\162")->strict(true)->insertGetId($data); goto nQT5k; QYmYJ: NDJec: goto GvTi1; DgY2E: Db::name("\171\x62\x73\x63\x5f\142\141\x72\x67\141\151\x6e\x5f\157\162\x64\145\x72\137\x70\141\x79\x6d\x65\156\164")->insert($pay_data); goto tllPY; GvTi1: $pay_data = array("\157\165\x74\x5f\164\162\141\144\145\x5f\x6e\157" => $data["\x6f\165\164\137\x74\162\x61\144\x65\137\x6e\x6f"], "\x70\141\171\x5f\x74\171\x70\145" => $data["\160\141\171\137\164\x79\160\145"], "\164\x79\x70\145\137\x61\154\x69\x73\137\x69\x64" => $id, "\160\141\171\x5f\x62\157\144\171" => mb_substr($data["\142\x61\162\x67\x61\x69\x6e\137\x6e\x61\155\145"], 0, 20, "\x75\164\x66\55\70"), "\x70\141\x79\137\x64\145\x74\x61\151\154" => "\345\xb9\263\345\x8f\260\xe8\xb4\xad\xe4\271\260\345\225\206\xe5\223\x81", "\x70\141\x79\x5f\155\x6f\x6e\145\171" => $data["\160\x61\171\137\155\x6f\x6e\145\x79"], "\x63\162\145\141\x74\145\x5f\x74\x69\x6d\145" => time()); goto DgY2E; nfWBG: $pp->print_order(); goto QYmYJ; HV00C: } catch (\Exception $e) { Db::rollback(); return null; } goto xNjxU; df_wT: Jb6JP: goto eEXCF; eEXCF: Db::startTrans(); goto PobJR; xNjxU: return $id; goto c_QuK; VGhFn: $data["\157\x72\x69\x67\151\x6e\141\154\x5f\x70\x72\x69\143\x65"] = $info["\156\160\x72\151\143\145"]; goto v8Z4l; GXcWS: $data["\142\x61\162\147\141\151\x6e\x5f\156\x61\x6d\145"] = $info["\x6e\141\155\x65"]; goto CwYlI; v8Z4l: goto Jb6JP; goto bVPUJ; i9KQI: $info = Db::name("\x79\x62\163\143\x5f\x62\x61\162\x67\141\151\156")->where("\151\144", $data["\x62\x61\162\x67\141\x69\x6e\x5f\x69\144"])->find(); goto sMS7D; QR_7d: $data["\x62\141\x72\x67\x61\151\156\137\160\151\143"] = $info["\x62\141\x72\x67\141\151\x6e\x5f\x70\x69\x63\164\165\x72\x65"]; goto q1MuK; Hsox2: if ($data["\x61\x63\164\x69\x76\151\x74\x79\x5f\x6f\162\x64\x65\162\x5f\x74\x79\x70\x65"] != 3) { goto VqYKw; } goto Lw_s2; CwYlI: $data["\x62\x61\162\x67\141\x69\156\137\x70\151\x63"] = ''; goto VGhFn; Lw_s2: $info = Db::name("\x79\142\x73\x63\x5f\x61\143\x74\151\166\x69\164\x79")->where("\x69\x64", $data["\x62\x61\x72\x67\141\151\156\137\x69\x64"])->find(); goto GXcWS; c_QuK: } public function orderList($data, $page = 1, $type) { goto V_fMo; C2qzO: goto yh15K; goto Gqye5; Ao6np: $order_list = null; goto C0bMQ; C0bMQ: $order_list = Db::name("\171\142\x73\x63\x5f\142\141\x72\147\x61\x69\156\x5f\x6f\x72\144\x65\162")->where("\x62\x75\x79\x65\162\137\151\x64", $data["\142\165\171\x65\x72\x5f\151\x64"])->where($where)->where("\x69\163\x5f\144\x65\x6c\x65\164\x65\x64", 0)->where("\157\162\144\x65\162\137\x73\x74\141\164\x75\163", $data["\157\162\x64\x65\x72\x5f\163\x74\141\164\165\163"])->page($page, PAGE_NUM)->order("\x63\x72\145\141\x74\145\x5f\x74\x69\155\x65", "\x64\145\163\x63")->select(); goto r0Xn6; Q2HY1: yh15K: goto Ao6np; xEGnN: $where = ["\x61\x63\164\x69\x76\x69\164\x79\x5f\157\x72\x64\x65\x72\x5f\164\171\x70\145" => 3]; goto C2qzO; CRNbw: return $order_list; goto Td0BZ; Gqye5: D_coT: goto fU9r7; aXINO: ATD_C: goto sG2W1; fU9r7: $where = ["\141\x63\164\151\166\x69\x74\x79\137\157\162\144\145\162\x5f\x74\171\160\145" => ["\x3c\76", 3]]; goto Q2HY1; NAqDQ: Ndvv1: goto CRNbw; sG2W1: foreach ($order_list as $key => $value) { goto QReMc; QHBRb: $order_list[$key]["\160\x61\x79\x5f\164\151\x6d\145"] = __TIME($value["\160\x61\x79\x5f\x74\x69\155\145"]); goto NKin1; BVfNa: if (!$pic) { goto voCby; } goto Jd2gm; yI8ch: $pic = Db::name("\171\142\163\143\137\151\155\141\147\x65\163")->where("\151\x6d\147\x5f\151\x64", $value["\x62\141\x72\x67\x61\x69\156\x5f\160\151\x63"])->field("\x69\x6d\x67\137\x63\x6f\x76\x65\x72\54\151\x6d\147\137\143\157\166\145\x72\x5f\x62\151\x67\54\x69\x6d\x67\137\143\x6f\166\145\x72\x5f\155\151\144\54\x69\x6d\147\x5f\x63\x6f\166\x65\162\x5f\163\x6d\x61\154\x6c")->find(); goto BVfNa; LSmak: wk260: goto axPQl; NKin1: $order_list[$key]["\143\x6f\x6e\163\151\x67\156\137\x74\x69\155\145"] = __TIME($value["\143\157\156\x73\151\147\x6e\x5f\164\x69\155\145"]); goto yI8ch; QReMc: $order_list[$key]["\x68\x61\166\x65\x5f\154\x6f\147"] = $this->check_log($value["\157\162\144\145\x72\x5f\x69\x64"]); goto X4TLX; Jd2gm: $order_list[$key]["\x70\x69\143"] = $pic; goto lqtUo; lqtUo: voCby: goto LSmak; X4TLX: $order_list[$key]["\x73\x69\x67\x6e\137\164\x69\155\145"] = __TIME($value["\163\x69\x67\x6e\x5f\164\x69\155\145"]); goto QHBRb; axPQl: } goto NAqDQ; flJLD: return $order_list; goto aXINO; r0Xn6: if (!empty($order_list)) { goto ATD_C; } goto flJLD; V_fMo: if ($type == 1) { goto D_coT; } goto xEGnN; Td0BZ: } public function check_log($order, $type = 2) { goto hD3Jf; eUYZM: $count = 0; goto kHuCi; jPwjv: return $count; goto YjvL1; kHuCi: goto gIN5K; goto nd9ZF; NlKyF: gIN5K: goto jPwjv; j9JeJ: if (!empty($res) && $res["\x72\x65\146\165\x6e\x64\137\x73\x74\x61\164\165\163"] != 3) { goto AJGTD; } goto eUYZM; nd9ZF: AJGTD: goto QJRgZ; QJRgZ: $count = 1; goto NlKyF; hD3Jf: $res = Db::name("\171\142\x73\x63\x5f\x6f\x72\144\145\162\x5f\x72\x65\146\x75\x6e\144")->field("\x72\x65\x66\165\156\x64\137\163\x74\x61\x74\x75\x73")->where(["\x6f\162\x64\x65\x72\x5f\151\144" => $order, "\x74\171\160\x65" => $type])->order("\151\x64", "\x64\x65\x73\143")->find(); goto j9JeJ; YjvL1: } public function getOrder($data) { goto j5f5k; cCeIh: return $order_info; goto proGX; Zt3Vz: $address["\143\151\164\x79"] = $city["\156\141\155\x65"]; goto DUpw_; sdZHx: QoXd2: goto b0L2m; A7zqN: $pro = Db::name("\x79\x62\163\x63\137\141\162\145\141")->where("\151\x64", $city["\160\x69\144"])->find(); goto QAfTQ; hgAT2: $order_info["\x70\x61\171\137\164\x69\x6d\145"] = __TIME($order_info["\160\141\171\137\164\151\x6d\145"]); goto yJLid; IWh7i: $order_info["\160\x69\143"] = $pic; goto sdZHx; QAfTQ: $address["\160\162\x6f\x76\x69\156\143\x65"] = $pro["\156\x61\155\x65"]; goto Zt3Vz; jcW1w: $city = Db::name("\x79\142\x73\x63\137\141\162\x65\141")->where("\151\x64", $res["\x70\x69\144"])->find(); goto A7zqN; PiDKp: $order_info["\x73\x69\147\x6e\137\x74\151\x6d\x65"] = __TIME($order_info["\163\x69\147\156\137\164\151\x6d\145"]); goto hgAT2; j5f5k: $order_info = null; goto whvF0; IdErW: if (!$pic) { goto QoXd2; } goto IWh7i; vwn9Z: $res = Db::name("\x79\x62\163\143\137\141\x72\x65\141")->where("\151\144", $order_info["\162\x65\x63\145\x69\x76\x65\x72\137\141\162\x65\x61"])->find(); goto jcW1w; yJLid: $order_info["\143\x6f\x6e\163\x69\x67\x6e\x5f\164\x69\x6d\145"] = __TIME($order_info["\143\x6f\x6e\163\x69\x67\x6e\x5f\164\x69\155\x65"]); goto zxoh0; EsuoH: $order_info["\141\x64\x64\x72\145\163\163"] = $address; goto OXPdd; proGX: V8ZNa: goto PiDKp; DUpw_: $address["\x64\151\163\x74\162\x69\143\x74"] = $res["\156\141\155\x65"]; goto EsuoH; KBBgh: if (!empty($order_info)) { goto V8ZNa; } goto cCeIh; whvF0: $order_info = Db::name("\171\x62\163\143\137\142\141\x72\x67\141\151\156\x5f\157\x72\x64\145\x72")->where($data)->where("\x69\163\137\144\x65\154\x65\x74\145\x64", 0)->find(); goto KBBgh; OXPdd: $pic = Db::name("\x79\142\163\x63\137\x69\155\141\x67\145\163")->where("\x69\155\147\x5f\151\x64", $order_info["\x62\141\x72\147\141\151\x6e\137\x70\151\x63"])->field("\151\x6d\147\137\143\157\x76\x65\x72\x2c\151\x6d\x67\x5f\x63\x6f\166\145\x72\x5f\142\151\x67\54\151\155\147\137\143\x6f\166\145\x72\137\155\x69\144\54\x69\155\147\137\x63\x6f\x76\x65\162\137\x73\x6d\141\x6c\x6c")->find(); goto IdErW; zxoh0: $order_info["\x63\x72\x65\141\x74\145\137\164\151\155\x65"] = __TIME($order_info["\143\162\145\141\x74\x65\x5f\x74\151\155\145"]); goto vwn9Z; b0L2m: return $order_info; goto mvgUG; mvgUG: } public function signOrder($data) { goto RA_on; jbVFR: $res = Db::name("\171\142\x73\x63\x5f\142\x61\x72\147\141\151\x6e\x5f\157\x72\x64\145\162")->where(["\157\162\144\x65\162\x5f\151\x64" => $data["\x6f\162\x64\x65\162\x5f\x69\144"]])->update($new_data); goto RtEdp; j9t7P: return json_encode($rs); goto Ed38O; aa4Vk: $new_data = array("\x6f\x72\x64\145\x72\137\x73\x74\x61\164\165\x73" => 3, "\x73\x69\147\x6e\x5f\x74\x69\x6d\x65" => time()); goto jbVFR; RA_on: $info = Db::name("\171\142\163\x63\137\142\x61\x72\147\141\151\x6e\137\157\162\144\x65\x72")->where($data)->find(); goto aL6pq; rMSHs: $pp->print_order(); goto aa4Vk; JNJA5: $pp = new PrinterService($data["\x6d\x63\150\x5f\x69\x64"], $data["\x6f\162\144\x65\x72\137\x69\x64"], "\143\157\156\x66\x69\x72\155", 1); goto rMSHs; aL6pq: if (!empty($info)) { goto kaL9d; } goto W6vXu; RtEdp: return $res; goto yj0ww; W6vXu: $rs["\x63\x6f\144\145"] = 1; goto Zp0oW; Zp0oW: $rs["\155\163\x67"] = "\xe8\257\xa5\xe8\256\242\xe5\x8d\x95\347\212\266\346\200\x81\345\xbc\x82\345\xb8\xb8\357\274\201"; goto j9t7P; Ed38O: kaL9d: goto JNJA5; yj0ww: } public function cancelOrder($data) { goto Sl93A; YnZhy: Db::startTrans(); goto MPYLT; NR84y: Db::name("\171\x62\163\143\137\x62\141\162\x67\x61\x69\156")->where("\151\x64\75" . $info["\x62\x61\x72\x67\x61\x69\156\137\x69\x64"])->setInc("\142\141\x72\147\141\x69\156\137\151\156\x76\145\156\164\x6f\162\x79", $info["\164\x6f\x74\141\154"]); goto cq7MX; c3plk: if (empty($bargain)) { goto BU5Ue; } goto NR84y; YmBMA: $bargain = Db::name("\x79\x62\x73\143\x5f\142\x61\162\147\x61\151\x6e")->where("\151\144\x3d" . $info["\142\x61\x72\x67\141\x69\x6e\x5f\x69\x64"])->find(); goto c3plk; cU3Uq: if (!empty($info)) { goto BbqNY; } goto GnGZ2; EED0L: return $res; goto entPW; cq7MX: BU5Ue: goto YnZhy; SCsXv: BbqNY: goto YmBMA; MPYLT: try { goto m5kmb; MDulj: $res = Db::name("\x79\x62\x73\143\x5f\x62\141\x72\147\141\151\156\x5f\x6f\x72\144\145\x72")->where(["\x6f\162\144\145\162\137\151\x64" => $data["\x6f\x72\x64\145\162\137\x69\144"]])->update($new_data); goto Fub2F; m5kmb: $new_data = array("\x6f\162\144\x65\x72\137\163\x74\x61\x74\x75\163" => -1); goto MDulj; Fub2F: Db::commit(); goto lEN8n; lEN8n: } catch (\Exception $e) { Db::rollback(); return $e->getMessage(); } goto EED0L; Sl93A: $info = Db::name("\171\x62\x73\x63\x5f\142\x61\x72\x67\141\151\x6e\x5f\x6f\x72\144\x65\x72")->where($data)->find(); goto cU3Uq; GnGZ2: return null; goto SCsXv; entPW: } public function delOrder($data) { goto yntUD; ChMZx: return $res; goto qYSUa; HJSCn: return null; goto w0oq8; wOzf1: $new_data = array("\151\x73\137\144\x65\x6c\145\164\145\x64" => 1); goto B0C_h; yntUD: $info = Db::name("\x79\142\x73\x63\x5f\x62\x61\x72\147\141\x69\156\137\x6f\x72\144\145\x72")->where($data)->find(); goto eFeys; B0C_h: $res = Db::name("\x79\142\163\x63\x5f\x62\x61\162\x67\x61\151\156\x5f\157\x72\144\x65\162")->where(["\157\x72\144\145\162\x5f\x69\144" => $data["\x6f\162\x64\x65\162\137\151\x64"]])->update($new_data); goto ChMZx; w0oq8: NWYdK: goto wOzf1; eFeys: if (!empty($info)) { goto NWYdK; } goto HJSCn; qYSUa: } public function refundOrder($data, $apply_refund) { goto sy50P; eCpiY: s2Ijv: goto KiLKZ; ucihh: if (!empty($info)) { goto mPRdC; } goto unYwi; vMxOk: mPRdC: goto iE_d7; ahcx9: $refund = new RefundService(); goto XKPS4; XKPS4: $refund->refundLog($info["\155\143\x68\x5f\x69\144"], $info["\x62\x75\x79\145\162\137\151\144"], $apply_refund, $info["\157\162\144\x65\x72\x5f\151\x64"], 2); goto eCpiY; KiLKZ: return $res; goto qmVek; unYwi: return null; goto vMxOk; PwjW0: $res = Db::name("\x79\x62\x73\x63\137\x62\141\162\147\141\x69\156\137\x6f\x72\x64\145\162")->where(["\157\x72\x64\x65\162\x5f\151\x64" => $data["\x6f\162\144\145\x72\137\x69\x64"]])->update($new_data); goto g5tPv; g5tPv: if (!($res && $apply_refund)) { goto s2Ijv; } goto ahcx9; sy50P: $info = Db::name("\171\142\x73\143\137\x62\x61\162\x67\141\151\x6e\x5f\x6f\x72\144\145\x72")->where($data)->find(); goto ucihh; iE_d7: $new_data = array("\x6f\x72\x64\145\162\x5f\x73\164\x61\164\165\x73" => 4, "\x72\x65\x66\x75\x6e\144\x5f\164\x69\155\145" => time(), "\x72\x65\x66\165\x6e\x64\x5f\163\164\141\164\x75\x73" => $info["\x6f\162\144\x65\x72\137\x73\x74\141\164\x75\x73"]); goto PwjW0; qmVek: } public function checkOrder($buyer_id, $bargain_id) { $rs = Db::name("\171\x62\x73\x63\x5f\142\x61\x72\147\141\x69\156\137\x6f\x72\x64\x65\x72")->where("\x62\x75\171\x65\162\137\151\144", $buyer_id)->where("\142\141\162\x67\141\x69\x6e\137\x69\144", $bargain_id)->where("\141\x63\x74\151\x76\x69\x74\x79\x5f\x6f\x72\x64\x65\x72\137\x74\171\x70\x65", 1)->where("\x6f\x72\144\x65\162\137\x73\164\x61\x74\x75\163", "\x3c\76", -1)->count(); return $rs; } public function checkmsOrder($buyer_id, $bargain_id) { goto mjgr5; TVltH: return $rs; goto jhKFW; gBsnE: $rs = Db::name("\171\142\163\143\x5f\142\x61\x72\147\x61\x69\156\137\157\162\144\x65\x72")->where("\142\165\171\x65\162\137\x69\x64", $buyer_id)->where("\142\141\162\147\141\x69\156\137\151\144", $bargain_id)->where("\141\143\164\151\166\x69\x74\x79\x5f\x6f\x72\x64\x65\162\x5f\x74\171\160\145", 3)->where("\157\x72\144\x65\x72\137\163\x74\141\x74\165\163", "\74\76", -1)->count(); goto TVltH; mjgr5: $act = Db::name("\x79\142\x73\143\x5f\x61\x63\x74\151\166\x69\x74\171")->where("\x69\x64", $bargain_id)->value("\155\x61\170\137\x70\162\145"); goto rMsGJ; wgw4a: return 0; goto edRPb; rMsGJ: if (!(empty($act) || $act == 0)) { goto gGv5G; } goto wgw4a; edRPb: gGv5G: goto gBsnE; jhKFW: } public function orderInfo($data) { goto tk6fx; Kh9wv: $res = Db::name("\x79\x62\x73\x63\x5f\141\162\x65\141")->where("\x69\144", $info["\162\x65\x63\x65\151\166\x65\x72\x5f\x61\x72\145\x61"])->find(); goto UvpLM; tk6fx: $info = Db::name("\x79\142\x73\143\x5f\x62\141\162\147\141\x69\x6e\137\157\x72\x64\x65\x72")->where($data)->find(); goto Kh9wv; bgnUj: return $info; goto aj0b1; jJzk1: $pro = Db::name("\x79\x62\x73\x63\x5f\141\162\145\141")->where("\x69\x64", $city["\160\x69\x64"])->find(); goto PsE28; dArk7: $info["\141\x64\x64\x72\x65\x73\163"] = $rs; goto bgnUj; UvpLM: $city = Db::name("\x79\142\x73\143\x5f\x61\x72\x65\x61")->where("\x69\x64", $res["\x70\151\x64"])->find(); goto jJzk1; NnsjQ: $rs["\x64\151\163\164\162\151\x63\x74"] = $res["\x6e\141\155\x65"]; goto dArk7; PsE28: $rs["\160\162\157\x76\151\156\143\145"] = $pro["\x6e\x61\x6d\x65"]; goto I4uLB; I4uLB: $rs["\143\x69\164\x79"] = $city["\x6e\x61\x6d\145"]; goto NnsjQ; aj0b1: } public function orderPay($data) { goto Cfpkr; UJi0H: zoA7V: goto dIFLq; p4cGR: $rs["\155\163\147"] = "\xe8\256\242\345\x8d\225\344\270\x8d\xe5\255\230\xe5\x9c\250"; goto D9109; Fj_vg: $unifiedorder = \WxPayApi::unifiedOrder($input); goto dklN6; gFJ7o: if (!empty($info)) { goto zoA7V; } goto A9F11; A9F11: $rs["\x63\x6f\144\145"] = 1; goto p4cGR; qllYf: return $rs; goto HePoq; JUBRw: if (!($unifiedorder["\162\x65\x73\x75\x6c\x74\x5f\143\x6f\x64\x65"] == "\x46\101\111\x4c")) { goto Zw_28; } goto j0cB9; DKoG5: $input->SetTrade_type("\x4a\x53\101\120\111"); goto Fj_vg; D9109: return $rs; goto UJi0H; c0Qte: $input->SetBody($info["\x70\141\171\x5f\142\157\144\171"]); goto fh65Q; eW8C9: $res = $this->weixinapp($unifiedorder); goto QpAXt; fh65Q: $input->SetOpenid($data["\157\x70\x65\x6e\151\144"]); goto Mu715; Cfpkr: $rs = array("\143\157\144\x65" => 0, "\151\x6e\146\x6f" => array()); goto LWaIw; TBbJv: $input->SetTotal_fee($info["\160\x61\x79\137\x6d\x6f\156\145\x79"] * 100); goto yNlyp; QK4HZ: $GLOBALS["\x6d\x63\150\137\x69\144"] = $data["\x6d\x63\150\137\151\144"]; goto sMDIz; ICG7x: return $rs; goto AoRYc; dIFLq: if (!($info["\x70\x61\x79\137\163\164\x61\x74\165\163"] != 0)) { goto rARVH; } goto NBRcH; IX9Wf: $rs["\155\163\x67"] = $unifiedorder["\145\x72\162\x5f\143\157\x64\x65\137\144\145\163"]; goto ICG7x; HePoq: rARVH: goto QK4HZ; AoRYc: Zw_28: goto eW8C9; KtYC8: $rs["\143\157\x64\x65"] = 1; goto OdlNI; lNxJc: $rs["\x6d\163\x67"] = "\xe8\xae\242\xe5\215\225\344\270\xbb\351\242\230\345\267\262\346\224\xb9\xe5\217\230"; goto qllYf; xFMua: return $rs; goto DIgZP; j0cB9: $rs["\143\x6f\144\x65"] = 1; goto IX9Wf; q6Yog: return $rs; goto CCIjN; OdlNI: $rs["\155\163\147"] = $unifiedorder["\162\x65\164\165\162\x6e\137\155\x73\147"]; goto q6Yog; LWaIw: $info = Db::name("\171\x62\x73\x63\137\x62\x61\x72\x67\x61\151\x6e\137\157\162\144\145\162\x5f\x70\141\171\155\x65\x6e\164")->where("\x6f\165\164\137\x74\162\x61\144\145\137\156\x6f", $data["\x6f\x75\x74\137\164\x72\141\144\x65\x5f\156\157"])->find(); goto gFJ7o; yNlyp: $input->SetOut_trade_no($data["\x6f\165\x74\x5f\164\x72\141\144\145\x5f\156\x6f"]); goto DKoG5; sMDIz: $GLOBALS["\x6b\145\x79"] = "\x62\x61\x72\147\x61\151\x6e"; goto o_xY2; dklN6: if (!($unifiedorder["\x72\145\164\x75\162\x6e\137\x63\x6f\x64\x65"] == "\x46\x41\111\x4c")) { goto LWQYS; } goto KtYC8; QpAXt: $rs["\x69\156\x66\x6f"] = $res; goto xFMua; NBRcH: $rs["\143\x6f\x64\x65"] = 1; goto lNxJc; Mu715: $input->SetDetail($info["\x70\141\171\x5f\x64\x65\x74\x61\x69\154"]); goto TBbJv; CCIjN: LWQYS: goto JUBRw; o_xY2: $input = new \WxPayUnifiedOrder(); goto c0Qte; DIgZP: } public function orderPaywap($data) { goto W0t3Q; eAXPO: if (!empty($info)) { goto Grj3S; } goto KrhIk; hmZew: return $rs; goto HaFVh; NZFvw: $input->SetBody($info["\x70\141\x79\x5f\144\145\164\x61\151\154"]); goto Rc_oD; dMytn: $rs["\143\157\x64\x65"] = 1; goto ZmItW; Rc_oD: $input->SetOut_trade_no($info["\x6f\x75\x74\x5f\164\x72\141\144\145\x5f\156\x6f"]); goto lq5fG; gkBPq: Grj3S: goto WMvX2; mmTlK: $input = new \WxPayUnifiedOrder(); goto NZFvw; IXZNM: $rs["\x63\x6f\144\x65"] = 1; goto aPtgb; H19My: $info = Db::name("\171\x62\163\x63\x5f\x62\x61\162\147\141\x69\156\x5f\157\162\x64\145\162\137\160\141\171\x6d\x65\156\x74")->where("\157\165\x74\x5f\164\x72\141\144\x65\137\x6e\157", $data["\x6f\165\x74\x5f\164\x72\x61\144\145\137\156\x6f"])->find(); goto eAXPO; y84E2: $spbill_create_ip = get_client_ip($type = 0, $adv = true); goto mmTlK; KrhIk: $rs["\143\157\x64\145"] = 1; goto OpQ47; ZmItW: $rs["\155\x73\x67"] = $unifiedorder["\x65\x72\x72\137\143\x6f\144\x65\137\x64\145\163"]; goto HJWOX; frENU: return $rs; goto IUkCQ; qxaLF: $input->SetScene_info("\173\42\x68\x35\137\x69\156\146\157\42\x3a\x20\x7b\42\164\171\x70\145\42\72\x22\127\x61\x70\42\54\x22\x77\141\x70\137\165\x72\x6c\x22\x3a\40\42\x68\164\x74\x70\x73\x3a\134\57\134\x2f\x77\x71\x2e\x73\x73\x73\x76\151\160\x2e\x6e\x65\164\x22\54\42\167\141\x70\137\156\x61\x6d\x65\x22\72\40\x22\xe5\243\271\xe4\xbd\260\xe5\x95\206\345\x9f\x8e\42\175\175"); goto JB_75; VZPAQ: $GLOBALS["\x6b\145\171"] = "\142\x61\x72\147\141\x69\x6e"; goto y84E2; WMvX2: if (!($info["\x70\141\x79\137\x73\x74\x61\x74\165\x73"] != 0)) { goto yFuPU; } goto vznbU; IUkCQ: d8UyJ: goto fOzXD; HJWOX: return $rs; goto pBR6N; F_Ied: $GLOBALS["\x6d\x63\150\x5f\x69\x64"] = $data["\155\x63\x68\137\151\144"]; goto VZPAQ; W0t3Q: $rs = array("\143\157\x64\145" => 0, "\151\156\146\157" => array()); goto H19My; vznbU: $rs["\x63\x6f\144\145"] = 1; goto yGRST; YHPMN: return $rs; goto gkBPq; aPtgb: $rs["\155\x73\147"] = $unifiedorder["\x72\x65\164\x75\x72\156\x5f\x6d\163\147"]; goto frENU; pudAM: return $unifiedorder; goto g_4gb; lq5fG: $input->SetTotal_fee($info["\x70\x61\x79\x5f\155\x6f\156\x65\171"] * 100); goto ySmMq; HaFVh: yFuPU: goto F_Ied; CpBER: if (!($unifiedorder["\x72\145\164\x75\x72\156\x5f\x63\157\x64\145"] == "\106\x41\x49\114")) { goto d8UyJ; } goto IXZNM; ySmMq: $input->SetSpbill_create_ip($spbill_create_ip); goto Wbuw4; pBR6N: wqQbl: goto pudAM; Wbuw4: $input->SetTrade_type("\115\127\105\x42"); goto qxaLF; JB_75: $unifiedorder = \WxPayApi::unifiedOrder($input); goto CpBER; yGRST: $rs["\x6d\163\x67"] = "\xe8\xae\242\xe5\x8d\225\xe4\270\xbb\xe9\xa2\230\xe5\267\262\346\224\271\xe5\217\x98"; goto hmZew; OpQ47: $rs["\155\x73\x67"] = "\350\256\242\345\215\x95\xe4\270\215\xe5\xad\230\345\x9c\250"; goto YHPMN; fOzXD: if (!($unifiedorder["\x72\145\163\165\x6c\164\137\143\157\144\x65"] == "\x46\x41\x49\114")) { goto wqQbl; } goto dMytn; g_4gb: } private function weixinapp($unifiedorder) { goto I54Qo; mYC20: $input->SetNonceStr($this->createNoncestr()); goto vb9Cf; MScHW: return $input; goto Tr00t; Bhoba: $input->SetSign(); goto MScHW; MEfRN: $input->SetSignType("\115\104\65"); goto Bhoba; VzpC_: $param = json_decode($param, true); goto v25dq; I54Qo: $param = Db::name("\x79\x62\163\143\137\x63\x6f\156\x66\x69\147")->where("\x6b\x65\171", "\x57\130\x50\101\x59")->where("\155\143\150\x5f\x69\144", $GLOBALS["\x6d\x63\x68\137\151\x64"])->where("\151\x73\137\165\x73\x65", 1)->value("\x76\x61\x6c\x75\x65"); goto VzpC_; v25dq: $input = new \WxPayJsApiPay(); goto p1Zpz; vb9Cf: $input->SetPackage("\160\x72\x65\160\141\171\137\151\144\75" . $unifiedorder["\160\162\x65\x70\x61\x79\137\x69\x64"]); goto MEfRN; p1Zpz: $input->SetAppid($param["\101\120\x50\x5f\x49\104"]); goto A0h3W; A0h3W: $input->SetTimeStamp('' . time() . ''); goto mYC20; Tr00t: } private function createNoncestr($length = 32) { goto rRZp2; k6ETy: $i = 0; goto ugrI3; rRZp2: $chars = "\141\142\143\x64\145\x66\x67\x68\151\x6a\x6b\154\155\x6e\x6f\x70\161\162\x73\164\x75\x76\x77\x78\171\172\x30\61\62\x33\64\x35\66\x37\70\71"; goto zpGTM; TBLoL: goto PVgSs; goto VF3ET; VF3ET: PsCMF: goto D3xO4; D3xO4: return $str; goto wgzaD; CHBV_: $i++; goto TBLoL; tu7Cj: if (!($i < $length)) { goto PsCMF; } goto dU8ci; ugrI3: PVgSs: goto tu7Cj; TYw76: jXISZ: goto CHBV_; zpGTM: $str = ''; goto k6ETy; dU8ci: $str .= substr($chars, mt_rand(0, strlen($chars) - 1), 1); goto TYw76; wgzaD: } }
