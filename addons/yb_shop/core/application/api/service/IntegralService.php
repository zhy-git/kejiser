<?php
 namespace app\api\service; use think\Db; use think\Exception; class IntegralService { public function get_integralinfo($data, $page) { goto XmpV0; VhOxC: foreach ($list as $k => $v) { $list[$k]["\x74\x69\x6d\x65"] = date("\x59\x2d\x6d\x2d\x64\40\150\x3a\x69\x3a\x73", $v["\164\151\155\145"]); zJRK3: } goto Hv3lU; W3tmy: $list = Db::name("\x79\x62\163\x63\x5f\x69\x6e\x74\x65\x67\x72\141\x6c\137\144\x65\164\x61\151\x6c")->where($where)->page($page, 20)->order("\x69\x64\x20\x64\145\163\x63")->select(); goto WrtzI; NcrPD: $where["\x75\163\145\162\x5f\x69\144"] = $data["\x75\x69\144"]; goto W3tmy; WrtzI: if (empty($list)) { goto qar4B; } goto VhOxC; Hv3lU: N2se7: goto TCNPd; TCNPd: qar4B: goto GMejM; BITcU: $where["\x69\156\164\x65\x67\162\x61\154"] = ["\x3e", 0]; goto aFBLr; JoEto: return $info; goto uI8AD; aFBLr: $where["\x6d\x63\150\x5f\151\x64"] = $data["\155\143\x68\137\151\144"]; goto NcrPD; GMejM: $info["\151\156\146\157"] = $list; goto JoEto; XmpV0: $info = ["\151\x6e\164\145\x67\x72\x61\x6c" => 0, "\151\156\146\x6f" => []]; goto cfJ69; cfJ69: $info["\151\156\x74\145\x67\x72\x61\154"] = Db::name("\171\x62\163\x63\137\165\x73\145\162")->where($data)->value("\x69\156\x74\x65\147\x72\x61\154"); goto BITcU; uI8AD: } public function get_speedrank($data, $page) { goto em2tA; IPDCE: tCr2i: goto YxK_5; em2tA: $today = strtotime(date("\x59\x2d\x6d\55\144"), time()); goto hOmB2; yoe2Z: Nhmhi: goto IPDCE; ZdW_1: if (empty($list)) { goto tCr2i; } goto rb75T; hOmB2: $list = Db::name("\x79\142\163\x63\x5f\151\156\164\145\147\x72\x61\154\x5f\144\145\164\x61\151\154")->where(["\155\143\x68\137\x69\144" => $data["\x6d\x63\150\137\x69\144"], "\x69\164\171\160\x65" => 1, "\x74\x79\160\x65\137\154\x78\x6d" => 1, "\151\156\x74\145\147\x72\x61\154" => ["\x3e", 0], "\x74\151\x6d\x65" => ["\x3e", $today]])->order("\151\x64\x20\141\163\143")->page($page, 20)->select(); goto ZdW_1; YxK_5: return $list; goto yIme3; rb75T: foreach ($list as $k => $v) { goto tdNOF; tdNOF: $list[$k]["\x75\163\145\162"] = Db::name("\x79\142\163\x63\x5f\165\163\145\162")->where("\x75\151\x64", $v["\165\163\145\162\137\x69\x64"])->field("\x75\x73\145\162\137\150\145\141\144\x69\155\x67\54\x6e\x69\143\x6b\137\156\x61\x6d\x65")->find(); goto Pe0OR; jlxxL: coek7: goto qPA7R; Pe0OR: $list[$k]["\x74\151\155\x65"] = "\344\273\212\345\244\xa9\40" . date("\110\72\x69\x3a\x73", $v["\x74\151\x6d\145"]); goto jlxxL; qPA7R: } goto yoe2Z; yIme3: } public function get_allrank($data, $page) { goto vEPfz; lRCD7: d0ta2: goto u1UQ4; JONsO: if (empty($list)) { goto uvszZ; } goto Xs2QN; Xs2QN: foreach ($list as $k => $v) { goto oh0w8; WnUZ7: A7S2V: goto cfO5p; oh0w8: $list[$k]["\165\163\145\x72"] = Db::name("\x79\x62\x73\143\x5f\x75\x73\x65\162")->where("\x75\151\x64", $v["\x75\x73\x65\162\137\151\144"])->field("\x75\163\145\x72\x5f\x68\145\141\x64\x69\x6d\x67\x2c\156\x69\x63\x6b\137\x6e\141\x6d\145")->find(); goto Kwol3; Kwol3: $list[$k]["\x74\x69\155\145"] = date("\x59\55\x6d\x2d\144\x20\x48\72\151\x3a\x73", $v["\164\151\x6d\145"]); goto WnUZ7; cfO5p: } goto lRCD7; u1UQ4: uvszZ: goto bL91q; vEPfz: $list = Db::name("\171\x62\x73\143\x5f\x69\156\164\145\x67\162\141\x6c\x5f\x64\145\164\141\151\x6c")->where(["\155\143\x68\x5f\151\x64" => $data["\155\x63\150\x5f\x69\144"], "\151\164\171\160\x65" => 1, "\164\171\x70\145\137\x6c\x78\155" => 1, "\x69\x6e\x74\x65\x67\162\x61\154" => ["\76", 0]])->field("\151\x64\54\x75\x73\x65\x72\137\x69\144\54\x63\157\x75\156\164\x28\165\x73\145\x72\x5f\151\x64\x29\x20\x61\x73\x20\x6e\165\155\137\x71\144\54\x74\x69\155\145")->order(["\156\x75\155\137\161\x64" => "\144\145\163\x63", "\164\151\155\145" => "\141\163\x63"])->page($page, 20)->group("\x75\x73\x65\x72\x5f\x69\144")->select(); goto JONsO; bL91q: return $list; goto JcMMa; JcMMa: } public function get_goodscate($data) { goto J6mIF; fu1RP: unset($data["\x75\x69\x64"]); goto tGl3Y; p6uxT: $data["\160\x69\x64"] = 0; goto m5c30; NvVI0: $info["\x69\156\164\x65\x67\x72\x61\x6c"] = Db::name("\x79\142\x73\x63\137\x75\x73\x65\x72")->where("\x75\x69\x64", $uid)->value("\x69\156\x74\145\x67\162\141\154"); goto ZogMt; tGl3Y: $data["\x73\x74\x61\164\x75\163"] = 1; goto p6uxT; ZogMt: return $info; goto HSOb9; J6mIF: $uid = $data["\x75\151\x64"]; goto fu1RP; EVjrO: $info["\154\151\163\164"] = $list; goto NvVI0; m5c30: $list = Db::name("\x79\142\163\143\137\151\x6e\x74\x65\147\162\141\154\x5f\147\157\157\x64\x73\x5f\x63\154\x61\163\163")->where($data)->order(["\163\157\162\x74" => "\141\163\143", "\151\144" => "\x61\x73\x63"])->select(); goto EVjrO; HSOb9: } public function get_goodslist($data, $page) { goto S9aHL; hWVsX: if (empty($list)) { goto EdNBP; } goto wwsU2; S9aHL: $data["\x73\x74\x61\x74\x75\x73"] = 1; goto nQ3i_; JjwS2: jVmeJ: goto ynLM9; wwsU2: foreach ($list as $k => $v) { goto U9irI; vWr2v: ZdEnh: goto oQsj3; ljsLa: $list[$k]["\162\145\163\164"] = intval($v["\156\165\x6d"]) - intval($v["\163\x61\x6c\x65\163"]); goto GqvOt; zw0G8: goto ZTLTc; goto ryPSU; GfIBO: $list[$k]["\x72\145\163\x74"] = 0; goto zw0G8; U9irI: if (intval($v["\156\165\155"]) > intval($v["\163\x61\x6c\x65\x73"])) { goto i7z3X; } goto GfIBO; ryPSU: i7z3X: goto ljsLa; GqvOt: ZTLTc: goto vWr2v; oQsj3: } goto JjwS2; nQ3i_: $list = Db::name("\x79\x62\x73\143\x5f\151\156\164\x65\147\x72\x61\154\x5f\147\x6f\x6f\144\163")->where($data)->order(["\163\x6f\x72\x74" => "\141\163\143", "\151\144" => "\x64\x65\163\x63"])->page($page, PAGE_NUM)->select(); goto hWVsX; YHInd: return $list; goto zHiW5; ynLM9: EdNBP: goto YHInd; zHiW5: } private $a = "\x79\142\163\143\137\165\163\x65\162\137\x61\x64\x64\x72\x65\x73\x73"; private $dq = "\x79\142\163\x63\x5f\141\x72\x65\x61"; public function get_goodsinfo($data, $uid) { goto uiHWi; bBEfy: $info["\165\163\x65\x72\137\151\156\164\x65\147\x72\141\x6c"] = Db::name("\x79\142\163\143\x5f\x75\163\x65\x72")->where("\165\151\x64", $uid)->value("\151\156\164\145\x67\162\x61\x6c"); goto gFMZT; o3Sas: if (!empty($info)) { goto XbBc3; } goto T0sun; jzTSR: QvCzd: goto CbUiP; uiHWi: $info = Db::name("\x79\142\x73\143\137\151\x6e\164\x65\x67\x72\x61\154\137\147\x6f\157\x64\x73")->where($data)->find(); goto o3Sas; KB9iK: if (intval($info["\x6e\165\x6d"]) > intval($info["\x73\141\154\145\163"])) { goto QvCzd; } goto chl0s; ragFa: $pro = Db::name($this->dq)->where("\151\144", $city["\160\x69\x64"])->find(); goto rqdTx; T2L_V: goto C4SGS; goto jzTSR; nxJ1y: $address = Db::name($this->a)->field("\143\157\x6e\x73\x69\147\x6e\145\x72\x2c\160\x68\x6f\x6e\x65\x2c\141\144\x64\162\x65\x73\x73\54\141\162\145\141")->where("\x75\x69\144", $uid)->where("\x69\x73\x5f\144\x65\146\141\x75\x6c\164\x20", 1)->find(); goto rztDa; EA3N_: XbBc3: goto KB9iK; cT95y: $city = Db::name($this->dq)->where("\151\144", $res["\160\x69\x64"])->find(); goto ragFa; PU7Sj: if (empty($address)) { goto hy2Lm; } goto kWkv6; kWkv6: $res = Db::name($this->dq)->where("\151\x64", $address["\141\x72\145\141"])->find(); goto cT95y; q3csd: C4SGS: goto nxJ1y; pH4zc: $address["\144\151\163\x74\162\151\143\164"] = $res["\156\x61\155\145"]; goto n2JAu; lMu5B: $address["\143\x69\164\171"] = $city["\x6e\141\x6d\x65"]; goto pH4zc; CbUiP: $info["\x72\x65\163\164"] = intval($info["\x6e\x75\x6d"]) - intval($info["\x73\x61\x6c\x65\163"]); goto q3csd; FAvpR: v9qIA: goto PU7Sj; gFMZT: return $info; goto GbU27; sNEHY: hy2Lm: goto bBEfy; T0sun: return null; goto EA3N_; chl0s: $info["\x72\145\x73\x74"] = 0; goto T2L_V; gBlCk: $address = Db::name($this->a)->field("\143\157\156\x73\151\147\156\x65\162\x2c\x70\x68\x6f\x6e\x65\x2c\141\x64\144\x72\145\163\x73\54\141\x72\x65\x61")->where("\165\151\144", $uid)->order("\143\x72\x65\x61\x74\145\x5f\x74\151\155\145", "\144\x65\x73\x63")->find(); goto FAvpR; rqdTx: $address["\160\x72\157\166\151\x6e\x63\x65"] = $pro["\x6e\x61\155\145"]; goto lMu5B; n2JAu: $info["\141\144\x64\x72\145\x73\x73"] = $address; goto sNEHY; rztDa: if (!empty($address)) { goto v9qIA; } goto gBlCk; GbU27: } public function get_exchangelog($data, $page) { goto MiZ94; MiZ94: $list = Db::name("\171\142\x73\x63\137\151\156\x74\x65\147\x72\141\154\x5f\157\162\x64\x65\162")->where($data)->order(["\151\x64" => "\144\145\x73\143"])->page($page, PAGE_NUM)->select(); goto mwTP0; eHWon: return $list; goto K8qz4; DId3k: foreach ($list as $k => $v) { goto GWRz9; jOIW2: $list[$k]["\x63\162\x65\141\164\x65\x5f\164\151\x6d\x65"] = date("\x59\x2d\x6d\55\x64\x20\x48\72\x73", $v["\143\x72\x65\141\164\145\137\164\x69\155\145"]); goto Tj_Ij; CiBRY: OD487: goto Or1Oh; Tj_Ij: LozAv: goto CiBRY; GWRz9: if (!$v["\143\x72\x65\x61\164\145\137\164\151\155\145"]) { goto LozAv; } goto jOIW2; Or1Oh: } goto c2Dnj; GsGhw: EOYP7: goto eHWon; mwTP0: if (empty($list)) { goto EOYP7; } goto DId3k; c2Dnj: ruiHh: goto GsGhw; K8qz4: } public function get_createorder($data) { goto UzryF; utUlv: Db::startTrans(); goto gvaO2; e3lb8: $rs["\x63\157\x64\145"] = 1; goto xDdQ6; wFr8B: qiFe5: goto hDS6_; CmHno: return json_encode($rs); goto WnAAh; d13eo: $rs["\x63\157\x64\x65"] = 1; goto pC1O8; qAO9V: return json_encode($rs); goto R8_Bb; xDdQ6: $rs["\x6d\x73\x67"] = "\xe8\257\245\xe5\225\x86\345\223\201\345\xb7\262\xe4\xb8\x8b\xe6\x9e\xb6\346\210\x96\344\270\x8d\xe5\255\230\xe5\234\xa8"; goto qAO9V; BCCMG: $user_integral = Db::name("\x79\142\163\143\137\x75\163\x65\x72")->where("\165\x69\x64", $data["\165\151\144"])->value("\151\x6e\164\145\147\x72\141\x6c"); goto kXObi; hDS6_: $data["\143\162\x65\141\x74\x65\x5f\x74\x69\155\145"] = time(); goto utUlv; UzryF: $rs = array("\x63\157\x64\x65" => 0, "\x6d\163\x67" => "\xe5\x85\221\346\x8d\242\346\210\x90\xe5\x8a\237"); goto tzKN0; gvaO2: try { goto dvNjN; z6als: zi_oC: goto O2IuH; wC6HE: WA4IC: goto krPDE; bAPBF: throw new Exception("\346\223\215\344\275\234\xe5\xa4\xb1\350\264\245\63"); goto ewsVL; q2Gsy: if (!empty($rs4)) { goto WA4IC; } goto SepKg; Do8xL: $rs1 = Db::name("\x79\x62\x73\143\x5f\x69\156\x74\145\x67\162\x61\154\137\x6f\162\144\x65\x72")->insert($data); goto Nix4h; f22sM: $rs3 = Db::name("\x79\142\163\x63\137\x69\x6e\x74\x65\x67\x72\x61\154\137\144\145\164\x61\x69\154")->insert($in_data); goto cud6g; k1bks: throw new Exception("\xe6\223\215\344\275\234\345\xa4\261\xe8\264\xa5\x31"); goto z6als; WERAC: $rs4 = Db::name("\x79\142\x73\x63\137\x69\x6e\x74\x65\147\x72\x61\154\x5f\147\x6f\x6f\x64\x73")->where("\151\144", $data["\x67\x6f\157\x64\x73\137\x69\x64"])->setInc("\x73\141\154\x65\x73"); goto q2Gsy; SepKg: throw new Exception("\346\x93\215\xe4\xbd\234\xe5\244\261\xe8\xb4\245\x34"); goto wC6HE; H6EyH: XxQsF: goto f22sM; O2IuH: $rs2 = Db::name("\x79\x62\x73\x63\137\x75\x73\x65\162")->where("\165\x69\144", $data["\x75\151\144"])->setDec("\151\x6e\164\145\147\162\x61\154", $data["\x69\156\164\x65\x67\162\141\x6c"]); goto cJM0X; ewsVL: db3AA: goto WERAC; Nix4h: if (!empty($rs1)) { goto zi_oC; } goto k1bks; lslK4: throw new Exception("\346\x93\x8d\xe4\275\x9c\xe5\xa4\261\xe8\xb4\245\62"); goto H6EyH; cJM0X: if (!empty($rs2)) { goto XxQsF; } goto lslK4; dvNjN: $in_data = ["\x65\x78\x70\x6c\141\151\x6e" => "\345\225\x86\345\x93\201\345\205\x91\346\215\242", "\164\x79\x70\145\137\154\170\155" => 3, "\165\x73\145\162\137\151\144" => $data["\x75\151\144"], "\x69\x6e\x74\145\147\x72\x61\x6c" => $data["\x69\x6e\164\145\x67\162\141\154"], "\151\164\171\x70\145" => 2, "\143\x74\171\x70\x65" => 0, "\x63\157\x6e\x73\165\155\145" => 0, "\164\x69\155\145" => time(), "\155\143\150\137\x69\x64" => $data["\155\143\150\137\151\144"]]; goto Do8xL; cud6g: if (!empty($rs3)) { goto db3AA; } goto bAPBF; krPDE: } catch (\Exception $e) { Db::rollback(); return json_encode(["\x63\157\x64\x65" => 1, "\155\163\147" => $e->getMessage()]); } goto CmHno; tzKN0: $goods = Db::name("\171\x62\163\x63\x5f\151\x6e\164\145\x67\162\141\154\x5f\147\157\x6f\144\163")->where(["\151\144" => $data["\147\157\157\144\163\x5f\x69\144"]])->find(); goto A4mWI; vD3PY: return json_encode($rs); goto wFr8B; R8_Bb: voxeV: goto iAQKj; pC1O8: $rs["\x6d\x73\x67"] = "\xe6\x82\xa8\xe7\232\x84\xe7\xa7\257\345\210\206\344\xb8\215\350\266\263"; goto vD3PY; iAQKj: $data["\x67\157\157\x64\163\137\156\x61\155\x65"] = $goods["\x74\151\x74\x6c\145"]; goto rGiYH; ofylX: $data["\151\156\164\145\147\x72\x61\154"] = $goods["\151\156\x74\x65\147\x72\x61\x6c"]; goto BCCMG; rGiYH: $data["\x67\157\157\x64\163\x5f\160\151\x63"] = $goods["\151\x6d\x61\147\145"]; goto ofylX; A4mWI: if (!empty($goods)) { goto voxeV; } goto e3lb8; kXObi: if (!(intval($user_integral) < intval($data["\151\156\164\x65\x67\162\141\154"]))) { goto qiFe5; } goto d13eo; WnAAh: } public function get_setting($data) { goto bFZRm; eYJqf: $rs["\x69\x6e\146\157"]["\x71\144"] = $this->qiandao($info, $data); goto krJLd; LLH3Y: if (empty($info)) { goto uVSDr; } goto F2qPw; jf6XM: $rs["\151\156\146\x6f"]["\165\163\145\x72"] = $user_list; goto OoMdH; phBW0: return json_encode($rs); goto kexbv; u6Yfs: goto MzIZl; goto DVift; JwiSb: $rs["\x69\156\146\x6f"]["\x73\x65\x74\164\151\156\147"] = $info; goto eYJqf; kexbv: MzIZl: goto dgMTg; pwa3I: $rs["\143\157\144\x65"] = 1; goto K1NaR; YZwfs: dX30U: goto vOCYu; gbUlG: JudO7: goto PpygY; HE9wr: yWRrV: goto JwiSb; BjYu7: if (empty($user_list)) { goto qf0rP; } goto Mf3NW; OoMdH: return json_encode($rs); goto KhaVE; KhaVE: goto MzIZl; goto UfSsu; PBFTR: $info = Db::name("\171\142\x73\143\x5f\x69\156\x74\145\147\162\x61\154\x5f\163\x65\x74\164\x69\x6e\x67")->where(["\155\143\150\x5f\151\x64" => $data["\155\143\150\x5f\151\144"]])->find(); goto LLH3Y; koQr5: $rs["\155\163\147"] = "\347\xa7\xaf\xe5\210\x86\347\255\276\345\x88\260\346\x9c\xaa\345\xbc\x80\xe5\220\257"; goto zZMO2; bv8k4: $info["\x63\157\x6e\x74\137\162\145\167\141\162\x64\62"] = json_decode($info["\143\x6f\156\164\137\x72\145\x77\141\x72\x64"], true); goto gbUlG; DVift: nIM2S: goto pwa3I; bFZRm: $rs = array("\x63\157\144\145" => 0, "\x69\156\146\x6f" => array()); goto mMQ97; UOV85: $info["\x6f\164\150\x65\x72\62"] = json_decode($info["\157\x74\150\x65\162"]); goto HE9wr; krJLd: $today = strtotime(date("\131\55\x6d\x2d\x64"), time()); goto GwbJ6; zZMO2: return json_encode($rs); goto u6Yfs; vOCYu: qf0rP: goto jf6XM; F2qPw: if ($info["\x69\x73\137\x6f\160\x65\156"] == 0) { goto nIM2S; } goto Cm90b; kIcw8: $rs["\143\x6f\x64\145"] = 1; goto koQr5; Cm90b: if (!$info["\x63\x6f\x6e\x74\x5f\162\x65\x77\x61\162\x64"]) { goto JudO7; } goto bv8k4; K1NaR: $rs["\155\163\x67"] = "\347\247\xaf\345\x88\206\347\xad\276\345\x88\xb0\346\x9c\252\xe5\274\200\345\220\xaf"; goto phBW0; UfSsu: uVSDr: goto kIcw8; Mf3NW: foreach ($user_list as $k => $v) { goto dSISo; RLWXn: RuoTv: goto qnxOa; fVxPh: $user_list[$k]["\x75\163\145\x72"] = Db::name("\171\x62\163\x63\137\165\163\x65\x72")->where("\165\151\144", $v["\165\x73\x65\162\137\x69\x64"])->field("\x75\x73\145\162\137\x68\x65\x61\144\151\x6d\147\x2c\x6e\x69\x63\x6b\x5f\x6e\141\155\145")->find(); goto GuIFI; Ro3AC: $rs["\x69\x6e\x66\x6f"]["\162\141\156\153"] = $k + 1; goto C9CRc; dSISo: if (!($v["\165\163\x65\x72\137\x69\144"] == $data["\x75\151\x64"])) { goto c24R3; } goto Ro3AC; C9CRc: c24R3: goto fVxPh; GuIFI: $user_list[$k]["\x74\x69\x6d\145"] = "\xe4\273\x8a\345\244\xa9\40" . date("\110\72\x69\x3a\x73", $v["\164\x69\x6d\x65"]); goto RLWXn; qnxOa: } goto YZwfs; PpygY: if (!$info["\x6f\164\150\145\162"]) { goto yWRrV; } goto UOV85; mMQ97: $rs["\x69\x6e\x66\157"]["\162\x61\156\x6b"] = 1; goto PBFTR; GwbJ6: $user_list = Db::name("\171\142\x73\143\x5f\151\x6e\164\145\147\162\141\154\137\144\x65\x74\141\x69\x6c")->where(["\x6d\143\x68\137\151\x64" => $data["\x6d\143\x68\137\151\144"], "\x69\164\171\160\x65" => 1, "\x74\171\160\145\137\x6c\x78\x6d" => 1, "\x69\x6e\164\x65\x67\x72\141\x6c" => ["\x3e", 0], "\164\151\x6d\145" => ["\76", $today]])->order("\x74\151\x6d\145\x20\141\163\143")->select(); goto BjYu7; dgMTg: } public function qiandao($info, $data) { goto WLwrd; QS4Md: FIBTJ: goto Pv3JA; amyuE: $res["\144\x61\171"] = $this->add_integral($data, $info["\154\x65\166\x65\x6c"], $num_qd, $other_lxm, 4); goto Si9n6; dwrRt: $num_qd = 1; goto O1C1Y; KQDT_: if (!($info["\143\157\156\164\137\x72\x65\x77\141\162\144"] && $num_qd > 1)) { goto Rmew6; } goto xcgwc; chEvD: goto WXqnV; goto jEWeW; n6LQs: if (empty($qd)) { goto eTeqC; } goto w5rFY; xcgwc: $cont_reward = json_decode($info["\143\157\156\164\137\162\145\x77\141\x72\x64"]); goto u0pKu; jtyQl: mRaQ0: goto R2kDd; R2kDd: aoftG: goto jp8pL; HO0TW: goto ALImp; goto m521L; EmLE8: goto BY7D2; goto jtyQl; A0o_g: goto ALImp; goto YvZjc; XJ3RS: $datea = $other->date; goto MwArz; C4i9G: WXqnV: goto OwH6A; M9Ftx: $other = json_decode($info["\157\x74\150\x65\x72"]); goto XJ3RS; UpxdX: $other_lxm->reward = $info["\144\141\x79\x5f\x72\145\167\141\162\144"]; goto amyuE; w5rFY: if ($qd && $qd["\x74\x69\x6d\x65"] < $today) { goto opGNk; } goto WpUeB; U6RO5: $res["\157\164\x68\x65\162"] = $this->add_integral($data, $info["\x6c\145\x76\145\154"], $num_qd, $other, 1); goto wXK8v; TG4FG: $today = strtotime(date("\x59\55\x6d\x2d\x64"), time()); goto dwrRt; jp8pL: $i++; goto chEvD; brGa6: bI6_k: goto KQDT_; ZDTXZ: return $res; goto xqZ9m; WpUeB: $lxm = 2; goto Pmg_j; IER5g: if (!$info["\x6f\x74\x68\145\x72"]) { goto bI6_k; } goto M9Ftx; bNx_p: $str_day = intval(strtotime(date("\131\55\x6d\55\144"), time())) - 24 * 3600; goto v0PTa; O1C1Y: $lxm = 1; goto enV0H; HvVzV: if (!($cont_reward[$i]->date == $num_qd && intval($cont_reward[$i]->reward) > 0)) { goto mRaQ0; } goto EkJ6A; u0pKu: $i = 0; goto C4i9G; Pmg_j: $res["\x64\x61\171"] = ["\x63\x6f\x64\145" => 0, "\155\x73\x67" => "\345\267\262\xe7\xad\276\xe5\x88\260", "\x69\x6e\x74\x65\147\162\x61\x6c" => $qd["\x69\156\164\x65\x67\162\141\x6c"], "\156\165\155\137\x71\144" => $qd["\x6e\x75\x6d\x5f\161\144"], "\x65\170\160\x6c\x61\151\x6e" => $this->to_explain($qd["\x65\x78\160\154\x61\151\x6e"])]; goto HO0TW; jO6ed: tABji: goto ZDTXZ; E8M_G: Rmew6: goto jO6ed; j1ikC: if (!($lxm == 1)) { goto tABji; } goto IER5g; OwH6A: if (!($i < count($cont_reward))) { goto BY7D2; } goto HvVzV; MwArz: if (!(!empty($datea) && !empty($other->reward) && intval($other->reward) > 0 && strtotime($datea) == $today)) { goto jwczU; } goto U6RO5; YvZjc: opGNk: goto bNx_p; Lnf1q: $other_lxm = (object) []; goto eGM1n; v7FS2: $res["\144\141\171"] = $this->add_integral($data, $info["\x6c\145\166\x65\154"], $num_qd, $other_lxm, 3); goto zHWYh; zHWYh: return $res; goto A0o_g; Pv3JA: $other_lxm = (object) []; goto UpxdX; rGRev: $num_qd = intval($qd["\156\x75\x6d\x5f\161\x64"]) + 1; goto QS4Md; enV0H: $qd = Db::name("\x79\x62\163\143\x5f\151\x6e\164\145\147\x72\141\x6c\x5f\x64\145\x74\x61\x69\x6c")->where(["\155\143\x68\137\x69\144" => $data["\x6d\x63\x68\137\x69\144"], "\x69\164\x79\x70\145" => 1, "\165\163\x65\162\x5f\151\x64" => $data["\165\x69\x64"], "\x74\x79\x70\x65\x5f\x6c\170\x6d" => 1, "\151\156\164\145\147\162\x61\x6c" => ["\x3e", 0]])->order("\x69\144\40\144\145\x73\x63")->find(); goto n6LQs; v0PTa: if (!($qd["\x74\151\x6d\145"] < $today && $qd["\164\151\x6d\145"] >= $str_day)) { goto FIBTJ; } goto rGRev; wXK8v: jwczU: goto brGa6; jEWeW: BY7D2: goto E8M_G; eGM1n: $other_lxm->reward = $info["\146\x72\151\163\x74\x5f\162\145\x77\141\x72\144"]; goto v7FS2; EkJ6A: $res["\x63\157\156\x74"] = $this->add_integral($data, $info["\x6c\145\166\x65\x6c"], $num_qd, $cont_reward[$i], 2); goto EmLE8; m521L: eTeqC: goto Lnf1q; WLwrd: $res = ["\x6f\x74\150\145\162" => [], "\144\141\171" => [], "\x63\157\156\164" => []]; goto TG4FG; Si9n6: ALImp: goto j1ikC; xqZ9m: } public function add_integral($data, $level, $num_qd, $other, $type = 1) { goto RPq3V; sjWoP: $new_data["\x74\x79\160\x65\x5f\x6c\170\x6d"] = 2; goto c2GxG; c2GxG: $new_data["\145\x78\160\154\141\151\x6e"] = $other->title ? $other->title : "\xe7\x89\xb9\xe6\xae\212\xe6\x97\xa5\346\234\x9f\xe5\xa5\226\xe5\x8a\xb1"; goto Izo7z; uQBBO: $new_data["\x74\x79\x70\x65\x5f\x6c\x78\x6d"] = 1; goto wtPHE; UPZm0: Db::startTrans(); goto e02ek; k0vfC: if ($type == 3) { goto RTQI7; } goto TqzyY; n3U7S: $new_data["\x74\171\160\145\x5f\x6c\170\155"] = 2; goto rq9z4; ef7Mi: $new_data["\145\x78\160\154\141\x69\156"] = "\xe6\257\x8f\346\227\xa5\347\255\xbe\xe5\x88\xb0"; goto djPn_; TqzyY: if ($type == 4) { goto mVSf1; } goto Rvtf3; gZ7oH: joB79: goto n3U7S; wtPHE: $new_data["\145\170\x70\154\141\x69\x6e"] = "\xe9\246\226\xe6\xac\241\347\xad\276\xe5\210\xb0"; goto o8mBZ; NxbVt: if ($type == 1) { goto SJSGP; } goto EyIha; Izo7z: goto ZIhFL; goto gZ7oH; VH4YZ: $new_data["\x74\171\x70\x65\x5f\x6c\170\155"] = 1; goto ef7Mi; O48nt: mVSf1: goto VH4YZ; o8mBZ: goto ZIhFL; goto O48nt; djPn_: ZIhFL: goto UPZm0; Rvtf3: goto ZIhFL; goto VMg2r; IWiHV: RTQI7: goto uQBBO; EyIha: if ($type == 2) { goto joB79; } goto k0vfC; l2AiF: goto ZIhFL; goto IWiHV; VMg2r: SJSGP: goto sjWoP; rq9z4: $new_data["\x65\x78\x70\154\x61\151\x6e"] = "\xe8\277\236\xe7\273\xad\347\255\276\345\x88\xb0" . $other->date . "\345\244\xa9"; goto l2AiF; RPq3V: $new_data = ["\164\151\155\145" => time(), "\x69\x74\x79\160\145" => 1, "\143\x74\x79\160\145" => $level == 1 ? 1 : 0, "\156\165\x6d\137\161\144" => $num_qd, "\x6f\x72\x64\x65\x72\x5f\x69\x64" => 0, "\165\163\x65\162\137\151\144" => $data["\165\151\144"], "\155\x63\150\137\x69\x64" => $data["\155\143\150\x5f\x69\x64"], "\x69\156\164\145\147\162\x61\154" => $other->reward, "\143\x6f\x6e\x73\165\155\x65" => $level == 1 ? $other->reward : 0]; goto NxbVt; e02ek: try { goto Ps1AD; xnrW9: $user_data["\x63\157\156\x73\165\155\145"] = intval($c["\x63\x6f\156\x73\165\x6d\145"]) + intval($new_data["\x63\x6f\156\163\165\x6d\145"]); goto cISg0; JuvXU: if (!$d) { goto kEV6B; } goto yWw4E; cISg0: RdXda: goto mEw37; XO97y: m5sdQ: goto d6bKG; Ps1AD: $lxm1 = Db::name("\171\142\x73\143\137\x69\x6e\164\x65\x67\x72\x61\x6c\137\144\145\164\141\x69\x6c")->insert($new_data); goto KnaNy; qB_7c: $user_data["\x69\x6e\164\145\147\x72\141\x6c"] = intval($c["\151\x6e\164\145\x67\x72\141\x6c"]) + intval($new_data["\151\x6e\164\x65\x67\162\141\x6c"]); goto W3rjP; yWw4E: $i = 0; goto jGnOl; sBFBK: $i++; goto jcJK3; bOaFP: $c = Db::name("\x79\142\x73\x63\x5f\x75\x73\145\x72")->where("\165\x69\144", $data["\165\x69\x64"])->find(); goto qB_7c; mEw37: $lxm2 = Db::name("\171\x62\x73\x63\137\165\x73\145\x72")->where("\x75\x69\144", $data["\x75\151\x64"])->update($user_data); goto iH2UG; gJEBD: ySSsg: goto R0Du7; vrlIL: Xm8m5: goto sBFBK; c9otY: kEV6B: goto XO97y; WQW0l: $level_id = $d[$i]["\x69\x64"]; goto HdAs_; jGnOl: oI7Hb: goto wAZqw; tOynb: HGexZ: goto c9otY; OBmVS: $d = Db::name("\x79\x62\163\143\x5f\165\x73\x65\x72\x5f\154\x65\x76\x65\154")->where("\155\x63\150\137\151\x64", $data["\x6d\143\x68\x5f\x69\144"])->order("\x68\151\145\162\141\162\x63\150\171", "\x64\x65\x73\x63")->select(); goto JuvXU; W3rjP: if (!($level == 1)) { goto RdXda; } goto xnrW9; D51CA: goto HGexZ; goto dsDkC; QXaBA: BD54I: goto bOaFP; iH2UG: if (!empty($lxm2)) { goto ySSsg; } goto O_19J; O_19J: throw new Exception("\347\255\xbe\345\x88\260\xe5\xa4\xb1\xe8\xb4\245\x32"); goto gJEBD; d6bKG: return ["\143\x6f\x64\x65" => $type, "\151\x6e\164\x65\147\162\x61\154" => $new_data["\x69\x6e\164\145\147\162\x61\154"], "\156\165\155\x5f\161\144" => $new_data["\156\165\155\x5f\x71\x64"], "\x65\x78\x70\154\x61\151\156" => $new_data["\x65\170\160\154\141\x69\x6e"]]; goto Z_Z0R; wAZqw: if (!($i < count($d))) { goto HGexZ; } goto SUDyv; KnaNy: if (!empty($lxm1)) { goto BD54I; } goto k7pOv; k7pOv: throw new Exception("\xe7\255\276\xe5\x88\xb0\xe5\244\xb1\350\264\245\61"); goto QXaBA; R0Du7: if (!($level == 1)) { goto m5sdQ; } goto OBmVS; HdAs_: Db::name("\171\x62\x73\x63\x5f\x75\x73\x65\x72")->where("\165\x69\144", $data["\x75\151\x64"])->update(["\154\x65\x76\145\x6c\137\x69\x64" => $level_id]); goto D51CA; jcJK3: goto oI7Hb; goto tOynb; SUDyv: if (!($user_data["\x63\x6f\x6e\163\165\155\x65"] >= $d[$i]["\x68\151\x65\162\141\x72\x63\x68\171"])) { goto W3IVm; } goto WQW0l; dsDkC: W3IVm: goto vrlIL; Z_Z0R: } catch (\Exception $e) { goto rOOoy; rOOoy: $msg = $e->getMessage(); goto dJBA9; QZTYu: return ["\x63\157\144\145" => -1, "\x6d\x73\x67" => $msg]; goto JiMuK; dJBA9: Db::rollback(); goto QZTYu; JiMuK: } goto jYgMA; jYgMA: } public function to_explain($msg, $itype = 1) { goto Wor2T; zXK4w: t_FfD: goto ajQ3f; ajQ3f: $msg = "\xe5\225\x86\345\x9f\216\346\266\x88\350\xb4\xb9"; goto nMR8P; UWWRj: if (empty($msg) || $msg == "\xe6\x97\240") { goto celFh; } goto FFij7; nMR8P: Quoh0: goto AsOM5; AsOM5: return $msg; goto TACV4; nQdk2: goto rjb9P; goto VEIbd; ZDHGu: goto Quoh0; goto zXK4w; VQw5Q: $lxm = "\345\xa5\226\xe5\212\xb1"; goto VNgwS; o3o78: celFh: goto B753V; SxrkL: $lxm = "\xe6\211\243\351\x99\244"; goto nQdk2; VNgwS: rjb9P: goto UWWRj; FFij7: if ($msg == "\346\xb6\x88\350\264\xb9") { goto t_FfD; } goto zWRHU; Wor2T: if ($itype == 1) { goto IBSfK; } goto SxrkL; B753V: $msg = "\347\263\273\xe7\273\237" . $lxm; goto ZDHGu; zWRHU: goto Quoh0; goto o3o78; VEIbd: IBSfK: goto VQw5Q; TACV4: } }
