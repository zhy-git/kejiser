<?php
 include_once "\x65\162\162\157\162\103\x6f\144\x65\x2e\x70\150\160"; class WXBizDataCrypt { private $appid; private $sessionKey; public function __construct($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto r9G6I; fqsFw: gq44t: goto y2FT2; r08Cv: c7kuy: goto WxO_J; FdlqI: DGeA_: goto Z7BHS; sowMG: if (!(strlen($iv) != 24)) { goto gq44t; } goto pVfm1; Z7BHS: $data = $result; goto Hy1TS; h16Li: $result = openssl_decrypt($aesCipher, "\x41\x45\x53\55\61\x32\x38\55\103\x42\103", $aesKey, 1, $aesIV); goto rUW1D; r9G6I: if (!(strlen($this->sessionKey) != 24)) { goto c7kuy; } goto hpL74; BLsDm: if (!($dataObj->watermark->appid != $this->appid)) { goto DGeA_; } goto Pj0QD; hpL74: return ErrorCode::$IllegalAesKey; goto r08Cv; LxeMD: SZzm3: goto BLsDm; WxO_J: $aesKey = base64_decode($this->sessionKey); goto sowMG; Hy1TS: return ErrorCode::$OK; goto X1rYc; rUW1D: $dataObj = json_decode($result); goto Jgxsw; AjmSY: $aesCipher = base64_decode($encryptedData); goto h16Li; pVfm1: return ErrorCode::$IllegalIv; goto fqsFw; Jgxsw: if (!($dataObj == NULL)) { goto SZzm3; } goto Iya2_; Pj0QD: return ErrorCode::$IllegalBuffer; goto FdlqI; y2FT2: $aesIV = base64_decode($iv); goto AjmSY; Iya2_: return ErrorCode::$IllegalBuffer; goto LxeMD; X1rYc: } }